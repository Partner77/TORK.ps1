# Define a preferencia de acao para erros (continua a execucao por padrao)
# Permite que o script tente rodar o m√°ximo poss√≠vel mesmo que alguns comandos encontrem problemas.
$ErrorActionPreference = 'SilentlyContinue' # N√£o exibe erros se um item n√£o puder ser processado, por exemplo.

# --- Funcao pra Centralizar Texto (Nosso Maestro de Alinhamento - s√≥ pra textos, n√£o pro bannerz√£o!) ---
# Deixa ela aqui, vai que a gente usa pra centralizar outra coisa, n√©?
function Centraliza($texto, $cor="White") {
    $largura = [console]::WindowWidth # Pega a largura da largura da janela agora
    # Calcula o espa√ßo pra botar o texto no meio. Pura matem√°tica da zoeira!
    $espacos = [Math]::Max(0, [Math]::Floor(($largura - $texto.Length) / 2))
    $linha = (" " * $espacos) + $texto # Cria a linha com os espa√ßos e o texto
    Write-Host $linha -ForegroundColor $cor # Manda pro console com a cor pedida
}

# --- Funcao que Desenha o Nosso Banner Irado do TORK! ---
# Esse √© o nosso outdoor digital no console! Ajustado pros espa√ßos que voc√™ mandou!
# Se as bordas ainda estiverem meio teimosas, √© o jeitinho do console mesmo, viu? üòâ
function Banner-TORK {
    # Nossas cores vibrantes para o banner!
    $CorBorda = "DarkCyan" # Mantido para a borda, combina com o ciano. Se quiser mudar, √© aqui!
    $CorLogo = "Green" # Cor vibrante
    $CorProjeto = "Cyan" # Cor vibrante
    $CorCopyright = "Gray" # Tom mais suave

    Write-Host "" # D√° um espacinho no topo, pra n√£o grudar
    Write-Host "                    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë          ‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë ‚ñà‚ñà‚ïî‚ïù                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ñà‚ñà‚ïó                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù                                          ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë           Bem-vindo ao TORK - Otimizador para Windows!                                ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë        Projeto de automacao, limpeza, manutencao e tweaks.                            ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë            (C) Partner77 - Todos os direitos reservados                               ‚ïë" -ForegroundColor $CorCopyright
    Write-Host "                    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor $CorBorda
    Write-Host "" # Espa√ßo embaixo
}

# --- Checagem de Permiss√µes de Administrador (O Guarda da Porta!) ---
# V√™ se a gente t√° rodando com poderes de admin, sen√£o n√£o d√° pra mexer no Windows direito.
function Test-Administrator {
    $currentUser = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())
    return $currentUser.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
}

if (-not (Test-Administrator)) {
    Write-Host "OPA! Calma l√°, patr√£o!" -ForegroundColor Red
    Write-Host "Pra usar o TORK e deixar o PC voando, preciso de super poderes de Administrador!" -ForegroundColor Yellow
    Write-Host "Fecha essa janela, clica com o bot√£o direito no arquivo do script e escolhe 'Executar como administrador'. A√≠ sim, tamo junto!" -ForegroundColor Yellow
    Read-Host "D√° um Enter quando terminar de ler, que a gente se v√™ na pr√≥xima..."
    Exit
}

Write-Host "Poderes de Administrador verificados! Bora nessa!" -ForegroundColor Green
Start-Sleep -Seconds 1

# --- Fun√ß√µes Utilit√°rias (Ferramentas que usamos em v√°rios lugares) ---
function Get-SystemInfo {
    $os = Get-CimInstance Win32_OperatingSystem
    $cs = Get-CimInstance Win32_ComputerSystem
    $proc = Get-CimInstance Win32_Processor
    $mem = Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property Capacity -Sum
    
    $info = @{
        "OSName" = $os.Caption
        "OSVersion" = $os.Version
        "OSBuild" = $os.BuildNumber
        "ComputerName" = $cs.Name
        "Manufacturer" = $cs.Manufacturer
        "Model" = $cs.Model
        "Processor" = $proc.Name
        "Memory" = [math]::Round($mem.Sum / 1GB, 2)
        "Architecture" = $os.OSArchitecture
        "InstallDate" = $os.InstallDate
        "LastBootTime" = $os.LastBootUpTime
    }
    
    return $info
}

function Show-SystemSummary {
    $sysInfo = Get-SystemInfo
    
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Computador: $($sysInfo.ComputerName)" -ForegroundColor White
    Write-Host "Fabricante: $($sysInfo.Manufacturer)" -ForegroundColor White
    Write-Host "Modelo: $($sysInfo.Model)" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "Instalado em: $($sysInfo.InstallDate)" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

function Get-DiskSpaceBefore {
    $drives = Get-PSDrive -PSProvider FileSystem
    $driveInfo = @{}
    
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        
        $driveInfo[$drive.Name] = @{
            "Free" = $freeSpace
            "Used" = $usedSpace
            "Total" = $totalSpace
        }
    }
    
    return $driveInfo
}

function Show-DiskSpaceComparison {
    param (
        $before
    )
    
    $after = Get-PSDrive -PSProvider FileSystem
    
    Write-Host "=== Compara√ß√£o de Espa√ßo em Disco ===" -ForegroundColor Cyan
    
    foreach ($drive in $after) {
        if ($before.ContainsKey($drive.Name)) {
            $freeSpaceAfter = [math]::Round($drive.Free / 1GB, 2)
            $freeSpaceBefore = $before[$drive.Name].Free
            $spaceRecovered = [math]::Round($freeSpaceAfter - $freeSpaceBefore, 2)
            
            Write-Host "Drive $($drive.Name):" -ForegroundColor White
            Write-Host "  Espa√ßo livre antes: $freeSpaceBefore GB" -ForegroundColor Gray
            Write-Host "  Espa√ßo livre agora: $freeSpaceAfter GB" -ForegroundColor Gray
            
            if ($spaceRecovered -gt 0) {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Green
            } else {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Yellow
            }
            Write-Host ""
        }
    }
    
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

# --- Fun√ß√µes dos Menus (Principal, Simplificado, Avan√ßado e Sub-menus) ---

# --- Menu Principal (A Bifurca√ß√£o do Destino! Simplificado vs Avan√ßado) ---
# √â aqui que o usu√°rio escolhe se quer ser um mago ou um cara pr√°tico!
function Show-MainMenu {
    do {
        Clear-Host # Limpa a tela pra organizar o menu
        Banner-TORK # Banner no topo, pra gente n√£o esquecer quem somos!
        Show-SystemSummary # Mostra um resumo do sistema

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "       MENU PRINCIPAL" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # As duas grandes estradas da otimiza√ß√£o! Cores variadas (repetindo)!
        Write-Host "[1] Otimiza√ß√£o Simplificada (Pra quem quer praticidade e resultado r√°pido!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o Avan√ßada (Pra quem curte mexer fundo e ter control total!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[3] Diagn√≥stico R√°pido do Sistema (Ver o que t√° rolando no PC)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[4] Sobre o TORK (Informa√ß√µes e cr√©ditos)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[0] Sair (Ah, que pena... Mas a porta t√° aberta!)" -ForegroundColor Red # Vermelho pra Sair - Ok

        Write-Host ""

        # Pergunta pro usu√°rio qual caminho ele escolhe, tipo Mestre Pok√©mon!
        $choice = Read-Host "Escolhe sua op√ß√£o, treinador!"

        # V√™ pra onde a gente vai com base na escolha
        switch ($choice) {
            "1" { Show-SimplifiedMenu } # Se escolheu 1, vai pro Menu Simplificado!
            "2" { Show-AdvancedMenu } # Se escolheu 2, vai pro Menu Avan√ßado!
            "3" { Invoke-QuickDiagnostic } # Nova fun√ß√£o de diagn√≥stico r√°pido
            "4" { Show-AboutTORK } # Nova fun√ß√£o de sobre
            "0" { Write-Host "Fechou! Valeu por usar o TORK! Volte sempre que seu PC pedir um g√°s! ;)" -ForegroundColor Green; Start-Sleep -Seconds 2; break } # Se escolheu 0, vaza (mas volta!)
            default {
                Write-Host "Eita! Op√ß√£o inv√°lida! Confere os n√∫meros e tenta de novo, bora l√°!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1 # D√° um tempinho pro usu√°rio ver a zoeira da mensagem
            }
        }
    } while ($choice -ne '0') # Repete o Menu Principal enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Simplificado (Aqui o TORK faz m√°gica r√°pida e segura!) ---
# Acessado pela op√ß√£o 1 do Menu Principal. Menos op√ß√µes, mais a√ß√£o direta!
function Show-SimplifiedMenu {
    do {
        Clear-Host # Limpa o palco pra esse menu!
        Banner-TORK # Nosso banner no topo, sempre presente!

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "   OTIMIZACAO SIMPLIFICADA" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes SIMPLIFICADAS - cada uma pode fazer um monte de coisa por baixo dos panos! Cores variadas (repetindo as prim√°rias/neon e adicionando outras)!
        Write-Host "[1] Limpeza Geral do Sistema (Tira o lixo que t√° pesando!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o de Mem√≥ria e Programas que Ligam com o Windows (Deixa tudo mais √°gil!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[3] Acelerar a Conex√£o com a Internet (Pra navegar sem gargalo!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[4] Deixar o Windows mais Leve Visualmente (Desativa uns efeitos pra ganhar desempenho!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Otimiza√ß√£o de Jogos (Configura√ß√µes pra melhorar FPS e desempenho)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[6] Manuten√ß√£o de Seguran√ßa (Verificar e corrigir problemas de seguran√ßa)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[7] RODAR TODAS as otimiza√ß√µes SIMPLIFICADAS! (Modo Turbo F√°cil!)" -ForegroundColor Red # Vermelho pra "Faz Tudo" - Destaque/Cuidado
        Write-Host "[0] Voltar ao Menu Principal (A gente te espera aqui!)" -ForegroundColor Gray # Cor neutra pra voltar

        Write-Host ""

        # Pergunta qual m√°gica simplificada o usu√°rio quer
        $choice = Read-Host "Escolhe sua m√°gica simplificada!"

        # V√™ qual m√°gica rodar
        switch ($choice) {
            "1" { Invoke-SimpleSystemCleanup } # Chama a fun√ß√£o de limpeza b√°sica
            "2" { Invoke-SimpleMemoryStartup } # Chama a fun√ß√£o pra mem√≥ria/inicializa√ß√£o
            "3" { Invoke-SimpleInternetOpt } # Chama a fun√ß√£o pra internet
            "4" { Invoke-SimpleVisualOpt } # Chama a fun√ß√£o pra visual
            "5" { Invoke-SimpleGamingOpt } # Nova fun√ß√£o para otimiza√ß√£o de jogos
            "6" { Invoke-SimpleSecurityMaintenance } # Nova fun√ß√£o para manuten√ß√£o de seguran√ßa
            "7" {
                # Rodar todas as simplificadas sequencialmente
                Write-Host "`nModo Turbo F√°cil ATIVADO! Rodando todas as otimiza√ß√µes SIMPLIFICADAS... segura pe√£o!`n" -ForegroundColor Yellow
                Invoke-SimpleSystemCleanup # Roda a 1
                Invoke-SimpleMemoryStartup # Roda a 2
                Invoke-SimpleInternetOpt # Roda a 3
                Invoke-SimpleVisualOpt # Roda a 4
                Invoke-SimpleGamingOpt # Roda a 5
                Invoke-SimpleSecurityMaintenance # Roda a 6
                Write-Host "`nShow! Todas as otimiza√ß√µes SIMPLIFICADAS foram executadas! PC t√° agradecendo! ;)`n" -ForegroundColor Green
                Read-Host "Aperta Enter pra voltar pro Menu Simplificado..." # Pausa no final do "Rodar Todas"
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-MainMenu
            default {
                Write-Host "Ops! Op√ß√£o inv√°lida no Menu Simplificado! Confere os n√∫meros e manda bala de novo!" -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Simplificado enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Avan√ßado (O Playground dos Magos do PC!) ---
# Acessado pela op√ß√£o 2 do Menu Principal. Aqui a gente mergulha fundo!
function Show-AdvancedMenu {
    do {
        Clear-Host # Limpa o palco pro menu avan√ßado!
        Banner-TORK # Nosso banner no topo, pra n√£o perder a pose!

        Write-Host "" # Espacinho maroto
        Write-Host "===============================" -ForegroundColor White
        Write-Host "      MENU AVANCADO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes do menu avan√ßado (as CATEGORIAS dos 200 poderes!) Cores variadas (repetindo)!
        Write-Host "[1] Limpeza e Manuten√ß√£o de Arquivos (Tirar a poeira digital!)" -ForegroundColor Cyan # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[2] Otimiza√ß√µes de Desempenho do Sistema (Deixar o motor roncando!)" -ForegroundColor Green # Cor variada
        Write-Host "[3] Configura√ß√µes e Otimiza√ß√µes de Rede (Pra internet voar baixo!)" -ForegroundColor Yellow # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[4] Gerenciamento e Otimiza√ß√£o de Servi√ßos do Windows (O que t√° rodando e n√£o precisa?!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Ferramentas de Diagn√≥stico e Verifica√ß√£o (Pra ver se t√° tudo nos conformes!)" -ForegroundColor Cyan # Cor repetida
        Write-Host "[6] Desabilitar/Gerenciar Recursos do Windows (Tirar o peso extra do sistema!)" -ForegroundColor Green # Cor repetida
        Write-Host "[7] Gerenciamento de Arquivos e Pastas Avan√ßado (Comandos ninja pra arquivos!)" -ForegroundColor Yellow # Cor repetida
        Write-Host "[8] Gerenciamento de Contas de Usu√°rio (Organizar a galera que usa o PC!)" -ForegroundColor White # Cor repetida
        Write-Host "[9] Otimiza√ß√£o para Jogos Avan√ßada (Tweaks pra gamers de verdade!)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Configura√ß√µes de Privacidade (Controle o que o Windows sabe sobre voc√™)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[11] Outras Configura√ß√µes e Tweaks Diversos (Aqueles ajustes secretos!)" -ForegroundColor Gray # Cor neutra/escura
        Write-Host "[0] Voltar ao Menu Principal (Pronto pra voltar pra estrada principal!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta pro mago qual categoria ele quer explorar
        $choice = Read-Host "Escolhe sua √°rea de magia, mago!"

        # V√™ pra onde a gente navega dentro do mundo avan√ßado
        switch ($choice) {
            "1" { Show-LimpezaManutencaoMenu } # CHAMA O SUB-MENU DE LIMPEZA
            "2" { Show-DesempenhoMenu } # Agora √© um sub-menu tamb√©m
            "3" { Show-ConfiguracoesRedeMenu } # CHAMA O SUB-MENU DE REDE
            "4" { Show-ServicosMenu } # Agora √© um sub-menu tamb√©m
            "5" { Show-DiagnosticoMenu } # Agora √© um sub-menu tamb√©m
            "6" { Show-RecursosMenu } # Agora √© um sub-menu tamb√©m
            "7" { Show-ArquivosPastasMenu } # Agora √© um sub-menu tamb√©m
            "8" { Show-UsuariosMenu } # Agora √© um sub-menu tamb√©m
            "9" { Show-JogosAvancadoMenu } # Novo sub-menu para jogos
            "10" { Show-PrivacidadeMenu } # Novo sub-menu para privacidade
            "11" { Show-OutrosMenu } # Agora √© um sub-menu tamb√©m
            "0" { break } # Sai do loop deste menu, voltando pro Menu Principal
            default {
                Write-Host "Humm, essa √°rea da magia ainda n√£o existe ou voc√™ digitou errado! Tenta de novo, mago!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Avan√ßado enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Limpeza e Manuten√ß√£o (Dentro do Avan√ßado!) ---
# Este menu lista as op√ß√µes ESPEC√çFICAS da categoria Limpeza no Menu Avan√ßado
function Show-LimpezaManutencaoMenu {
    do {
        Clear-Host # Limpa o palco pra este sub-menu!
        Banner-TORK # Banner no topo, sempre!

        Write-Host "" # Espacinho
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: LIMPEZA E MANUT." -ForegroundColor White # T√≠tulo menor pro sub-menu
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes ESPEC√çFICAS da categoria Limpeza. Cores variadas (repetindo cores)!
        Write-Host "[1] Limpar Arquivos Tempor√°rios do Usu√°rio (Tipo a pasta Temp!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[2] Limpar Arquivos Tempor√°rios do Sistema (Os tempor√°rios do Windows!)" -ForegroundColor Gray # Cor neutra (substitui DarkCyan)
        Write-Host "[3] Limpar Cache de DNS (Pra resolver nomes de site mais r√°pido!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[4] Esvaziar Lixeira (Adeus, arquivos deletados!)" -ForegroundColor Gray # Cor neutra (repetindo)
        Write-Host "[5] Limpar Cache de Miniaturas (Aqueles previews de imagem/v√≠deo!)" -ForegroundColor Green # Cor variada
        Write-Host "[6] Limpar Logs do Sistema (Arquivos de registro que acumulam)" -ForegroundColor Cyan # Nova op√ß√£o
        Write-Host "[7] Limpar Cache de Atualiza√ß√µes do Windows (Liberar espa√ßo de updates)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[8] Limpar Arquivos de Hiberna√ß√£o (Liberar o hiberfil.sys)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[9] Limpar Arquivos WinSxS (Pasta que ocupa muito espa√ßo)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Executar TODAS as limpezas acima (Faxina completa!)" -ForegroundColor Red # Nova op√ß√£o
        Write-Host "[0] Voltar ao Menu Avan√ßado (De volta pras categorias!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta qual limpeza espec√≠fica o mago quer fazer
        $choice = Read-Host "Escolhe a limpeza avan√ßada, mestre!"

        # V√™ qual fun√ß√£o de limpeza espec√≠fica chamar
        switch ($choice) {
            "1" { Invoke-CleanUserTemp } # Chama a fun√ß√£o pra Limpar Temp Usu√°rio
            "2" { Invoke-CleanSystemTemp } # Chama a fun√ß√£o pra Limpar Temp Sistema
            "3" { Invoke-CleanDnsCache } # Chama a fun√ß√£o pra Limpar Cache DNS
            "4" { Invoke-EmptyRecycleBin } # Chama a fun√ß√£o pra Esvaziar Lixeira
            "5" { Invoke-CleanThumbnailCache } # Chama a fun√ß√£o pra Limpar Cache de Miniaturas
            "6" { Invoke-CleanSystemLogs } # Nova fun√ß√£o para limpar logs do sistema
            "7" { Invoke-CleanWindowsUpdateCache } # Nova fun√ß√£o para limpar cache de updates
            "8" { Invoke-CleanHibernationFile } # Nova fun√ß√£o para limpar arquivo de hiberna√ß√£o
            "9" { Invoke-CleanWinSxS } # Nova fun√ß√£o para limpar pasta WinSxS
            "10" { 
                # Executa todas as limpezas em sequ√™ncia
                Write-Host "`nIniciando faxina completa do sistema! Isso pode demorar um pouco...`n" -ForegroundColor Yellow
                $diskSpaceBefore = Get-DiskSpaceBefore
                
                Invoke-CleanUserTemp
                Invoke-CleanSystemTemp
                Invoke-CleanDnsCache
                Invoke-EmptyRecycleBin
                Invoke-CleanThumbnailCache
                Invoke-CleanSystemLogs
                Invoke-CleanWindowsUpdateCache
                Invoke-CleanHibernationFile
                Invoke-CleanWinSxS
                
                Write-Host "`nFaxina completa finalizada! Veja quanto espa√ßo foi recuperado:`n" -ForegroundColor Green
                Show-DiskSpaceComparison -before $diskSpaceBefore
                Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-AdvancedMenu
            default {
                Write-Host "Essa tarefa de limpeza ainda n√£o t√° na lista! V√™ os n√∫meros e tenta de novo!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Sub-Menu Limpeza enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Desempenho (Dentro do Avan√ßado!) ---
function Show-DesempenhoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DESEMPENHO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Ajustar Efeitos Visuais para Melhor Desempenho" -ForegroundColor Green
        Write-Host "[2] Otimizar Disco do Sistema" -ForegroundColor Cyan
        Write-Host "[3] Limpar Arquivos Prefetch" -ForegroundColor Yellow
        Write-Host "[4] Definir Plano de Energia para Alto Desempenho" -ForegroundColor White
        Write-Host "[5] Otimizar Servi√ßo SuperFetch/SysMain" -ForegroundColor Magenta
        Write-Host "[6] Ajustar Tamanho da Mem√≥ria Virtual" -ForegroundColor Gray
        Write-Host "[7] Desativar Indexa√ß√£o de Arquivos" -ForegroundColor Green
        Write-Host "[8] Otimizar Inicializa√ß√£o do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de desempenho" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o de desempenho"

        switch ($choice) {
            "1" { Invoke-OptimizeVisualEffects }
            "2" { Invoke-OptimizeDisk }
            "3" { Invoke-CleanPrefetch }
            "4" { Invoke-SetHighPerformancePower }
            "5" { Invoke-OptimizeSuperFetch }
            "6" { Invoke-AdjustVirtualMemory }
            "7" { Invoke-DisableIndexing }
            "8" { Invoke-OptimizeStartup }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de desempenho...`n" -ForegroundColor Yellow
                Invoke-OptimizeVisualEffects
                Invoke-OptimizeDisk
                Invoke-CleanPrefetch
                Invoke-SetHighPerformancePower
                Invoke-OptimizeSuperFetch
                Invoke-AdjustVirtualMemory
                Invoke-DisableIndexing
                Invoke-OptimizeStartup
                Write-Host "`nTodas as otimiza√ß√µes de desempenho foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Configura√ß√µes de Rede (Dentro do Avan√ßado!) ---
function Show-ConfiguracoesRedeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: CONFIG. REDE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Limpar Cache de DNS" -ForegroundColor Yellow
        Write-Host "[2] Mudar Servidor DNS" -ForegroundColor Cyan
        Write-Host "[3] Resetar Configura√ß√µes de Rede" -ForegroundColor White
        Write-Host "[4] Otimizar Configura√ß√µes TCP/IP" -ForegroundColor Green
        Write-Host "[5] Verificar Velocidade da Conex√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar QoS (Qualidade de Servi√ßo)" -ForegroundColor Gray
        Write-Host "[7] Desativar IPv6 (Se n√£o estiver usando)" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Lat√™ncia de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de rede" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√£o de rede"

        switch ($choice) {
            "1" { Invoke-NetworkFlushDns }
            "2" { Invoke-NetworkChangeDns }
            "3" { Invoke-NetworkReset }
            "4" { Invoke-OptimizeTcpIp }
            "5" { Invoke-CheckNetworkSpeed }
            "6" { Invoke-ConfigureQoS }
            "7" { Invoke-DisableIPv6 }
            "8" { Invoke-OptimizeGamingLatency }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de rede...`n" -ForegroundColor Yellow
                Invoke-NetworkFlushDns
                Invoke-OptimizeTcpIp
                Invoke-CheckNetworkSpeed
                Invoke-ConfigureQoS
                Invoke-DisableIPv6
                Invoke-OptimizeGamingLatency
                Write-Host "`nTodas as otimiza√ß√µes de rede foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Rede..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Servi√ßos (Dentro do Avan√ßado!) ---
function Show-ServicosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: SERVICOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desabilitar Servi√ßo SuperFetch/SysMain" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Servi√ßo de Impress√£o" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Servi√ßo Windows Update" -ForegroundColor White
        Write-Host "[4] Listar Todos os Servi√ßos em Execu√ß√£o" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Otimizar Servi√ßos para Desempenho Geral" -ForegroundColor Gray
        Write-Host "[7] Restaurar Servi√ßos para Configura√ß√£o Padr√£o" -ForegroundColor Yellow
        Write-Host "[8] Desabilitar Servi√ßos Desnecess√°rios" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de servi√ßos"

        switch ($choice) {
            "1" { Invoke-ManageSuperFetch }
            "2" { Invoke-ManagePrintService }
            "3" { Invoke-ManageWindowsUpdate }
            "4" { Invoke-ListRunningServices }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-OptimizeServicesForPerformance }
            "7" { Invoke-RestoreDefaultServices }
            "8" { Invoke-DisableUnnecessaryServices }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Diagn√≥stico (Dentro do Avan√ßado!) ---
function Show-DiagnosticoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DIAGNOSTICO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Verificar Arquivos do Sistema (SFC)" -ForegroundColor Yellow
        Write-Host "[2] Reparar Imagem do Windows (DISM)" -ForegroundColor Cyan
        Write-Host "[3] Verificar Disco por Erros (CHKDSK)" -ForegroundColor White
        Write-Host "[4] Verificar Sa√∫de do Disco" -ForegroundColor Green
        Write-Host "[5] Verificar Drivers Desatualizados" -ForegroundColor Magenta
        Write-Host "[6] Verificar Problemas de Inicializa√ß√£o" -ForegroundColor Gray
        Write-Host "[7] Verificar Problemas de Mem√≥ria RAM" -ForegroundColor Yellow
        Write-Host "[8] Verificar Temperatura do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODOS os diagn√≥sticos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de diagn√≥stico"

        switch ($choice) {
            "1" { Invoke-SfcScan }
            "2" { Invoke-DismRepair }
            "3" { Invoke-ChkDsk }
            "4" { Invoke-CheckDiskHealth }
            "5" { Invoke-CheckDrivers }
            "6" { Invoke-CheckStartupIssues }
            "7" { Invoke-CheckMemory }
            "8" { Invoke-CheckTemperature }
            "9" {
                Write-Host "`nExecutando todos os diagn√≥sticos...`n" -ForegroundColor Yellow
                Invoke-SfcScan
                Invoke-DismRepair
                Invoke-CheckDiskHealth
                Invoke-CheckDrivers
                Invoke-CheckStartupIssues
                Invoke-CheckTemperature
                Write-Host "`nTodos os diagn√≥sticos foram conclu√≠dos!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Diagn√≥stico..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Recursos (Dentro do Avan√ßado!) ---
function Show-RecursosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: RECURSOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Gerenciar Hiberna√ß√£o" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Planos de Energia" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Recursos Opcionais do Windows" -ForegroundColor White
        Write-Host "[4] Gerenciar Mem√≥ria Virtual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Windows Defender" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Recursos de Telemetria" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Recursos de Inicializa√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Recursos de Seguran√ßa" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de recursos"

        switch ($choice) {
            "1" { Invoke-ManageHibernation }
            "2" { Invoke-ManagePowerPlans }
            "3" { Invoke-ManageOptionalFeatures }
            "4" { Invoke-ManageVirtualMemory }
            "5" { Invoke-ManageWindowsDefender }
            "6" { Invoke-ManageTelemetry }
            "7" { Invoke-ManageStartupResources }
            "8" { Invoke-ManageSecurityFeatures }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Arquivos e Pastas (Dentro do Avan√ßado!) ---
function Show-ArquivosPastasMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: ARQUIVOS E PASTAS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Encontrar Arquivos Grandes" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Arquivos" -ForegroundColor Cyan
        Write-Host "[3] Tomar Posse de Arquivos (TakeOwn)" -ForegroundColor White
        Write-Host "[4] Listar Conte√∫do de Pastas Espec√≠ficas" -ForegroundColor Green
        Write-Host "[5] Compactar Pastas para Economizar Espa√ßo" -ForegroundColor Magenta
        Write-Host "[6] Verificar Integridade de Arquivos" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Arquivos Ocultos e do Sistema" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Atributos de Arquivos" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de arquivos e pastas"

        switch ($choice) {
            "1" { Invoke-FindLargeFiles }
            "2" { Invoke-ManageFilePermissions }
            "3" { Invoke-TakeOwnership }
            "4" { Invoke-ListFolderContents }
            "5" { Invoke-CompressFolders }
            "6" { Invoke-VerifyFileIntegrity }
            "7" { Invoke-ManageHiddenSystemFiles }
            "8" { Invoke-ManageFileAttributes }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Usu√°rios (Dentro do Avan√ßado!) ---
function Show-UsuariosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: USUARIOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Listar Todos os Usu√°rios Locais" -ForegroundColor Yellow
        Write-Host "[2] Listar Todos os Grupos Locais" -ForegroundColor Cyan
        Write-Host "[3] Listar Membros de Grupos Espec√≠ficos" -ForegroundColor White
        Write-Host "[4] Mostrar Propriedades do Usu√°rio Atual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Contas de Usu√°rio" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Pol√≠ticas de Senha" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Permiss√µes de Usu√°rio" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar UAC (Controle de Conta de Usu√°rio)" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de usu√°rios"

        switch ($choice) {
            "1" { Invoke-ListLocalUsers }
            "2" { Invoke-ListLocalGroups }
            "3" { Invoke-ListGroupMembers }
            "4" { Invoke-ShowCurrentUserProperties }
            "5" { Invoke-ManageUserAccounts }
            "6" { Invoke-ManagePasswordPolicies }
            "7" { Invoke-ManageUserPermissions }
            "8" { Invoke-ManageUAC }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Jogos Avan√ßado (Dentro do Avan√ßado!) ---
function Show-JogosAvancadoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: JOGOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Otimizar Prioridade de CPU para Jogos" -ForegroundColor Yellow
        Write-Host "[2] Otimizar Configura√ß√µes de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[3] Otimizar Configura√ß√µes de GPU" -ForegroundColor White
        Write-Host "[4] Desativar Game DVR e Game Bar" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Configurar Modo de Jogo do Windows" -ForegroundColor Gray
        Write-Host "[7] Otimizar Configura√ß√µes de √Åudio para Jogos" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Configura√ß√µes de Input Lag" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes para jogos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o para jogos"

        switch ($choice) {
            "1" { Invoke-OptimizeCpuPriority }
            "2" { Invoke-OptimizeNetworkForGaming }
            "3" { Invoke-OptimizeGpuSettings }
            "4" { Invoke-DisableGameDvrBar }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-ConfigureGameMode }
            "7" { Invoke-OptimizeAudioForGaming }
            "8" { Invoke-OptimizeInputLag }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes para jogos...`n" -ForegroundColor Yellow
                Invoke-OptimizeCpuPriority
                Invoke-OptimizeNetworkForGaming
                Invoke-OptimizeGpuSettings
                Invoke-DisableGameDvrBar
                Invoke-OptimizeServicesForGaming
                Invoke-ConfigureGameMode
                Invoke-OptimizeAudioForGaming
                Invoke-OptimizeInputLag
                Write-Host "`nTodas as otimiza√ß√µes para jogos foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Jogos..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Privacidade (Dentro do Avan√ßado!) ---
function Show-PrivacidadeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: PRIVACIDADE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desativar Telemetria do Windows" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Aplicativos" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Hist√≥rico de Atividades" -ForegroundColor White
        Write-Host "[4] Gerenciar Diagn√≥stico e Feedback" -ForegroundColor Green
        Write-Host "[5] Gerenciar An√∫ncios Personalizados" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Localiza√ß√£o e Sensores" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Reconhecimento de Voz e Digita√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Sincroniza√ß√£o com a Microsoft" -ForegroundColor Cyan
        Write-Host "[9] Aplicar TODAS as configura√ß√µes de privacidade" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de privacidade"

        switch ($choice) {
            "1" { Invoke-DisableTelemetry }
            "2" { Invoke-ManageAppPermissions }
            "3" { Invoke-ManageActivityHistory }
            "4" { Invoke-ManageDiagnosticsFeedback }
            "5" { Invoke-ManagePersonalizedAds }
            "6" { Invoke-ManageLocationSensors }
            "7" { Invoke-ManageVoiceTyping }
            "8" { Invoke-ManageMicrosoftSync }
            "9" {
                Write-Host "`nAplicando todas as configura√ß√µes de privacidade...`n" -ForegroundColor Yellow
                Invoke-DisableTelemetry
                Invoke-ManageAppPermissions
                Invoke-ManageActivityHistory
                Invoke-ManageDiagnosticsFeedback
                Invoke-ManagePersonalizedAds
                Invoke-ManageLocationSensors
                Invoke-ManageVoiceTyping
                Invoke-ManageMicrosoftSync
                Write-Host "`nTodas as configura√ß√µes de privacidade foram aplicadas!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Privacidade..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Outros (Dentro do Avan√ßado!) ---
function Show-OutrosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: OUTROS TWEAKS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Mostrar Informa√ß√µes Detalhadas do Sistema" -ForegroundColor Yellow
        Write-Host "[2] Mostrar Configura√ß√£o Completa de Rede" -ForegroundColor Cyan
        Write-Host "[3] Reiniciar Explorer.exe" -ForegroundColor White
        Write-Host "[4] Limpar Cache de Atualiza√ß√µes do Windows" -ForegroundColor Green
        Write-Host "[5] Gerenciar Programas de Inicializa√ß√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar Op√ß√µes de Energia Avan√ßadas" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Configura√ß√µes de Armazenamento" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Configura√ß√µes de Notifica√ß√µes" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√µes diversas"

        switch ($choice) {
            "1" { Invoke-ShowDetailedSystemInfo }
            "2" { Invoke-ShowDetailedNetworkConfig }
            "3" { Invoke-RestartExplorer }
            "4" { Invoke-CleanWindowsUpdateCache }
            "5" { Invoke-ManageStartupPrograms }
            "6" { Invoke-ConfigureAdvancedPowerOptions }
            "7" { Invoke-ManageStorageSettings }
            "8" { Invoke-ManageNotificationSettings }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- Fun√ß√µes para as Secoes SIMPLIFICADAS (Expandidas) ---
function Invoke-SimpleSystemCleanup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza Geral do Sistema: Hora de varrer o lixo digital! ---" -ForegroundColor Green
    Write-Host "Essa op√ß√£o vai te ajudar a liberar espa√ßo e dar um f√¥lego pro PC tirando arquivos tempor√°rios, lixo da lixeira, etc. √â tipo faxina no computador!" -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Comando 1: Limpar Arquivos Tempor√°rios do Usu√°rio
    Write-Host "Bora come√ßar limpando os arquivos tempor√°rios do seu usu√°rio! Eles acumulam que √© uma beleza!" -ForegroundColor Yellow
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio limpos! Menos peso pro PC respirar! ;)" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Esvaziar a Lixeira
    Write-Host "Agora, vamos dar um fim definitivo naqueles arquivos na Lixeira. Eles s√≥ est√£o ocupando espa√ßo √† toa!" -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada! Espa√ßo recuperado com sucesso! R√°!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios do Windows
    Write-Host "Vamos limpar tamb√©m os tempor√°rios do pr√≥prio Windows. √Äs vezes, fica lixo escondido por l√°!" -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Limpar Cache de Navegadores Comuns
    Write-Host "Bora dar uma geral nos caches dos navegadores tamb√©m! Eles guardam um monte de coisa que pode pesar!" -ForegroundColor Yellow
    
    # Chrome
    Write-Host "Tentando limpar cache do Google Chrome..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Chrome limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Edge
    Write-Host "Tentando limpar cache do Microsoft Edge..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Edge limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Firefox
    Write-Host "Tentando limpar cache do Mozilla Firefox..." -ForegroundColor DarkGray
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\cache2\entries\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\startupCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\thumbnails\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Firefox limpo (pode n√£o ser completo, dependendo do perfil/uso)." -ForegroundColor DarkGray

    # Brave (se instalado)
    Write-Host "Tentando limpar cache do Brave Browser (se instalado)..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Brave limpo (se instalado e n√£o estiver rodando)." -ForegroundColor DarkGray

    Write-Host "Limpeza de caches de navegador conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Comando 5: Limpar Cache de Miniaturas
    Write-Host "Limpando cache de miniaturas do Windows (aquelas pr√©-visualiza√ß√µes de imagens e v√≠deos)..." -ForegroundColor Yellow
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Write-Host "Cache de miniaturas limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Limpar Arquivos de Log do Windows
    Write-Host "Limpando arquivos de log do Windows que podem ocupar espa√ßo..." -ForegroundColor Yellow
    wevtutil cl Application
    wevtutil cl System
    wevtutil cl Security
    Write-Host "Logs do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 7: Limpar Arquivos Tempor√°rios de Instala√ß√£o
    Write-Host "Limpando arquivos tempor√°rios de instala√ß√£o de programas..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Installer\$*\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios de instala√ß√£o limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 8: Limpar Arquivos de Atualiza√ß√£o do Windows
    Write-Host "Limpando arquivos de atualiza√ß√£o do Windows que podem ocupar bastante espa√ßo..." -ForegroundColor Yellow
    Stop-Service -Name wuauserv -ErrorAction SilentlyContinue
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    Write-Host "Arquivos de atualiza√ß√£o do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 9: Limpar Arquivos Prefetch
    Write-Host "Limpando arquivos prefetch para melhorar a inicializa√ß√£o..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Prefetch\*.pf" -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos prefetch limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 10: Executar Limpeza de Disco Integrada do Windows
    Write-Host "Executando a ferramenta de limpeza de disco integrada do Windows..." -ForegroundColor Yellow
    Start-Process -FilePath cleanmgr.exe -ArgumentList "/sagerun:1" -Wait -ErrorAction SilentlyContinue
    Write-Host "Limpeza de disco conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "Vamos ver quanto espa√ßo conseguimos recuperar com essa faxina:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nPronto! A faxina geral b√°sica foi feita! Seu PC agradece o espa√ßo extra! ;)" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu
    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleMemoryStartup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Mem√≥ria e Inicializa√ß√£o R√°pida: Deixa o PC ligando num piscar! ---" -ForegroundColor Yellow
    Write-Host "Aqui a gente d√° uma olhada na mem√≥ria RAM e nos programas que ligam junto com o Windows. Menos coisa ligando √† toa = PC mais r√°pido pra usar na hora!" -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Listar Programas de Inicializa√ß√£o
    Write-Host "Listando programas que iniciam com o Windows (pra voc√™ saber o que t√° rodando por baixo dos panos):" -ForegroundColor Yellow
    Get-CimInstance win32_startupcommand | Select-Object Name, command, Location | Format-Table -AutoSize
    Write-Host "Lista de programas de inicializa√ß√£o exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Servi√ßo SuperFetch/SysMain
    Write-Host "Otimizando o servi√ßo SuperFetch/SysMain para melhorar o desempenho..." -ForegroundColor Yellow
    $confirmSysMain = Read-Host "Deseja desativar o servi√ßo SysMain/SuperFetch? (s/n) - Recomendado para SSDs"
    if ($confirmSysMain -eq 's') {
        Set-Service -Name SysMain -StartupType Disabled -ErrorAction SilentlyContinue
        Stop-Service -Name SysMain -Force -ErrorAction SilentlyContinue
        Write-Host "Servi√ßo SysMain/SuperFetch desativado!" -ForegroundColor Green
    } else {
        Write-Host "Servi√ßo SysMain/SuperFetch mantido ativo." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios de Updates
    Write-Host "Limpando arquivos tempor√°rios de atualiza√ß√µes do Windows (podem ocupar bastante espa√ßo e afetar performance):" -ForegroundColor Yellow
    Dism /online /Cleanup-Image /StartComponentCleanup /ErrorAction SilentlyContinue
    Write-Host "Limpeza de componentes de atualiza√ß√£o iniciada (pode levar um tempo)." -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Mem√≥ria Virtual
    Write-Host "Otimizando configura√ß√µes de mem√≥ria virtual para melhor desempenho..." -ForegroundColor Yellow
    $totalRam = (Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property capacity -Sum).Sum / 1GB
    Write-Host "Seu sistema tem aproximadamente $totalRam GB de RAM." -ForegroundColor White
    
    $confirmPageFile = Read-Host "Deseja otimizar o arquivo de pagina√ß√£o (mem√≥ria virtual)? (s/n)"
    if ($confirmPageFile -eq 's') {
        # Calcula tamanho recomendado (1.5x a RAM para sistemas com menos de 8GB, 1x para sistemas com mais)
        $pageFileSize = if ($totalRam -lt 8) { [math]::Round($totalRam * 1.5) * 1024 } else { [math]::Round($totalRam) * 1024 }
        
        Write-Host "Configurando arquivo de pagina√ß√£o para tamanho fixo de $pageFileSize MB..." -ForegroundColor DarkGray
        $computerSystem = Get-WmiObject -Class Win32_ComputerSystem
        $computerSystem.AutomaticManagedPagefile = $false
        $computerSystem.Put() | Out-Null
        
        $pageFileSetting = Get-WmiObject -Class Win32_PageFileSetting
        if ($pageFileSetting) {
            $pageFileSetting.InitialSize = $pageFileSize
            $pageFileSetting.MaximumSize = $pageFileSize
            $pageFileSetting.Put() | Out-Null
        }
        Write-Host "Arquivo de pagina√ß√£o otimizado! (Requer reinicializa√ß√£o para aplicar totalmente)" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes de mem√≥ria virtual mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Listar os 10 Processos que mais usam mem√≥ria no momento
    Write-Host "Listando os 10 processos que mais consomem mem√≥ria agora:" -ForegroundColor Yellow
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host "Lista de processos exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Otimizar Inicializa√ß√£o do Windows
    Write-Host "Otimizando a inicializa√ß√£o do Windows..." -ForegroundColor Yellow
    # Desabilitar servi√ßos n√£o essenciais que podem atrasar a inicializa√ß√£o
    $startupServices = @(
        @{Name="DiagTrack"; DisplayName="Experi√™ncias do Usu√°rio Conectado e Telemetria"},
        @{Name="dmwappushservice"; DisplayName="Servi√ßo de Transfer√™ncia Inteligente em Segundo Plano (BITS)"},
        @{Name="MapsBroker"; DisplayName="Servi√ßo de Dados de Mapas"}
    )
    
    foreach ($service in $startupServices) {
        $confirmService = Read-Host "Deseja desativar o servi√ßo '$($service.DisplayName)' na inicializa√ß√£o? (s/n)"
        if ($confirmService -eq 's') {
            Set-Service -Name $service.Name -StartupType Disabled -ErrorAction SilentlyContinue
            Stop-Service -Name $service.Name -Force -ErrorAction SilentlyContinue
            Write-Host "Servi√ßo '$($service.DisplayName)' desativado!" -ForegroundColor Green
        } else {
            Write-Host "Servi√ßo '$($service.DisplayName)' mantido." -ForegroundColor Green
        }
    }
    Write-Host ""

    # Comando 7: Reiniciar o Computador (√ötil pra liberar mem√≥ria e aplicar mudan√ßas)
    Write-Host "Quer dar um 'refresh' geral no PC? Reiniciar pode ajudar!" -ForegroundColor Yellow
    $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (digite 'sim' para confirmar)"
    if ($confirmRestart -eq 'sim') {
        Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
        Restart-Computer -Force
    } else {
        Write-Host "Rein√≠cio cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o de mem√≥ria e inicializa√ß√£o!" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu (a n√£o ser que o PC tenha reiniciado)
    if ($confirmRestart -ne 'sim') {
        Write-Host ""
        Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
    }
}

function Invoke-SimpleInternetOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Acelerar a Conex√£o com a Internet (Simplificado): Diz adeus pro 'carregando...'! ---" -ForegroundColor Cyan
    Write-Host "Vamos fazer uns ajustes r√°pidos na sua conex√£o pra tentar deixar ela mais esperta." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Limpar Cache de DNS
    Write-Host "Limpando o cache de endere√ßos de internet (DNS) pra resolver nomes mais r√°pido!" -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Configura√ß√µes TCP/IP
    Write-Host "Otimizando configura√ß√µes TCP/IP para melhorar a velocidade de conex√£o..." -ForegroundColor Yellow
    
    # Habilitar TCP Window Auto-Tuning
    netsh int tcp set global autotuninglevel=normal
    Write-Host "TCP Auto-Tuning configurado para 'normal'." -ForegroundColor DarkGray
    
    # Otimizar par√¢metros de recebimento de pacotes
    netsh int tcp set global rss=enabled
    Write-Host "Receive-Side Scaling (RSS) habilitado." -ForegroundColor DarkGray
    
    # Otimizar congestion provider
    netsh int tcp set global congestionprovider=ctcp
    Write-Host "Congestion Provider configurado para 'ctcp'." -ForegroundColor DarkGray
    
    # Otimizar ECN capability
    netsh int tcp set global ecncapability=enabled
    Write-Host "ECN Capability habilitado." -ForegroundColor DarkGray
    
    Write-Host "Configura√ß√µes TCP/IP otimizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Reiniciar Adaptadores de Rede
    Write-Host "Dando um 'reset' r√°pido nas suas conex√µes de rede. Pode resolver uns pepinos!" -ForegroundColor Yellow
    $confirmResetAdapter = Read-Host "Isso vai desconectar brevemente sua internet. Continuar? (s/n)"
    if ($confirmResetAdapter -eq 's') {
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        Write-Host "Adaptadores de rede reiniciados." -ForegroundColor Green
    } else {
        Write-Host "Reset de adaptadores cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 4: Configurar DNS R√°pido
    Write-Host "Configurar DNS mais r√°pido pode melhorar sua navega√ß√£o!" -ForegroundColor Yellow
    $confirmDns = Read-Host "Deseja configurar DNS mais r√°pidos (Google ou Cloudflare)? (s/n)"
    if ($confirmDns -eq 's') {
        Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
        Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
        $dnsChoice = Read-Host "Escolha uma op√ß√£o (1 ou 2)"
        
        $primaryDns = ""
        $secondaryDns = ""
        
        if ($dnsChoice -eq '1') {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            Write-Host "Google DNS selecionado." -ForegroundColor DarkGray
        } elseif ($dnsChoice -eq '2') {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            Write-Host "Cloudflare DNS selecionado." -ForegroundColor DarkGray
        } else {
            Write-Host "Op√ß√£o inv√°lida. DNS n√£o alterado." -ForegroundColor Red
        }
        
        if ($primaryDns -ne "") {
            $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" -and ($_.InterfaceDescription -match "Ethernet" -or $_.InterfaceDescription -match "Wi-Fi" -or $_.InterfaceDescription -match "Wireless") }
            
            foreach ($adapter in $networkAdapters) {
                Write-Host "Configurando DNS para adaptador: $($adapter.Name)" -ForegroundColor DarkGray
                Set-DnsClientServerAddress -InterfaceIndex $adapter.ifIndex -ServerAddresses ($primaryDns, $secondaryDns)
            }
            
            Write-Host "DNS configurado! Sua navega√ß√£o deve ficar mais r√°pida agora." -ForegroundColor Green
        }
    } else {
        Write-Host "Configura√ß√£o de DNS mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Mostrar Status B√°sico da Conex√£o
    Write-Host "Mostrando um resumo b√°sico da sua configura√ß√£o de rede atual:" -ForegroundColor Yellow
    ipconfig /all | Select-String -Pattern "IPv4", "DNS", "Gateway", "DHCP", "Subnet", "Physical Address"
    Write-Host "Status b√°sico da rede exibido." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Testar a conex√£o com a internet
    Write-Host "Testando a conex√£o com a internet (ping para google.com)..." -ForegroundColor Yellow
    Test-Connection -Count 4 google.com -ErrorAction SilentlyContinue
    Write-Host "Teste de conex√£o finalizado." -ForegroundColor Green
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o b√°sica de internet!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleVisualOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Deixar o Windows mais Leve Visualmente (Simplificado): Desempenho antes da beleza! ---" -ForegroundColor White
    Write-Host "Ajustes r√°pidos pra desativar efeitos visuais que podem pesar, liberando recursos pro que importa." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ajustar Efeitos Visuais
    Write-Host "Voc√™ quer desativar ou ativar as anima√ß√µes e efeitos visuais do Windows?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Efeitos Visuais (Pra ganhar desempenho)" -ForegroundColor Green
    Write-Host "[2] Configurar para Melhor Apar√™ncia (Mais bonito, mas mais pesado)" -ForegroundColor White
    Write-Host "[3] Deixar o Windows Escolher (Configura√ß√£o padr√£o)" -ForegroundColor Cyan
    $choiceVisual = Read-Host "Escolha [1], [2] ou [3]"

    if ($choiceVisual -eq '1') {
        Write-Host "Desativando efeitos visuais para melhor desempenho..." -ForegroundColor Yellow
        # Valor 2 = Ajustar para melhor desempenho (desativa a maioria dos efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 2 -Type DWord -Force -ErrorAction SilentlyContinue
        
        # Desativar anima√ß√µes individuais
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop' -Name 'UserPreferencesMask' -Value ([byte[]](0x90, 0x12, 0x01, 0x80)) -Type Binary -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop\WindowMetrics' -Name 'MinAnimate' -Value 0 -Type String -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'ListviewAlphaSelect' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'TaskbarAnimations' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        
        Write-Host "Efeitos visuais desativados para melhor desempenho!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '2') {
        Write-Host "Configurando para melhor apar√™ncia (todos os efeitos visuais ativados)..." -ForegroundColor Yellow
        # Valor 1 = Ajustar para melhor apar√™ncia (ativa todos os efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Efeitos visuais configurados para melhor apar√™ncia!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '3') {
        Write-Host "Deixando o Windows escolher automaticamente (configura√ß√£o padr√£o)..." -ForegroundColor Yellow
        # Valor 0 = Deixar o Windows escolher
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Configura√ß√£o visual definida para padr√£o do Windows!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa nos efeitos visuais foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 2: Ativar/Desativar Efeitos de Transpar√™ncia
    Write-Host "E os efeitos de transpar√™ncia do Windows (tipo na barra de tarefas)?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Transpar√™ncia (Mais leve)" -ForegroundColor Green
    Write-Host "[2] Ativar Transpar√™ncia (Mais 'bonito')" -ForegroundColor White
    $choiceTransp = Read-Host "Escolha [1] ou [2]"

    if ($choiceTransp -eq '1') {
        Write-Host "Desativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 0 = Desativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia desativada!" -ForegroundColor Green
    } elseif ($choiceTransp -eq '2') {
        Write-Host "Ativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 1 = Ativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia ativada!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa na transpar√™ncia foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 3: Configurar Tema Claro/Escuro
    Write-Host "Voc√™ prefere tema claro ou escuro? O tema escuro pode ser mais confort√°vel para os olhos." -ForegroundColor Yellow
    Write-Host "[1] Tema Escuro (Dark Mode)" -ForegroundColor DarkGray
    Write-Host "[2] Tema Claro (Light Mode)" -ForegroundColor White
    $choiceTheme = Read-Host "Escolha [1] ou [2]"

    if ($choiceTheme -eq '1') {
        Write-Host "Configurando tema escuro..." -ForegroundColor Yellow
        # Valor 0 = Tema Escuro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema escuro configurado!" -ForegroundColor Green
    } elseif ($choiceTheme -eq '2') {
        Write-Host "Configurando tema claro..." -ForegroundColor Yellow
        # Valor 1 = Tema Claro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema claro configurado!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa no tema foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Configurar Resolu√ß√£o de Tela
    Write-Host "Deseja ajustar a resolu√ß√£o da tela? Resolu√ß√µes menores podem melhorar o desempenho em PCs mais antigos." -ForegroundColor Yellow
    $confirmResolution = Read-Host "Deseja ver e ajustar a resolu√ß√£o da tela? (s/n)"
    
    if ($confirmResolution -eq 's') {
        # Mostrar resolu√ß√£o atual
        $currentResolution = Get-WmiObject -Class Win32_VideoController | Select-Object -ExpandProperty VideoModeDescription
        Write-Host "Resolu√ß√£o atual: $currentResolution" -ForegroundColor White
        
        # Abrir configura√ß√µes de exibi√ß√£o do Windows
        Write-Host "Abrindo configura√ß√µes de exibi√ß√£o do Windows..." -ForegroundColor DarkGray
        Start-Process "ms-settings:display"
        Write-Host "Ajuste a resolu√ß√£o conforme necess√°rio na janela de configura√ß√µes que foi aberta." -ForegroundColor Green
        
        $waitForSettings = Read-Host "Pressione Enter quando terminar de ajustar as configura√ß√µes de exibi√ß√£o"
    } else {
        Write-Host "Configura√ß√£o de resolu√ß√£o mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizados os ajustes visuais b√°sicos!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleGamingOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Jogos (Simplificado): Mais FPS, menos lag! ---" -ForegroundColor Magenta
    Write-Host "Vamos fazer alguns ajustes para melhorar o desempenho dos seus jogos sem complica√ß√µes." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ativar Modo de Jogo do Windows
    Write-Host "Ativando o Modo de Jogo do Windows para priorizar recursos para jogos..." -ForegroundColor Yellow
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AllowAutoGameMode" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AutoGameModeEnabled" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Write-Host "Modo de Jogo do Windows ativado!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Desativar Game DVR e Game Bar
    Write-Host "O Game DVR e Game Bar podem reduzir o desempenho em jogos. Deseja desativ√°-los?" -ForegroundColor Yellow
    $confirmGameDVR = Read-Host "Desativar Game DVR e Game Bar? (s/n)"
    
    if ($confirmGameDVR -eq 's') {
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "UseNexusForGameBarEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\System\GameConfigStore" -Name "GameDVR_Enabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR" -Name "AppCaptureEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Write-Host "Game DVR e Game Bar desativados!" -ForegroundColor Green
    } else {
        Write-Host "Game DVR e Game Bar mantidos ativos." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Otimizar Plano de Energia para Jogos
    Write-Host "Configurando plano de energia para alto desempenho (ideal para jogos)..." -ForegroundColor Yellow
    powercfg.exe /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c
    Write-Host "Plano de energia configurado para alto desempenho!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Configura√ß√µes de Mouse
    Write-Host "Otimizando configura√ß√µes de mouse para jogos (precis√£o do ponteiro)..." -ForegroundColor Yellow
    $confirmMouseFix = Read-Host "Desativar a acelera√ß√£o do mouse para melhor precis√£o em jogos? (s/n)"
    
    if ($confirmMouseFix -eq 's') {
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseSpeed" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold1" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold2" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Write-Host "Acelera√ß√£o do mouse desativada para melhor precis√£o em jogos!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do mouse mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Otimizar Prioridade de CPU para Jogos
    Write-Host "Configurando prioridade de CPU para jogos..." -ForegroundColor Yellow
    Write-Host "Esta configura√ß√£o ajusta o sistema para dar mais prioridade aos jogos." -ForegroundColor DarkGray
    
    # Criar chave de registro para prioridade de jogos
    if (-not (Test-Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games")) {
        New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Force | Out-Null
    }
    
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "GPU Priority" -Type DWord -Value 8 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Priority" -Type DWord -Value 6 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Scheduling Category" -Type String -Value "High" -Force -ErrorAction SilentlyContinue
    
    Write-Host "Prioridade de CPU para jogos otimizada!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Verificar Driver de Placa de V√≠deo
    Write-Host "Verificando informa√ß√µes da placa de v√≠deo..." -ForegroundColor Yellow
    $gpuInfo = Get-WmiObject -Class Win32_VideoController | Select-Object Name, DriverVersion, CurrentHorizontalResolution, CurrentVerticalResolution
    
    foreach ($gpu in $gpuInfo) {
        Write-Host "Placa de v√≠deo: $($gpu.Name)" -ForegroundColor White
        Write-Host "Vers√£o do driver: $($gpu.DriverVersion)" -ForegroundColor White
        Write-Host "Resolu√ß√£o atual: $($gpu.CurrentHorizontalResolution) x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
      x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
    
    Write-Host "Recomenda√ß√£o: Mantenha seus drivers de v√≠deo atualizados para melhor desempenho em jogos!" -ForegroundColor Green
    Write-Host "Voc√™ pode baixar os drivers mais recentes nos sites oficiais da NVIDIA, AMD ou Intel." -ForegroundColor DarkGray
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nOtimiza√ß√µes para jogos conclu√≠das! Seus jogos devem rodar mais suaves agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleSecurityMaintenance {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Manuten√ß√£o de Seguran√ßa (Simplificado): Mantenha seu PC protegido! ---" -ForegroundColor DarkYellow
    Write-Host "Vamos verificar e melhorar a seguran√ßa do seu sistema com alguns ajustes simples." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Verificar Status do Windows Defender
    Write-Host "Verificando status do Windows Defender..." -ForegroundColor Yellow
    $defenderStatus = Get-MpComputerStatus
    
    Write-Host "Status do Windows Defender:" -ForegroundColor White
    Write-Host "Antiv√≠rus habilitado: $($defenderStatus.AntivirusEnabled)" -ForegroundColor $(if ($defenderStatus.AntivirusEnabled) { "Green" } else { "Red" })
    Write-Host "Prote√ß√£o em tempo real: $($defenderStatus.RealTimeProtectionEnabled)" -ForegroundColor $(if ($defenderStatus.RealTimeProtectionEnabled) { "Green" } else { "Red" })
    Write-Host "Defini√ß√µes de antiv√≠rus: $($defenderStatus.AntivirusSignatureVersion)" -ForegroundColor White
    Write-Host "√öltima atualiza√ß√£o: $($defenderStatus.AntivirusSignatureLastUpdated)" -ForegroundColor White
    Write-Host ""

    # Comando 2: Atualizar Defini√ß√µes do Windows Defender
    Write-Host "Atualizando defini√ß√µes do Windows Defender..." -ForegroundColor Yellow
    Update-MpSignature -ErrorAction SilentlyContinue
    Write-Host "Defini√ß√µes do Windows Defender atualizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Verificar Atualiza√ß√µes do Windows
    Write-Host "Verificando status das atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
            Write-Host "Recomenda√ß√£o: Execute o Windows Update para manter seu sistema seguro." -ForegroundColor Green
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Verificar Configura√ß√µes de Firewall
    Write-Host "Verificando status do Firewall do Windows..." -ForegroundColor Yellow
    $firewallStatus = Get-NetFirewallProfile
    
    foreach ($profile in $firewallStatus) {
        Write-Host "Perfil: $($profile.Name)" -ForegroundColor White
        Write-Host "Status: $($profile.Enabled)" -ForegroundColor $(if ($profile.Enabled) { "Green" } else { "Red" })
        Write-Host ""
    }
    
    $confirmFirewall = Read-Host "Deseja habilitar o Firewall em todos os perfis? (s/n)"
    if ($confirmFirewall -eq 's') {
        Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True
        Write-Host "Firewall habilitado em todos os perfis!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do Firewall mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Verificar Configura√ß√µes de UAC
    Write-Host "Verificando configura√ß√µes do Controle de Conta de Usu√°rio (UAC)..." -ForegroundColor Yellow
    $uacLevel = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -ErrorAction SilentlyContinue
    
    if ($uacLevel) {
        switch ($uacLevel.ConsentPromptBehaviorAdmin) {
            0 { $uacStatus = "Desativado (N√£o recomendado)" }
            1 { $uacStatus = "Baixo (N√£o recomendado)" }
            2 { $uacStatus = "M√©dio" }
            5 { $uacStatus = "Alto (Recomendado)" }
            default { $uacStatus = "Personalizado" }
        }
        
        Write-Host "N√≠vel atual do UAC: $uacStatus" -ForegroundColor $(if ($uacLevel.ConsentPromptBehaviorAdmin -ge 2) { "Green" } else { "Red" })
        
        $confirmUAC = Read-Host "Deseja configurar o UAC para o n√≠vel recomendado? (s/n)"
        if ($confirmUAC -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -Value 5 -Type DWord -Force -ErrorAction SilentlyContinue
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "PromptOnSecureDesktop" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
            Write-Host "UAC configurado para o n√≠vel recomendado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do UAC mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do UAC." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 6: Verificar Configura√ß√µes de SmartScreen
    Write-Host "Verificando configura√ß√µes do Windows SmartScreen..." -ForegroundColor Yellow
    $smartScreen = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -ErrorAction SilentlyContinue
    
    if ($smartScreen) {
        Write-Host "Status do SmartScreen: $($smartScreen.SmartScreenEnabled)" -ForegroundColor $(if ($smartScreen.SmartScreenEnabled -eq "RequireAdmin" -or $smartScreen.SmartScreenEnabled -eq "Warn") { "Green" } else { "Red" })
        
        $confirmSmartScreen = Read-Host "Deseja habilitar o SmartScreen para maior seguran√ßa? (s/n)"
        if ($confirmSmartScreen -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -Value "RequireAdmin" -Type String -Force -ErrorAction SilentlyContinue
            Write-Host "SmartScreen habilitado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do SmartScreen mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do SmartScreen." -ForegroundColor Red
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nManuten√ß√£o de seguran√ßa conclu√≠da! Seu sistema est√° mais protegido agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

# --- Fun√ß√µes para o Diagn√≥stico R√°pido e Sobre ---
function Invoke-QuickDiagnostic {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Diagn√≥stico R√°pido do Sistema ---" -ForegroundColor Yellow
    Write-Host "Vamos fazer uma verifica√ß√£o r√°pida do estado atual do seu PC." -ForegroundColor Gray
    Write-Host ""

    # Informa√ß√µes do Sistema
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    $sysInfo = Get-SystemInfo
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host ""

    # Uso de CPU
    Write-Host "=== Uso de CPU ===" -ForegroundColor Cyan
    $cpuLoad = (Get-WmiObject Win32_Processor).LoadPercentage
    Write-Host "Uso atual de CPU: $cpuLoad%" -ForegroundColor $(if ($cpuLoad -lt 70) { "Green" } elseif ($cpuLoad -lt 90) { "Yellow" } else { "Red" })
    Write-Host ""

    # Uso de Mem√≥ria
    Write-Host "=== Uso de Mem√≥ria ===" -ForegroundColor Cyan
    $os = Get-WmiObject Win32_OperatingSystem
    $totalMemory = [math]::Round($os.TotalVisibleMemorySize / 1MB, 2)
    $freeMemory = [math]::Round($os.FreePhysicalMemory / 1MB, 2)
    $usedMemory = [math]::Round($totalMemory - $freeMemory, 2)
    $memoryPercentage = [math]::Round(($usedMemory / $totalMemory) * 100, 2)
    
    Write-Host "Mem√≥ria Total: $totalMemory GB" -ForegroundColor White
    Write-Host "Mem√≥ria Usada: $usedMemory GB ($memoryPercentage%)" -ForegroundColor $(if ($memoryPercentage -lt 70) { "Green" } elseif ($memoryPercentage -lt 90) { "Yellow" } else { "Red" })
    Write-Host "Mem√≥ria Livre: $freeMemory GB" -ForegroundColor White
    Write-Host ""

    # Espa√ßo em Disco
    Write-Host "=== Espa√ßo em Disco ===" -ForegroundColor Cyan
    $drives = Get-PSDrive -PSProvider FileSystem
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        $percentFree = [math]::Round(($freeSpace / $totalSpace) * 100, 2)
        
        Write-Host "Drive $($drive.Name):" -ForegroundColor White
        Write-Host "  Total: $totalSpace GB" -ForegroundColor White
        Write-Host "  Usado: $usedSpace GB" -ForegroundColor White
        Write-Host "  Livre: $freeSpace GB ($percentFree%)" -ForegroundColor $(if ($percentFree -gt 20) { "Green" } elseif ($percentFree -gt 10) { "Yellow" } else { "Red" })
    }
    Write-Host ""

    # Processos que mais consomem recursos
    Write-Host "=== Top 5 Processos (CPU) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object CPU -Descending | Select-Object -First 5 ProcessName, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}}, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host ""

    Write-Host "=== Top 5 Processos (Mem√≥ria) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 5 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}}, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}} | Format-Table -AutoSize
    Write-Host ""

    # Status de Servi√ßos Cr√≠ticos
    Write-Host "=== Status de Servi√ßos Cr√≠ticos ===" -ForegroundColor Cyan
    $criticalServices = @("wuauserv", "WinDefend", "MpsSvc", "wscsvc")
    foreach ($service in $criticalServices) {
        $serviceStatus = Get-Service -Name $service -ErrorAction SilentlyContinue
        if ($serviceStatus) {
            Write-Host "$($serviceStatus.DisplayName): $($serviceStatus.Status)" -ForegroundColor $(if ($serviceStatus.Status -eq "Running") { "Green" } else { "Red" })
        }
    }
    Write-Host ""

    # Verificar Atualiza√ß√µes Pendentes
    Write-Host "=== Atualiza√ß√µes do Windows ===" -ForegroundColor Cyan
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Recomenda√ß√µes
    Write-Host "=== Recomenda√ß√µes ===" -ForegroundColor Cyan
    
    # Recomenda√ß√£o de Mem√≥ria
    if ($memoryPercentage -gt 80) {
        Write-Host "- Seu uso de mem√≥ria est√° alto. Considere fechar alguns programas ou usar a op√ß√£o 'Otimiza√ß√£o de Mem√≥ria'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Disco
    $lowDiskSpace = $false
    foreach ($drive in $drives) {
        $percentFree = [math]::Round(($drive.Free / ($drive.Free + $drive.Used)) * 100, 2)
        if ($percentFree -lt 15) {
            $lowDiskSpace = $true
            break
        }
    }
    
    if ($lowDiskSpace) {
        Write-Host "- Espa√ßo em disco baixo detectado. Considere usar a op√ß√£o 'Limpeza Geral do Sistema'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Atualiza√ß√µes
    if ($pendingUpdates -gt 0) {
        Write-Host "- Existem atualiza√ß√µes pendentes. Recomendamos atualizar seu sistema para maior seguran√ßa." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Inicializa√ß√£o
    $bootTime = $sysInfo.LastBootTime
    $uptime = (Get-Date) - $bootTime
    if ($uptime.Days -gt 7) {
        Write-Host "- Seu sistema est√° ligado h√° $($uptime.Days) dias. Considere reiniciar para aplicar atualiza√ß√µes e limpar a mem√≥ria." -ForegroundColor Yellow
    }
    
    Write-Host ""

    # Mensagem de conclus√£o
    Write-Host "`nDiagn√≥stico r√°pido conclu√≠do! Use as informa√ß√µes acima para decidir quais otimiza√ß√µes fazer." -ForegroundColor Green

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

function Show-AboutTORK {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Sobre o TORK ---" -ForegroundColor White
    Write-Host ""
    
    Write-Host "TORK - Otimizador para Windows" -ForegroundColor Cyan
    Write-Host "Vers√£o: 2.0" -ForegroundColor White
    Write-Host "Desenvolvido por: Partner77" -ForegroundColor White
    Write-Host ""
    
    Write-Host "=== Descri√ß√£o ===" -ForegroundColor Yellow
    Write-Host "O TORK √© uma ferramenta abrangente de otimiza√ß√£o para Windows, projetada para" -ForegroundColor Gray
    Write-Host "melhorar o desempenho do seu sistema atrav√©s de limpeza, ajustes e otimiza√ß√µes." -ForegroundColor Gray
    Write-Host "Ele oferece op√ß√µes simplificadas para usu√°rios comuns e op√ß√µes avan√ßadas para" -ForegroundColor Gray
    Write-Host "usu√°rios experientes que desejam um controle mais detalhado sobre o sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Recursos ===" -ForegroundColor Yellow
    Write-Host "- Limpeza completa do sistema" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√£o de mem√≥ria e inicializa√ß√£o" -ForegroundColor Gray
    Write-Host "- Ajustes de rede para melhor conectividade" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√µes visuais para melhor desempenho" -ForegroundColor Gray
    Write-Host "- Configura√ß√µes espec√≠ficas para jogos" -ForegroundColor Gray
    Write-Host "- Manuten√ß√£o de seguran√ßa" -ForegroundColor Gray
    Write-Host "- Diagn√≥stico r√°pido do sistema" -ForegroundColor Gray
    Write-Host "- Mais de 100 ajustes e otimiza√ß√µes avan√ßadas" -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Aviso Legal ===" -ForegroundColor Yellow
    Write-Host "Este software √© fornecido 'como est√°', sem garantias de qualquer tipo." -ForegroundColor Gray
    Write-Host "O autor n√£o se responsabiliza por quaisquer danos ou problemas causados pelo uso" -ForegroundColor Gray
    Write-Host "deste software. Use por sua conta e risco. Recomendamos sempre fazer backup" -ForegroundColor Gray
    Write-Host "dos seus dados importantes antes de realizar otimiza√ß√µes no sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Agradecimentos ===" -ForegroundColor Yellow
    Write-Host "Obrigado por escolher o TORK para otimizar seu sistema Windows!" -ForegroundColor Gray
    Write-Host "Esperamos que esta ferramenta ajude a melhorar o desempenho do seu PC." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "¬© 2023-2024 Partner77 - Todos os direitos reservados" -ForegroundColor Cyan
    Write-Host ""
    
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - LIMPEZA (Expandidas) ---
function Invoke-CleanUserTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Usu√°rio ---" -ForegroundColor Cyan
    Write-Host "Remove arquivos da pasta tempor√°ria do seu usu√°rio (`$env:TEMP`)." -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:TEMP..." -ForegroundColor Yellow
    $tempFiles = Get-ChildItem -Path $env:TEMP -Recurse -ErrorAction SilentlyContinue
    $tempFilesCount = ($tempFiles | Measure-Object).Count
    $tempFilesSize = ($tempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $tempFilesCount arquivos tempor√°rios ocupando aproximadamente $([math]::Round($tempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Sistema ---" -ForegroundColor Gray
    Write-Host "Remove arquivos da pasta tempor√°ria do Windows (`$env:SystemRoot\Temp`)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:SystemRoot\Temp..." -ForegroundColor Yellow
    $systemTempFiles = Get-ChildItem -Path "$env:SystemRoot\Temp" -Recurse -ErrorAction SilentlyContinue
    $systemTempFilesCount = ($systemTempFiles | Measure-Object).Count
    $systemTempFilesSize = ($systemTempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $systemTempFilesCount arquivos tempor√°rios do sistema ocupando aproximadamente $([math]::Round($systemTempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do sistema removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanDnsCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-EmptyRecycleBin {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Esvaziar Lixeira ---" -ForegroundColor Gray
    Write-Host "Esvazia a lixeira do usu√°rio logado." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar tamanho da lixeira antes de esvaziar
    Write-Host "Verificando tamanho da lixeira..." -ForegroundColor Yellow
    
    try {
        $shell = New-Object -ComObject Shell.Application
        $recycleBin = $shell.Namespace(0xA)
        $recycleBinItems = $recycleBin.Items()
        $recycleBinItemCount = $recycleBinItems.Count
        
        Write-Host "A lixeira cont√©m $recycleBinItemCount itens." -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o conte√∫do da lixeira." -ForegroundColor DarkGray
    }
    
    # Esvaziar a lixeira
    Write-Host "Executando: Esvaziando a lixeira..." -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanThumbnailCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Miniaturas ---" -ForegroundColor Green
    Write-Host "Remove o cache de miniaturas de arquivos (imagens, v√≠deos, etc.)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Limpando cache de miniaturas..." -ForegroundColor Yellow
    
    # Verificar tamanho do cache de miniaturas antes da limpeza
    $thumbnailPath = "$env:LOCALAPPDATA\Microsoft\Windows\Explorer"
    $thumbnailFiles = Get-ChildItem -Path $thumbnailPath -Filter "thumbcache_*.db" -ErrorAction SilentlyContinue
    $thumbnailFilesCount = ($thumbnailFiles | Measure-Object).Count
    $thumbnailFilesSize = ($thumbnailFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $thumbnailFilesCount arquivos de cache de miniaturas ocupando aproximadamente $([math]::Round($thumbnailFilesSize, 2)) MB." -ForegroundColor White
    
    # Limpar o cache de miniaturas
    Stop-Process -Name explorer -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Start-Process explorer
    
    Write-Host "Cache de miniaturas limpo com sucesso!" -ForegroundColor Green
    Write-Host "O Windows Explorer foi reiniciado para aplicar as altera√ß√µes." -ForegroundColor DarkGray
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de miniaturas:" -ForegroundColor Cyan
    Write-Host "- Navega√ß√£o mais r√°pida em pastas com muitas imagens ou v√≠deos" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de miniaturas corrompidas ou desatualizadas" -ForegroundColor DarkGray
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemLogs {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Logs do Sistema ---" -ForegroundColor Cyan
    Write-Host "Limpa os logs de eventos do sistema para liberar espa√ßo e melhorar o desempenho." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando logs do sistema..." -ForegroundColor Yellow
    
    # Verificar tamanho dos logs antes da limpeza
    $eventLogs = Get-WinEvent -ListLog * -ErrorAction SilentlyContinue | Where-Object { $_.RecordCount -gt 0 }
    $totalLogCount = ($eventLogs | Measure-Object).Count
    $total### Enhanced TORK Optimizer

I'll enhance the TORK optimizer with more comprehensive functionality across all features, starting with an expanded Simple Cleanup function and then improving all other options.

```powershell type="code"
# Define a preferencia de acao para erros (continua a execucao por padrao)
# Permite que o script tente rodar o m√°ximo poss√≠vel mesmo que alguns comandos encontrem problemas.
$ErrorActionPreference = 'SilentlyContinue' # N√£o exibe erros se um item n√£o puder ser processado, por exemplo.

# --- Funcao pra Centralizar Texto (Nosso Maestro de Alinhamento - s√≥ pra textos, n√£o pro bannerz√£o!) ---
# Deixa ela aqui, vai que a gente usa pra centralizar outra coisa, n√©?
function Centraliza($texto, $cor="White") {
    $largura = [console]::WindowWidth # Pega a largura da largura da janela agora
    # Calcula o espa√ßo pra botar o texto no meio. Pura matem√°tica da zoeira!
    $espacos = [Math]::Max(0, [Math]::Floor(($largura - $texto.Length) / 2))
    $linha = (" " * $espacos) + $texto # Cria a linha com os espa√ßos e o texto
    Write-Host $linha -ForegroundColor $cor # Manda pro console com a cor pedida
}

# --- Funcao que Desenha o Nosso Banner Irado do TORK! ---
# Esse √© o nosso outdoor digital no console! Ajustado pros espa√ßos que voc√™ mandou!
# Se as bordas ainda estiverem meio teimosas, √© o jeitinho do console mesmo, viu? üòâ
function Banner-TORK {
    # Nossas cores vibrantes para o banner!
    $CorBorda = "DarkCyan" # Mantido para a borda, combina com o ciano. Se quiser mudar, √© aqui!
    $CorLogo = "Green" # Cor vibrante
    $CorProjeto = "Cyan" # Cor vibrante
    $CorCopyright = "Gray" # Tom mais suave

    Write-Host "" # D√° um espacinho no topo, pra n√£o grudar
    Write-Host "                    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë          ‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë ‚ñà‚ñà‚ïî‚ïù                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ñà‚ñà‚ïó                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù                                          ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë           Bem-vindo ao TORK - Otimizador para Windows!                                ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë        Projeto de automacao, limpeza, manutencao e tweaks.                            ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë            (C) Partner77 - Todos os direitos reservados                               ‚ïë" -ForegroundColor $CorCopyright
    Write-Host "                    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor $CorBorda
    Write-Host "" # Espa√ßo embaixo
}

# --- Checagem de Permiss√µes de Administrador (O Guarda da Porta!) ---
# V√™ se a gente t√° rodando com poderes de admin, sen√£o n√£o d√° pra mexer no Windows direito.
function Test-Administrator {
    $currentUser = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())
    return $currentUser.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
}

if (-not (Test-Administrator)) {
    Write-Host "OPA! Calma l√°, patr√£o!" -ForegroundColor Red
    Write-Host "Pra usar o TORK e deixar o PC voando, preciso de super poderes de Administrador!" -ForegroundColor Yellow
    Write-Host "Fecha essa janela, clica com o bot√£o direito no arquivo do script e escolhe 'Executar como administrador'. A√≠ sim, tamo junto!" -ForegroundColor Yellow
    Read-Host "D√° um Enter quando terminar de ler, que a gente se v√™ na pr√≥xima..."
    Exit
}

Write-Host "Poderes de Administrador verificados! Bora nessa!" -ForegroundColor Green
Start-Sleep -Seconds 1

# --- Fun√ß√µes Utilit√°rias (Ferramentas que usamos em v√°rios lugares) ---
function Get-SystemInfo {
    $os = Get-CimInstance Win32_OperatingSystem
    $cs = Get-CimInstance Win32_ComputerSystem
    $proc = Get-CimInstance Win32_Processor
    $mem = Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property Capacity -Sum
    
    $info = @{
        "OSName" = $os.Caption
        "OSVersion" = $os.Version
        "OSBuild" = $os.BuildNumber
        "ComputerName" = $cs.Name
        "Manufacturer" = $cs.Manufacturer
        "Model" = $cs.Model
        "Processor" = $proc.Name
        "Memory" = [math]::Round($mem.Sum / 1GB, 2)
        "Architecture" = $os.OSArchitecture
        "InstallDate" = $os.InstallDate
        "LastBootTime" = $os.LastBootUpTime
    }
    
    return $info
}

function Show-SystemSummary {
    $sysInfo = Get-SystemInfo
    
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Computador: $($sysInfo.ComputerName)" -ForegroundColor White
    Write-Host "Fabricante: $($sysInfo.Manufacturer)" -ForegroundColor White
    Write-Host "Modelo: $($sysInfo.Model)" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "Instalado em: $($sysInfo.InstallDate)" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

function Get-DiskSpaceBefore {
    $drives = Get-PSDrive -PSProvider FileSystem
    $driveInfo = @{}
    
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        
        $driveInfo[$drive.Name] = @{
            "Free" = $freeSpace
            "Used" = $usedSpace
            "Total" = $totalSpace
        }
    }
    
    return $driveInfo
}

function Show-DiskSpaceComparison {
    param (
        $before
    )
    
    $after = Get-PSDrive -PSProvider FileSystem
    
    Write-Host "=== Compara√ß√£o de Espa√ßo em Disco ===" -ForegroundColor Cyan
    
    foreach ($drive in $after) {
        if ($before.ContainsKey($drive.Name)) {
            $freeSpaceAfter = [math]::Round($drive.Free / 1GB, 2)
            $freeSpaceBefore = $before[$drive.Name].Free
            $spaceRecovered = [math]::Round($freeSpaceAfter - $freeSpaceBefore, 2)
            
            Write-Host "Drive $($drive.Name):" -ForegroundColor White
            Write-Host "  Espa√ßo livre antes: $freeSpaceBefore GB" -ForegroundColor Gray
            Write-Host "  Espa√ßo livre agora: $freeSpaceAfter GB" -ForegroundColor Gray
            
            if ($spaceRecovered -gt 0) {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Green
            } else {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Yellow
            }
            Write-Host ""
        }
    }
    
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

# --- Fun√ß√µes dos Menus (Principal, Simplificado, Avan√ßado e Sub-menus) ---

# --- Menu Principal (A Bifurca√ß√£o do Destino! Simplificado vs Avan√ßado) ---
# √â aqui que o usu√°rio escolhe se quer ser um mago ou um cara pr√°tico!
function Show-MainMenu {
    do {
        Clear-Host # Limpa a tela pra organizar o menu
        Banner-TORK # Banner no topo, pra gente n√£o esquecer quem somos!
        Show-SystemSummary # Mostra um resumo do sistema

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "       MENU PRINCIPAL" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # As duas grandes estradas da otimiza√ß√£o! Cores variadas (repetindo)!
        Write-Host "[1] Otimiza√ß√£o Simplificada (Pra quem quer praticidade e resultado r√°pido!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o Avan√ßada (Pra quem curte mexer fundo e ter control total!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[3] Diagn√≥stico R√°pido do Sistema (Ver o que t√° rolando no PC)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[4] Sobre o TORK (Informa√ß√µes e cr√©ditos)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[0] Sair (Ah, que pena... Mas a porta t√° aberta!)" -ForegroundColor Red # Vermelho pra Sair - Ok

        Write-Host ""

        # Pergunta pro usu√°rio qual caminho ele escolhe, tipo Mestre Pok√©mon!
        $choice = Read-Host "Escolhe sua op√ß√£o, treinador!"

        # V√™ pra onde a gente vai com base na escolha
        switch ($choice) {
            "1" { Show-SimplifiedMenu } # Se escolheu 1, vai pro Menu Simplificado!
            "2" { Show-AdvancedMenu } # Se escolheu 2, vai pro Menu Avan√ßado!
            "3" { Invoke-QuickDiagnostic } # Nova fun√ß√£o de diagn√≥stico r√°pido
            "4" { Show-AboutTORK } # Nova fun√ß√£o de sobre
            "0" { Write-Host "Fechou! Valeu por usar o TORK! Volte sempre que seu PC pedir um g√°s! ;)" -ForegroundColor Green; Start-Sleep -Seconds 2; break } # Se escolheu 0, vaza (mas volta!)
            default {
                Write-Host "Eita! Op√ß√£o inv√°lida! Confere os n√∫meros e tenta de novo, bora l√°!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1 # D√° um tempinho pro usu√°rio ver a zoeira da mensagem
            }
        }
    } while ($choice -ne '0') # Repete o Menu Principal enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Simplificado (Aqui o TORK faz m√°gica r√°pida e segura!) ---
# Acessado pela op√ß√£o 1 do Menu Principal. Menos op√ß√µes, mais a√ß√£o direta!
function Show-SimplifiedMenu {
    do {
        Clear-Host # Limpa o palco pra esse menu!
        Banner-TORK # Nosso banner no topo, sempre presente!

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "   OTIMIZACAO SIMPLIFICADA" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes SIMPLIFICADAS - cada uma pode fazer um monte de coisa por baixo dos panos! Cores variadas (repetindo as prim√°rias/neon e adicionando outras)!
        Write-Host "[1] Limpeza Geral do Sistema (Tira o lixo que t√° pesando!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o de Mem√≥ria e Programas que Ligam com o Windows (Deixa tudo mais √°gil!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[3] Acelerar a Conex√£o com a Internet (Pra navegar sem gargalo!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[4] Deixar o Windows mais Leve Visualmente (Desativa uns efeitos pra ganhar desempenho!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Otimiza√ß√£o de Jogos (Configura√ß√µes pra melhorar FPS e desempenho)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[6] Manuten√ß√£o de Seguran√ßa (Verificar e corrigir problemas de seguran√ßa)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[7] RODAR TODAS as otimiza√ß√µes SIMPLIFICADAS! (Modo Turbo F√°cil!)" -ForegroundColor Red # Vermelho pra "Faz Tudo" - Destaque/Cuidado
        Write-Host "[0] Voltar ao Menu Principal (A gente te espera aqui!)" -ForegroundColor Gray # Cor neutra pra voltar

        Write-Host ""

        # Pergunta qual m√°gica simplificada o usu√°rio quer
        $choice = Read-Host "Escolhe sua m√°gica simplificada!"

        # V√™ qual m√°gica rodar
        switch ($choice) {
            "1" { Invoke-SimpleSystemCleanup } # Chama a fun√ß√£o de limpeza b√°sica
            "2" { Invoke-SimpleMemoryStartup } # Chama a fun√ß√£o pra mem√≥ria/inicializa√ß√£o
            "3" { Invoke-SimpleInternetOpt } # Chama a fun√ß√£o pra internet
            "4" { Invoke-SimpleVisualOpt } # Chama a fun√ß√£o pra visual
            "5" { Invoke-SimpleGamingOpt } # Nova fun√ß√£o para otimiza√ß√£o de jogos
            "6" { Invoke-SimpleSecurityMaintenance } # Nova fun√ß√£o para manuten√ß√£o de seguran√ßa
            "7" {
                # Rodar todas as simplificadas sequencialmente
                Write-Host "`nModo Turbo F√°cil ATIVADO! Rodando todas as otimiza√ß√µes SIMPLIFICADAS... segura pe√£o!`n" -ForegroundColor Yellow
                Invoke-SimpleSystemCleanup # Roda a 1
                Invoke-SimpleMemoryStartup # Roda a 2
                Invoke-SimpleInternetOpt # Roda a 3
                Invoke-SimpleVisualOpt # Roda a 4
                Invoke-SimpleGamingOpt # Roda a 5
                Invoke-SimpleSecurityMaintenance # Roda a 6
                Write-Host "`nShow! Todas as otimiza√ß√µes SIMPLIFICADAS foram executadas! PC t√° agradecendo! ;)`n" -ForegroundColor Green
                Read-Host "Aperta Enter pra voltar pro Menu Simplificado..." # Pausa no final do "Rodar Todas"
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-MainMenu
            default {
                Write-Host "Ops! Op√ß√£o inv√°lida no Menu Simplificado! Confere os n√∫meros e manda bala de novo!" -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Simplificado enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Avan√ßado (O Playground dos Magos do PC!) ---
# Acessado pela op√ß√£o 2 do Menu Principal. Aqui a gente mergulha fundo!
function Show-AdvancedMenu {
    do {
        Clear-Host # Limpa o palco pro menu avan√ßado!
        Banner-TORK # Nosso banner no topo, pra n√£o perder a pose!

        Write-Host "" # Espacinho maroto
        Write-Host "===============================" -ForegroundColor White
        Write-Host "      MENU AVANCADO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes do menu avan√ßado (as CATEGORIAS dos 200 poderes!) Cores variadas (repetindo)!
        Write-Host "[1] Limpeza e Manuten√ß√£o de Arquivos (Tirar a poeira digital!)" -ForegroundColor Cyan # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[2] Otimiza√ß√µes de Desempenho do Sistema (Deixar o motor roncando!)" -ForegroundColor Green # Cor variada
        Write-Host "[3] Configura√ß√µes e Otimiza√ß√µes de Rede (Pra internet voar baixo!)" -ForegroundColor Yellow # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[4] Gerenciamento e Otimiza√ß√£o de Servi√ßos do Windows (O que t√° rodando e n√£o precisa?!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Ferramentas de Diagn√≥stico e Verifica√ß√£o (Pra ver se t√° tudo nos conformes!)" -ForegroundColor Cyan # Cor repetida
        Write-Host "[6] Desabilitar/Gerenciar Recursos do Windows (Tirar o peso extra do sistema!)" -ForegroundColor Green # Cor repetida
        Write-Host "[7] Gerenciamento de Arquivos e Pastas Avan√ßado (Comandos ninja pra arquivos!)" -ForegroundColor Yellow # Cor repetida
        Write-Host "[8] Gerenciamento de Contas de Usu√°rio (Organizar a galera que usa o PC!)" -ForegroundColor White # Cor repetida
        Write-Host "[9] Otimiza√ß√£o para Jogos Avan√ßada (Tweaks pra gamers de verdade!)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Configura√ß√µes de Privacidade (Controle o que o Windows sabe sobre voc√™)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[11] Outras Configura√ß√µes e Tweaks Diversos (Aqueles ajustes secretos!)" -ForegroundColor Gray # Cor neutra/escura
        Write-Host "[0] Voltar ao Menu Principal (Pronto pra voltar pra estrada principal!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta pro mago qual categoria ele quer explorar
        $choice = Read-Host "Escolhe sua √°rea de magia, mago!"

        # V√™ pra onde a gente navega dentro do mundo avan√ßado
        switch ($choice) {
            "1" { Show-LimpezaManutencaoMenu } # CHAMA O SUB-MENU DE LIMPEZA
            "2" { Show-DesempenhoMenu } # Agora √© um sub-menu tamb√©m
            "3" { Show-ConfiguracoesRedeMenu } # CHAMA O SUB-MENU DE REDE
            "4" { Show-ServicosMenu } # Agora √© um sub-menu tamb√©m
            "5" { Show-DiagnosticoMenu } # Agora √© um sub-menu tamb√©m
            "6" { Show-RecursosMenu } # Agora √© um sub-menu tamb√©m
            "7" { Show-ArquivosPastasMenu } # Agora √© um sub-menu tamb√©m
            "8" { Show-UsuariosMenu } # Agora √© um sub-menu tamb√©m
            "9" { Show-JogosAvancadoMenu } # Novo sub-menu para jogos
            "10" { Show-PrivacidadeMenu } # Novo sub-menu para privacidade
            "11" { Show-OutrosMenu } # Agora √© um sub-menu tamb√©m
            "0" { break } # Sai do loop deste menu, voltando pro Menu Principal
            default {
                Write-Host "Humm, essa √°rea da magia ainda n√£o existe ou voc√™ digitou errado! Tenta de novo, mago!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Avan√ßado enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Limpeza e Manuten√ß√£o (Dentro do Avan√ßado!) ---
# Este menu lista as op√ß√µes ESPEC√çFICAS da categoria Limpeza no Menu Avan√ßado
function Show-LimpezaManutencaoMenu {
    do {
        Clear-Host # Limpa o palco pra este sub-menu!
        Banner-TORK # Banner no topo, sempre!

        Write-Host "" # Espacinho
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: LIMPEZA E MANUT." -ForegroundColor White # T√≠tulo menor pro sub-menu
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes ESPEC√çFICAS da categoria Limpeza. Cores variadas (repetindo cores)!
        Write-Host "[1] Limpar Arquivos Tempor√°rios do Usu√°rio (Tipo a pasta Temp!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[2] Limpar Arquivos Tempor√°rios do Sistema (Os tempor√°rios do Windows!)" -ForegroundColor Gray # Cor neutra (substitui DarkCyan)
        Write-Host "[3] Limpar Cache de DNS (Pra resolver nomes de site mais r√°pido!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[4] Esvaziar Lixeira (Adeus, arquivos deletados!)" -ForegroundColor Gray # Cor neutra (repetindo)
        Write-Host "[5] Limpar Cache de Miniaturas (Aqueles previews de imagem/v√≠deo!)" -ForegroundColor Green # Cor variada
        Write-Host "[6] Limpar Logs do Sistema (Arquivos de registro que acumulam)" -ForegroundColor Cyan # Nova op√ß√£o
        Write-Host "[7] Limpar Cache de Atualiza√ß√µes do Windows (Liberar espa√ßo de updates)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[8] Limpar Arquivos de Hiberna√ß√£o (Liberar o hiberfil.sys)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[9] Limpar Arquivos WinSxS (Pasta que ocupa muito espa√ßo)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Executar TODAS as limpezas acima (Faxina completa!)" -ForegroundColor Red # Nova op√ß√£o
        Write-Host "[0] Voltar ao Menu Avan√ßado (De volta pras categorias!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta qual limpeza espec√≠fica o mago quer fazer
        $choice = Read-Host "Escolhe a limpeza avan√ßada, mestre!"

        # V√™ qual fun√ß√£o de limpeza espec√≠fica chamar
        switch ($choice) {
            "1" { Invoke-CleanUserTemp } # Chama a fun√ß√£o pra Limpar Temp Usu√°rio
            "2" { Invoke-CleanSystemTemp } # Chama a fun√ß√£o pra Limpar Temp Sistema
            "3" { Invoke-CleanDnsCache } # Chama a fun√ß√£o pra Limpar Cache DNS
            "4" { Invoke-EmptyRecycleBin } # Chama a fun√ß√£o pra Esvaziar Lixeira
            "5" { Invoke-CleanThumbnailCache } # Chama a fun√ß√£o pra Limpar Cache de Miniaturas
            "6" { Invoke-CleanSystemLogs } # Nova fun√ß√£o para limpar logs do sistema
            "7" { Invoke-CleanWindowsUpdateCache } # Nova fun√ß√£o para limpar cache de updates
            "8" { Invoke-CleanHibernationFile } # Nova fun√ß√£o para limpar arquivo de hiberna√ß√£o
            "9" { Invoke-CleanWinSxS } # Nova fun√ß√£o para limpar pasta WinSxS
            "10" { 
                # Executa todas as limpezas em sequ√™ncia
                Write-Host "`nIniciando faxina completa do sistema! Isso pode demorar um pouco...`n" -ForegroundColor Yellow
                $diskSpaceBefore = Get-DiskSpaceBefore
                
                Invoke-CleanUserTemp
                Invoke-CleanSystemTemp
                Invoke-CleanDnsCache
                Invoke-EmptyRecycleBin
                Invoke-CleanThumbnailCache
                Invoke-CleanSystemLogs
                Invoke-CleanWindowsUpdateCache
                Invoke-CleanHibernationFile
                Invoke-CleanWinSxS
                
                Write-Host "`nFaxina completa finalizada! Veja quanto espa√ßo foi recuperado:`n" -ForegroundColor Green
                Show-DiskSpaceComparison -before $diskSpaceBefore
                Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-AdvancedMenu
            default {
                Write-Host "Essa tarefa de limpeza ainda n√£o t√° na lista! V√™ os n√∫meros e tenta de novo!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Sub-Menu Limpeza enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Desempenho (Dentro do Avan√ßado!) ---
function Show-DesempenhoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DESEMPENHO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Ajustar Efeitos Visuais para Melhor Desempenho" -ForegroundColor Green
        Write-Host "[2] Otimizar Disco do Sistema" -ForegroundColor Cyan
        Write-Host "[3] Limpar Arquivos Prefetch" -ForegroundColor Yellow
        Write-Host "[4] Definir Plano de Energia para Alto Desempenho" -ForegroundColor White
        Write-Host "[5] Otimizar Servi√ßo SuperFetch/SysMain" -ForegroundColor Magenta
        Write-Host "[6] Ajustar Tamanho da Mem√≥ria Virtual" -ForegroundColor Gray
        Write-Host "[7] Desativar Indexa√ß√£o de Arquivos" -ForegroundColor Green
        Write-Host "[8] Otimizar Inicializa√ß√£o do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de desempenho" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o de desempenho"

        switch ($choice) {
            "1" { Invoke-OptimizeVisualEffects }
            "2" { Invoke-OptimizeDisk }
            "3" { Invoke-CleanPrefetch }
            "4" { Invoke-SetHighPerformancePower }
            "5" { Invoke-OptimizeSuperFetch }
            "6" { Invoke-AdjustVirtualMemory }
            "7" { Invoke-DisableIndexing }
            "8" { Invoke-OptimizeStartup }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de desempenho...`n" -ForegroundColor Yellow
                Invoke-OptimizeVisualEffects
                Invoke-OptimizeDisk
                Invoke-CleanPrefetch
                Invoke-SetHighPerformancePower
                Invoke-OptimizeSuperFetch
                Invoke-AdjustVirtualMemory
                Invoke-DisableIndexing
                Invoke-OptimizeStartup
                Write-Host "`nTodas as otimiza√ß√µes de desempenho foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Configura√ß√µes de Rede (Dentro do Avan√ßado!) ---
function Show-ConfiguracoesRedeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: CONFIG. REDE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Limpar Cache de DNS" -ForegroundColor Yellow
        Write-Host "[2] Mudar Servidor DNS" -ForegroundColor Cyan
        Write-Host "[3] Resetar Configura√ß√µes de Rede" -ForegroundColor White
        Write-Host "[4] Otimizar Configura√ß√µes TCP/IP" -ForegroundColor Green
        Write-Host "[5] Verificar Velocidade da Conex√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar QoS (Qualidade de Servi√ßo)" -ForegroundColor Gray
        Write-Host "[7] Desativar IPv6 (Se n√£o estiver usando)" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Lat√™ncia de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de rede" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√£o de rede"

        switch ($choice) {
            "1" { Invoke-NetworkFlushDns }
            "2" { Invoke-NetworkChangeDns }
            "3" { Invoke-NetworkReset }
            "4" { Invoke-OptimizeTcpIp }
            "5" { Invoke-CheckNetworkSpeed }
            "6" { Invoke-ConfigureQoS }
            "7" { Invoke-DisableIPv6 }
            "8" { Invoke-OptimizeGamingLatency }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de rede...`n" -ForegroundColor Yellow
                Invoke-NetworkFlushDns
                Invoke-OptimizeTcpIp
                Invoke-CheckNetworkSpeed
                Invoke-ConfigureQoS
                Invoke-DisableIPv6
                Invoke-OptimizeGamingLatency
                Write-Host "`nTodas as otimiza√ß√µes de rede foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Rede..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Servi√ßos (Dentro do Avan√ßado!) ---
function Show-ServicosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: SERVICOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desabilitar Servi√ßo SuperFetch/SysMain" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Servi√ßo de Impress√£o" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Servi√ßo Windows Update" -ForegroundColor White
        Write-Host "[4] Listar Todos os Servi√ßos em Execu√ß√£o" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Otimizar Servi√ßos para Desempenho Geral" -ForegroundColor Gray
        Write-Host "[7] Restaurar Servi√ßos para Configura√ß√£o Padr√£o" -ForegroundColor Yellow
        Write-Host "[8] Desabilitar Servi√ßos Desnecess√°rios" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de servi√ßos"

        switch ($choice) {
            "1" { Invoke-ManageSuperFetch }
            "2" { Invoke-ManagePrintService }
            "3" { Invoke-ManageWindowsUpdate }
            "4" { Invoke-ListRunningServices }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-OptimizeServicesForPerformance }
            "7" { Invoke-RestoreDefaultServices }
            "8" { Invoke-DisableUnnecessaryServices }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Diagn√≥stico (Dentro do Avan√ßado!) ---
function Show-DiagnosticoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DIAGNOSTICO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Verificar Arquivos do Sistema (SFC)" -ForegroundColor Yellow
        Write-Host "[2] Reparar Imagem do Windows (DISM)" -ForegroundColor Cyan
        Write-Host "[3] Verificar Disco por Erros (CHKDSK)" -ForegroundColor White
        Write-Host "[4] Verificar Sa√∫de do Disco" -ForegroundColor Green
        Write-Host "[5] Verificar Drivers Desatualizados" -ForegroundColor Magenta
        Write-Host "[6] Verificar Problemas de Inicializa√ß√£o" -ForegroundColor Gray
        Write-Host "[7] Verificar Problemas de Mem√≥ria RAM" -ForegroundColor Yellow
        Write-Host "[8] Verificar Temperatura do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODOS os diagn√≥sticos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de diagn√≥stico"

        switch ($choice) {
            "1" { Invoke-SfcScan }
            "2" { Invoke-DismRepair }
            "3" { Invoke-ChkDsk }
            "4" { Invoke-CheckDiskHealth }
            "5" { Invoke-CheckDrivers }
            "6" { Invoke-CheckStartupIssues }
            "7" { Invoke-CheckMemory }
            "8" { Invoke-CheckTemperature }
            "9" {
                Write-Host "`nExecutando todos os diagn√≥sticos...`n" -ForegroundColor Yellow
                Invoke-SfcScan
                Invoke-DismRepair
                Invoke-CheckDiskHealth
                Invoke-CheckDrivers
                Invoke-CheckStartupIssues
                Invoke-CheckTemperature
                Write-Host "`nTodos os diagn√≥sticos foram conclu√≠dos!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Diagn√≥stico..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Recursos (Dentro do Avan√ßado!) ---
function Show-RecursosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: RECURSOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Gerenciar Hiberna√ß√£o" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Planos de Energia" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Recursos Opcionais do Windows" -ForegroundColor White
        Write-Host "[4] Gerenciar Mem√≥ria Virtual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Windows Defender" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Recursos de Telemetria" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Recursos de Inicializa√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Recursos de Seguran√ßa" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de recursos"

        switch ($choice) {
            "1" { Invoke-ManageHibernation }
            "2" { Invoke-ManagePowerPlans }
            "3" { Invoke-ManageOptionalFeatures }
            "4" { Invoke-ManageVirtualMemory }
            "5" { Invoke-ManageWindowsDefender }
            "6" { Invoke-ManageTelemetry }
            "7" { Invoke-ManageStartupResources }
            "8" { Invoke-ManageSecurityFeatures }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Arquivos e Pastas (Dentro do Avan√ßado!) ---
function Show-ArquivosPastasMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: ARQUIVOS E PASTAS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Encontrar Arquivos Grandes" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Arquivos" -ForegroundColor Cyan
        Write-Host "[3] Tomar Posse de Arquivos (TakeOwn)" -ForegroundColor White
        Write-Host "[4] Listar Conte√∫do de Pastas Espec√≠ficas" -ForegroundColor Green
        Write-Host "[5] Compactar Pastas para Economizar Espa√ßo" -ForegroundColor Magenta
        Write-Host "[6] Verificar Integridade de Arquivos" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Arquivos Ocultos e do Sistema" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Atributos de Arquivos" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de arquivos e pastas"

        switch ($choice) {
            "1" { Invoke-FindLargeFiles }
            "2" { Invoke-ManageFilePermissions }
            "3" { Invoke-TakeOwnership }
            "4" { Invoke-ListFolderContents }
            "5" { Invoke-CompressFolders }
            "6" { Invoke-VerifyFileIntegrity }
            "7" { Invoke-ManageHiddenSystemFiles }
            "8" { Invoke-ManageFileAttributes }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Usu√°rios (Dentro do Avan√ßado!) ---
function Show-UsuariosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: USUARIOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Listar Todos os Usu√°rios Locais" -ForegroundColor Yellow
        Write-Host "[2] Listar Todos os Grupos Locais" -ForegroundColor Cyan
        Write-Host "[3] Listar Membros de Grupos Espec√≠ficos" -ForegroundColor White
        Write-Host "[4] Mostrar Propriedades do Usu√°rio Atual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Contas de Usu√°rio" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Pol√≠ticas de Senha" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Permiss√µes de Usu√°rio" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar UAC (Controle de Conta de Usu√°rio)" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de usu√°rios"

        switch ($choice) {
            "1" { Invoke-ListLocalUsers }
            "2" { Invoke-ListLocalGroups }
            "3" { Invoke-ListGroupMembers }
            "4" { Invoke-ShowCurrentUserProperties }
            "5" { Invoke-ManageUserAccounts }
            "6" { Invoke-ManagePasswordPolicies }
            "7" { Invoke-ManageUserPermissions }
            "8" { Invoke-ManageUAC }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Jogos Avan√ßado (Dentro do Avan√ßado!) ---
function Show-JogosAvancadoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: JOGOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Otimizar Prioridade de CPU para Jogos" -ForegroundColor Yellow
        Write-Host "[2] Otimizar Configura√ß√µes de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[3] Otimizar Configura√ß√µes de GPU" -ForegroundColor White
        Write-Host "[4] Desativar Game DVR e Game Bar" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Configurar Modo de Jogo do Windows" -ForegroundColor Gray
        Write-Host "[7] Otimizar Configura√ß√µes de √Åudio para Jogos" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Configura√ß√µes de Input Lag" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes para jogos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o para jogos"

        switch ($choice) {
            "1" { Invoke-OptimizeCpuPriority }
            "2" { Invoke-OptimizeNetworkForGaming }
            "3" { Invoke-OptimizeGpuSettings }
            "4" { Invoke-DisableGameDvrBar }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-ConfigureGameMode }
            "7" { Invoke-OptimizeAudioForGaming }
            "8" { Invoke-OptimizeInputLag }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes para jogos...`n" -ForegroundColor Yellow
                Invoke-OptimizeCpuPriority
                Invoke-OptimizeNetworkForGaming
                Invoke-OptimizeGpuSettings
                Invoke-DisableGameDvrBar
                Invoke-OptimizeServicesForGaming
                Invoke-ConfigureGameMode
                Invoke-OptimizeAudioForGaming
                Invoke-OptimizeInputLag
                Write-Host "`nTodas as otimiza√ß√µes para jogos foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Jogos..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Privacidade (Dentro do Avan√ßado!) ---
function Show-PrivacidadeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: PRIVACIDADE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desativar Telemetria do Windows" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Aplicativos" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Hist√≥rico de Atividades" -ForegroundColor White
        Write-Host "[4] Gerenciar Diagn√≥stico e Feedback" -ForegroundColor Green
        Write-Host "[5] Gerenciar An√∫ncios Personalizados" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Localiza√ß√£o e Sensores" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Reconhecimento de Voz e Digita√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Sincroniza√ß√£o com a Microsoft" -ForegroundColor Cyan
        Write-Host "[9] Aplicar TODAS as configura√ß√µes de privacidade" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de privacidade"

        switch ($choice) {
            "1" { Invoke-DisableTelemetry }
            "2" { Invoke-ManageAppPermissions }
            "3" { Invoke-ManageActivityHistory }
            "4" { Invoke-ManageDiagnosticsFeedback }
            "5" { Invoke-ManagePersonalizedAds }
            "6" { Invoke-ManageLocationSensors }
            "7" { Invoke-ManageVoiceTyping }
            "8" { Invoke-ManageMicrosoftSync }
            "9" {
                Write-Host "`nAplicando todas as configura√ß√µes de privacidade...`n" -ForegroundColor Yellow
                Invoke-DisableTelemetry
                Invoke-ManageAppPermissions
                Invoke-ManageActivityHistory
                Invoke-ManageDiagnosticsFeedback
                Invoke-ManagePersonalizedAds
                Invoke-ManageLocationSensors
                Invoke-ManageVoiceTyping
                Invoke-ManageMicrosoftSync
                Write-Host "`nTodas as configura√ß√µes de privacidade foram aplicadas!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Privacidade..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Outros (Dentro do Avan√ßado!) ---
function Show-OutrosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: OUTROS TWEAKS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Mostrar Informa√ß√µes Detalhadas do Sistema" -ForegroundColor Yellow
        Write-Host "[2] Mostrar Configura√ß√£o Completa de Rede" -ForegroundColor Cyan
        Write-Host "[3] Reiniciar Explorer.exe" -ForegroundColor White
        Write-Host "[4] Limpar Cache de Atualiza√ß√µes do Windows" -ForegroundColor Green
        Write-Host "[5] Gerenciar Programas de Inicializa√ß√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar Op√ß√µes de Energia Avan√ßadas" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Configura√ß√µes de Armazenamento" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Configura√ß√µes de Notifica√ß√µes" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√µes diversas"

        switch ($choice) {
            "1" { Invoke-ShowDetailedSystemInfo }
            "2" { Invoke-ShowDetailedNetworkConfig }
            "3" { Invoke-RestartExplorer }
            "4" { Invoke-CleanWindowsUpdateCache }
            "5" { Invoke-ManageStartupPrograms }
            "6" { Invoke-ConfigureAdvancedPowerOptions }
            "7" { Invoke-ManageStorageSettings }
            "8" { Invoke-ManageNotificationSettings }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- Fun√ß√µes para as Secoes SIMPLIFICADAS (Expandidas) ---
function Invoke-SimpleSystemCleanup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza Geral do Sistema: Hora de varrer o lixo digital! ---" -ForegroundColor Green
    Write-Host "Essa op√ß√£o vai te ajudar a liberar espa√ßo e dar um f√¥lego pro PC tirando arquivos tempor√°rios, lixo da lixeira, etc. √â tipo faxina no computador!" -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Comando 1: Limpar Arquivos Tempor√°rios do Usu√°rio
    Write-Host "Bora come√ßar limpando os arquivos tempor√°rios do seu usu√°rio! Eles acumulam que √© uma beleza!" -ForegroundColor Yellow
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio limpos! Menos peso pro PC respirar! ;)" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Esvaziar a Lixeira
    Write-Host "Agora, vamos dar um fim definitivo naqueles arquivos na Lixeira. Eles s√≥ est√£o ocupando espa√ßo √† toa!" -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada! Espa√ßo recuperado com sucesso! R√°!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios do Windows
    Write-Host "Vamos limpar tamb√©m os tempor√°rios do pr√≥prio Windows. √Äs vezes, fica lixo escondido por l√°!" -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Limpar Cache de Navegadores Comuns
    Write-Host "Bora dar uma geral nos caches dos navegadores tamb√©m! Eles guardam um monte de coisa que pode pesar!" -ForegroundColor Yellow
    
    # Chrome
    Write-Host "Tentando limpar cache do Google Chrome..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Chrome limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Edge
    Write-Host "Tentando limpar cache do Microsoft Edge..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Edge limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Firefox
    Write-Host "Tentando limpar cache do Mozilla Firefox..." -ForegroundColor DarkGray
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\cache2\entries\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\startupCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\thumbnails\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Firefox limpo (pode n√£o ser completo, dependendo do perfil/uso)." -ForegroundColor DarkGray

    # Brave (se instalado)
    Write-Host "Tentando limpar cache do Brave Browser (se instalado)..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Brave limpo (se instalado e n√£o estiver rodando)." -ForegroundColor DarkGray

    Write-Host "Limpeza de caches de navegador conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Comando 5: Limpar Cache de Miniaturas
    Write-Host "Limpando cache de miniaturas do Windows (aquelas pr√©-visualiza√ß√µes de imagens e v√≠deos)..." -ForegroundColor Yellow
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Write-Host "Cache de miniaturas limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Limpar Arquivos de Log do Windows
    Write-Host "Limpando arquivos de log do Windows que podem ocupar espa√ßo..." -ForegroundColor Yellow
    wevtutil cl Application
    wevtutil cl System
    wevtutil cl Security
    Write-Host "Logs do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 7: Limpar Arquivos Tempor√°rios de Instala√ß√£o
    Write-Host "Limpando arquivos tempor√°rios de instala√ß√£o de programas..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Installer\$*\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios de instala√ß√£o limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 8: Limpar Arquivos de Atualiza√ß√£o do Windows
    Write-Host "Limpando arquivos de atualiza√ß√£o do Windows que podem ocupar bastante espa√ßo..." -ForegroundColor Yellow
    Stop-Service -Name wuauserv -ErrorAction SilentlyContinue
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    Write-Host "Arquivos de atualiza√ß√£o do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 9: Limpar Arquivos Prefetch
    Write-Host "Limpando arquivos prefetch para melhorar a inicializa√ß√£o..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Prefetch\*.pf" -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos prefetch limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 10: Executar Limpeza de Disco Integrada do Windows
    Write-Host "Executando a ferramenta de limpeza de disco integrada do Windows..." -ForegroundColor Yellow
    Start-Process -FilePath cleanmgr.exe -ArgumentList "/sagerun:1" -Wait -ErrorAction SilentlyContinue
    Write-Host "Limpeza de disco conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "Vamos ver quanto espa√ßo conseguimos recuperar com essa faxina:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nPronto! A faxina geral b√°sica foi feita! Seu PC agradece o espa√ßo extra! ;)" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu
    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleMemoryStartup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Mem√≥ria e Inicializa√ß√£o R√°pida: Deixa o PC ligando num piscar! ---" -ForegroundColor Yellow
    Write-Host "Aqui a gente d√° uma olhada na mem√≥ria RAM e nos programas que ligam junto com o Windows. Menos coisa ligando √† toa = PC mais r√°pido pra usar na hora!" -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Listar Programas de Inicializa√ß√£o
    Write-Host "Listando programas que iniciam com o Windows (pra voc√™ saber o que t√° rodando por baixo dos panos):" -ForegroundColor Yellow
    Get-CimInstance win32_startupcommand | Select-Object Name, command, Location | Format-Table -AutoSize
    Write-Host "Lista de programas de inicializa√ß√£o exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Servi√ßo SuperFetch/SysMain
    Write-Host "Otimizando o servi√ßo SuperFetch/SysMain para melhorar o desempenho..." -ForegroundColor Yellow
    $confirmSysMain = Read-Host "Deseja desativar o servi√ßo SysMain/SuperFetch? (s/n) - Recomendado para SSDs"
    if ($confirmSysMain -eq 's') {
        Set-Service -Name SysMain -StartupType Disabled -ErrorAction SilentlyContinue
        Stop-Service -Name SysMain -Force -ErrorAction SilentlyContinue
        Write-Host "Servi√ßo SysMain/SuperFetch desativado!" -ForegroundColor Green
    } else {
        Write-Host "Servi√ßo SysMain/SuperFetch mantido ativo." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios de Updates
    Write-Host "Limpando arquivos tempor√°rios de atualiza√ß√µes do Windows (podem ocupar bastante espa√ßo e afetar performance):" -ForegroundColor Yellow
    Dism /online /Cleanup-Image /StartComponentCleanup /ErrorAction SilentlyContinue
    Write-Host "Limpeza de componentes de atualiza√ß√£o iniciada (pode levar um tempo)." -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Mem√≥ria Virtual
    Write-Host "Otimizando configura√ß√µes de mem√≥ria virtual para melhor desempenho..." -ForegroundColor Yellow
    $totalRam = (Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property capacity -Sum).Sum / 1GB
    Write-Host "Seu sistema tem aproximadamente $totalRam GB de RAM." -ForegroundColor White
    
    $confirmPageFile = Read-Host "Deseja otimizar o arquivo de pagina√ß√£o (mem√≥ria virtual)? (s/n)"
    if ($confirmPageFile -eq 's') {
        # Calcula tamanho recomendado (1.5x a RAM para sistemas com menos de 8GB, 1x para sistemas com mais)
        $pageFileSize = if ($totalRam -lt 8) { [math]::Round($totalRam * 1.5) * 1024 } else { [math]::Round($totalRam) * 1024 }
        
        Write-Host "Configurando arquivo de pagina√ß√£o para tamanho fixo de $pageFileSize MB..." -ForegroundColor DarkGray
        $computerSystem = Get-WmiObject -Class Win32_ComputerSystem
        $computerSystem.AutomaticManagedPagefile = $false
        $computerSystem.Put() | Out-Null
        
        $pageFileSetting = Get-WmiObject -Class Win32_PageFileSetting
        if ($pageFileSetting) {
            $pageFileSetting.InitialSize = $pageFileSize
            $pageFileSetting.MaximumSize = $pageFileSize
            $pageFileSetting.Put() | Out-Null
        }
        Write-Host "Arquivo de pagina√ß√£o otimizado! (Requer reinicializa√ß√£o para aplicar totalmente)" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes de mem√≥ria virtual mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Listar os 10 Processos que mais usam mem√≥ria no momento
    Write-Host "Listando os 10 processos que mais consomem mem√≥ria agora:" -ForegroundColor Yellow
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host "Lista de processos exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Otimizar Inicializa√ß√£o do Windows
    Write-Host "Otimizando a inicializa√ß√£o do Windows..." -ForegroundColor Yellow
    # Desabilitar servi√ßos n√£o essenciais que podem atrasar a inicializa√ß√£o
    $startupServices = @(
        @{Name="DiagTrack"; DisplayName="Experi√™ncias do Usu√°rio Conectado e Telemetria"},
        @{Name="dmwappushservice"; DisplayName="Servi√ßo de Transfer√™ncia Inteligente em Segundo Plano (BITS)"},
        @{Name="MapsBroker"; DisplayName="Servi√ßo de Dados de Mapas"}
    )
    
    foreach ($service in $startupServices) {
        $confirmService = Read-Host "Deseja desativar o servi√ßo '$($service.DisplayName)' na inicializa√ß√£o? (s/n)"
        if ($confirmService -eq 's') {
            Set-Service -Name $service.Name -StartupType Disabled -ErrorAction SilentlyContinue
            Stop-Service -Name $service.Name -Force -ErrorAction SilentlyContinue
            Write-Host "Servi√ßo '$($service.DisplayName)' desativado!" -ForegroundColor Green
        } else {
            Write-Host "Servi√ßo '$($service.DisplayName)' mantido." -ForegroundColor Green
        }
    }
    Write-Host ""

    # Comando 7: Reiniciar o Computador (√ötil pra liberar mem√≥ria e aplicar mudan√ßas)
    Write-Host "Quer dar um 'refresh' geral no PC? Reiniciar pode ajudar!" -ForegroundColor Yellow
    $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (digite 'sim' para confirmar)"
    if ($confirmRestart -eq 'sim') {
        Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
        Restart-Computer -Force
    } else {
        Write-Host "Rein√≠cio cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o de mem√≥ria e inicializa√ß√£o!" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu (a n√£o ser que o PC tenha reiniciado)
    if ($confirmRestart -ne 'sim') {
        Write-Host ""
        Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
    }
}

function Invoke-SimpleInternetOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Acelerar a Conex√£o com a Internet (Simplificado): Diz adeus pro 'carregando...'! ---" -ForegroundColor Cyan
    Write-Host "Vamos fazer uns ajustes r√°pidos na sua conex√£o pra tentar deixar ela mais esperta." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Limpar Cache de DNS
    Write-Host "Limpando o cache de endere√ßos de internet (DNS) pra resolver nomes mais r√°pido!" -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Configura√ß√µes TCP/IP
    Write-Host "Otimizando configura√ß√µes TCP/IP para melhorar a velocidade de conex√£o..." -ForegroundColor Yellow
    
    # Habilitar TCP Window Auto-Tuning
    netsh int tcp set global autotuninglevel=normal
    Write-Host "TCP Auto-Tuning configurado para 'normal'." -ForegroundColor DarkGray
    
    # Otimizar par√¢metros de recebimento de pacotes
    netsh int tcp set global rss=enabled
    Write-Host "Receive-Side Scaling (RSS) habilitado." -ForegroundColor DarkGray
    
    # Otimizar congestion provider
    netsh int tcp set global congestionprovider=ctcp
    Write-Host "Congestion Provider configurado para 'ctcp'." -ForegroundColor DarkGray
    
    # Otimizar ECN capability
    netsh int tcp set global ecncapability=enabled
    Write-Host "ECN Capability habilitado." -ForegroundColor DarkGray
    
    Write-Host "Configura√ß√µes TCP/IP otimizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Reiniciar Adaptadores de Rede
    Write-Host "Dando um 'reset' r√°pido nas suas conex√µes de rede. Pode resolver uns pepinos!" -ForegroundColor Yellow
    $confirmResetAdapter = Read-Host "Isso vai desconectar brevemente sua internet. Continuar? (s/n)"
    if ($confirmResetAdapter -eq 's') {
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        Write-Host "Adaptadores de rede reiniciados." -ForegroundColor Green
    } else {
        Write-Host "Reset de adaptadores cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 4: Configurar DNS R√°pido
    Write-Host "Configurar DNS mais r√°pido pode melhorar sua navega√ß√£o!" -ForegroundColor Yellow
    $confirmDns = Read-Host "Deseja configurar DNS mais r√°pidos (Google ou Cloudflare)? (s/n)"
    if ($confirmDns -eq 's') {
        Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
        Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
        $dnsChoice = Read-Host "Escolha uma op√ß√£o (1 ou 2)"
        
        $primaryDns = ""
        $secondaryDns = ""
        
        if ($dnsChoice -eq '1') {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            Write-Host "Google DNS selecionado." -ForegroundColor DarkGray
        } elseif ($dnsChoice -eq '2') {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            Write-Host "Cloudflare DNS selecionado." -ForegroundColor DarkGray
        } else {
            Write-Host "Op√ß√£o inv√°lida. DNS n√£o alterado." -ForegroundColor Red
        }
        
        if ($primaryDns -ne "") {
            $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" -and ($_.InterfaceDescription -match "Ethernet" -or $_.InterfaceDescription -match "Wi-Fi" -or $_.InterfaceDescription -match "Wireless") }
            
            foreach ($adapter in $networkAdapters) {
                Write-Host "Configurando DNS para adaptador: $($adapter.Name)" -ForegroundColor DarkGray
                Set-DnsClientServerAddress -InterfaceIndex $adapter.ifIndex -ServerAddresses ($primaryDns, $secondaryDns)
            }
            
            Write-Host "DNS configurado! Sua navega√ß√£o deve ficar mais r√°pida agora." -ForegroundColor Green
        }
    } else {
        Write-Host "Configura√ß√£o de DNS mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Mostrar Status B√°sico da Conex√£o
    Write-Host "Mostrando um resumo b√°sico da sua configura√ß√£o de rede atual:" -ForegroundColor Yellow
    ipconfig /all | Select-String -Pattern "IPv4", "DNS", "Gateway", "DHCP", "Subnet", "Physical Address"
    Write-Host "Status b√°sico da rede exibido." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Testar a conex√£o com a internet
    Write-Host "Testando a conex√£o com a internet (ping para google.com)..." -ForegroundColor Yellow
    Test-Connection -Count 4 google.com -ErrorAction SilentlyContinue
    Write-Host "Teste de conex√£o finalizado." -ForegroundColor Green
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o b√°sica de internet!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleVisualOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Deixar o Windows mais Leve Visualmente (Simplificado): Desempenho antes da beleza! ---" -ForegroundColor White
    Write-Host "Ajustes r√°pidos pra desativar efeitos visuais que podem pesar, liberando recursos pro que importa." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ajustar Efeitos Visuais
    Write-Host "Voc√™ quer desativar ou ativar as anima√ß√µes e efeitos visuais do Windows?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Efeitos Visuais (Pra ganhar desempenho)" -ForegroundColor Green
    Write-Host "[2] Configurar para Melhor Apar√™ncia (Mais bonito, mas mais pesado)" -ForegroundColor White
    Write-Host "[3] Deixar o Windows Escolher (Configura√ß√£o padr√£o)" -ForegroundColor Cyan
    $choiceVisual = Read-Host "Escolha [1], [2] ou [3]"

    if ($choiceVisual -eq '1') {
        Write-Host "Desativando efeitos visuais para melhor desempenho..." -ForegroundColor Yellow
        # Valor 2 = Ajustar para melhor desempenho (desativa a maioria dos efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 2 -Type DWord -Force -ErrorAction SilentlyContinue
        
        # Desativar anima√ß√µes individuais
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop' -Name 'UserPreferencesMask' -Value ([byte[]](0x90, 0x12, 0x01, 0x80)) -Type Binary -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop\WindowMetrics' -Name 'MinAnimate' -Value 0 -Type String -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'ListviewAlphaSelect' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'TaskbarAnimations' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        
        Write-Host "Efeitos visuais desativados para melhor desempenho!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '2') {
        Write-Host "Configurando para melhor apar√™ncia (todos os efeitos visuais ativados)..." -ForegroundColor Yellow
        # Valor 1 = Ajustar para melhor apar√™ncia (ativa todos os efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Efeitos visuais configurados para melhor apar√™ncia!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '3') {
        Write-Host "Deixando o Windows escolher automaticamente (configura√ß√£o padr√£o)..." -ForegroundColor Yellow
        # Valor 0 = Deixar o Windows escolher
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Configura√ß√£o visual definida para padr√£o do Windows!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa nos efeitos visuais foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 2: Ativar/Desativar Efeitos de Transpar√™ncia
    Write-Host "E os efeitos de transpar√™ncia do Windows (tipo na barra de tarefas)?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Transpar√™ncia (Mais leve)" -ForegroundColor Green
    Write-Host "[2] Ativar Transpar√™ncia (Mais 'bonito')" -ForegroundColor White
    $choiceTransp = Read-Host "Escolha [1] ou [2]"

    if ($choiceTransp -eq '1') {
        Write-Host "Desativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 0 = Desativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia desativada!" -ForegroundColor Green
    } elseif ($choiceTransp -eq '2') {
        Write-Host "Ativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 1 = Ativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia ativada!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa na transpar√™ncia foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 3: Configurar Tema Claro/Escuro
    Write-Host "Voc√™ prefere tema claro ou escuro? O tema escuro pode ser mais confort√°vel para os olhos." -ForegroundColor Yellow
    Write-Host "[1] Tema Escuro (Dark Mode)" -ForegroundColor DarkGray
    Write-Host "[2] Tema Claro (Light Mode)" -ForegroundColor White
    $choiceTheme = Read-Host "Escolha [1] ou [2]"

    if ($choiceTheme -eq '1') {
        Write-Host "Configurando tema escuro..." -ForegroundColor Yellow
        # Valor 0 = Tema Escuro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema escuro configurado!" -ForegroundColor Green
    } elseif ($choiceTheme -eq '2') {
        Write-Host "Configurando tema claro..." -ForegroundColor Yellow
        # Valor 1 = Tema Claro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema claro configurado!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa no tema foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Configurar Resolu√ß√£o de Tela
    Write-Host "Deseja ajustar a resolu√ß√£o da tela? Resolu√ß√µes menores podem melhorar o desempenho em PCs mais antigos." -ForegroundColor Yellow
    $confirmResolution = Read-Host "Deseja ver e ajustar a resolu√ß√£o da tela? (s/n)"
    
    if ($confirmResolution -eq 's') {
        # Mostrar resolu√ß√£o atual
        $currentResolution = Get-WmiObject -Class Win32_VideoController | Select-Object -ExpandProperty VideoModeDescription
        Write-Host "Resolu√ß√£o atual: $currentResolution" -ForegroundColor White
        
        # Abrir configura√ß√µes de exibi√ß√£o do Windows
        Write-Host "Abrindo configura√ß√µes de exibi√ß√£o do Windows..." -ForegroundColor DarkGray
        Start-Process "ms-settings:display"
        Write-Host "Ajuste a resolu√ß√£o conforme necess√°rio na janela de configura√ß√µes que foi aberta." -ForegroundColor Green
        
        $waitForSettings = Read-Host "Pressione Enter quando terminar de ajustar as configura√ß√µes de exibi√ß√£o"
    } else {
        Write-Host "Configura√ß√£o de resolu√ß√£o mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizados os ajustes visuais b√°sicos!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleGamingOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Jogos (Simplificado): Mais FPS, menos lag! ---" -ForegroundColor Magenta
    Write-Host "Vamos fazer alguns ajustes para melhorar o desempenho dos seus jogos sem complica√ß√µes." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ativar Modo de Jogo do Windows
    Write-Host "Ativando o Modo de Jogo do Windows para priorizar recursos para jogos..." -ForegroundColor Yellow
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AllowAutoGameMode" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AutoGameModeEnabled" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Write-Host "Modo de Jogo do Windows ativado!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Desativar Game DVR e Game Bar
    Write-Host "O Game DVR e Game Bar podem reduzir o desempenho em jogos. Deseja desativ√°-los?" -ForegroundColor Yellow
    $confirmGameDVR = Read-Host "Desativar Game DVR e Game Bar? (s/n)"
    
    if ($confirmGameDVR -eq 's') {
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "UseNexusForGameBarEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\System\GameConfigStore" -Name "GameDVR_Enabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR" -Name "AppCaptureEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Write-Host "Game DVR e Game Bar desativados!" -ForegroundColor Green
    } else {
        Write-Host "Game DVR e Game Bar mantidos ativos." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Otimizar Plano de Energia para Jogos
    Write-Host "Configurando plano de energia para alto desempenho (ideal para jogos)..." -ForegroundColor Yellow
    powercfg.exe /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c
    Write-Host "Plano de energia configurado para alto desempenho!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Configura√ß√µes de Mouse
    Write-Host "Otimizando configura√ß√µes de mouse para jogos (precis√£o do ponteiro)..." -ForegroundColor Yellow
    $confirmMouseFix = Read-Host "Desativar a acelera√ß√£o do mouse para melhor precis√£o em jogos? (s/n)"
    
    if ($confirmMouseFix -eq 's') {
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseSpeed" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold1" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold2" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Write-Host "Acelera√ß√£o do mouse desativada para melhor precis√£o em jogos!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do mouse mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Otimizar Prioridade de CPU para Jogos
    Write-Host "Configurando prioridade de CPU para jogos..." -ForegroundColor Yellow
    Write-Host "Esta configura√ß√£o ajusta o sistema para dar mais prioridade aos jogos." -ForegroundColor DarkGray
    
    # Criar chave de registro para prioridade de jogos
    if (-not (Test-Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games")) {
        New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Force | Out-Null
    }
    
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "GPU Priority" -Type DWord -Value 8 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Priority" -Type DWord -Value 6 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Scheduling Category" -Type String -Value "High" -Force -ErrorAction SilentlyContinue
    
    Write-Host "Prioridade de CPU para jogos otimizada!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Verificar Driver de Placa de V√≠deo
    Write-Host "Verificando informa√ß√µes da placa de v√≠deo..." -ForegroundColor Yellow
    $gpuInfo = Get-WmiObject -Class Win32_VideoController | Select-Object Name, DriverVersion, CurrentHorizontalResolution, CurrentVerticalResolution
    
    foreach ($gpu in $gpuInfo) {
        Write-Host "Placa de v√≠deo: $($gpu.Name)" -ForegroundColor White
        Write-Host "Vers√£o do driver: $($gpu.DriverVersion)" -ForegroundColor White
        Write-Host "Resolu√ß√£o atual: $($gpu.CurrentHorizontalResolution) x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
      x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
    
    Write-Host "Recomenda√ß√£o: Mantenha seus drivers de v√≠deo atualizados para melhor desempenho em jogos!" -ForegroundColor Green
    Write-Host "Voc√™ pode baixar os drivers mais recentes nos sites oficiais da NVIDIA, AMD ou Intel." -ForegroundColor DarkGray
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nOtimiza√ß√µes para jogos conclu√≠das! Seus jogos devem rodar mais suaves agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleSecurityMaintenance {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Manuten√ß√£o de Seguran√ßa (Simplificado): Mantenha seu PC protegido! ---" -ForegroundColor DarkYellow
    Write-Host "Vamos verificar e melhorar a seguran√ßa do seu sistema com alguns ajustes simples." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Verificar Status do Windows Defender
    Write-Host "Verificando status do Windows Defender..." -ForegroundColor Yellow
    $defenderStatus = Get-MpComputerStatus
    
    Write-Host "Status do Windows Defender:" -ForegroundColor White
    Write-Host "Antiv√≠rus habilitado: $($defenderStatus.AntivirusEnabled)" -ForegroundColor $(if ($defenderStatus.AntivirusEnabled) { "Green" } else { "Red" })
    Write-Host "Prote√ß√£o em tempo real: $($defenderStatus.RealTimeProtectionEnabled)" -ForegroundColor $(if ($defenderStatus.RealTimeProtectionEnabled) { "Green" } else { "Red" })
    Write-Host "Defini√ß√µes de antiv√≠rus: $($defenderStatus.AntivirusSignatureVersion)" -ForegroundColor White
    Write-Host "√öltima atualiza√ß√£o: $($defenderStatus.AntivirusSignatureLastUpdated)" -ForegroundColor White
    Write-Host ""

    # Comando 2: Atualizar Defini√ß√µes do Windows Defender
    Write-Host "Atualizando defini√ß√µes do Windows Defender..." -ForegroundColor Yellow
    Update-MpSignature -ErrorAction SilentlyContinue
    Write-Host "Defini√ß√µes do Windows Defender atualizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Verificar Atualiza√ß√µes do Windows
    Write-Host "Verificando status das atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
            Write-Host "Recomenda√ß√£o: Execute o Windows Update para manter seu sistema seguro." -ForegroundColor Green
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Verificar Configura√ß√µes de Firewall
    Write-Host "Verificando status do Firewall do Windows..." -ForegroundColor Yellow
    $firewallStatus = Get-NetFirewallProfile
    
    foreach ($profile in $firewallStatus) {
        Write-Host "Perfil: $($profile.Name)" -ForegroundColor White
        Write-Host "Status: $($profile.Enabled)" -ForegroundColor $(if ($profile.Enabled) { "Green" } else { "Red" })
        Write-Host ""
    }
    
    $confirmFirewall = Read-Host "Deseja habilitar o Firewall em todos os perfis? (s/n)"
    if ($confirmFirewall -eq 's') {
        Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True
        Write-Host "Firewall habilitado em todos os perfis!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do Firewall mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Verificar Configura√ß√µes de UAC
    Write-Host "Verificando configura√ß√µes do Controle de Conta de Usu√°rio (UAC)..." -ForegroundColor Yellow
    $uacLevel = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -ErrorAction SilentlyContinue
    
    if ($uacLevel) {
        switch ($uacLevel.ConsentPromptBehaviorAdmin) {
            0 { $uacStatus = "Desativado (N√£o recomendado)" }
            1 { $uacStatus = "Baixo (N√£o recomendado)" }
            2 { $uacStatus = "M√©dio" }
            5 { $uacStatus = "Alto (Recomendado)" }
            default { $uacStatus = "Personalizado" }
        }
        
        Write-Host "N√≠vel atual do UAC: $uacStatus" -ForegroundColor $(if ($uacLevel.ConsentPromptBehaviorAdmin -ge 2) { "Green" } else { "Red" })
        
        $confirmUAC = Read-Host "Deseja configurar o UAC para o n√≠vel recomendado? (s/n)"
        if ($confirmUAC -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -Value 5 -Type DWord -Force -ErrorAction SilentlyContinue
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "PromptOnSecureDesktop" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
            Write-Host "UAC configurado para o n√≠vel recomendado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do UAC mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do UAC." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 6: Verificar Configura√ß√µes de SmartScreen
    Write-Host "Verificando configura√ß√µes do Windows SmartScreen..." -ForegroundColor Yellow
    $smartScreen = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -ErrorAction SilentlyContinue
    
    if ($smartScreen) {
        Write-Host "Status do SmartScreen: $($smartScreen.SmartScreenEnabled)" -ForegroundColor $(if ($smartScreen.SmartScreenEnabled -eq "RequireAdmin" -or $smartScreen.SmartScreenEnabled -eq "Warn") { "Green" } else { "Red" })
        
        $confirmSmartScreen = Read-Host "Deseja habilitar o SmartScreen para maior seguran√ßa? (s/n)"
        if ($confirmSmartScreen -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -Value "RequireAdmin" -Type String -Force -ErrorAction SilentlyContinue
            Write-Host "SmartScreen habilitado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do SmartScreen mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do SmartScreen." -ForegroundColor Red
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nManuten√ß√£o de seguran√ßa conclu√≠da! Seu sistema est√° mais protegido agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

# --- Fun√ß√µes para o Diagn√≥stico R√°pido e Sobre ---
function Invoke-QuickDiagnostic {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Diagn√≥stico R√°pido do Sistema ---" -ForegroundColor Yellow
    Write-Host "Vamos fazer uma verifica√ß√£o r√°pida do estado atual do seu PC." -ForegroundColor Gray
    Write-Host ""

    # Informa√ß√µes do Sistema
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    $sysInfo = Get-SystemInfo
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host ""

    # Uso de CPU
    Write-Host "=== Uso de CPU ===" -ForegroundColor Cyan
    $cpuLoad = (Get-WmiObject Win32_Processor).LoadPercentage
    Write-Host "Uso atual de CPU: $cpuLoad%" -ForegroundColor $(if ($cpuLoad -lt 70) { "Green" } elseif ($cpuLoad -lt 90) { "Yellow" } else { "Red" })
    Write-Host ""

    # Uso de Mem√≥ria
    Write-Host "=== Uso de Mem√≥ria ===" -ForegroundColor Cyan
    $os = Get-WmiObject Win32_OperatingSystem
    $totalMemory = [math]::Round($os.TotalVisibleMemorySize / 1MB, 2)
    $freeMemory = [math]::Round($os.FreePhysicalMemory / 1MB, 2)
    $usedMemory = [math]::Round($totalMemory - $freeMemory, 2)
    $memoryPercentage = [math]::Round(($usedMemory / $totalMemory) * 100, 2)
    
    Write-Host "Mem√≥ria Total: $totalMemory GB" -ForegroundColor White
    Write-Host "Mem√≥ria Usada: $usedMemory GB ($memoryPercentage%)" -ForegroundColor $(if ($memoryPercentage -lt 70) { "Green" } elseif ($memoryPercentage -lt 90) { "Yellow" } else { "Red" })
    Write-Host "Mem√≥ria Livre: $freeMemory GB" -ForegroundColor White
    Write-Host ""

    # Espa√ßo em Disco
    Write-Host "=== Espa√ßo em Disco ===" -ForegroundColor Cyan
    $drives = Get-PSDrive -PSProvider FileSystem
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        $percentFree = [math]::Round(($freeSpace / $totalSpace) * 100, 2)
        
        Write-Host "Drive $($drive.Name):" -ForegroundColor White
        Write-Host "  Total: $totalSpace GB" -ForegroundColor White
        Write-Host "  Usado: $usedSpace GB" -ForegroundColor White
        Write-Host "  Livre: $freeSpace GB ($percentFree%)" -ForegroundColor $(if ($percentFree -gt 20) { "Green" } elseif ($percentFree -gt 10) { "Yellow" } else { "Red" })
    }
    Write-Host ""

    # Processos que mais consomem recursos
    Write-Host "=== Top 5 Processos (CPU) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object CPU -Descending | Select-Object -First 5 ProcessName, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}}, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host ""

    Write-Host "=== Top 5 Processos (Mem√≥ria) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 5 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}}, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}} | Format-Table -AutoSize
    Write-Host ""

    # Status de Servi√ßos Cr√≠ticos
    Write-Host "=== Status de Servi√ßos Cr√≠ticos ===" -ForegroundColor Cyan
    $criticalServices = @("wuauserv", "WinDefend", "MpsSvc", "wscsvc")
    foreach ($service in $criticalServices) {
        $serviceStatus = Get-Service -Name $service -ErrorAction SilentlyContinue
        if ($serviceStatus) {
            Write-Host "$($serviceStatus.DisplayName): $($serviceStatus.Status)" -ForegroundColor $(if ($serviceStatus.Status -eq "Running") { "Green" } else { "Red" })
        }
    }
    Write-Host ""

    # Verificar Atualiza√ß√µes Pendentes
    Write-Host "=== Atualiza√ß√µes do Windows ===" -ForegroundColor Cyan
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Recomenda√ß√µes
    Write-Host "=== Recomenda√ß√µes ===" -ForegroundColor Cyan
    
    # Recomenda√ß√£o de Mem√≥ria
    if ($memoryPercentage -gt 80) {
        Write-Host "- Seu uso de mem√≥ria est√° alto. Considere fechar alguns programas ou usar a op√ß√£o 'Otimiza√ß√£o de Mem√≥ria'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Disco
    $lowDiskSpace = $false
    foreach ($drive in $drives) {
        $percentFree = [math]::Round(($drive.Free / ($drive.Free + $drive.Used)) * 100, 2)
        if ($percentFree -lt 15) {
            $lowDiskSpace = $true
            break
        }
    }
    
    if ($lowDiskSpace) {
        Write-Host "- Espa√ßo em disco baixo detectado. Considere usar a op√ß√£o 'Limpeza Geral do Sistema'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Atualiza√ß√µes
    if ($pendingUpdates -gt 0) {
        Write-Host "- Existem atualiza√ß√µes pendentes. Recomendamos atualizar seu sistema para maior seguran√ßa." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Inicializa√ß√£o
    $bootTime = $sysInfo.LastBootTime
    $uptime = (Get-Date) - $bootTime
    if ($uptime.Days -gt 7) {
        Write-Host "- Seu sistema est√° ligado h√° $($uptime.Days) dias. Considere reiniciar para aplicar atualiza√ß√µes e limpar a mem√≥ria." -ForegroundColor Yellow
    }
    
    Write-Host ""

    # Mensagem de conclus√£o
    Write-Host "`nDiagn√≥stico r√°pido conclu√≠do! Use as informa√ß√µes acima para decidir quais otimiza√ß√µes fazer." -ForegroundColor Green

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

function Show-AboutTORK {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Sobre o TORK ---" -ForegroundColor White
    Write-Host ""
    
    Write-Host "TORK - Otimizador para Windows" -ForegroundColor Cyan
    Write-Host "Vers√£o: 2.0" -ForegroundColor White
    Write-Host "Desenvolvido por: Partner77" -ForegroundColor White
    Write-Host ""
    
    Write-Host "=== Descri√ß√£o ===" -ForegroundColor Yellow
    Write-Host "O TORK √© uma ferramenta abrangente de otimiza√ß√£o para Windows, projetada para" -ForegroundColor Gray
    Write-Host "melhorar o desempenho do seu sistema atrav√©s de limpeza, ajustes e otimiza√ß√µes." -ForegroundColor Gray
    Write-Host "Ele oferece op√ß√µes simplificadas para usu√°rios comuns e op√ß√µes avan√ßadas para" -ForegroundColor Gray
    Write-Host "usu√°rios experientes que desejam um controle mais detalhado sobre o sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Recursos ===" -ForegroundColor Yellow
    Write-Host "- Limpeza completa do sistema" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√£o de mem√≥ria e inicializa√ß√£o" -ForegroundColor Gray
    Write-Host "- Ajustes de rede para melhor conectividade" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√µes visuais para melhor desempenho" -ForegroundColor Gray
    Write-Host "- Configura√ß√µes espec√≠ficas para jogos" -ForegroundColor Gray
    Write-Host "- Manuten√ß√£o de seguran√ßa" -ForegroundColor Gray
    Write-Host "- Diagn√≥stico r√°pido do sistema" -ForegroundColor Gray
    Write-Host "- Mais de 100 ajustes e otimiza√ß√µes avan√ßadas" -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Aviso Legal ===" -ForegroundColor Yellow
    Write-Host "Este software √© fornecido 'como est√°', sem garantias de qualquer tipo." -ForegroundColor Gray
    Write-Host "O autor n√£o se responsabiliza por quaisquer danos ou problemas causados pelo uso" -ForegroundColor Gray
    Write-Host "deste software. Use por sua conta e risco. Recomendamos sempre fazer backup" -ForegroundColor Gray
    Write-Host "dos seus dados importantes antes de realizar otimiza√ß√µes no sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Agradecimentos ===" -ForegroundColor Yellow
    Write-Host "Obrigado por escolher o TORK para otimizar seu sistema Windows!" -ForegroundColor Gray
    Write-Host "Esperamos que esta ferramenta ajude a melhorar o desempenho do seu PC." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "¬© 2023-2024 Partner77 - Todos os direitos reservados" -ForegroundColor Cyan
    Write-Host ""
    
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - LIMPEZA (Expandidas) ---
function Invoke-CleanUserTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Usu√°rio ---" -ForegroundColor Cyan
    Write-Host "Remove arquivos da pasta tempor√°ria do seu usu√°rio (`$env:TEMP`)." -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:TEMP..." -ForegroundColor Yellow
    $tempFiles = Get-ChildItem -Path $env:TEMP -Recurse -ErrorAction SilentlyContinue
    $tempFilesCount = ($tempFiles | Measure-Object).Count
    $tempFilesSize = ($tempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $tempFilesCount arquivos tempor√°rios ocupando aproximadamente $([math]::Round($tempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Sistema ---" -ForegroundColor Gray
    Write-Host "Remove arquivos da pasta tempor√°ria do Windows (`$env:SystemRoot\Temp`)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:SystemRoot\Temp..." -ForegroundColor Yellow
    $systemTempFiles = Get-ChildItem -Path "$env:SystemRoot\Temp" -Recurse -ErrorAction SilentlyContinue
    $systemTempFilesCount = ($systemTempFiles | Measure-Object).Count
    $systemTempFilesSize = ($systemTempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $systemTempFilesCount arquivos tempor√°rios do sistema ocupando aproximadamente $([math]::Round($systemTempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do sistema removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanDnsCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-EmptyRecycleBin {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Esvaziar Lixeira ---" -ForegroundColor Gray
    Write-Host "Esvazia a lixeira do usu√°rio logado." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar tamanho da lixeira antes de esvaziar
    Write-Host "Verificando tamanho da lixeira..." -ForegroundColor Yellow
    
    try {
        $shell = New-Object -ComObject Shell.Application
        $recycleBin = $shell.Namespace(0xA)
        $recycleBinItems = $recycleBin.Items()
        $recycleBinItemCount = $recycleBinItems.Count
        
        Write-Host "A lixeira cont√©m $recycleBinItemCount itens." -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o conte√∫do da lixeira." -ForegroundColor DarkGray
    }
    
    # Esvaziar a lixeira
    Write-Host "Executando: Esvaziando a lixeira..." -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanThumbnailCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Miniaturas ---" -ForegroundColor Green
    Write-Host "Remove o cache de miniaturas de arquivos (imagens, v√≠deos, etc.)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Limpando cache de miniaturas..." -ForegroundColor Yellow
    
    # Verificar tamanho do cache de miniaturas antes da limpeza
    $thumbnailPath = "$env:LOCALAPPDATA\Microsoft\Windows\Explorer"
    $thumbnailFiles = Get-ChildItem -Path $thumbnailPath -Filter "thumbcache_*.db" -ErrorAction SilentlyContinue
    $thumbnailFilesCount = ($thumbnailFiles | Measure-Object).Count
    $thumbnailFilesSize = ($thumbnailFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $thumbnailFilesCount arquivos de cache de miniaturas ocupando aproximadamente $([math]::Round($thumbnailFilesSize, 2)) MB." -ForegroundColor White
    
    # Limpar o cache de miniaturas
    Stop-Process -Name explorer -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Start-Process explorer
    
    Write-Host "Cache de miniaturas limpo com sucesso!" -ForegroundColor Green
    Write-Host "O Windows Explorer foi reiniciado para aplicar as altera√ß√µes." -ForegroundColor DarkGray
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de miniaturas:" -ForegroundColor Cyan
    Write-Host "- Navega√ß√£o mais r√°pida em pastas com muitas imagens ou v√≠deos" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de miniaturas corrompidas ou desatualizadas" -ForegroundColor DarkGray
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemLogs {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Logs do Sistema ---" -ForegroundColor Cyan
    Write-Host "Limpa os logs de eventos do sistema para liberar espa√ßo e melhorar o desempenho." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando logs do sistema..." -ForegroundColor Yellow
    
    # Verificar tamanho dos logs antes da limpeza
    $eventLogs = Get-WinEvent -ListLog * -ErrorAction SilentlyContinue | Where-Object { $_.RecordCount -gt 0 }
    $totalLogCount = ($eventLogs | Measure-Object).Count
    $total = ($eventLogs | Measure-Object -Property FileSize -Sum).Sum / 1MB
    
    Write-Host "Encontrados $totalLogCount logs de eventos ocupando aproximadamente $([math]::Round($total, 2)) MB." -ForegroundColor White
    
    # Limpar os logs principais
    Write-Host "Limpando logs principais do sistema..." -ForegroundColor Yellow
    
    $mainLogs = @("Application", "System", "Security")
    foreach ($log in $mainLogs) {
        try {
            $logSize = (Get-WinEvent -ListLog $log -ErrorAction SilentlyContinue).FileSize / 1MB
            $logRecords = (Get-WinEvent -ListLog $log -ErrorAction SilentlyContinue).RecordCount
            
            Write-Host "Log $log: $([math]::Round($logSize, 2)) MB com $logRecords registros" -ForegroundColor DarkGray
            wevtutil cl $log
            Write-Host "Log $log limpo com sucesso!" -ForegroundColor Green
        } catch {
            Write-Host "N√£o foi poss√≠vel limpar o log $log." -ForegroundColor Red
        }
    }
    
    # Perguntar se deseja limpar todos os outros logs
    $confirmAllLogs = Read-Host "Deseja limpar todos os outros logs do sistema? (s/n)"
    
    if ($confirmAllLogs -eq 's') {
        Write-Host "Limpando todos os logs do sistema... (isso pode levar algum tempo)" -ForegroundColor Yellow
        
        $otherLogs = $eventLogs | Where-Object { $_.LogName -notin $mainLogs }
        foreach ($log in $otherLogs) {
            try {
                wevtutil cl $log.LogName
            } catch {
                # Ignorar erros silenciosamente
            }
        }
        
        Write-Host "Todos os logs do sistema foram limpos!" -ForegroundColor Green
    } else {
        Write-Host "Apenas os logs principais foram limpos." -ForegroundColor Green
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanWindowsUpdateCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Atualiza√ß√µes do Windows ---" -ForegroundColor Yellow
    Write-Host "Limpa os arquivos tempor√°rios de atualiza√ß√µes do Windows para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando cache de atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    
    # Verificar tamanho da pasta SoftwareDistribution antes da limpeza
    $updateCachePath = "$env:SystemRoot\SoftwareDistribution\Download"
    $updateCacheFiles = Get-ChildItem -Path $updateCachePath -Recurse -ErrorAction SilentlyContinue
    $updateCacheSize = ($updateCacheFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "O cache de atualiza√ß√µes do Windows est√° ocupando aproximadamente $([math]::Round($updateCacheSize, 2)) MB." -ForegroundColor White
    
    # Parar o servi√ßo Windows Update
    Write-Host "Parando o servi√ßo Windows Update..." -ForegroundColor DarkGray
    Stop-Service -Name wuauserv -Force -ErrorAction SilentlyContinue
    
    # Limpar o cache de atualiza√ß√µes
    Write-Host "Limpando o cache de atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    
    # Iniciar o servi√ßo Windows Update novamente
    Write-Host "Iniciando o servi√ßo Windows Update..." -ForegroundColor DarkGray
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    
    Write-Host "Cache de atualiza√ß√µes do Windows limpo com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de atualiza√ß√µes:" -ForegroundColor Cyan
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray
    Write-Host "- Resolu√ß√£o de problemas com atualiza√ß√µes do Windows" -ForegroundColor DarkGray
    Write-Host "- Melhoria no desempenho do sistema" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanHibernationFile {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos de Hiberna√ß√£o ---" -ForegroundColor White
    Write-Host "Gerencia o arquivo de hiberna√ß√£o (hiberfil.sys) para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar status atual da hiberna√ß√£o
    Write-Host "Verificando status atual da hiberna√ß√£o..." -ForegroundColor Yellow
    $hibernationStatus = powercfg.exe /availablesleepstates | Select-String -Pattern "Hiberna√ß√£o"
    
    if ($hibernationStatus -match "Hiberna√ß√£o est√° desativada") {
        $currentStatus = "desativada"
    } else {
        $currentStatus = "ativada"
    }
    
    Write-Host "Status atual da hiberna√ß√£o: $currentStatus" -ForegroundColor White
    
    # Verificar tamanho do arquivo de hiberna√ß√£o (se existir)
    $systemDrive = $env:SystemDrive
    $hiberfilPath = "$systemDrive\hiberfil.sys"
    
    if (Test-Path -Path $hiberfilPath -ErrorAction SilentlyContinue) {
        try {
            $hiberfilSize = (Get-Item -Path $hiberfilPath -Force -ErrorAction SilentlyContinue).Length / 1GB
            Write-Host "Tamanho do arquivo de hiberna√ß√£o: $([math]::Round($hiberfilSize, 2)) GB" -ForegroundColor White
        } catch {
            Write-Host "N√£o foi poss√≠vel determinar o tamanho do arquivo de hiberna√ß√£o." -ForegroundColor DarkGray
        }
    } else {
        Write-Host "Arquivo de hiberna√ß√£o n√£o encontrado (j√° est√° desativado)." -ForegroundColor DarkGray
    }
    
    # Perguntar se deseja desativar ou ativar a hiberna√ß√£o
    if ($currentStatus -eq "ativada") {
        $confirmHibernation = Read-Host "Deseja desativar a hiberna√ß√£o para liberar espa√ßo em disco? (s/n)"
        
        if ($confirmHibernation -eq 's') {
            Write-Host "Desativando a hiberna√ß√£o..." -ForegroundColor Yellow
            powercfg.exe /hibernate off
            Write-Host "Hiberna√ß√£o desativada com sucesso! O arquivo hiberfil.sys foi removido." -ForegroundColor Green
        } else {
            Write-Host "Hiberna√ß√£o mantida ativada." -ForegroundColor Green
        }
    } else {
        $confirmHibernation = Read-Host "Deseja ativar a hiberna√ß√£o? (s/n)"
        
        if ($confirmHibernation -eq 's') {
            Write-Host "Ativando a hiberna√ß√£o..." -ForegroundColor Yellow
            powercfg.exe /hibernate on
            Write-Host "Hiberna√ß√£o ativada com sucesso! O arquivo hiberfil.sys foi criado." -ForegroundColor Green
            
            # Verificar novo tamanho do arquivo de hiberna√ß√£o
            if (Test-Path -Path $hiberfilPath -ErrorAction SilentlyContinue) {
                try {
                    $newHiberfilSize = (Get-Item -Path $hiberfilPath -Force -ErrorAction SilentlyContinue).Length / 1GB
                    Write-Host "Tamanho do novo arquivo de hiberna√ß√£o: $([math]::Round($newHiberfilSize, 2)) GB" -ForegroundColor White
                } catch {
                    Write-Host "N√£o foi poss√≠vel determinar o tamanho do novo arquivo de hiberna√ß√£o." -ForegroundColor DarkGray
                }
            }
        } else {
            Write-Host "Hiberna√ß√£o mantida desativada." -ForegroundColor Green
        }
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo foi afetado:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nInforma√ß√µes sobre a hiberna√ß√£o:" -ForegroundColor Cyan
    Write-Host "- O arquivo de hiberna√ß√£o (hiberfil.sys) geralmente ocupa espa√ßo equivalente a 75% da RAM instalada" -ForegroundColor DarkGray
    Write-Host "- Desativar a hiberna√ß√£o libera esse espa√ßo, mas voc√™ n√£o poder√° usar o modo de hiberna√ß√£o" -ForegroundColor DarkGray
    Write-Host "- A hiberna√ß√£o √© √∫til para laptops, pois salva o estado do sistema no disco antes de desligar" -ForegroundColor DarkGray
    Write-Host "- Para desktops, a hiberna√ß√£o geralmente √© menos necess√°ria" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanWinSxS {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Pasta WinSxS ---" -ForegroundColor Magenta
    Write-Host "Limpa componentes n√£o utilizados da pasta WinSxS para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "A pasta WinSxS (Windows Side-by-Side) armazena componentes do sistema e pode ocupar muito espa√ßo." -ForegroundColor White
    Write-Host "Esta limpeza √© segura e usa ferramentas oficiais do Windows para remover componentes n√£o utilizados." -ForegroundColor White
    Write-Host ""
    
    # Verificar tamanho da pasta WinSxS antes da limpeza
    Write-Host "Verificando tamanho da pasta WinSxS (isso pode levar algum tempo)..." -ForegroundColor Yellow
    
    try {
        $winSxSSize = (Get-ChildItem -Path "$env:SystemRoot\WinSxS" -Recurse -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum / 1GB
        Write-Host "Tamanho atual da pasta WinSxS: $([math]::Round($winSxSSize, 2)) GB" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel determinar o tamanho da pasta WinSxS." -ForegroundColor DarkGray
    }
    
    # Perguntar se deseja prosseguir com a limpeza
    $confirmCleanup = Read-Host "Deseja prosseguir com a limpeza da pasta WinSxS? (s/n)"
    
    if ($confirmCleanup -eq 's') {
        Write-Host "Executando limpeza de componentes n√£o utilizados (isso pode levar v√°rios minutos)..." -ForegroundColor Yellow
        
        # Executar limpeza de componentes
        Write-Host "Etapa 1: Limpeza de componentes..." -ForegroundColor DarkGray
        Dism.exe /Online /Cleanup-Image /StartComponentCleanup
        
        # Perguntar se deseja executar limpeza mais agressiva (com reset base)
        $confirmResetBase = Read-Host "Deseja executar uma limpeza mais profunda? (remove a capacidade de desinstalar atualiza√ß√µes) (s/n)"
        
        if ($confirmResetBase -eq 's') {
            Write-Host "Etapa 2: Executando limpeza profunda (isso pode levar muito tempo)..." -ForegroundColor DarkGray
            Dism.exe /Online /Cleanup-Image /StartComponentCleanup /ResetBase
            Write-Host "Limpeza profunda conclu√≠da!" -ForegroundColor Green
        }
        
        Write-Host "Limpeza da pasta WinSxS conclu√≠da com sucesso!" -ForegroundColor Green
        
        # Verificar tamanho da pasta WinSxS ap√≥s a limpeza
        try {
            $newWinSxSSize = (Get-ChildItem -Path "$env:SystemRoot\WinSxS" -Recurse -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum / 1GB
            $savedSpace = $winSxSSize - $newWinSxSSize
            
            Write-Host "Tamanho atual da pasta WinSxS: $([math]::Round($newWinSxSSize, 2)) GB" -ForegroundColor White
            Write-Host "Espa√ßo liberado: $([math]::Round($savedSpace, 2)) GB" -ForegroundColor Green
        } catch {
            Write-Host "N√£o foi poss√≠vel determinar o novo tamanho da pasta WinSxS." -ForegroundColor DarkGray
        }
    } else {
        Write-Host "Limpeza da pasta WinSxS cancelada." -ForegroundColor Yellow
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nInforma√ß√µes sobre a pasta WinSxS:" -ForegroundColor Cyan
    Write-Host "- A pasta WinSxS armazena componentes do sistema Windows e atualiza√ß√µes" -ForegroundColor DarkGray
    Write-Host "- N√£o √© recomendado excluir esta pasta manualmente" -ForegroundColor DarkGray
    Write-Host "- A limpeza realizada √© segura e usa ferramentas oficiais do Windows" -ForegroundColor DarkGray
    Write-Host "- Ap√≥s a limpeza profunda, n√£o ser√° poss√≠vel desinstalar algumas atualiza√ß√µes" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - REDE (Expandidas) ---
function Invoke-NetworkFlushDns {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Limpar Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-NetworkChangeDns {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Mudar Servidor DNS ---" -ForegroundColor Cyan
    Write-Host "Permite definir servidores DNS personalizados para suas conex√µes de rede." -ForegroundColor DarkGray
    Write-Host ""

    # Listar adaptadores de rede ativos
    Write-Host "Listando adaptadores de rede ativos..." -ForegroundColor Yellow
    $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" }
    
    if ($networkAdapters.Count -eq 0) {
        Write-Host "Nenhum adaptador de rede ativo encontrado." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    Write-Host "Adaptadores de rede ativos:" -ForegroundColor White
    $index = 1
    foreach ($adapter in $networkAdapters) {
        Write-Host "[$index] $($adapter.Name) - $($adapter.InterfaceDescription)" -ForegroundColor White
        $index++
    }
    Write-Host ""
    
    # Selecionar adaptador de rede
    $adapterChoice = Read-Host "Selecione o n√∫mero do adaptador que deseja configurar (ou 0 para voltar)"
    
    if ($adapterChoice -eq "0" -or $adapterChoice -eq "") {
        Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    $adapterIndex = [int]$adapterChoice - 1
    if ($adapterIndex -lt 0 -or $adapterIndex -ge $networkAdapters.Count) {
        Write-Host "Sele√ß√£o inv√°lida." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    $selectedAdapter = $networkAdapters[$adapterIndex]
    
    # Mostrar configura√ß√£o DNS atual
    Write-Host "Configura√ß√£o DNS atual para $($selectedAdapter.Name):" -ForegroundColor Yellow
    $currentDns = Get-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -AddressFamily IPv4 | Select-Object -ExpandProperty ServerAddresses
    
    if ($currentDns.Count -eq 0) {
        Write-Host "Nenhum servidor DNS configurado manualmente (usando DHCP)." -ForegroundColor DarkGray
    } else {
        foreach ($dns in $currentDns) {
            Write-Host $dns -ForegroundColor White
        }
    }
    Write-Host ""
    
    # Op√ß√µes de DNS
    Write-Host "Op√ß√µes de DNS:" -ForegroundColor Yellow
    Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
    Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
    Write-Host "[3] OpenDNS (208.67.222.222, 208.67.220.220)" -ForegroundColor White
    Write-Host "[4] Quad9 (9.9.9.9, 149.112.112.112)" -ForegroundColor White
    Write-Host "[5] AdGuard DNS (94.140.14.14, 94.140.15.15)" -ForegroundColor White
    Write-Host "[6] Inserir DNS personalizado" -ForegroundColor White
    Write-Host "[7] Usar DNS autom√°tico (DHCP)" -ForegroundColor White
    Write-Host "[0] Cancelar" -ForegroundColor White
    Write-Host ""
    
    $dnsChoice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($dnsChoice) {
        "1" {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            $dnsName = "Google DNS"
        }
        "2" {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            $dnsName = "Cloudflare DNS"
        }
        "3" {
            $primaryDns = "208.67.222.222"
            $secondaryDns = "208.67.220.220"
            $dnsName = "OpenDNS"
        }
        "4" {
            $primaryDns = "9.9.9.9"
            $secondaryDns = "149.112.112.112"
            $dnsName = "Quad9"
        }
        "5" {
            $primaryDns = "94.140.14.14"
            $secondaryDns = "94.140.15.15"
            $dnsName = "AdGuard DNS"
        }
        "6" {
            $primaryDns = Read-Host "Digite o endere√ßo do DNS prim√°rio"
            $secondaryDns = Read-Host "Digite o endere√ßo do DNS secund√°rio (ou deixe em branco)"
            $dnsName = "DNS Personalizado"
        }
        "7" {
            Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ResetServerAddresses
            Write-Host "Configura√ß√£o de DNS definida para autom√°tica (DHCP)." -ForegroundColor Green
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
        "0" {
            Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
        default {
            Write-Host "Op√ß√£o inv√°lida." -ForegroundColor Red
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
    }
    
    # Aplicar configura√ß√£o de DNS
    if ($secondaryDns -eq "") {
        Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ServerAddresses $primaryDns
    } else {
        Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ServerAddresses $primaryDns, $secondaryDns
    }
    
    Write-Host "Configura√ß√£o de DNS alterada para $dnsName." -ForegroundColor Green
    Write-Host "DNS Prim√°rio: $primaryDns" -ForegroundColor White
    if ($secondaryDns -ne "") {
        Write-Host "DNS Secund√°rio: $secondaryDns" -ForegroundColor White
    }
    
    # Limpar cache DNS ap√≥s a mudan√ßa
    Write-Host "Limpando cache DNS para aplicar as altera√ß√µes..." -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo." -ForegroundColor Green
    
    Write-Host "`nBenef√≠cios de usar servidores DNS alternativos:" -ForegroundColor Cyan
    Write-Host "- Maior velocidade de resolu√ß√£o de nomes" -ForegroundColor DarkGray
    Write-Host "- Melhor confiabilidade e disponibilidade" -ForegroundColor DarkGray
    Write-Host "- Alguns servidores oferecem prote√ß√£o adicional contra malware e phishing" -ForegroundColor DarkGray
    Write-Host "- Possibilidade de contornar bloqueios de conte√∫do baseados em DNS" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-NetworkReset {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Resetar Configura√ß√µes de Rede ---" -ForegroundColor White
    Write-Host "Reinicia os componentes de rede. Use como √∫ltimo recurso para solucionar problemas de conex√£o." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "!!! ATEN√á√ÉO: ESTE COMANDO VAI REINICIAR SUAS CONFIGURA√á√ïES DE REDE !!!" -ForegroundColor Red
    Write-Host "Sua conex√£o ser√° interrompida temporariamente e todas as configura√ß√µes de rede personalizadas ser√£o redefinidas." -ForegroundColor Yellow
    Write-Host "Isso inclui adaptadores de rede, configura√ß√µes de DNS, configura√ß√µes de proxy, etc." -ForegroundColor Yellow
    Write-Host ""
    
    Write-Host "Esta opera√ß√£o pode ajudar a resolver os seguintes problemas:" -ForegroundColor Cyan
    Write-Host "- Conex√µes de rede inst√°veis ou intermitentes" -ForegroundColor DarkGray
    Write-Host "- Problemas de DNS ou resolu√ß√£o de nomes" -ForegroundColor DarkGray
    Write-Host "- Problemas de conectividade ap√≥s instala√ß√£o de software ou atualiza√ß√µes" -ForegroundColor DarkGray
    Write-Host "- Erros de rede persistentes que n√£o s√£o resolvidos por outros m√©todos" -ForegroundColor DarkGray
    Write-Host ""
    
    $confirm = Read-Host "Tem certeza que deseja resetar as configura√ß√µes de rede? (digite 'sim' para confirmar)"
    
    if ($confirm -eq 'sim') {
        Write-Host "Iniciando reset de configura√ß√µes de rede..." -ForegroundColor Yellow
        
        # Etapa 1: Resetar pilha TCP/IP
        Write-Host "Etapa 1: Resetando pilha TCP/IP..." -ForegroundColor DarkGray
        netsh int ip reset
        
        # Etapa 2: Resetar cat√°logo Winsock
        Write-Host "Etapa 2: Resetando cat√°logo Winsock..." -ForegroundColor DarkGray
        netsh winsock reset
        
        # Etapa 3: Limpar cache DNS
        Write-Host "Etapa 3: Limpando cache DNS..." -ForegroundColor DarkGray
        ipconfig /flushdns
        
        # Etapa 4: Renovar configura√ß√µes DHCP
        Write-Host "Etapa 4: Renovando configura√ß√µes DHCP..." -ForegroundColor DarkGray
        ipconfig /release
        ipconfig /renew
        
        # Etapa 5: Reiniciar adaptadores de rede
        Write-Host "Etapa 5: Reiniciando adaptadores de rede..." -ForegroundColor DarkGray
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        
        Write-Host "Reset de configura√ß√µes de rede conclu√≠do!" -ForegroundColor Green
        Write-Host "Recomenda-se reiniciar o computador para aplicar todas as altera√ß√µes." -ForegroundColor Yellow
        
        $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (s/n)"
        if ($confirmRestart -eq 's') {
            Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
            Restart-Computer -Force
        } else {
            Write-Host "Rein√≠cio cancelado. Algumas altera√ß√µes podem n√£o ter efeito at√© que o computador seja reiniciado." -ForegroundColor Yellow
        }
    } else {
        Write-Host "Reset de configura√ß√µes de rede cancelado." -ForegroundColor Green
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-OptimizeTcpIp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Otimizar Configura√ß√µes TCP/IP ---" -ForegroundColor Green
    Write-Host "Ajusta configura√ß√µes avan√ßadas do TCP/IP para melhorar o desempenho da conex√£o." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o otimiza v√°rios par√¢metros TCP/IP para melhorar a velocidade e estabilidade da conex√£o." -ForegroundColor White
    Write-Host "As otimiza√ß√µes s√£o seguras e podem ser revertidas se necess√°rio." -ForegroundColor White
    Write-Host ""
    
    Write-Host "Configura√ß√µes atuais:" -ForegroundColor Yellow
    
    # Mostrar configura√ß√µes atuais
    Write-Host "Auto-Tuning Level:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Auto-Tuning Level"
    
    Write-Host "Congestion Provider:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Congestion Control Provider"
    
    Write-Host "ECN Capability:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "ECN Capability"
    
    Write-Host "Receive-Side Scaling (RSS):" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Receive-Side Scaling State"
    
    Write-Host ""
    $confirm = Read-Host "Deseja aplicar otimiza√ß√µes TCP/IP recomendadas? (s/n)"
    
    if ($confirm -eq 's') {
        Write-Host "Aplicando otimiza√ß√µes TCP/IP..." -ForegroundColor Yellow
        
        # Otimiza√ß√£o 1: Habilitar TCP Window Auto-Tuning
        Write-Host "Configurando TCP Auto-Tuning para 'normal'..." -ForegroundColor DarkGray
        netsh int tcp set global### Enhanced TORK Optimizer

I'll enhance the TORK optimizer with more comprehensive functionality across all features, starting with an expanded Simple Cleanup function and then improving all other options.

```powershell type="code"
# Define a preferencia de acao para erros (continua a execucao por padrao)
# Permite que o script tente rodar o m√°ximo poss√≠vel mesmo que alguns comandos encontrem problemas.
$ErrorActionPreference = 'SilentlyContinue' # N√£o exibe erros se um item n√£o puder ser processado, por exemplo.

# --- Funcao pra Centralizar Texto (Nosso Maestro de Alinhamento - s√≥ pra textos, n√£o pro bannerz√£o!) ---
# Deixa ela aqui, vai que a gente usa pra centralizar outra coisa, n√©?
function Centraliza($texto, $cor="White") {
    $largura = [console]::WindowWidth # Pega a largura da largura da janela agora
    # Calcula o espa√ßo pra botar o texto no meio. Pura matem√°tica da zoeira!
    $espacos = [Math]::Max(0, [Math]::Floor(($largura - $texto.Length) / 2))
    $linha = (" " * $espacos) + $texto # Cria a linha com os espa√ßos e o texto
    Write-Host $linha -ForegroundColor $cor # Manda pro console com a cor pedida
}

# --- Funcao que Desenha o Nosso Banner Irado do TORK! ---
# Esse √© o nosso outdoor digital no console! Ajustado pros espa√ßos que voc√™ mandou!
# Se as bordas ainda estiverem meio teimosas, √© o jeitinho do console mesmo, viu? üòâ
function Banner-TORK {
    # Nossas cores vibrantes para o banner!
    $CorBorda = "DarkCyan" # Mantido para a borda, combina com o ciano. Se quiser mudar, √© aqui!
    $CorLogo = "Green" # Cor vibrante
    $CorProjeto = "Cyan" # Cor vibrante
    $CorCopyright = "Gray" # Tom mais suave

    Write-Host "" # D√° um espacinho no topo, pra n√£o grudar
    Write-Host "                    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë          ‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë ‚ñà‚ñà‚ïî‚ïù                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ñà‚ñà‚ïó                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù                                          ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë           Bem-vindo ao TORK - Otimizador para Windows!                                ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë        Projeto de automacao, limpeza, manutencao e tweaks.                            ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë            (C) Partner77 - Todos os direitos reservados                               ‚ïë" -ForegroundColor $CorCopyright
    Write-Host "                    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor $CorBorda
    Write-Host "" # Espa√ßo embaixo
}

# --- Checagem de Permiss√µes de Administrador (O Guarda da Porta!) ---
# V√™ se a gente t√° rodando com poderes de admin, sen√£o n√£o d√° pra mexer no Windows direito.
function Test-Administrator {
    $currentUser = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())
    return $currentUser.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
}

if (-not (Test-Administrator)) {
    Write-Host "OPA! Calma l√°, patr√£o!" -ForegroundColor Red
    Write-Host "Pra usar o TORK e deixar o PC voando, preciso de super poderes de Administrador!" -ForegroundColor Yellow
    Write-Host "Fecha essa janela, clica com o bot√£o direito no arquivo do script e escolhe 'Executar como administrador'. A√≠ sim, tamo junto!" -ForegroundColor Yellow
    Read-Host "D√° um Enter quando terminar de ler, que a gente se v√™ na pr√≥xima..."
    Exit
}

Write-Host "Poderes de Administrador verificados! Bora nessa!" -ForegroundColor Green
Start-Sleep -Seconds 1

# --- Fun√ß√µes Utilit√°rias (Ferramentas que usamos em v√°rios lugares) ---
function Get-SystemInfo {
    $os = Get-CimInstance Win32_OperatingSystem
    $cs = Get-CimInstance Win32_ComputerSystem
    $proc = Get-CimInstance Win32_Processor
    $mem = Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property Capacity -Sum
    
    $info = @{
        "OSName" = $os.Caption
        "OSVersion" = $os.Version
        "OSBuild" = $os.BuildNumber
        "ComputerName" = $cs.Name
        "Manufacturer" = $cs.Manufacturer
        "Model" = $cs.Model
        "Processor" = $proc.Name
        "Memory" = [math]::Round($mem.Sum / 1GB, 2)
        "Architecture" = $os.OSArchitecture
        "InstallDate" = $os.InstallDate
        "LastBootTime" = $os.LastBootUpTime
    }
    
    return $info
}

function Show-SystemSummary {
    $sysInfo = Get-SystemInfo
    
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Computador: $($sysInfo.ComputerName)" -ForegroundColor White
    Write-Host "Fabricante: $($sysInfo.Manufacturer)" -ForegroundColor White
    Write-Host "Modelo: $($sysInfo.Model)" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "Instalado em: $($sysInfo.InstallDate)" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

function Get-DiskSpaceBefore {
    $drives = Get-PSDrive -PSProvider FileSystem
    $driveInfo = @{}
    
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        
        $driveInfo[$drive.Name] = @{
            "Free" = $freeSpace
            "Used" = $usedSpace
            "Total" = $totalSpace
        }
    }
    
    return $driveInfo
}

function Show-DiskSpaceComparison {
    param (
        $before
    )
    
    $after = Get-PSDrive -PSProvider FileSystem
    
    Write-Host "=== Compara√ß√£o de Espa√ßo em Disco ===" -ForegroundColor Cyan
    
    foreach ($drive in $after) {
        if ($before.ContainsKey($drive.Name)) {
            $freeSpaceAfter = [math]::Round($drive.Free / 1GB, 2)
            $freeSpaceBefore = $before[$drive.Name].Free
            $spaceRecovered = [math]::Round($freeSpaceAfter - $freeSpaceBefore, 2)
            
            Write-Host "Drive $($drive.Name):" -ForegroundColor White
            Write-Host "  Espa√ßo livre antes: $freeSpaceBefore GB" -ForegroundColor Gray
            Write-Host "  Espa√ßo livre agora: $freeSpaceAfter GB" -ForegroundColor Gray
            
            if ($spaceRecovered -gt 0) {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Green
            } else {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Yellow
            }
            Write-Host ""
        }
    }
    
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

# --- Fun√ß√µes dos Menus (Principal, Simplificado, Avan√ßado e Sub-menus) ---

# --- Menu Principal (A Bifurca√ß√£o do Destino! Simplificado vs Avan√ßado) ---
# √â aqui que o usu√°rio escolhe se quer ser um mago ou um cara pr√°tico!
function Show-MainMenu {
    do {
        Clear-Host # Limpa a tela pra organizar o menu
        Banner-TORK # Banner no topo, pra gente n√£o esquecer quem somos!
        Show-SystemSummary # Mostra um resumo do sistema

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "       MENU PRINCIPAL" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # As duas grandes estradas da otimiza√ß√£o! Cores variadas (repetindo)!
        Write-Host "[1] Otimiza√ß√£o Simplificada (Pra quem quer praticidade e resultado r√°pido!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o Avan√ßada (Pra quem curte mexer fundo e ter control total!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[3] Diagn√≥stico R√°pido do Sistema (Ver o que t√° rolando no PC)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[4] Sobre o TORK (Informa√ß√µes e cr√©ditos)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[0] Sair (Ah, que pena... Mas a porta t√° aberta!)" -ForegroundColor Red # Vermelho pra Sair - Ok

        Write-Host ""

        # Pergunta pro usu√°rio qual caminho ele escolhe, tipo Mestre Pok√©mon!
        $choice = Read-Host "Escolhe sua op√ß√£o, treinador!"

        # V√™ pra onde a gente vai com base na escolha
        switch ($choice) {
            "1" { Show-SimplifiedMenu } # Se escolheu 1, vai pro Menu Simplificado!
            "2" { Show-AdvancedMenu } # Se escolheu 2, vai pro Menu Avan√ßado!
            "3" { Invoke-QuickDiagnostic } # Nova fun√ß√£o de diagn√≥stico r√°pido
            "4" { Show-AboutTORK } # Nova fun√ß√£o de sobre
            "0" { Write-Host "Fechou! Valeu por usar o TORK! Volte sempre que seu PC pedir um g√°s! ;)" -ForegroundColor Green; Start-Sleep -Seconds 2; break } # Se escolheu 0, vaza (mas volta!)
            default {
                Write-Host "Eita! Op√ß√£o inv√°lida! Confere os n√∫meros e tenta de novo, bora l√°!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1 # D√° um tempinho pro usu√°rio ver a zoeira da mensagem
            }
        }
    } while ($choice -ne '0') # Repete o Menu Principal enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Simplificado (Aqui o TORK faz m√°gica r√°pida e segura!) ---
# Acessado pela op√ß√£o 1 do Menu Principal. Menos op√ß√µes, mais a√ß√£o direta!
function Show-SimplifiedMenu {
    do {
        Clear-Host # Limpa o palco pra esse menu!
        Banner-TORK # Nosso banner no topo, sempre presente!

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "   OTIMIZACAO SIMPLIFICADA" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes SIMPLIFICADAS - cada uma pode fazer um monte de coisa por baixo dos panos! Cores variadas (repetindo as prim√°rias/neon e adicionando outras)!
        Write-Host "[1] Limpeza Geral do Sistema (Tira o lixo que t√° pesando!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o de Mem√≥ria e Programas que Ligam com o Windows (Deixa tudo mais √°gil!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[3] Acelerar a Conex√£o com a Internet (Pra navegar sem gargalo!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[4] Deixar o Windows mais Leve Visualmente (Desativa uns efeitos pra ganhar desempenho!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Otimiza√ß√£o de Jogos (Configura√ß√µes pra melhorar FPS e desempenho)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[6] Manuten√ß√£o de Seguran√ßa (Verificar e corrigir problemas de seguran√ßa)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[7] RODAR TODAS as otimiza√ß√µes SIMPLIFICADAS! (Modo Turbo F√°cil!)" -ForegroundColor Red # Vermelho pra "Faz Tudo" - Destaque/Cuidado
        Write-Host "[0] Voltar ao Menu Principal (A gente te espera aqui!)" -ForegroundColor Gray # Cor neutra pra voltar

        Write-Host ""

        # Pergunta qual m√°gica simplificada o usu√°rio quer
        $choice = Read-Host "Escolhe sua m√°gica simplificada!"

        # V√™ qual m√°gica rodar
        switch ($choice) {
            "1" { Invoke-SimpleSystemCleanup } # Chama a fun√ß√£o de limpeza b√°sica
            "2" { Invoke-SimpleMemoryStartup } # Chama a fun√ß√£o pra mem√≥ria/inicializa√ß√£o
            "3" { Invoke-SimpleInternetOpt } # Chama a fun√ß√£o pra internet
            "4" { Invoke-SimpleVisualOpt } # Chama a fun√ß√£o pra visual
            "5" { Invoke-SimpleGamingOpt } # Nova fun√ß√£o para otimiza√ß√£o de jogos
            "6" { Invoke-SimpleSecurityMaintenance } # Nova fun√ß√£o para manuten√ß√£o de seguran√ßa
            "7" {
                # Rodar todas as simplificadas sequencialmente
                Write-Host "`nModo Turbo F√°cil ATIVADO! Rodando todas as otimiza√ß√µes SIMPLIFICADAS... segura pe√£o!`n" -ForegroundColor Yellow
                Invoke-SimpleSystemCleanup # Roda a 1
                Invoke-SimpleMemoryStartup # Roda a 2
                Invoke-SimpleInternetOpt # Roda a 3
                Invoke-SimpleVisualOpt # Roda a 4
                Invoke-SimpleGamingOpt # Roda a 5
                Invoke-SimpleSecurityMaintenance # Roda a 6
                Write-Host "`nShow! Todas as otimiza√ß√µes SIMPLIFICADAS foram executadas! PC t√° agradecendo! ;)`n" -ForegroundColor Green
                Read-Host "Aperta Enter pra voltar pro Menu Simplificado..." # Pausa no final do "Rodar Todas"
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-MainMenu
            default {
                Write-Host "Ops! Op√ß√£o inv√°lida no Menu Simplificado! Confere os n√∫meros e manda bala de novo!" -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Simplificado enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Avan√ßado (O Playground dos Magos do PC!) ---
# Acessado pela op√ß√£o 2 do Menu Principal. Aqui a gente mergulha fundo!
function Show-AdvancedMenu {
    do {
        Clear-Host # Limpa o palco pro menu avan√ßado!
        Banner-TORK # Nosso banner no topo, pra n√£o perder a pose!

        Write-Host "" # Espacinho maroto
        Write-Host "===============================" -ForegroundColor White
        Write-Host "      MENU AVANCADO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes do menu avan√ßado (as CATEGORIAS dos 200 poderes!) Cores variadas (repetindo)!
        Write-Host "[1] Limpeza e Manuten√ß√£o de Arquivos (Tirar a poeira digital!)" -ForegroundColor Cyan # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[2] Otimiza√ß√µes de Desempenho do Sistema (Deixar o motor roncando!)" -ForegroundColor Green # Cor variada
        Write-Host "[3] Configura√ß√µes e Otimiza√ß√µes de Rede (Pra internet voar baixo!)" -ForegroundColor Yellow # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[4] Gerenciamento e Otimiza√ß√£o de Servi√ßos do Windows (O que t√° rodando e n√£o precisa?!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Ferramentas de Diagn√≥stico e Verifica√ß√£o (Pra ver se t√° tudo nos conformes!)" -ForegroundColor Cyan # Cor repetida
        Write-Host "[6] Desabilitar/Gerenciar Recursos do Windows (Tirar o peso extra do sistema!)" -ForegroundColor Green # Cor repetida
        Write-Host "[7] Gerenciamento de Arquivos e Pastas Avan√ßado (Comandos ninja pra arquivos!)" -ForegroundColor Yellow # Cor repetida
        Write-Host "[8] Gerenciamento de Contas de Usu√°rio (Organizar a galera que usa o PC!)" -ForegroundColor White # Cor repetida
        Write-Host "[9] Otimiza√ß√£o para Jogos Avan√ßada (Tweaks pra gamers de verdade!)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Configura√ß√µes de Privacidade (Controle o que o Windows sabe sobre voc√™)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[11] Outras Configura√ß√µes e Tweaks Diversos (Aqueles ajustes secretos!)" -ForegroundColor Gray # Cor neutra/escura
        Write-Host "[0] Voltar ao Menu Principal (Pronto pra voltar pra estrada principal!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta pro mago qual categoria ele quer explorar
        $choice = Read-Host "Escolhe sua √°rea de magia, mago!"

        # V√™ pra onde a gente navega dentro do mundo avan√ßado
        switch ($choice) {
            "1" { Show-LimpezaManutencaoMenu } # CHAMA O SUB-MENU DE LIMPEZA
            "2" { Show-DesempenhoMenu } # Agora √© um sub-menu tamb√©m
            "3" { Show-ConfiguracoesRedeMenu } # CHAMA O SUB-MENU DE REDE
            "4" { Show-ServicosMenu } # Agora √© um sub-menu tamb√©m
            "5" { Show-DiagnosticoMenu } # Agora √© um sub-menu tamb√©m
            "6" { Show-RecursosMenu } # Agora √© um sub-menu tamb√©m
            "7" { Show-ArquivosPastasMenu } # Agora √© um sub-menu tamb√©m
            "8" { Show-UsuariosMenu } # Agora √© um sub-menu tamb√©m
            "9" { Show-JogosAvancadoMenu } # Novo sub-menu para jogos
            "10" { Show-PrivacidadeMenu } # Novo sub-menu para privacidade
            "11" { Show-OutrosMenu } # Agora √© um sub-menu tamb√©m
            "0" { break } # Sai do loop deste menu, voltando pro Menu Principal
            default {
                Write-Host "Humm, essa √°rea da magia ainda n√£o existe ou voc√™ digitou errado! Tenta de novo, mago!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Avan√ßado enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Limpeza e Manuten√ß√£o (Dentro do Avan√ßado!) ---
# Este menu lista as op√ß√µes ESPEC√çFICAS da categoria Limpeza no Menu Avan√ßado
function Show-LimpezaManutencaoMenu {
    do {
        Clear-Host # Limpa o palco pra este sub-menu!
        Banner-TORK # Banner no topo, sempre!

        Write-Host "" # Espacinho
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: LIMPEZA E MANUT." -ForegroundColor White # T√≠tulo menor pro sub-menu
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes ESPEC√çFICAS da categoria Limpeza. Cores variadas (repetindo cores)!
        Write-Host "[1] Limpar Arquivos Tempor√°rios do Usu√°rio (Tipo a pasta Temp!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[2] Limpar Arquivos Tempor√°rios do Sistema (Os tempor√°rios do Windows!)" -ForegroundColor Gray # Cor neutra (substitui DarkCyan)
        Write-Host "[3] Limpar Cache de DNS (Pra resolver nomes de site mais r√°pido!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[4] Esvaziar Lixeira (Adeus, arquivos deletados!)" -ForegroundColor Gray # Cor neutra (repetindo)
        Write-Host "[5] Limpar Cache de Miniaturas (Aqueles previews de imagem/v√≠deo!)" -ForegroundColor Green # Cor variada
        Write-Host "[6] Limpar Logs do Sistema (Arquivos de registro que acumulam)" -ForegroundColor Cyan # Nova op√ß√£o
        Write-Host "[7] Limpar Cache de Atualiza√ß√µes do Windows (Liberar espa√ßo de updates)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[8] Limpar Arquivos de Hiberna√ß√£o (Liberar o hiberfil.sys)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[9] Limpar Arquivos WinSxS (Pasta que ocupa muito espa√ßo)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Executar TODAS as limpezas acima (Faxina completa!)" -ForegroundColor Red # Nova op√ß√£o
        Write-Host "[0] Voltar ao Menu Avan√ßado (De volta pras categorias!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta qual limpeza espec√≠fica o mago quer fazer
        $choice = Read-Host "Escolhe a limpeza avan√ßada, mestre!"

        # V√™ qual fun√ß√£o de limpeza espec√≠fica chamar
        switch ($choice) {
            "1" { Invoke-CleanUserTemp } # Chama a fun√ß√£o pra Limpar Temp Usu√°rio
            "2" { Invoke-CleanSystemTemp } # Chama a fun√ß√£o pra Limpar Temp Sistema
            "3" { Invoke-CleanDnsCache } # Chama a fun√ß√£o pra Limpar Cache DNS
            "4" { Invoke-EmptyRecycleBin } # Chama a fun√ß√£o pra Esvaziar Lixeira
            "5" { Invoke-CleanThumbnailCache } # Chama a fun√ß√£o pra Limpar Cache de Miniaturas
            "6" { Invoke-CleanSystemLogs } # Nova fun√ß√£o para limpar logs do sistema
            "7" { Invoke-CleanWindowsUpdateCache } # Nova fun√ß√£o para limpar cache de updates
            "8" { Invoke-CleanHibernationFile } # Nova fun√ß√£o para limpar arquivo de hiberna√ß√£o
            "9" { Invoke-CleanWinSxS } # Nova fun√ß√£o para limpar pasta WinSxS
            "10" { 
                # Executa todas as limpezas em sequ√™ncia
                Write-Host "`nIniciando faxina completa do sistema! Isso pode demorar um pouco...`n" -ForegroundColor Yellow
                $diskSpaceBefore = Get-DiskSpaceBefore
                
                Invoke-CleanUserTemp
                Invoke-CleanSystemTemp
                Invoke-CleanDnsCache
                Invoke-EmptyRecycleBin
                Invoke-CleanThumbnailCache
                Invoke-CleanSystemLogs
                Invoke-CleanWindowsUpdateCache
                Invoke-CleanHibernationFile
                Invoke-CleanWinSxS
                
                Write-Host "`nFaxina completa finalizada! Veja quanto espa√ßo foi recuperado:`n" -ForegroundColor Green
                Show-DiskSpaceComparison -before $diskSpaceBefore
                Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-AdvancedMenu
            default {
                Write-Host "Essa tarefa de limpeza ainda n√£o t√° na lista! V√™ os n√∫meros e tenta de novo!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Sub-Menu Limpeza enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Desempenho (Dentro do Avan√ßado!) ---
function Show-DesempenhoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DESEMPENHO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Ajustar Efeitos Visuais para Melhor Desempenho" -ForegroundColor Green
        Write-Host "[2] Otimizar Disco do Sistema" -ForegroundColor Cyan
        Write-Host "[3] Limpar Arquivos Prefetch" -ForegroundColor Yellow
        Write-Host "[4] Definir Plano de Energia para Alto Desempenho" -ForegroundColor White
        Write-Host "[5] Otimizar Servi√ßo SuperFetch/SysMain" -ForegroundColor Magenta
        Write-Host "[6] Ajustar Tamanho da Mem√≥ria Virtual" -ForegroundColor Gray
        Write-Host "[7] Desativar Indexa√ß√£o de Arquivos" -ForegroundColor Green
        Write-Host "[8] Otimizar Inicializa√ß√£o do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de desempenho" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o de desempenho"

        switch ($choice) {
            "1" { Invoke-OptimizeVisualEffects }
            "2" { Invoke-OptimizeDisk }
            "3" { Invoke-CleanPrefetch }
            "4" { Invoke-SetHighPerformancePower }
            "5" { Invoke-OptimizeSuperFetch }
            "6" { Invoke-AdjustVirtualMemory }
            "7" { Invoke-DisableIndexing }
            "8" { Invoke-OptimizeStartup }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de desempenho...`n" -ForegroundColor Yellow
                Invoke-OptimizeVisualEffects
                Invoke-OptimizeDisk
                Invoke-CleanPrefetch
                Invoke-SetHighPerformancePower
                Invoke-OptimizeSuperFetch
                Invoke-AdjustVirtualMemory
                Invoke-DisableIndexing
                Invoke-OptimizeStartup
                Write-Host "`nTodas as otimiza√ß√µes de desempenho foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Configura√ß√µes de Rede (Dentro do Avan√ßado!) ---
function Show-ConfiguracoesRedeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: CONFIG. REDE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Limpar Cache de DNS" -ForegroundColor Yellow
        Write-Host "[2] Mudar Servidor DNS" -ForegroundColor Cyan
        Write-Host "[3] Resetar Configura√ß√µes de Rede" -ForegroundColor White
        Write-Host "[4] Otimizar Configura√ß√µes TCP/IP" -ForegroundColor Green
        Write-Host "[5] Verificar Velocidade da Conex√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar QoS (Qualidade de Servi√ßo)" -ForegroundColor Gray
        Write-Host "[7] Desativar IPv6 (Se n√£o estiver usando)" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Lat√™ncia de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de rede" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√£o de rede"

        switch ($choice) {
            "1" { Invoke-NetworkFlushDns }
            "2" { Invoke-NetworkChangeDns }
            "3" { Invoke-NetworkReset }
            "4" { Invoke-OptimizeTcpIp }
            "5" { Invoke-CheckNetworkSpeed }
            "6" { Invoke-ConfigureQoS }
            "7" { Invoke-DisableIPv6 }
            "8" { Invoke-OptimizeGamingLatency }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de rede...`n" -ForegroundColor Yellow
                Invoke-NetworkFlushDns
                Invoke-OptimizeTcpIp
                Invoke-CheckNetworkSpeed
                Invoke-ConfigureQoS
                Invoke-DisableIPv6
                Invoke-OptimizeGamingLatency
                Write-Host "`nTodas as otimiza√ß√µes de rede foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Rede..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Servi√ßos (Dentro do Avan√ßado!) ---
function Show-ServicosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: SERVICOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desabilitar Servi√ßo SuperFetch/SysMain" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Servi√ßo de Impress√£o" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Servi√ßo Windows Update" -ForegroundColor White
        Write-Host "[4] Listar Todos os Servi√ßos em Execu√ß√£o" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Otimizar Servi√ßos para Desempenho Geral" -ForegroundColor Gray
        Write-Host "[7] Restaurar Servi√ßos para Configura√ß√£o Padr√£o" -ForegroundColor Yellow
        Write-Host "[8] Desabilitar Servi√ßos Desnecess√°rios" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de servi√ßos"

        switch ($choice) {
            "1" { Invoke-ManageSuperFetch }
            "2" { Invoke-ManagePrintService }
            "3" { Invoke-ManageWindowsUpdate }
            "4" { Invoke-ListRunningServices }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-OptimizeServicesForPerformance }
            "7" { Invoke-RestoreDefaultServices }
            "8" { Invoke-DisableUnnecessaryServices }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Diagn√≥stico (Dentro do Avan√ßado!) ---
function Show-DiagnosticoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DIAGNOSTICO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Verificar Arquivos do Sistema (SFC)" -ForegroundColor Yellow
        Write-Host "[2] Reparar Imagem do Windows (DISM)" -ForegroundColor Cyan
        Write-Host "[3] Verificar Disco por Erros (CHKDSK)" -ForegroundColor White
        Write-Host "[4] Verificar Sa√∫de do Disco" -ForegroundColor Green
        Write-Host "[5] Verificar Drivers Desatualizados" -ForegroundColor Magenta
        Write-Host "[6] Verificar Problemas de Inicializa√ß√£o" -ForegroundColor Gray
        Write-Host "[7] Verificar Problemas de Mem√≥ria RAM" -ForegroundColor Yellow
        Write-Host "[8] Verificar Temperatura do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODOS os diagn√≥sticos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de diagn√≥stico"

        switch ($choice) {
            "1" { Invoke-SfcScan }
            "2" { Invoke-DismRepair }
            "3" { Invoke-ChkDsk }
            "4" { Invoke-CheckDiskHealth }
            "5" { Invoke-CheckDrivers }
            "6" { Invoke-CheckStartupIssues }
            "7" { Invoke-CheckMemory }
            "8" { Invoke-CheckTemperature }
            "9" {
                Write-Host "`nExecutando todos os diagn√≥sticos...`n" -ForegroundColor Yellow
                Invoke-SfcScan
                Invoke-DismRepair
                Invoke-CheckDiskHealth
                Invoke-CheckDrivers
                Invoke-CheckStartupIssues
                Invoke-CheckTemperature
                Write-Host "`nTodos os diagn√≥sticos foram conclu√≠dos!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Diagn√≥stico..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Recursos (Dentro do Avan√ßado!) ---
function Show-RecursosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: RECURSOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Gerenciar Hiberna√ß√£o" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Planos de Energia" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Recursos Opcionais do Windows" -ForegroundColor White
        Write-Host "[4] Gerenciar Mem√≥ria Virtual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Windows Defender" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Recursos de Telemetria" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Recursos de Inicializa√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Recursos de Seguran√ßa" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de recursos"

        switch ($choice) {
            "1" { Invoke-ManageHibernation }
            "2" { Invoke-ManagePowerPlans }
            "3" { Invoke-ManageOptionalFeatures }
            "4" { Invoke-ManageVirtualMemory }
            "5" { Invoke-ManageWindowsDefender }
            "6" { Invoke-ManageTelemetry }
            "7" { Invoke-ManageStartupResources }
            "8" { Invoke-ManageSecurityFeatures }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Arquivos e Pastas (Dentro do Avan√ßado!) ---
function Show-ArquivosPastasMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: ARQUIVOS E PASTAS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Encontrar Arquivos Grandes" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Arquivos" -ForegroundColor Cyan
        Write-Host "[3] Tomar Posse de Arquivos (TakeOwn)" -ForegroundColor White
        Write-Host "[4] Listar Conte√∫do de Pastas Espec√≠ficas" -ForegroundColor Green
        Write-Host "[5] Compactar Pastas para Economizar Espa√ßo" -ForegroundColor Magenta
        Write-Host "[6] Verificar Integridade de Arquivos" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Arquivos Ocultos e do Sistema" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Atributos de Arquivos" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de arquivos e pastas"

        switch ($choice) {
            "1" { Invoke-FindLargeFiles }
            "2" { Invoke-ManageFilePermissions }
            "3" { Invoke-TakeOwnership }
            "4" { Invoke-ListFolderContents }
            "5" { Invoke-CompressFolders }
            "6" { Invoke-VerifyFileIntegrity }
            "7" { Invoke-ManageHiddenSystemFiles }
            "8" { Invoke-ManageFileAttributes }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Usu√°rios (Dentro do Avan√ßado!) ---
function Show-UsuariosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: USUARIOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Listar Todos os Usu√°rios Locais" -ForegroundColor Yellow
        Write-Host "[2] Listar Todos os Grupos Locais" -ForegroundColor Cyan
        Write-Host "[3] Listar Membros de Grupos Espec√≠ficos" -ForegroundColor White
        Write-Host "[4] Mostrar Propriedades do Usu√°rio Atual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Contas de Usu√°rio" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Pol√≠ticas de Senha" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Permiss√µes de Usu√°rio" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar UAC (Controle de Conta de Usu√°rio)" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de usu√°rios"

        switch ($choice) {
            "1" { Invoke-ListLocalUsers }
            "2" { Invoke-ListLocalGroups }
            "3" { Invoke-ListGroupMembers }
            "4" { Invoke-ShowCurrentUserProperties }
            "5" { Invoke-ManageUserAccounts }
            "6" { Invoke-ManagePasswordPolicies }
            "7" { Invoke-ManageUserPermissions }
            "8" { Invoke-ManageUAC }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Jogos Avan√ßado (Dentro do Avan√ßado!) ---
function Show-JogosAvancadoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: JOGOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Otimizar Prioridade de CPU para Jogos" -ForegroundColor Yellow
        Write-Host "[2] Otimizar Configura√ß√µes de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[3] Otimizar Configura√ß√µes de GPU" -ForegroundColor White
        Write-Host "[4] Desativar Game DVR e Game Bar" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Configurar Modo de Jogo do Windows" -ForegroundColor Gray
        Write-Host "[7] Otimizar Configura√ß√µes de √Åudio para Jogos" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Configura√ß√µes de Input Lag" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes para jogos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o para jogos"

        switch ($choice) {
            "1" { Invoke-OptimizeCpuPriority }
            "2" { Invoke-OptimizeNetworkForGaming }
            "3" { Invoke-OptimizeGpuSettings }
            "4" { Invoke-DisableGameDvrBar }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-ConfigureGameMode }
            "7" { Invoke-OptimizeAudioForGaming }
            "8" { Invoke-OptimizeInputLag }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes para jogos...`n" -ForegroundColor Yellow
                Invoke-OptimizeCpuPriority
                Invoke-OptimizeNetworkForGaming
                Invoke-OptimizeGpuSettings
                Invoke-DisableGameDvrBar
                Invoke-OptimizeServicesForGaming
                Invoke-ConfigureGameMode
                Invoke-OptimizeAudioForGaming
                Invoke-OptimizeInputLag
                Write-Host "`nTodas as otimiza√ß√µes para jogos foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Jogos..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Privacidade (Dentro do Avan√ßado!) ---
function Show-PrivacidadeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: PRIVACIDADE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desativar Telemetria do Windows" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Aplicativos" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Hist√≥rico de Atividades" -ForegroundColor White
        Write-Host "[4] Gerenciar Diagn√≥stico e Feedback" -ForegroundColor Green
        Write-Host "[5] Gerenciar An√∫ncios Personalizados" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Localiza√ß√£o e Sensores" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Reconhecimento de Voz e Digita√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Sincroniza√ß√£o com a Microsoft" -ForegroundColor Cyan
        Write-Host "[9] Aplicar TODAS as configura√ß√µes de privacidade" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de privacidade"

        switch ($choice) {
            "1" { Invoke-DisableTelemetry }
            "2" { Invoke-ManageAppPermissions }
            "3" { Invoke-ManageActivityHistory }
            "4" { Invoke-ManageDiagnosticsFeedback }
            "5" { Invoke-ManagePersonalizedAds }
            "6" { Invoke-ManageLocationSensors }
            "7" { Invoke-ManageVoiceTyping }
            "8" { Invoke-ManageMicrosoftSync }
            "9" {
                Write-Host "`nAplicando todas as configura√ß√µes de privacidade...`n" -ForegroundColor Yellow
                Invoke-DisableTelemetry
                Invoke-ManageAppPermissions
                Invoke-ManageActivityHistory
                Invoke-ManageDiagnosticsFeedback
                Invoke-ManagePersonalizedAds
                Invoke-ManageLocationSensors
                Invoke-ManageVoiceTyping
                Invoke-ManageMicrosoftSync
                Write-Host "`nTodas as configura√ß√µes de privacidade foram aplicadas!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Privacidade..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Outros (Dentro do Avan√ßado!) ---
function Show-OutrosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: OUTROS TWEAKS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Mostrar Informa√ß√µes Detalhadas do Sistema" -ForegroundColor Yellow
        Write-Host "[2] Mostrar Configura√ß√£o Completa de Rede" -ForegroundColor Cyan
        Write-Host "[3] Reiniciar Explorer.exe" -ForegroundColor White
        Write-Host "[4] Limpar Cache de Atualiza√ß√µes do Windows" -ForegroundColor Green
        Write-Host "[5] Gerenciar Programas de Inicializa√ß√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar Op√ß√µes de Energia Avan√ßadas" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Configura√ß√µes de Armazenamento" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Configura√ß√µes de Notifica√ß√µes" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√µes diversas"

        switch ($choice) {
            "1" { Invoke-ShowDetailedSystemInfo }
            "2" { Invoke-ShowDetailedNetworkConfig }
            "3" { Invoke-RestartExplorer }
            "4" { Invoke-CleanWindowsUpdateCache }
            "5" { Invoke-ManageStartupPrograms }
            "6" { Invoke-ConfigureAdvancedPowerOptions }
            "7" { Invoke-ManageStorageSettings }
            "8" { Invoke-ManageNotificationSettings }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- Fun√ß√µes para as Secoes SIMPLIFICADAS (Expandidas) ---
function Invoke-SimpleSystemCleanup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza Geral do Sistema: Hora de varrer o lixo digital! ---" -ForegroundColor Green
    Write-Host "Essa op√ß√£o vai te ajudar a liberar espa√ßo e dar um f√¥lego pro PC tirando arquivos tempor√°rios, lixo da lixeira, etc. √â tipo faxina no computador!" -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Comando 1: Limpar Arquivos Tempor√°rios do Usu√°rio
    Write-Host "Bora come√ßar limpando os arquivos tempor√°rios do seu usu√°rio! Eles acumulam que √© uma beleza!" -ForegroundColor Yellow
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio limpos! Menos peso pro PC respirar! ;)" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Esvaziar a Lixeira
    Write-Host "Agora, vamos dar um fim definitivo naqueles arquivos na Lixeira. Eles s√≥ est√£o ocupando espa√ßo √† toa!" -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada! Espa√ßo recuperado com sucesso! R√°!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios do Windows
    Write-Host "Vamos limpar tamb√©m os tempor√°rios do pr√≥prio Windows. √Äs vezes, fica lixo escondido por l√°!" -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Limpar Cache de Navegadores Comuns
    Write-Host "Bora dar uma geral nos caches dos navegadores tamb√©m! Eles guardam um monte de coisa que pode pesar!" -ForegroundColor Yellow
    
    # Chrome
    Write-Host "Tentando limpar cache do Google Chrome..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Chrome limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Edge
    Write-Host "Tentando limpar cache do Microsoft Edge..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Edge limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Firefox
    Write-Host "Tentando limpar cache do Mozilla Firefox..." -ForegroundColor DarkGray
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\cache2\entries\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\startupCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\thumbnails\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Firefox limpo (pode n√£o ser completo, dependendo do perfil/uso)." -ForegroundColor DarkGray

    # Brave (se instalado)
    Write-Host "Tentando limpar cache do Brave Browser (se instalado)..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Brave limpo (se instalado e n√£o estiver rodando)." -ForegroundColor DarkGray

    Write-Host "Limpeza de caches de navegador conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Comando 5: Limpar Cache de Miniaturas
    Write-Host "Limpando cache de miniaturas do Windows (aquelas pr√©-visualiza√ß√µes de imagens e v√≠deos)..." -ForegroundColor Yellow
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Write-Host "Cache de miniaturas limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Limpar Arquivos de Log do Windows
    Write-Host "Limpando arquivos de log do Windows que podem ocupar espa√ßo..." -ForegroundColor Yellow
    wevtutil cl Application
    wevtutil cl System
    wevtutil cl Security
    Write-Host "Logs do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 7: Limpar Arquivos Tempor√°rios de Instala√ß√£o
    Write-Host "Limpando arquivos tempor√°rios de instala√ß√£o de programas..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Installer\$*\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios de instala√ß√£o limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 8: Limpar Arquivos de Atualiza√ß√£o do Windows
    Write-Host "Limpando arquivos de atualiza√ß√£o do Windows que podem ocupar bastante espa√ßo..." -ForegroundColor Yellow
    Stop-Service -Name wuauserv -ErrorAction SilentlyContinue
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    Write-Host "Arquivos de atualiza√ß√£o do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 9: Limpar Arquivos Prefetch
    Write-Host "Limpando arquivos prefetch para melhorar a inicializa√ß√£o..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Prefetch\*.pf" -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos prefetch limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 10: Executar Limpeza de Disco Integrada do Windows
    Write-Host "Executando a ferramenta de limpeza de disco integrada do Windows..." -ForegroundColor Yellow
    Start-Process -FilePath cleanmgr.exe -ArgumentList "/sagerun:1" -Wait -ErrorAction SilentlyContinue
    Write-Host "Limpeza de disco conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "Vamos ver quanto espa√ßo conseguimos recuperar com essa faxina:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nPronto! A faxina geral b√°sica foi feita! Seu PC agradece o espa√ßo extra! ;)" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu
    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleMemoryStartup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Mem√≥ria e Inicializa√ß√£o R√°pida: Deixa o PC ligando num piscar! ---" -ForegroundColor Yellow
    Write-Host "Aqui a gente d√° uma olhada na mem√≥ria RAM e nos programas que ligam junto com o Windows. Menos coisa ligando √† toa = PC mais r√°pido pra usar na hora!" -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Listar Programas de Inicializa√ß√£o
    Write-Host "Listando programas que iniciam com o Windows (pra voc√™ saber o que t√° rodando por baixo dos panos):" -ForegroundColor Yellow
    Get-CimInstance win32_startupcommand | Select-Object Name, command, Location | Format-Table -AutoSize
    Write-Host "Lista de programas de inicializa√ß√£o exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Servi√ßo SuperFetch/SysMain
    Write-Host "Otimizando o servi√ßo SuperFetch/SysMain para melhorar o desempenho..." -ForegroundColor Yellow
    $confirmSysMain = Read-Host "Deseja desativar o servi√ßo SysMain/SuperFetch? (s/n) - Recomendado para SSDs"
    if ($confirmSysMain -eq 's') {
        Set-Service -Name SysMain -StartupType Disabled -ErrorAction SilentlyContinue
        Stop-Service -Name SysMain -Force -ErrorAction SilentlyContinue
        Write-Host "Servi√ßo SysMain/SuperFetch desativado!" -ForegroundColor Green
    } else {
        Write-Host "Servi√ßo SysMain/SuperFetch mantido ativo." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios de Updates
    Write-Host "Limpando arquivos tempor√°rios de atualiza√ß√µes do Windows (podem ocupar bastante espa√ßo e afetar performance):" -ForegroundColor Yellow
    Dism /online /Cleanup-Image /StartComponentCleanup /ErrorAction SilentlyContinue
    Write-Host "Limpeza de componentes de atualiza√ß√£o iniciada (pode levar um tempo)." -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Mem√≥ria Virtual
    Write-Host "Otimizando configura√ß√µes de mem√≥ria virtual para melhor desempenho..." -ForegroundColor Yellow
    $totalRam = (Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property capacity -Sum).Sum / 1GB
    Write-Host "Seu sistema tem aproximadamente $totalRam GB de RAM." -ForegroundColor White
    
    $confirmPageFile = Read-Host "Deseja otimizar o arquivo de pagina√ß√£o (mem√≥ria virtual)? (s/n)"
    if ($confirmPageFile -eq 's') {
        # Calcula tamanho recomendado (1.5x a RAM para sistemas com menos de 8GB, 1x para sistemas com mais)
        $pageFileSize = if ($totalRam -lt 8) { [math]::Round($totalRam * 1.5) * 1024 } else { [math]::Round($totalRam) * 1024 }
        
        Write-Host "Configurando arquivo de pagina√ß√£o para tamanho fixo de $pageFileSize MB..." -ForegroundColor DarkGray
        $computerSystem = Get-WmiObject -Class Win32_ComputerSystem
        $computerSystem.AutomaticManagedPagefile = $false
        $computerSystem.Put() | Out-Null
        
        $pageFileSetting = Get-WmiObject -Class Win32_PageFileSetting
        if ($pageFileSetting) {
            $pageFileSetting.InitialSize = $pageFileSize
            $pageFileSetting.MaximumSize = $pageFileSize
            $pageFileSetting.Put() | Out-Null
        }
        Write-Host "Arquivo de pagina√ß√£o otimizado! (Requer reinicializa√ß√£o para aplicar totalmente)" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes de mem√≥ria virtual mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Listar os 10 Processos que mais usam mem√≥ria no momento
    Write-Host "Listando os 10 processos que mais consomem mem√≥ria agora:" -ForegroundColor Yellow
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host "Lista de processos exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Otimizar Inicializa√ß√£o do Windows
    Write-Host "Otimizando a inicializa√ß√£o do Windows..." -ForegroundColor Yellow
    # Desabilitar servi√ßos n√£o essenciais que podem atrasar a inicializa√ß√£o
    $startupServices = @(
        @{Name="DiagTrack"; DisplayName="Experi√™ncias do Usu√°rio Conectado e Telemetria"},
        @{Name="dmwappushservice"; DisplayName="Servi√ßo de Transfer√™ncia Inteligente em Segundo Plano (BITS)"},
        @{Name="MapsBroker"; DisplayName="Servi√ßo de Dados de Mapas"}
    )
    
    foreach ($service in $startupServices) {
        $confirmService = Read-Host "Deseja desativar o servi√ßo '$($service.DisplayName)' na inicializa√ß√£o? (s/n)"
        if ($confirmService -eq 's') {
            Set-Service -Name $service.Name -StartupType Disabled -ErrorAction SilentlyContinue
            Stop-Service -Name $service.Name -Force -ErrorAction SilentlyContinue
            Write-Host "Servi√ßo '$($service.DisplayName)' desativado!" -ForegroundColor Green
        } else {
            Write-Host "Servi√ßo '$($service.DisplayName)' mantido." -ForegroundColor Green
        }
    }
    Write-Host ""

    # Comando 7: Reiniciar o Computador (√ötil pra liberar mem√≥ria e aplicar mudan√ßas)
    Write-Host "Quer dar um 'refresh' geral no PC? Reiniciar pode ajudar!" -ForegroundColor Yellow
    $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (digite 'sim' para confirmar)"
    if ($confirmRestart -eq 'sim') {
        Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
        Restart-Computer -Force
    } else {
        Write-Host "Rein√≠cio cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o de mem√≥ria e inicializa√ß√£o!" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu (a n√£o ser que o PC tenha reiniciado)
    if ($confirmRestart -ne 'sim') {
        Write-Host ""
        Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
    }
}

function Invoke-SimpleInternetOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Acelerar a Conex√£o com a Internet (Simplificado): Diz adeus pro 'carregando...'! ---" -ForegroundColor Cyan
    Write-Host "Vamos fazer uns ajustes r√°pidos na sua conex√£o pra tentar deixar ela mais esperta." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Limpar Cache de DNS
    Write-Host "Limpando o cache de endere√ßos de internet (DNS) pra resolver nomes mais r√°pido!" -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Configura√ß√µes TCP/IP
    Write-Host "Otimizando configura√ß√µes TCP/IP para melhorar a velocidade de conex√£o..." -ForegroundColor Yellow
    
    # Habilitar TCP Window Auto-Tuning
    netsh int tcp set global autotuninglevel=normal
    Write-Host "TCP Auto-Tuning configurado para 'normal'." -ForegroundColor DarkGray
    
    # Otimizar par√¢metros de recebimento de pacotes
    netsh int tcp set global rss=enabled
    Write-Host "Receive-Side Scaling (RSS) habilitado." -ForegroundColor DarkGray
    
    # Otimizar congestion provider
    netsh int tcp set global congestionprovider=ctcp
    Write-Host "Congestion Provider configurado para 'ctcp'." -ForegroundColor DarkGray
    
    # Otimizar ECN capability
    netsh int tcp set global ecncapability=enabled
    Write-Host "ECN Capability habilitado." -ForegroundColor DarkGray
    
    Write-Host "Configura√ß√µes TCP/IP otimizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Reiniciar Adaptadores de Rede
    Write-Host "Dando um 'reset' r√°pido nas suas conex√µes de rede. Pode resolver uns pepinos!" -ForegroundColor Yellow
    $confirmResetAdapter = Read-Host "Isso vai desconectar brevemente sua internet. Continuar? (s/n)"
    if ($confirmResetAdapter -eq 's') {
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        Write-Host "Adaptadores de rede reiniciados." -ForegroundColor Green
    } else {
        Write-Host "Reset de adaptadores cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 4: Configurar DNS R√°pido
    Write-Host "Configurar DNS mais r√°pido pode melhorar sua navega√ß√£o!" -ForegroundColor Yellow
    $confirmDns = Read-Host "Deseja configurar DNS mais r√°pidos (Google ou Cloudflare)? (s/n)"
    if ($confirmDns -eq 's') {
        Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
        Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
        $dnsChoice = Read-Host "Escolha uma op√ß√£o (1 ou 2)"
        
        $primaryDns = ""
        $secondaryDns = ""
        
        if ($dnsChoice -eq '1') {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            Write-Host "Google DNS selecionado." -ForegroundColor DarkGray
        } elseif ($dnsChoice -eq '2') {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            Write-Host "Cloudflare DNS selecionado." -ForegroundColor DarkGray
        } else {
            Write-Host "Op√ß√£o inv√°lida. DNS n√£o alterado." -ForegroundColor Red
        }
        
        if ($primaryDns -ne "") {
            $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" -and ($_.InterfaceDescription -match "Ethernet" -or $_.InterfaceDescription -match "Wi-Fi" -or $_.InterfaceDescription -match "Wireless") }
            
            foreach ($adapter in $networkAdapters) {
                Write-Host "Configurando DNS para adaptador: $($adapter.Name)" -ForegroundColor DarkGray
                Set-DnsClientServerAddress -InterfaceIndex $adapter.ifIndex -ServerAddresses ($primaryDns, $secondaryDns)
            }
            
            Write-Host "DNS configurado! Sua navega√ß√£o deve ficar mais r√°pida agora." -ForegroundColor Green
        }
    } else {
        Write-Host "Configura√ß√£o de DNS mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Mostrar Status B√°sico da Conex√£o
    Write-Host "Mostrando um resumo b√°sico da sua configura√ß√£o de rede atual:" -ForegroundColor Yellow
    ipconfig /all | Select-String -Pattern "IPv4", "DNS", "Gateway", "DHCP", "Subnet", "Physical Address"
    Write-Host "Status b√°sico da rede exibido." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Testar a conex√£o com a internet
    Write-Host "Testando a conex√£o com a internet (ping para google.com)..." -ForegroundColor Yellow
    Test-Connection -Count 4 google.com -ErrorAction SilentlyContinue
    Write-Host "Teste de conex√£o finalizado." -ForegroundColor Green
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o b√°sica de internet!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleVisualOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Deixar o Windows mais Leve Visualmente (Simplificado): Desempenho antes da beleza! ---" -ForegroundColor White
    Write-Host "Ajustes r√°pidos pra desativar efeitos visuais que podem pesar, liberando recursos pro que importa." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ajustar Efeitos Visuais
    Write-Host "Voc√™ quer desativar ou ativar as anima√ß√µes e efeitos visuais do Windows?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Efeitos Visuais (Pra ganhar desempenho)" -ForegroundColor Green
    Write-Host "[2] Configurar para Melhor Apar√™ncia (Mais bonito, mas mais pesado)" -ForegroundColor White
    Write-Host "[3] Deixar o Windows Escolher (Configura√ß√£o padr√£o)" -ForegroundColor Cyan
    $choiceVisual = Read-Host "Escolha [1], [2] ou [3]"

    if ($choiceVisual -eq '1') {
        Write-Host "Desativando efeitos visuais para melhor desempenho..." -ForegroundColor Yellow
        # Valor 2 = Ajustar para melhor desempenho (desativa a maioria dos efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 2 -Type DWord -Force -ErrorAction SilentlyContinue
        
        # Desativar anima√ß√µes individuais
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop' -Name 'UserPreferencesMask' -Value ([byte[]](0x90, 0x12, 0x01, 0x80)) -Type Binary -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop\WindowMetrics' -Name 'MinAnimate' -Value 0 -Type String -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'ListviewAlphaSelect' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'TaskbarAnimations' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        
        Write-Host "Efeitos visuais desativados para melhor desempenho!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '2') {
        Write-Host "Configurando para melhor apar√™ncia (todos os efeitos visuais ativados)..." -ForegroundColor Yellow
        # Valor 1 = Ajustar para melhor apar√™ncia (ativa todos os efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Efeitos visuais configurados para melhor apar√™ncia!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '3') {
        Write-Host "Deixando o Windows escolher automaticamente (configura√ß√£o padr√£o)..." -ForegroundColor Yellow
        # Valor 0 = Deixar o Windows escolher
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Configura√ß√£o visual definida para padr√£o do Windows!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa nos efeitos visuais foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 2: Ativar/Desativar Efeitos de Transpar√™ncia
    Write-Host "E os efeitos de transpar√™ncia do Windows (tipo na barra de tarefas)?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Transpar√™ncia (Mais leve)" -ForegroundColor Green
    Write-Host "[2] Ativar Transpar√™ncia (Mais 'bonito')" -ForegroundColor White
    $choiceTransp = Read-Host "Escolha [1] ou [2]"

    if ($choiceTransp -eq '1') {
        Write-Host "Desativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 0 = Desativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia desativada!" -ForegroundColor Green
    } elseif ($choiceTransp -eq '2') {
        Write-Host "Ativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 1 = Ativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia ativada!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa na transpar√™ncia foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 3: Configurar Tema Claro/Escuro
    Write-Host "Voc√™ prefere tema claro ou escuro? O tema escuro pode ser mais confort√°vel para os olhos." -ForegroundColor Yellow
    Write-Host "[1] Tema Escuro (Dark Mode)" -ForegroundColor DarkGray
    Write-Host "[2] Tema Claro (Light Mode)" -ForegroundColor White
    $choiceTheme = Read-Host "Escolha [1] ou [2]"

    if ($choiceTheme -eq '1') {
        Write-Host "Configurando tema escuro..." -ForegroundColor Yellow
        # Valor 0 = Tema Escuro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema escuro configurado!" -ForegroundColor Green
    } elseif ($choiceTheme -eq '2') {
        Write-Host "Configurando tema claro..." -ForegroundColor Yellow
        # Valor 1 = Tema Claro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema claro configurado!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa no tema foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Configurar Resolu√ß√£o de Tela
    Write-Host "Deseja ajustar a resolu√ß√£o da tela? Resolu√ß√µes menores podem melhorar o desempenho em PCs mais antigos." -ForegroundColor Yellow
    $confirmResolution = Read-Host "Deseja ver e ajustar a resolu√ß√£o da tela? (s/n)"
    
    if ($confirmResolution -eq 's') {
        # Mostrar resolu√ß√£o atual
        $currentResolution = Get-WmiObject -Class Win32_VideoController | Select-Object -ExpandProperty VideoModeDescription
        Write-Host "Resolu√ß√£o atual: $currentResolution" -ForegroundColor White
        
        # Abrir configura√ß√µes de exibi√ß√£o do Windows
        Write-Host "Abrindo configura√ß√µes de exibi√ß√£o do Windows..." -ForegroundColor DarkGray
        Start-Process "ms-settings:display"
        Write-Host "Ajuste a resolu√ß√£o conforme necess√°rio na janela de configura√ß√µes que foi aberta." -ForegroundColor Green
        
        $waitForSettings = Read-Host "Pressione Enter quando terminar de ajustar as configura√ß√µes de exibi√ß√£o"
    } else {
        Write-Host "Configura√ß√£o de resolu√ß√£o mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizados os ajustes visuais b√°sicos!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleGamingOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Jogos (Simplificado): Mais FPS, menos lag! ---" -ForegroundColor Magenta
    Write-Host "Vamos fazer alguns ajustes para melhorar o desempenho dos seus jogos sem complica√ß√µes." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ativar Modo de Jogo do Windows
    Write-Host "Ativando o Modo de Jogo do Windows para priorizar recursos para jogos..." -ForegroundColor Yellow
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AllowAutoGameMode" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AutoGameModeEnabled" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Write-Host "Modo de Jogo do Windows ativado!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Desativar Game DVR e Game Bar
    Write-Host "O Game DVR e Game Bar podem reduzir o desempenho em jogos. Deseja desativ√°-los?" -ForegroundColor Yellow
    $confirmGameDVR = Read-Host "Desativar Game DVR e Game Bar? (s/n)"
    
    if ($confirmGameDVR -eq 's') {
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "UseNexusForGameBarEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\System\GameConfigStore" -Name "GameDVR_Enabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR" -Name "AppCaptureEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Write-Host "Game DVR e Game Bar desativados!" -ForegroundColor Green
    } else {
        Write-Host "Game DVR e Game Bar mantidos ativos." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Otimizar Plano de Energia para Jogos
    Write-Host "Configurando plano de energia para alto desempenho (ideal para jogos)..." -ForegroundColor Yellow
    powercfg.exe /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c
    Write-Host "Plano de energia configurado para alto desempenho!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Configura√ß√µes de Mouse
    Write-Host "Otimizando configura√ß√µes de mouse para jogos (precis√£o do ponteiro)..." -ForegroundColor Yellow
    $confirmMouseFix = Read-Host "Desativar a acelera√ß√£o do mouse para melhor precis√£o em jogos? (s/n)"
    
    if ($confirmMouseFix -eq 's') {
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseSpeed" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold1" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold2" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Write-Host "Acelera√ß√£o do mouse desativada para melhor precis√£o em jogos!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do mouse mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Otimizar Prioridade de CPU para Jogos
    Write-Host "Configurando prioridade de CPU para jogos..." -ForegroundColor Yellow
    Write-Host "Esta configura√ß√£o ajusta o sistema para dar mais prioridade aos jogos." -ForegroundColor DarkGray
    
    # Criar chave de registro para prioridade de jogos
    if (-not (Test-Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games")) {
        New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Force | Out-Null
    }
    
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "GPU Priority" -Type DWord -Value 8 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Priority" -Type DWord -Value 6 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Scheduling Category" -Type String -Value "High" -Force -ErrorAction SilentlyContinue
    
    Write-Host "Prioridade de CPU para jogos otimizada!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Verificar Driver de Placa de V√≠deo
    Write-Host "Verificando informa√ß√µes da placa de v√≠deo..." -ForegroundColor Yellow
    $gpuInfo = Get-WmiObject -Class Win32_VideoController | Select-Object Name, DriverVersion, CurrentHorizontalResolution, CurrentVerticalResolution
    
    foreach ($gpu in $gpuInfo) {
        Write-Host "Placa de v√≠deo: $($gpu.Name)" -ForegroundColor White
        Write-Host "Vers√£o do driver: $($gpu.DriverVersion)" -ForegroundColor White
        Write-Host "Resolu√ß√£o atual: $($gpu.CurrentHorizontalResolution) x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
      x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
    
    Write-Host "Recomenda√ß√£o: Mantenha seus drivers de v√≠deo atualizados para melhor desempenho em jogos!" -ForegroundColor Green
    Write-Host "Voc√™ pode baixar os drivers mais recentes nos sites oficiais da NVIDIA, AMD ou Intel." -ForegroundColor DarkGray
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nOtimiza√ß√µes para jogos conclu√≠das! Seus jogos devem rodar mais suaves agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleSecurityMaintenance {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Manuten√ß√£o de Seguran√ßa (Simplificado): Mantenha seu PC protegido! ---" -ForegroundColor DarkYellow
    Write-Host "Vamos verificar e melhorar a seguran√ßa do seu sistema com alguns ajustes simples." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Verificar Status do Windows Defender
    Write-Host "Verificando status do Windows Defender..." -ForegroundColor Yellow
    $defenderStatus = Get-MpComputerStatus
    
    Write-Host "Status do Windows Defender:" -ForegroundColor White
    Write-Host "Antiv√≠rus habilitado: $($defenderStatus.AntivirusEnabled)" -ForegroundColor $(if ($defenderStatus.AntivirusEnabled) { "Green" } else { "Red" })
    Write-Host "Prote√ß√£o em tempo real: $($defenderStatus.RealTimeProtectionEnabled)" -ForegroundColor $(if ($defenderStatus.RealTimeProtectionEnabled) { "Green" } else { "Red" })
    Write-Host "Defini√ß√µes de antiv√≠rus: $($defenderStatus.AntivirusSignatureVersion)" -ForegroundColor White
    Write-Host "√öltima atualiza√ß√£o: $($defenderStatus.AntivirusSignatureLastUpdated)" -ForegroundColor White
    Write-Host ""

    # Comando 2: Atualizar Defini√ß√µes do Windows Defender
    Write-Host "Atualizando defini√ß√µes do Windows Defender..." -ForegroundColor Yellow
    Update-MpSignature -ErrorAction SilentlyContinue
    Write-Host "Defini√ß√µes do Windows Defender atualizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Verificar Atualiza√ß√µes do Windows
    Write-Host "Verificando status das atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
            Write-Host "Recomenda√ß√£o: Execute o Windows Update para manter seu sistema seguro." -ForegroundColor Green
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Verificar Configura√ß√µes de Firewall
    Write-Host "Verificando status do Firewall do Windows..." -ForegroundColor Yellow
    $firewallStatus = Get-NetFirewallProfile
    
    foreach ($profile in $firewallStatus) {
        Write-Host "Perfil: $($profile.Name)" -ForegroundColor White
        Write-Host "Status: $($profile.Enabled)" -ForegroundColor $(if ($profile.Enabled) { "Green" } else { "Red" })
        Write-Host ""
    }
    
    $confirmFirewall = Read-Host "Deseja habilitar o Firewall em todos os perfis? (s/n)"
    if ($confirmFirewall -eq 's') {
        Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True
        Write-Host "Firewall habilitado em todos os perfis!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do Firewall mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Verificar Configura√ß√µes de UAC
    Write-Host "Verificando configura√ß√µes do Controle de Conta de Usu√°rio (UAC)..." -ForegroundColor Yellow
    $uacLevel = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -ErrorAction SilentlyContinue
    
    if ($uacLevel) {
        switch ($uacLevel.ConsentPromptBehaviorAdmin) {
            0 { $uacStatus = "Desativado (N√£o recomendado)" }
            1 { $uacStatus = "Baixo (N√£o recomendado)" }
            2 { $uacStatus = "M√©dio" }
            5 { $uacStatus = "Alto (Recomendado)" }
            default { $uacStatus = "Personalizado" }
        }
        
        Write-Host "N√≠vel atual do UAC: $uacStatus" -ForegroundColor $(if ($uacLevel.ConsentPromptBehaviorAdmin -ge 2) { "Green" } else { "Red" })
        
        $confirmUAC = Read-Host "Deseja configurar o UAC para o n√≠vel recomendado? (s/n)"
        if ($confirmUAC -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -Value 5 -Type DWord -Force -ErrorAction SilentlyContinue
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "PromptOnSecureDesktop" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
            Write-Host "UAC configurado para o n√≠vel recomendado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do UAC mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do UAC." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 6: Verificar Configura√ß√µes de SmartScreen
    Write-Host "Verificando configura√ß√µes do Windows SmartScreen..." -ForegroundColor Yellow
    $smartScreen = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -ErrorAction SilentlyContinue
    
    if ($smartScreen) {
        Write-Host "Status do SmartScreen: $($smartScreen.SmartScreenEnabled)" -ForegroundColor $(if ($smartScreen.SmartScreenEnabled -eq "RequireAdmin" -or $smartScreen.SmartScreenEnabled -eq "Warn") { "Green" } else { "Red" })
        
        $confirmSmartScreen = Read-Host "Deseja habilitar o SmartScreen para maior seguran√ßa? (s/n)"
        if ($confirmSmartScreen -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -Value "RequireAdmin" -Type String -Force -ErrorAction SilentlyContinue
            Write-Host "SmartScreen habilitado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do SmartScreen mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do SmartScreen." -ForegroundColor Red
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nManuten√ß√£o de seguran√ßa conclu√≠da! Seu sistema est√° mais protegido agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

# --- Fun√ß√µes para o Diagn√≥stico R√°pido e Sobre ---
function Invoke-QuickDiagnostic {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Diagn√≥stico R√°pido do Sistema ---" -ForegroundColor Yellow
    Write-Host "Vamos fazer uma verifica√ß√£o r√°pida do estado atual do seu PC." -ForegroundColor Gray
    Write-Host ""

    # Informa√ß√µes do Sistema
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    $sysInfo = Get-SystemInfo
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host ""

    # Uso de CPU
    Write-Host "=== Uso de CPU ===" -ForegroundColor Cyan
    $cpuLoad = (Get-WmiObject Win32_Processor).LoadPercentage
    Write-Host "Uso atual de CPU: $cpuLoad%" -ForegroundColor $(if ($cpuLoad -lt 70) { "Green" } elseif ($cpuLoad -lt 90) { "Yellow" } else { "Red" })
    Write-Host ""

    # Uso de Mem√≥ria
    Write-Host "=== Uso de Mem√≥ria ===" -ForegroundColor Cyan
    $os = Get-WmiObject Win32_OperatingSystem
    $totalMemory = [math]::Round($os.TotalVisibleMemorySize / 1MB, 2)
    $freeMemory = [math]::Round($os.FreePhysicalMemory / 1MB, 2)
    $usedMemory = [math]::Round($totalMemory - $freeMemory, 2)
    $memoryPercentage = [math]::Round(($usedMemory / $totalMemory) * 100, 2)
    
    Write-Host "Mem√≥ria Total: $totalMemory GB" -ForegroundColor White
    Write-Host "Mem√≥ria Usada: $usedMemory GB ($memoryPercentage%)" -ForegroundColor $(if ($memoryPercentage -lt 70) { "Green" } elseif ($memoryPercentage -lt 90) { "Yellow" } else { "Red" })
    Write-Host "Mem√≥ria Livre: $freeMemory GB" -ForegroundColor White
    Write-Host ""

    # Espa√ßo em Disco
    Write-Host "=== Espa√ßo em Disco ===" -ForegroundColor Cyan
    $drives = Get-PSDrive -PSProvider FileSystem
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        $percentFree = [math]::Round(($freeSpace / $totalSpace) * 100, 2)
        
        Write-Host "Drive $($drive.Name):" -ForegroundColor White
        Write-Host "  Total: $totalSpace GB" -ForegroundColor White
        Write-Host "  Usado: $usedSpace GB" -ForegroundColor White
        Write-Host "  Livre: $freeSpace GB ($percentFree%)" -ForegroundColor $(if ($percentFree -gt 20) { "Green" } elseif ($percentFree -gt 10) { "Yellow" } else { "Red" })
    }
    Write-Host ""

    # Processos que mais consomem recursos
    Write-Host "=== Top 5 Processos (CPU) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object CPU -Descending | Select-Object -First 5 ProcessName, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}}, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host ""

    Write-Host "=== Top 5 Processos (Mem√≥ria) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 5 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}}, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}} | Format-Table -AutoSize
    Write-Host ""

    # Status de Servi√ßos Cr√≠ticos
    Write-Host "=== Status de Servi√ßos Cr√≠ticos ===" -ForegroundColor Cyan
    $criticalServices = @("wuauserv", "WinDefend", "MpsSvc", "wscsvc")
    foreach ($service in $criticalServices) {
        $serviceStatus = Get-Service -Name $service -ErrorAction SilentlyContinue
        if ($serviceStatus) {
            Write-Host "$($serviceStatus.DisplayName): $($serviceStatus.Status)" -ForegroundColor $(if ($serviceStatus.Status -eq "Running") { "Green" } else { "Red" })
        }
    }
    Write-Host ""

    # Verificar Atualiza√ß√µes Pendentes
    Write-Host "=== Atualiza√ß√µes do Windows ===" -ForegroundColor Cyan
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Recomenda√ß√µes
    Write-Host "=== Recomenda√ß√µes ===" -ForegroundColor Cyan
    
    # Recomenda√ß√£o de Mem√≥ria
    if ($memoryPercentage -gt 80) {
        Write-Host "- Seu uso de mem√≥ria est√° alto. Considere fechar alguns programas ou usar a op√ß√£o 'Otimiza√ß√£o de Mem√≥ria'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Disco
    $lowDiskSpace = $false
    foreach ($drive in $drives) {
        $percentFree = [math]::Round(($drive.Free / ($drive.Free + $drive.Used)) * 100, 2)
        if ($percentFree -lt 15) {
            $lowDiskSpace = $true
            break
        }
    }
    
    if ($lowDiskSpace) {
        Write-Host "- Espa√ßo em disco baixo detectado. Considere usar a op√ß√£o 'Limpeza Geral do Sistema'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Atualiza√ß√µes
    if ($pendingUpdates -gt 0) {
        Write-Host "- Existem atualiza√ß√µes pendentes. Recomendamos atualizar seu sistema para maior seguran√ßa." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Inicializa√ß√£o
    $bootTime = $sysInfo.LastBootTime
    $uptime = (Get-Date) - $bootTime
    if ($uptime.Days -gt 7) {
        Write-Host "- Seu sistema est√° ligado h√° $($uptime.Days) dias. Considere reiniciar para aplicar atualiza√ß√µes e limpar a mem√≥ria." -ForegroundColor Yellow
    }
    
    Write-Host ""

    # Mensagem de conclus√£o
    Write-Host "`nDiagn√≥stico r√°pido conclu√≠do! Use as informa√ß√µes acima para decidir quais otimiza√ß√µes fazer." -ForegroundColor Green

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

function Show-AboutTORK {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Sobre o TORK ---" -ForegroundColor White
    Write-Host ""
    
    Write-Host "TORK - Otimizador para Windows" -ForegroundColor Cyan
    Write-Host "Vers√£o: 2.0" -ForegroundColor White
    Write-Host "Desenvolvido por: Partner77" -ForegroundColor White
    Write-Host ""
    
    Write-Host "=== Descri√ß√£o ===" -ForegroundColor Yellow
    Write-Host "O TORK √© uma ferramenta abrangente de otimiza√ß√£o para Windows, projetada para" -ForegroundColor Gray
    Write-Host "melhorar o desempenho do seu sistema atrav√©s de limpeza, ajustes e otimiza√ß√µes." -ForegroundColor Gray
    Write-Host "Ele oferece op√ß√µes simplificadas para usu√°rios comuns e op√ß√µes avan√ßadas para" -ForegroundColor Gray
    Write-Host "usu√°rios experientes que desejam um controle mais detalhado sobre o sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Recursos ===" -ForegroundColor Yellow
    Write-Host "- Limpeza completa do sistema" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√£o de mem√≥ria e inicializa√ß√£o" -ForegroundColor Gray
    Write-Host "- Ajustes de rede para melhor conectividade" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√µes visuais para melhor desempenho" -ForegroundColor Gray
    Write-Host "- Configura√ß√µes espec√≠ficas para jogos" -ForegroundColor Gray
    Write-Host "- Manuten√ß√£o de seguran√ßa" -ForegroundColor Gray
    Write-Host "- Diagn√≥stico r√°pido do sistema" -ForegroundColor Gray
    Write-Host "- Mais de 100 ajustes e otimiza√ß√µes avan√ßadas" -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Aviso Legal ===" -ForegroundColor Yellow
    Write-Host "Este software √© fornecido 'como est√°', sem garantias de qualquer tipo." -ForegroundColor Gray
    Write-Host "O autor n√£o se responsabiliza por quaisquer danos ou problemas causados pelo uso" -ForegroundColor Gray
    Write-Host "deste software. Use por sua conta e risco. Recomendamos sempre fazer backup" -ForegroundColor Gray
    Write-Host "dos seus dados importantes antes de realizar otimiza√ß√µes no sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Agradecimentos ===" -ForegroundColor Yellow
    Write-Host "Obrigado por escolher o TORK para otimizar seu sistema Windows!" -ForegroundColor Gray
    Write-Host "Esperamos que esta ferramenta ajude a melhorar o desempenho do seu PC." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "¬© 2023-2024 Partner77 - Todos os direitos reservados" -ForegroundColor Cyan
    Write-Host ""
    
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - LIMPEZA (Expandidas) ---
function Invoke-CleanUserTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Usu√°rio ---" -ForegroundColor Cyan
    Write-Host "Remove arquivos da pasta tempor√°ria do seu usu√°rio (`$env:TEMP`)." -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:TEMP..." -ForegroundColor Yellow
    $tempFiles = Get-ChildItem -Path $env:TEMP -Recurse -ErrorAction SilentlyContinue
    $tempFilesCount = ($tempFiles | Measure-Object).Count
    $tempFilesSize = ($tempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $tempFilesCount arquivos tempor√°rios ocupando aproximadamente $([math]::Round($tempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Sistema ---" -ForegroundColor Gray
    Write-Host "Remove arquivos da pasta tempor√°ria do Windows (`$env:SystemRoot\Temp`)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:SystemRoot\Temp..." -ForegroundColor Yellow
    $systemTempFiles = Get-ChildItem -Path "$env:SystemRoot\Temp" -Recurse -ErrorAction SilentlyContinue
    $systemTempFilesCount = ($systemTempFiles | Measure-Object).Count
    $systemTempFilesSize = ($systemTempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $systemTempFilesCount arquivos tempor√°rios do sistema ocupando aproximadamente $([math]::Round($systemTempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do sistema removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanDnsCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-EmptyRecycleBin {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Esvaziar Lixeira ---" -ForegroundColor Gray
    Write-Host "Esvazia a lixeira do usu√°rio logado." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar tamanho da lixeira antes de esvaziar
    Write-Host "Verificando tamanho da lixeira..." -ForegroundColor Yellow
    
    try {
        $shell = New-Object -ComObject Shell.Application
        $recycleBin = $shell.Namespace(0xA)
        $recycleBinItems = $recycleBin.Items()
        $recycleBinItemCount = $recycleBinItems.Count
        
        Write-Host "A lixeira cont√©m $recycleBinItemCount itens." -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o conte√∫do da lixeira." -ForegroundColor DarkGray
    }
    
    # Esvaziar a lixeira
    Write-Host "Executando: Esvaziando a lixeira..." -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanThumbnailCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Miniaturas ---" -ForegroundColor Green
    Write-Host "Remove o cache de miniaturas de arquivos (imagens, v√≠deos, etc.)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Limpando cache de miniaturas..." -ForegroundColor Yellow
    
    # Verificar tamanho do cache de miniaturas antes da limpeza
    $thumbnailPath = "$env:LOCALAPPDATA\Microsoft\Windows\Explorer"
    $thumbnailFiles = Get-ChildItem -Path $thumbnailPath -Filter "thumbcache_*.db" -ErrorAction SilentlyContinue
    $thumbnailFilesCount = ($thumbnailFiles | Measure-Object).Count
    $thumbnailFilesSize = ($thumbnailFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $thumbnailFilesCount arquivos de cache de miniaturas ocupando aproximadamente $([math]::Round($thumbnailFilesSize, 2)) MB." -ForegroundColor White
    
    # Limpar o cache de miniaturas
    Stop-Process -Name explorer -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Start-Process explorer
    
    Write-Host "Cache de miniaturas limpo com sucesso!" -ForegroundColor Green
    Write-Host "O Windows Explorer foi reiniciado para aplicar as altera√ß√µes." -ForegroundColor DarkGray
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de miniaturas:" -ForegroundColor Cyan
    Write-Host "- Navega√ß√£o mais r√°pida em pastas com muitas imagens ou v√≠deos" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de miniaturas corrompidas ou desatualizadas" -ForegroundColor DarkGray
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemLogs {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Logs do Sistema ---" -ForegroundColor Cyan
    Write-Host "Limpa os logs de eventos do sistema para liberar espa√ßo e melhorar o desempenho." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando logs do sistema..." -ForegroundColor Yellow
    
    # Verificar tamanho dos logs antes da limpeza
    $eventLogs = Get-WinEvent -ListLog * -ErrorAction SilentlyContinue | Where-Object { $_.RecordCount -gt 0 }
    $totalLogCount = ($eventLogs | Measure-Object).Count
    $total### Enhanced TORK Optimizer

I'll enhance the TORK optimizer with more comprehensive functionality across all features, starting with an expanded Simple Cleanup function and then improving all other options.

```powershell type="code"
# Define a preferencia de acao para erros (continua a execucao por padrao)
# Permite que o script tente rodar o m√°ximo poss√≠vel mesmo que alguns comandos encontrem problemas.
$ErrorActionPreference = 'SilentlyContinue' # N√£o exibe erros se um item n√£o puder ser processado, por exemplo.

# --- Funcao pra Centralizar Texto (Nosso Maestro de Alinhamento - s√≥ pra textos, n√£o pro bannerz√£o!) ---
# Deixa ela aqui, vai que a gente usa pra centralizar outra coisa, n√©?
function Centraliza($texto, $cor="White") {
    $largura = [console]::WindowWidth # Pega a largura da largura da janela agora
    # Calcula o espa√ßo pra botar o texto no meio. Pura matem√°tica da zoeira!
    $espacos = [Math]::Max(0, [Math]::Floor(($largura - $texto.Length) / 2))
    $linha = (" " * $espacos) + $texto # Cria a linha com os espa√ßos e o texto
    Write-Host $linha -ForegroundColor $cor # Manda pro console com a cor pedida
}

# --- Funcao que Desenha o Nosso Banner Irado do TORK! ---
# Esse √© o nosso outdoor digital no console! Ajustado pros espa√ßos que voc√™ mandou!
# Se as bordas ainda estiverem meio teimosas, √© o jeitinho do console mesmo, viu? üòâ
function Banner-TORK {
    # Nossas cores vibrantes para o banner!
    $CorBorda = "DarkCyan" # Mantido para a borda, combina com o ciano. Se quiser mudar, √© aqui!
    $CorLogo = "Green" # Cor vibrante
    $CorProjeto = "Cyan" # Cor vibrante
    $CorCopyright = "Gray" # Tom mais suave

    Write-Host "" # D√° um espacinho no topo, pra n√£o grudar
    Write-Host "                    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë          ‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë ‚ñà‚ñà‚ïî‚ïù                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ñà‚ñà‚ïó                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù                                          ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë           Bem-vindo ao TORK - Otimizador para Windows!                                ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë        Projeto de automacao, limpeza, manutencao e tweaks.                            ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë            (C) Partner77 - Todos os direitos reservados                               ‚ïë" -ForegroundColor $CorCopyright
    Write-Host "                    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor $CorBorda
    Write-Host "" # Espa√ßo embaixo
}

# --- Checagem de Permiss√µes de Administrador (O Guarda da Porta!) ---
# V√™ se a gente t√° rodando com poderes de admin, sen√£o n√£o d√° pra mexer no Windows direito.
function Test-Administrator {
    $currentUser = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())
    return $currentUser.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
}

if (-not (Test-Administrator)) {
    Write-Host "OPA! Calma l√°, patr√£o!" -ForegroundColor Red
    Write-Host "Pra usar o TORK e deixar o PC voando, preciso de super poderes de Administrador!" -ForegroundColor Yellow
    Write-Host "Fecha essa janela, clica com o bot√£o direito no arquivo do script e escolhe 'Executar como administrador'. A√≠ sim, tamo junto!" -ForegroundColor Yellow
    Read-Host "D√° um Enter quando terminar de ler, que a gente se v√™ na pr√≥xima..."
    Exit
}

Write-Host "Poderes de Administrador verificados! Bora nessa!" -ForegroundColor Green
Start-Sleep -Seconds 1

# --- Fun√ß√µes Utilit√°rias (Ferramentas que usamos em v√°rios lugares) ---
function Get-SystemInfo {
    $os = Get-CimInstance Win32_OperatingSystem
    $cs = Get-CimInstance Win32_ComputerSystem
    $proc = Get-CimInstance Win32_Processor
    $mem = Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property Capacity -Sum
    
    $info = @{
        "OSName" = $os.Caption
        "OSVersion" = $os.Version
        "OSBuild" = $os.BuildNumber
        "ComputerName" = $cs.Name
        "Manufacturer" = $cs.Manufacturer
        "Model" = $cs.Model
        "Processor" = $proc.Name
        "Memory" = [math]::Round($mem.Sum / 1GB, 2)
        "Architecture" = $os.OSArchitecture
        "InstallDate" = $os.InstallDate
        "LastBootTime" = $os.LastBootUpTime
    }
    
    return $info
}

function Show-SystemSummary {
    $sysInfo = Get-SystemInfo
    
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Computador: $($sysInfo.ComputerName)" -ForegroundColor White
    Write-Host "Fabricante: $($sysInfo.Manufacturer)" -ForegroundColor White
    Write-Host "Modelo: $($sysInfo.Model)" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "Instalado em: $($sysInfo.InstallDate)" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

function Get-DiskSpaceBefore {
    $drives = Get-PSDrive -PSProvider FileSystem
    $driveInfo = @{}
    
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        
        $driveInfo[$drive.Name] = @{
            "Free" = $freeSpace
            "Used" = $usedSpace
            "Total" = $totalSpace
        }
    }
    
    return $driveInfo
}

function Show-DiskSpaceComparison {
    param (
        $before
    )
    
    $after = Get-PSDrive -PSProvider FileSystem
    
    Write-Host "=== Compara√ß√£o de Espa√ßo em Disco ===" -ForegroundColor Cyan
    
    foreach ($drive in $after) {
        if ($before.ContainsKey($drive.Name)) {
            $freeSpaceAfter = [math]::Round($drive.Free / 1GB, 2)
            $freeSpaceBefore = $before[$drive.Name].Free
            $spaceRecovered = [math]::Round($freeSpaceAfter - $freeSpaceBefore, 2)
            
            Write-Host "Drive $($drive.Name):" -ForegroundColor White
            Write-Host "  Espa√ßo livre antes: $freeSpaceBefore GB" -ForegroundColor Gray
            Write-Host "  Espa√ßo livre agora: $freeSpaceAfter GB" -ForegroundColor Gray
            
            if ($spaceRecovered -gt 0) {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Green
            } else {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Yellow
            }
            Write-Host ""
        }
    }
    
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

# --- Fun√ß√µes dos Menus (Principal, Simplificado, Avan√ßado e Sub-menus) ---

# --- Menu Principal (A Bifurca√ß√£o do Destino! Simplificado vs Avan√ßado) ---
# √â aqui que o usu√°rio escolhe se quer ser um mago ou um cara pr√°tico!
function Show-MainMenu {
    do {
        Clear-Host # Limpa a tela pra organizar o menu
        Banner-TORK # Banner no topo, pra gente n√£o esquecer quem somos!
        Show-SystemSummary # Mostra um resumo do sistema

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "       MENU PRINCIPAL" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # As duas grandes estradas da otimiza√ß√£o! Cores variadas (repetindo)!
        Write-Host "[1] Otimiza√ß√£o Simplificada (Pra quem quer praticidade e resultado r√°pido!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o Avan√ßada (Pra quem curte mexer fundo e ter control total!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[3] Diagn√≥stico R√°pido do Sistema (Ver o que t√° rolando no PC)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[4] Sobre o TORK (Informa√ß√µes e cr√©ditos)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[0] Sair (Ah, que pena... Mas a porta t√° aberta!)" -ForegroundColor Red # Vermelho pra Sair - Ok

        Write-Host ""

        # Pergunta pro usu√°rio qual caminho ele escolhe, tipo Mestre Pok√©mon!
        $choice = Read-Host "Escolhe sua op√ß√£o, treinador!"

        # V√™ pra onde a gente vai com base na escolha
        switch ($choice) {
            "1" { Show-SimplifiedMenu } # Se escolheu 1, vai pro Menu Simplificado!
            "2" { Show-AdvancedMenu } # Se escolheu 2, vai pro Menu Avan√ßado!
            "3" { Invoke-QuickDiagnostic } # Nova fun√ß√£o de diagn√≥stico r√°pido
            "4" { Show-AboutTORK } # Nova fun√ß√£o de sobre
            "0" { Write-Host "Fechou! Valeu por usar o TORK! Volte sempre que seu PC pedir um g√°s! ;)" -ForegroundColor Green; Start-Sleep -Seconds 2; break } # Se escolheu 0, vaza (mas volta!)
            default {
                Write-Host "Eita! Op√ß√£o inv√°lida! Confere os n√∫meros e tenta de novo, bora l√°!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1 # D√° um tempinho pro usu√°rio ver a zoeira da mensagem
            }
        }
    } while ($choice -ne '0') # Repete o Menu Principal enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Simplificado (Aqui o TORK faz m√°gica r√°pida e segura!) ---
# Acessado pela op√ß√£o 1 do Menu Principal. Menos op√ß√µes, mais a√ß√£o direta!
function Show-SimplifiedMenu {
    do {
        Clear-Host # Limpa o palco pra esse menu!
        Banner-TORK # Nosso banner no topo, sempre presente!

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "   OTIMIZACAO SIMPLIFICADA" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes SIMPLIFICADAS - cada uma pode fazer um monte de coisa por baixo dos panos! Cores variadas (repetindo as prim√°rias/neon e adicionando outras)!
        Write-Host "[1] Limpeza Geral do Sistema (Tira o lixo que t√° pesando!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o de Mem√≥ria e Programas que Ligam com o Windows (Deixa tudo mais √°gil!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[3] Acelerar a Conex√£o com a Internet (Pra navegar sem gargalo!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[4] Deixar o Windows mais Leve Visualmente (Desativa uns efeitos pra ganhar desempenho!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Otimiza√ß√£o de Jogos (Configura√ß√µes pra melhorar FPS e desempenho)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[6] Manuten√ß√£o de Seguran√ßa (Verificar e corrigir problemas de seguran√ßa)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[7] RODAR TODAS as otimiza√ß√µes SIMPLIFICADAS! (Modo Turbo F√°cil!)" -ForegroundColor Red # Vermelho pra "Faz Tudo" - Destaque/Cuidado
        Write-Host "[0] Voltar ao Menu Principal (A gente te espera aqui!)" -ForegroundColor Gray # Cor neutra pra voltar

        Write-Host ""

        # Pergunta qual m√°gica simplificada o usu√°rio quer
        $choice = Read-Host "Escolhe sua m√°gica simplificada!"

        # V√™ qual m√°gica rodar
        switch ($choice) {
            "1" { Invoke-SimpleSystemCleanup } # Chama a fun√ß√£o de limpeza b√°sica
            "2" { Invoke-SimpleMemoryStartup } # Chama a fun√ß√£o pra mem√≥ria/inicializa√ß√£o
            "3" { Invoke-SimpleInternetOpt } # Chama a fun√ß√£o pra internet
            "4" { Invoke-SimpleVisualOpt } # Chama a fun√ß√£o pra visual
            "5" { Invoke-SimpleGamingOpt } # Nova fun√ß√£o para otimiza√ß√£o de jogos
            "6" { Invoke-SimpleSecurityMaintenance } # Nova fun√ß√£o para manuten√ß√£o de seguran√ßa
            "7" {
                # Rodar todas as simplificadas sequencialmente
                Write-Host "`nModo Turbo F√°cil ATIVADO! Rodando todas as otimiza√ß√µes SIMPLIFICADAS... segura pe√£o!`n" -ForegroundColor Yellow
                Invoke-SimpleSystemCleanup # Roda a 1
                Invoke-SimpleMemoryStartup # Roda a 2
                Invoke-SimpleInternetOpt # Roda a 3
                Invoke-SimpleVisualOpt # Roda a 4
                Invoke-SimpleGamingOpt # Roda a 5
                Invoke-SimpleSecurityMaintenance # Roda a 6
                Write-Host "`nShow! Todas as otimiza√ß√µes SIMPLIFICADAS foram executadas! PC t√° agradecendo! ;)`n" -ForegroundColor Green
                Read-Host "Aperta Enter pra voltar pro Menu Simplificado..." # Pausa no final do "Rodar Todas"
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-MainMenu
            default {
                Write-Host "Ops! Op√ß√£o inv√°lida no Menu Simplificado! Confere os n√∫meros e manda bala de novo!" -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Simplificado enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Avan√ßado (O Playground dos Magos do PC!) ---
# Acessado pela op√ß√£o 2 do Menu Principal. Aqui a gente mergulha fundo!
function Show-AdvancedMenu {
    do {
        Clear-Host # Limpa o palco pro menu avan√ßado!
        Banner-TORK # Nosso banner no topo, pra n√£o perder a pose!

        Write-Host "" # Espacinho maroto
        Write-Host "===============================" -ForegroundColor White
        Write-Host "      MENU AVANCADO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes do menu avan√ßado (as CATEGORIAS dos 200 poderes!) Cores variadas (repetindo)!
        Write-Host "[1] Limpeza e Manuten√ß√£o de Arquivos (Tirar a poeira digital!)" -ForegroundColor Cyan # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[2] Otimiza√ß√µes de Desempenho do Sistema (Deixar o motor roncando!)" -ForegroundColor Green # Cor variada
        Write-Host "[3] Configura√ß√µes e Otimiza√ß√µes de Rede (Pra internet voar baixo!)" -ForegroundColor Yellow # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[4] Gerenciamento e Otimiza√ß√£o de Servi√ßos do Windows (O que t√° rodando e n√£o precisa?!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Ferramentas de Diagn√≥stico e Verifica√ß√£o (Pra ver se t√° tudo nos conformes!)" -ForegroundColor Cyan # Cor repetida
        Write-Host "[6] Desabilitar/Gerenciar Recursos do Windows (Tirar o peso extra do sistema!)" -ForegroundColor Green # Cor repetida
        Write-Host "[7] Gerenciamento de Arquivos e Pastas Avan√ßado (Comandos ninja pra arquivos!)" -ForegroundColor Yellow # Cor repetida
        Write-Host "[8] Gerenciamento de Contas de Usu√°rio (Organizar a galera que usa o PC!)" -ForegroundColor White # Cor repetida
        Write-Host "[9] Otimiza√ß√£o para Jogos Avan√ßada (Tweaks pra gamers de verdade!)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Configura√ß√µes de Privacidade (Controle o que o Windows sabe sobre voc√™)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[11] Outras Configura√ß√µes e Tweaks Diversos (Aqueles ajustes secretos!)" -ForegroundColor Gray # Cor neutra/escura
        Write-Host "[0] Voltar ao Menu Principal (Pronto pra voltar pra estrada principal!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta pro mago qual categoria ele quer explorar
        $choice = Read-Host "Escolhe sua √°rea de magia, mago!"

        # V√™ pra onde a gente navega dentro do mundo avan√ßado
        switch ($choice) {
            "1" { Show-LimpezaManutencaoMenu } # CHAMA O SUB-MENU DE LIMPEZA
            "2" { Show-DesempenhoMenu } # Agora √© um sub-menu tamb√©m
            "3" { Show-ConfiguracoesRedeMenu } # CHAMA O SUB-MENU DE REDE
            "4" { Show-ServicosMenu } # Agora √© um sub-menu tamb√©m
            "5" { Show-DiagnosticoMenu } # Agora √© um sub-menu tamb√©m
            "6" { Show-RecursosMenu } # Agora √© um sub-menu tamb√©m
            "7" { Show-ArquivosPastasMenu } # Agora √© um sub-menu tamb√©m
            "8" { Show-UsuariosMenu } # Agora √© um sub-menu tamb√©m
            "9" { Show-JogosAvancadoMenu } # Novo sub-menu para jogos
            "10" { Show-PrivacidadeMenu } # Novo sub-menu para privacidade
            "11" { Show-OutrosMenu } # Agora √© um sub-menu tamb√©m
            "0" { break } # Sai do loop deste menu, voltando pro Menu Principal
            default {
                Write-Host "Humm, essa √°rea da magia ainda n√£o existe ou voc√™ digitou errado! Tenta de novo, mago!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Avan√ßado enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Limpeza e Manuten√ß√£o (Dentro do Avan√ßado!) ---
# Este menu lista as op√ß√µes ESPEC√çFICAS da categoria Limpeza no Menu Avan√ßado
function Show-LimpezaManutencaoMenu {
    do {
        Clear-Host # Limpa o palco pra este sub-menu!
        Banner-TORK # Banner no topo, sempre!

        Write-Host "" # Espacinho
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: LIMPEZA E MANUT." -ForegroundColor White # T√≠tulo menor pro sub-menu
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes ESPEC√çFICAS da categoria Limpeza. Cores variadas (repetindo cores)!
        Write-Host "[1] Limpar Arquivos Tempor√°rios do Usu√°rio (Tipo a pasta Temp!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[2] Limpar Arquivos Tempor√°rios do Sistema (Os tempor√°rios do Windows!)" -ForegroundColor Gray # Cor neutra (substitui DarkCyan)
        Write-Host "[3] Limpar Cache de DNS (Pra resolver nomes de site mais r√°pido!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[4] Esvaziar Lixeira (Adeus, arquivos deletados!)" -ForegroundColor Gray # Cor neutra (repetindo)
        Write-Host "[5] Limpar Cache de Miniaturas (Aqueles previews de imagem/v√≠deo!)" -ForegroundColor Green # Cor variada
        Write-Host "[6] Limpar Logs do Sistema (Arquivos de registro que acumulam)" -ForegroundColor Cyan # Nova op√ß√£o
        Write-Host "[7] Limpar Cache de Atualiza√ß√µes do Windows (Liberar espa√ßo de updates)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[8] Limpar Arquivos de Hiberna√ß√£o (Liberar o hiberfil.sys)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[9] Limpar Arquivos WinSxS (Pasta que ocupa muito espa√ßo)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Executar TODAS as limpezas acima (Faxina completa!)" -ForegroundColor Red # Nova op√ß√£o
        Write-Host "[0] Voltar ao Menu Avan√ßado (De volta pras categorias!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta qual limpeza espec√≠fica o mago quer fazer
        $choice = Read-Host "Escolhe a limpeza avan√ßada, mestre!"

        # V√™ qual fun√ß√£o de limpeza espec√≠fica chamar
        switch ($choice) {
            "1" { Invoke-CleanUserTemp } # Chama a fun√ß√£o pra Limpar Temp Usu√°rio
            "2" { Invoke-CleanSystemTemp } # Chama a fun√ß√£o pra Limpar Temp Sistema
            "3" { Invoke-CleanDnsCache } # Chama a fun√ß√£o pra Limpar Cache DNS
            "4" { Invoke-EmptyRecycleBin } # Chama a fun√ß√£o pra Esvaziar Lixeira
            "5" { Invoke-CleanThumbnailCache } # Chama a fun√ß√£o pra Limpar Cache de Miniaturas
            "6" { Invoke-CleanSystemLogs } # Nova fun√ß√£o para limpar logs do sistema
            "7" { Invoke-CleanWindowsUpdateCache } # Nova fun√ß√£o para limpar cache de updates
            "8" { Invoke-CleanHibernationFile } # Nova fun√ß√£o para limpar arquivo de hiberna√ß√£o
            "9" { Invoke-CleanWinSxS } # Nova fun√ß√£o para limpar pasta WinSxS
            "10" { 
                # Executa todas as limpezas em sequ√™ncia
                Write-Host "`nIniciando faxina completa do sistema! Isso pode demorar um pouco...`n" -ForegroundColor Yellow
                $diskSpaceBefore = Get-DiskSpaceBefore
                
                Invoke-CleanUserTemp
                Invoke-CleanSystemTemp
                Invoke-CleanDnsCache
                Invoke-EmptyRecycleBin
                Invoke-CleanThumbnailCache
                Invoke-CleanSystemLogs
                Invoke-CleanWindowsUpdateCache
                Invoke-CleanHibernationFile
                Invoke-CleanWinSxS
                
                Write-Host "`nFaxina completa finalizada! Veja quanto espa√ßo foi recuperado:`n" -ForegroundColor Green
                Show-DiskSpaceComparison -before $diskSpaceBefore
                Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-AdvancedMenu
            default {
                Write-Host "Essa tarefa de limpeza ainda n√£o t√° na lista! V√™ os n√∫meros e tenta de novo!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Sub-Menu Limpeza enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Desempenho (Dentro do Avan√ßado!) ---
function Show-DesempenhoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DESEMPENHO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Ajustar Efeitos Visuais para Melhor Desempenho" -ForegroundColor Green
        Write-Host "[2] Otimizar Disco do Sistema" -ForegroundColor Cyan
        Write-Host "[3] Limpar Arquivos Prefetch" -ForegroundColor Yellow
        Write-Host "[4] Definir Plano de Energia para Alto Desempenho" -ForegroundColor White
        Write-Host "[5] Otimizar Servi√ßo SuperFetch/SysMain" -ForegroundColor Magenta
        Write-Host "[6] Ajustar Tamanho da Mem√≥ria Virtual" -ForegroundColor Gray
        Write-Host "[7] Desativar Indexa√ß√£o de Arquivos" -ForegroundColor Green
        Write-Host "[8] Otimizar Inicializa√ß√£o do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de desempenho" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o de desempenho"

        switch ($choice) {
            "1" { Invoke-OptimizeVisualEffects }
            "2" { Invoke-OptimizeDisk }
            "3" { Invoke-CleanPrefetch }
            "4" { Invoke-SetHighPerformancePower }
            "5" { Invoke-OptimizeSuperFetch }
            "6" { Invoke-AdjustVirtualMemory }
            "7" { Invoke-DisableIndexing }
            "8" { Invoke-OptimizeStartup }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de desempenho...`n" -ForegroundColor Yellow
                Invoke-OptimizeVisualEffects
                Invoke-OptimizeDisk
                Invoke-CleanPrefetch
                Invoke-SetHighPerformancePower
                Invoke-OptimizeSuperFetch
                Invoke-AdjustVirtualMemory
                Invoke-DisableIndexing
                Invoke-OptimizeStartup
                Write-Host "`nTodas as otimiza√ß√µes de desempenho foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Configura√ß√µes de Rede (Dentro do Avan√ßado!) ---
function Show-ConfiguracoesRedeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: CONFIG. REDE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Limpar Cache de DNS" -ForegroundColor Yellow
        Write-Host "[2] Mudar Servidor DNS" -ForegroundColor Cyan
        Write-Host "[3] Resetar Configura√ß√µes de Rede" -ForegroundColor White
        Write-Host "[4] Otimizar Configura√ß√µes TCP/IP" -ForegroundColor Green
        Write-Host "[5] Verificar Velocidade da Conex√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar QoS (Qualidade de Servi√ßo)" -ForegroundColor Gray
        Write-Host "[7] Desativar IPv6 (Se n√£o estiver usando)" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Lat√™ncia de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de rede" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√£o de rede"

        switch ($choice) {
            "1" { Invoke-NetworkFlushDns }
            "2" { Invoke-NetworkChangeDns }
            "3" { Invoke-NetworkReset }
            "4" { Invoke-OptimizeTcpIp }
            "5" { Invoke-CheckNetworkSpeed }
            "6" { Invoke-ConfigureQoS }
            "7" { Invoke-DisableIPv6 }
            "8" { Invoke-OptimizeGamingLatency }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de rede...`n" -ForegroundColor Yellow
                Invoke-NetworkFlushDns
                Invoke-OptimizeTcpIp
                Invoke-CheckNetworkSpeed
                Invoke-ConfigureQoS
                Invoke-DisableIPv6
                Invoke-OptimizeGamingLatency
                Write-Host "`nTodas as otimiza√ß√µes de rede foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Rede..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Servi√ßos (Dentro do Avan√ßado!) ---
function Show-ServicosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: SERVICOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desabilitar Servi√ßo SuperFetch/SysMain" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Servi√ßo de Impress√£o" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Servi√ßo Windows Update" -ForegroundColor White
        Write-Host "[4] Listar Todos os Servi√ßos em Execu√ß√£o" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Otimizar Servi√ßos para Desempenho Geral" -ForegroundColor Gray
        Write-Host "[7] Restaurar Servi√ßos para Configura√ß√£o Padr√£o" -ForegroundColor Yellow
        Write-Host "[8] Desabilitar Servi√ßos Desnecess√°rios" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de servi√ßos"

        switch ($choice) {
            "1" { Invoke-ManageSuperFetch }
            "2" { Invoke-ManagePrintService }
            "3" { Invoke-ManageWindowsUpdate }
            "4" { Invoke-ListRunningServices }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-OptimizeServicesForPerformance }
            "7" { Invoke-RestoreDefaultServices }
            "8" { Invoke-DisableUnnecessaryServices }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Diagn√≥stico (Dentro do Avan√ßado!) ---
function Show-DiagnosticoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DIAGNOSTICO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Verificar Arquivos do Sistema (SFC)" -ForegroundColor Yellow
        Write-Host "[2] Reparar Imagem do Windows (DISM)" -ForegroundColor Cyan
        Write-Host "[3] Verificar Disco por Erros (CHKDSK)" -ForegroundColor White
        Write-Host "[4] Verificar Sa√∫de do Disco" -ForegroundColor Green
        Write-Host "[5] Verificar Drivers Desatualizados" -ForegroundColor Magenta
        Write-Host "[6] Verificar Problemas de Inicializa√ß√£o" -ForegroundColor Gray
        Write-Host "[7] Verificar Problemas de Mem√≥ria RAM" -ForegroundColor Yellow
        Write-Host "[8] Verificar Temperatura do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODOS os diagn√≥sticos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de diagn√≥stico"

        switch ($choice) {
            "1" { Invoke-SfcScan }
            "2" { Invoke-DismRepair }
            "3" { Invoke-ChkDsk }
            "4" { Invoke-CheckDiskHealth }
            "5" { Invoke-CheckDrivers }
            "6" { Invoke-CheckStartupIssues }
            "7" { Invoke-CheckMemory }
            "8" { Invoke-CheckTemperature }
            "9" {
                Write-Host "`nExecutando todos os diagn√≥sticos...`n" -ForegroundColor Yellow
                Invoke-SfcScan
                Invoke-DismRepair
                Invoke-CheckDiskHealth
                Invoke-CheckDrivers
                Invoke-CheckStartupIssues
                Invoke-CheckTemperature
                Write-Host "`nTodos os diagn√≥sticos foram conclu√≠dos!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Diagn√≥stico..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Recursos (Dentro do Avan√ßado!) ---
function Show-RecursosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: RECURSOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Gerenciar Hiberna√ß√£o" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Planos de Energia" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Recursos Opcionais do Windows" -ForegroundColor White
        Write-Host "[4] Gerenciar Mem√≥ria Virtual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Windows Defender" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Recursos de Telemetria" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Recursos de Inicializa√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Recursos de Seguran√ßa" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de recursos"

        switch ($choice) {
            "1" { Invoke-ManageHibernation }
            "2" { Invoke-ManagePowerPlans }
            "3" { Invoke-ManageOptionalFeatures }
            "4" { Invoke-ManageVirtualMemory }
            "5" { Invoke-ManageWindowsDefender }
            "6" { Invoke-ManageTelemetry }
            "7" { Invoke-ManageStartupResources }
            "8" { Invoke-ManageSecurityFeatures }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Arquivos e Pastas (Dentro do Avan√ßado!) ---
function Show-ArquivosPastasMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: ARQUIVOS E PASTAS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Encontrar Arquivos Grandes" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Arquivos" -ForegroundColor Cyan
        Write-Host "[3] Tomar Posse de Arquivos (TakeOwn)" -ForegroundColor White
        Write-Host "[4] Listar Conte√∫do de Pastas Espec√≠ficas" -ForegroundColor Green
        Write-Host "[5] Compactar Pastas para Economizar Espa√ßo" -ForegroundColor Magenta
        Write-Host "[6] Verificar Integridade de Arquivos" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Arquivos Ocultos e do Sistema" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Atributos de Arquivos" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de arquivos e pastas"

        switch ($choice) {
            "1" { Invoke-FindLargeFiles }
            "2" { Invoke-ManageFilePermissions }
            "3" { Invoke-TakeOwnership }
            "4" { Invoke-ListFolderContents }
            "5" { Invoke-CompressFolders }
            "6" { Invoke-VerifyFileIntegrity }
            "7" { Invoke-ManageHiddenSystemFiles }
            "8" { Invoke-ManageFileAttributes }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Usu√°rios (Dentro do Avan√ßado!) ---
function Show-UsuariosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: USUARIOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Listar Todos os Usu√°rios Locais" -ForegroundColor Yellow
        Write-Host "[2] Listar Todos os Grupos Locais" -ForegroundColor Cyan
        Write-Host "[3] Listar Membros de Grupos Espec√≠ficos" -ForegroundColor White
        Write-Host "[4] Mostrar Propriedades do Usu√°rio Atual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Contas de Usu√°rio" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Pol√≠ticas de Senha" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Permiss√µes de Usu√°rio" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar UAC (Controle de Conta de Usu√°rio)" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de usu√°rios"

        switch ($choice) {
            "1" { Invoke-ListLocalUsers }
            "2" { Invoke-ListLocalGroups }
            "3" { Invoke-ListGroupMembers }
            "4" { Invoke-ShowCurrentUserProperties }
            "5" { Invoke-ManageUserAccounts }
            "6" { Invoke-ManagePasswordPolicies }
            "7" { Invoke-ManageUserPermissions }
            "8" { Invoke-ManageUAC }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Jogos Avan√ßado (Dentro do Avan√ßado!) ---
function Show-JogosAvancadoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: JOGOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Otimizar Prioridade de CPU para Jogos" -ForegroundColor Yellow
        Write-Host "[2] Otimizar Configura√ß√µes de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[3] Otimizar Configura√ß√µes de GPU" -ForegroundColor White
        Write-Host "[4] Desativar Game DVR e Game Bar" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Configurar Modo de Jogo do Windows" -ForegroundColor Gray
        Write-Host "[7] Otimizar Configura√ß√µes de √Åudio para Jogos" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Configura√ß√µes de Input Lag" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes para jogos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o para jogos"

        switch ($choice) {
            "1" { Invoke-OptimizeCpuPriority }
            "2" { Invoke-OptimizeNetworkForGaming }
            "3" { Invoke-OptimizeGpuSettings }
            "4" { Invoke-DisableGameDvrBar }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-ConfigureGameMode }
            "7" { Invoke-OptimizeAudioForGaming }
            "8" { Invoke-OptimizeInputLag }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes para jogos...`n" -ForegroundColor Yellow
                Invoke-OptimizeCpuPriority
                Invoke-OptimizeNetworkForGaming
                Invoke-OptimizeGpuSettings
                Invoke-DisableGameDvrBar
                Invoke-OptimizeServicesForGaming
                Invoke-ConfigureGameMode
                Invoke-OptimizeAudioForGaming
                Invoke-OptimizeInputLag
                Write-Host "`nTodas as otimiza√ß√µes para jogos foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Jogos..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Privacidade (Dentro do Avan√ßado!) ---
function Show-PrivacidadeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: PRIVACIDADE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desativar Telemetria do Windows" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Aplicativos" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Hist√≥rico de Atividades" -ForegroundColor White
        Write-Host "[4] Gerenciar Diagn√≥stico e Feedback" -ForegroundColor Green
        Write-Host "[5] Gerenciar An√∫ncios Personalizados" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Localiza√ß√£o e Sensores" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Reconhecimento de Voz e Digita√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Sincroniza√ß√£o com a Microsoft" -ForegroundColor Cyan
        Write-Host "[9] Aplicar TODAS as configura√ß√µes de privacidade" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de privacidade"

        switch ($choice) {
            "1" { Invoke-DisableTelemetry }
            "2" { Invoke-ManageAppPermissions }
            "3" { Invoke-ManageActivityHistory }
            "4" { Invoke-ManageDiagnosticsFeedback }
            "5" { Invoke-ManagePersonalizedAds }
            "6" { Invoke-ManageLocationSensors }
            "7" { Invoke-ManageVoiceTyping }
            "8" { Invoke-ManageMicrosoftSync }
            "9" {
                Write-Host "`nAplicando todas as configura√ß√µes de privacidade...`n" -ForegroundColor Yellow
                Invoke-DisableTelemetry
                Invoke-ManageAppPermissions
                Invoke-ManageActivityHistory
                Invoke-ManageDiagnosticsFeedback
                Invoke-ManagePersonalizedAds
                Invoke-ManageLocationSensors
                Invoke-ManageVoiceTyping
                Invoke-ManageMicrosoftSync
                Write-Host "`nTodas as configura√ß√µes de privacidade foram aplicadas!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Privacidade..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Outros (Dentro do Avan√ßado!) ---
function Show-OutrosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: OUTROS TWEAKS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Mostrar Informa√ß√µes Detalhadas do Sistema" -ForegroundColor Yellow
        Write-Host "[2] Mostrar Configura√ß√£o Completa de Rede" -ForegroundColor Cyan
        Write-Host "[3] Reiniciar Explorer.exe" -ForegroundColor White
        Write-Host "[4] Limpar Cache de Atualiza√ß√µes do Windows" -ForegroundColor Green
        Write-Host "[5] Gerenciar Programas de Inicializa√ß√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar Op√ß√µes de Energia Avan√ßadas" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Configura√ß√µes de Armazenamento" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Configura√ß√µes de Notifica√ß√µes" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√µes diversas"

        switch ($choice) {
            "1" { Invoke-ShowDetailedSystemInfo }
            "2" { Invoke-ShowDetailedNetworkConfig }
            "3" { Invoke-RestartExplorer }
            "4" { Invoke-CleanWindowsUpdateCache }
            "5" { Invoke-ManageStartupPrograms }
            "6" { Invoke-ConfigureAdvancedPowerOptions }
            "7" { Invoke-ManageStorageSettings }
            "8" { Invoke-ManageNotificationSettings }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- Fun√ß√µes para as Secoes SIMPLIFICADAS (Expandidas) ---
function Invoke-SimpleSystemCleanup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza Geral do Sistema: Hora de varrer o lixo digital! ---" -ForegroundColor Green
    Write-Host "Essa op√ß√£o vai te ajudar a liberar espa√ßo e dar um f√¥lego pro PC tirando arquivos tempor√°rios, lixo da lixeira, etc. √â tipo faxina no computador!" -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Comando 1: Limpar Arquivos Tempor√°rios do Usu√°rio
    Write-Host "Bora come√ßar limpando os arquivos tempor√°rios do seu usu√°rio! Eles acumulam que √© uma beleza!" -ForegroundColor Yellow
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio limpos! Menos peso pro PC respirar! ;)" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Esvaziar a Lixeira
    Write-Host "Agora, vamos dar um fim definitivo naqueles arquivos na Lixeira. Eles s√≥ est√£o ocupando espa√ßo √† toa!" -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada! Espa√ßo recuperado com sucesso! R√°!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios do Windows
    Write-Host "Vamos limpar tamb√©m os tempor√°rios do pr√≥prio Windows. √Äs vezes, fica lixo escondido por l√°!" -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Limpar Cache de Navegadores Comuns
    Write-Host "Bora dar uma geral nos caches dos navegadores tamb√©m! Eles guardam um monte de coisa que pode pesar!" -ForegroundColor Yellow
    
    # Chrome
    Write-Host "Tentando limpar cache do Google Chrome..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Chrome limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Edge
    Write-Host "Tentando limpar cache do Microsoft Edge..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Edge limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Firefox
    Write-Host "Tentando limpar cache do Mozilla Firefox..." -ForegroundColor DarkGray
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\cache2\entries\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\startupCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\thumbnails\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Firefox limpo (pode n√£o ser completo, dependendo do perfil/uso)." -ForegroundColor DarkGray

    # Brave (se instalado)
    Write-Host "Tentando limpar cache do Brave Browser (se instalado)..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Brave limpo (se instalado e n√£o estiver rodando)." -ForegroundColor DarkGray

    Write-Host "Limpeza de caches de navegador conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Comando 5: Limpar Cache de Miniaturas
    Write-Host "Limpando cache de miniaturas do Windows (aquelas pr√©-visualiza√ß√µes de imagens e v√≠deos)..." -ForegroundColor Yellow
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Write-Host "Cache de miniaturas limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Limpar Arquivos de Log do Windows
    Write-Host "Limpando arquivos de log do Windows que podem ocupar espa√ßo..." -ForegroundColor Yellow
    wevtutil cl Application
    wevtutil cl System
    wevtutil cl Security
    Write-Host "Logs do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 7: Limpar Arquivos Tempor√°rios de Instala√ß√£o
    Write-Host "Limpando arquivos tempor√°rios de instala√ß√£o de programas..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Installer\$*\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios de instala√ß√£o limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 8: Limpar Arquivos de Atualiza√ß√£o do Windows
    Write-Host "Limpando arquivos de atualiza√ß√£o do Windows que podem ocupar bastante espa√ßo..." -ForegroundColor Yellow
    Stop-Service -Name wuauserv -ErrorAction SilentlyContinue
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    Write-Host "Arquivos de atualiza√ß√£o do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 9: Limpar Arquivos Prefetch
    Write-Host "Limpando arquivos prefetch para melhorar a inicializa√ß√£o..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Prefetch\*.pf" -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos prefetch limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 10: Executar Limpeza de Disco Integrada do Windows
    Write-Host "Executando a ferramenta de limpeza de disco integrada do Windows..." -ForegroundColor Yellow
    Start-Process -FilePath cleanmgr.exe -ArgumentList "/sagerun:1" -Wait -ErrorAction SilentlyContinue
    Write-Host "Limpeza de disco conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "Vamos ver quanto espa√ßo conseguimos recuperar com essa faxina:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nPronto! A faxina geral b√°sica foi feita! Seu PC agradece o espa√ßo extra! ;)" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu
    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleMemoryStartup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Mem√≥ria e Inicializa√ß√£o R√°pida: Deixa o PC ligando num piscar! ---" -ForegroundColor Yellow
    Write-Host "Aqui a gente d√° uma olhada na mem√≥ria RAM e nos programas que ligam junto com o Windows. Menos coisa ligando √† toa = PC mais r√°pido pra usar na hora!" -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Listar Programas de Inicializa√ß√£o
    Write-Host "Listando programas que iniciam com o Windows (pra voc√™ saber o que t√° rodando por baixo dos panos):" -ForegroundColor Yellow
    Get-CimInstance win32_startupcommand | Select-Object Name, command, Location | Format-Table -AutoSize
    Write-Host "Lista de programas de inicializa√ß√£o exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Servi√ßo SuperFetch/SysMain
    Write-Host "Otimizando o servi√ßo SuperFetch/SysMain para melhorar o desempenho..." -ForegroundColor Yellow
    $confirmSysMain = Read-Host "Deseja desativar o servi√ßo SysMain/SuperFetch? (s/n) - Recomendado para SSDs"
    if ($confirmSysMain -eq 's') {
        Set-Service -Name SysMain -StartupType Disabled -ErrorAction SilentlyContinue
        Stop-Service -Name SysMain -Force -ErrorAction SilentlyContinue
        Write-Host "Servi√ßo SysMain/SuperFetch desativado!" -ForegroundColor Green
    } else {
        Write-Host "Servi√ßo SysMain/SuperFetch mantido ativo." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios de Updates
    Write-Host "Limpando arquivos tempor√°rios de atualiza√ß√µes do Windows (podem ocupar bastante espa√ßo e afetar performance):" -ForegroundColor Yellow
    Dism /online /Cleanup-Image /StartComponentCleanup /ErrorAction SilentlyContinue
    Write-Host "Limpeza de componentes de atualiza√ß√£o iniciada (pode levar um tempo)." -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Mem√≥ria Virtual
    Write-Host "Otimizando configura√ß√µes de mem√≥ria virtual para melhor desempenho..." -ForegroundColor Yellow
    $totalRam = (Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property capacity -Sum).Sum / 1GB
    Write-Host "Seu sistema tem aproximadamente $totalRam GB de RAM." -ForegroundColor White
    
    $confirmPageFile = Read-Host "Deseja otimizar o arquivo de pagina√ß√£o (mem√≥ria virtual)? (s/n)"
    if ($confirmPageFile -eq 's') {
        # Calcula tamanho recomendado (1.5x a RAM para sistemas com menos de 8GB, 1x para sistemas com mais)
        $pageFileSize = if ($totalRam -lt 8) { [math]::Round($totalRam * 1.5) * 1024 } else { [math]::Round($totalRam) * 1024 }
        
        Write-Host "Configurando arquivo de pagina√ß√£o para tamanho fixo de $pageFileSize MB..." -ForegroundColor DarkGray
        $computerSystem = Get-WmiObject -Class Win32_ComputerSystem
        $computerSystem.AutomaticManagedPagefile = $false
        $computerSystem.Put() | Out-Null
        
        $pageFileSetting = Get-WmiObject -Class Win32_PageFileSetting
        if ($pageFileSetting) {
            $pageFileSetting.InitialSize = $pageFileSize
            $pageFileSetting.MaximumSize = $pageFileSize
            $pageFileSetting.Put() | Out-Null
        }
        Write-Host "Arquivo de pagina√ß√£o otimizado! (Requer reinicializa√ß√£o para aplicar totalmente)" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes de mem√≥ria virtual mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Listar os 10 Processos que mais usam mem√≥ria no momento
    Write-Host "Listando os 10 processos que mais consomem mem√≥ria agora:" -ForegroundColor Yellow
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host "Lista de processos exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Otimizar Inicializa√ß√£o do Windows
    Write-Host "Otimizando a inicializa√ß√£o do Windows..." -ForegroundColor Yellow
    # Desabilitar servi√ßos n√£o essenciais que podem atrasar a inicializa√ß√£o
    $startupServices = @(
        @{Name="DiagTrack"; DisplayName="Experi√™ncias do Usu√°rio Conectado e Telemetria"},
        @{Name="dmwappushservice"; DisplayName="Servi√ßo de Transfer√™ncia Inteligente em Segundo Plano (BITS)"},
        @{Name="MapsBroker"; DisplayName="Servi√ßo de Dados de Mapas"}
    )
    
    foreach ($service in $startupServices) {
        $confirmService = Read-Host "Deseja desativar o servi√ßo '$($service.DisplayName)' na inicializa√ß√£o? (s/n)"
        if ($confirmService -eq 's') {
            Set-Service -Name $service.Name -StartupType Disabled -ErrorAction SilentlyContinue
            Stop-Service -Name $service.Name -Force -ErrorAction SilentlyContinue
            Write-Host "Servi√ßo '$($service.DisplayName)' desativado!" -ForegroundColor Green
        } else {
            Write-Host "Servi√ßo '$($service.DisplayName)' mantido." -ForegroundColor Green
        }
    }
    Write-Host ""

    # Comando 7: Reiniciar o Computador (√ötil pra liberar mem√≥ria e aplicar mudan√ßas)
    Write-Host "Quer dar um 'refresh' geral no PC? Reiniciar pode ajudar!" -ForegroundColor Yellow
    $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (digite 'sim' para confirmar)"
    if ($confirmRestart -eq 'sim') {
        Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
        Restart-Computer -Force
    } else {
        Write-Host "Rein√≠cio cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o de mem√≥ria e inicializa√ß√£o!" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu (a n√£o ser que o PC tenha reiniciado)
    if ($confirmRestart -ne 'sim') {
        Write-Host ""
        Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
    }
}

function Invoke-SimpleInternetOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Acelerar a Conex√£o com a Internet (Simplificado): Diz adeus pro 'carregando...'! ---" -ForegroundColor Cyan
    Write-Host "Vamos fazer uns ajustes r√°pidos na sua conex√£o pra tentar deixar ela mais esperta." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Limpar Cache de DNS
    Write-Host "Limpando o cache de endere√ßos de internet (DNS) pra resolver nomes mais r√°pido!" -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Configura√ß√µes TCP/IP
    Write-Host "Otimizando configura√ß√µes TCP/IP para melhorar a velocidade de conex√£o..." -ForegroundColor Yellow
    
    # Habilitar TCP Window Auto-Tuning
    netsh int tcp set global autotuninglevel=normal
    Write-Host "TCP Auto-Tuning configurado para 'normal'." -ForegroundColor DarkGray
    
    # Otimizar par√¢metros de recebimento de pacotes
    netsh int tcp set global rss=enabled
    Write-Host "Receive-Side Scaling (RSS) habilitado." -ForegroundColor DarkGray
    
    # Otimizar congestion provider
    netsh int tcp set global congestionprovider=ctcp
    Write-Host "Congestion Provider configurado para 'ctcp'." -ForegroundColor DarkGray
    
    # Otimizar ECN capability
    netsh int tcp set global ecncapability=enabled
    Write-Host "ECN Capability habilitado." -ForegroundColor DarkGray
    
    Write-Host "Configura√ß√µes TCP/IP otimizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Reiniciar Adaptadores de Rede
    Write-Host "Dando um 'reset' r√°pido nas suas conex√µes de rede. Pode resolver uns pepinos!" -ForegroundColor Yellow
    $confirmResetAdapter = Read-Host "Isso vai desconectar brevemente sua internet. Continuar? (s/n)"
    if ($confirmResetAdapter -eq 's') {
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        Write-Host "Adaptadores de rede reiniciados." -ForegroundColor Green
    } else {
        Write-Host "Reset de adaptadores cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 4: Configurar DNS R√°pido
    Write-Host "Configurar DNS mais r√°pido pode melhorar sua navega√ß√£o!" -ForegroundColor Yellow
    $confirmDns = Read-Host "Deseja configurar DNS mais r√°pidos (Google ou Cloudflare)? (s/n)"
    if ($confirmDns -eq 's') {
        Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
        Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
        $dnsChoice = Read-Host "Escolha uma op√ß√£o (1 ou 2)"
        
        $primaryDns = ""
        $secondaryDns = ""
        
        if ($dnsChoice -eq '1') {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            Write-Host "Google DNS selecionado." -ForegroundColor DarkGray
        } elseif ($dnsChoice -eq '2') {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            Write-Host "Cloudflare DNS selecionado." -ForegroundColor DarkGray
        } else {
            Write-Host "Op√ß√£o inv√°lida. DNS n√£o alterado." -ForegroundColor Red
        }
        
        if ($primaryDns -ne "") {
            $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" -and ($_.InterfaceDescription -match "Ethernet" -or $_.InterfaceDescription -match "Wi-Fi" -or $_.InterfaceDescription -match "Wireless") }
            
            foreach ($adapter in $networkAdapters) {
                Write-Host "Configurando DNS para adaptador: $($adapter.Name)" -ForegroundColor DarkGray
                Set-DnsClientServerAddress -InterfaceIndex $adapter.ifIndex -ServerAddresses ($primaryDns, $secondaryDns)
            }
            
            Write-Host "DNS configurado! Sua navega√ß√£o deve ficar mais r√°pida agora." -ForegroundColor Green
        }
    } else {
        Write-Host "Configura√ß√£o de DNS mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Mostrar Status B√°sico da Conex√£o
    Write-Host "Mostrando um resumo b√°sico da sua configura√ß√£o de rede atual:" -ForegroundColor Yellow
    ipconfig /all | Select-String -Pattern "IPv4", "DNS", "Gateway", "DHCP", "Subnet", "Physical Address"
    Write-Host "Status b√°sico da rede exibido." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Testar a conex√£o com a internet
    Write-Host "Testando a conex√£o com a internet (ping para google.com)..." -ForegroundColor Yellow
    Test-Connection -Count 4 google.com -ErrorAction SilentlyContinue
    Write-Host "Teste de conex√£o finalizado." -ForegroundColor Green
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o b√°sica de internet!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleVisualOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Deixar o Windows mais Leve Visualmente (Simplificado): Desempenho antes da beleza! ---" -ForegroundColor White
    Write-Host "Ajustes r√°pidos pra desativar efeitos visuais que podem pesar, liberando recursos pro que importa." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ajustar Efeitos Visuais
    Write-Host "Voc√™ quer desativar ou ativar as anima√ß√µes e efeitos visuais do Windows?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Efeitos Visuais (Pra ganhar desempenho)" -ForegroundColor Green
    Write-Host "[2] Configurar para Melhor Apar√™ncia (Mais bonito, mas mais pesado)" -ForegroundColor White
    Write-Host "[3] Deixar o Windows Escolher (Configura√ß√£o padr√£o)" -ForegroundColor Cyan
    $choiceVisual = Read-Host "Escolha [1], [2] ou [3]"

    if ($choiceVisual -eq '1') {
        Write-Host "Desativando efeitos visuais para melhor desempenho..." -ForegroundColor Yellow
        # Valor 2 = Ajustar para melhor desempenho (desativa a maioria dos efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 2 -Type DWord -Force -ErrorAction SilentlyContinue
        
        # Desativar anima√ß√µes individuais
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop' -Name 'UserPreferencesMask' -Value ([byte[]](0x90, 0x12, 0x01, 0x80)) -Type Binary -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop\WindowMetrics' -Name 'MinAnimate' -Value 0 -Type String -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'ListviewAlphaSelect' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'TaskbarAnimations' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        
        Write-Host "Efeitos visuais desativados para melhor desempenho!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '2') {
        Write-Host "Configurando para melhor apar√™ncia (todos os efeitos visuais ativados)..." -ForegroundColor Yellow
        # Valor 1 = Ajustar para melhor apar√™ncia (ativa todos os efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Efeitos visuais configurados para melhor apar√™ncia!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '3') {
        Write-Host "Deixando o Windows escolher automaticamente (configura√ß√£o padr√£o)..." -ForegroundColor Yellow
        # Valor 0 = Deixar o Windows escolher
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Configura√ß√£o visual definida para padr√£o do Windows!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa nos efeitos visuais foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 2: Ativar/Desativar Efeitos de Transpar√™ncia
    Write-Host "E os efeitos de transpar√™ncia do Windows (tipo na barra de tarefas)?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Transpar√™ncia (Mais leve)" -ForegroundColor Green
    Write-Host "[2] Ativar Transpar√™ncia (Mais 'bonito')" -ForegroundColor White
    $choiceTransp = Read-Host "Escolha [1] ou [2]"

    if ($choiceTransp -eq '1') {
        Write-Host "Desativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 0 = Desativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia desativada!" -ForegroundColor Green
    } elseif ($choiceTransp -eq '2') {
        Write-Host "Ativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 1 = Ativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia ativada!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa na transpar√™ncia foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 3: Configurar Tema Claro/Escuro
    Write-Host "Voc√™ prefere tema claro ou escuro? O tema escuro pode ser mais confort√°vel para os olhos." -ForegroundColor Yellow
    Write-Host "[1] Tema Escuro (Dark Mode)" -ForegroundColor DarkGray
    Write-Host "[2] Tema Claro (Light Mode)" -ForegroundColor White
    $choiceTheme = Read-Host "Escolha [1] ou [2]"

    if ($choiceTheme -eq '1') {
        Write-Host "Configurando tema escuro..." -ForegroundColor Yellow
        # Valor 0 = Tema Escuro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema escuro configurado!" -ForegroundColor Green
    } elseif ($choiceTheme -eq '2') {
        Write-Host "Configurando tema claro..." -ForegroundColor Yellow
        # Valor 1 = Tema Claro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema claro configurado!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa no tema foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Configurar Resolu√ß√£o de Tela
    Write-Host "Deseja ajustar a resolu√ß√£o da tela? Resolu√ß√µes menores podem melhorar o desempenho em PCs mais antigos." -ForegroundColor Yellow
    $confirmResolution = Read-Host "Deseja ver e ajustar a resolu√ß√£o da tela? (s/n)"
    
    if ($confirmResolution -eq 's') {
        # Mostrar resolu√ß√£o atual
        $currentResolution = Get-WmiObject -Class Win32_VideoController | Select-Object -ExpandProperty VideoModeDescription
        Write-Host "Resolu√ß√£o atual: $currentResolution" -ForegroundColor White
        
        # Abrir configura√ß√µes de exibi√ß√£o do Windows
        Write-Host "Abrindo configura√ß√µes de exibi√ß√£o do Windows..." -ForegroundColor DarkGray
        Start-Process "ms-settings:display"
        Write-Host "Ajuste a resolu√ß√£o conforme necess√°rio na janela de configura√ß√µes que foi aberta." -ForegroundColor Green
        
        $waitForSettings = Read-Host "Pressione Enter quando terminar de ajustar as configura√ß√µes de exibi√ß√£o"
    } else {
        Write-Host "Configura√ß√£o de resolu√ß√£o mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizados os ajustes visuais b√°sicos!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleGamingOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Jogos (Simplificado): Mais FPS, menos lag! ---" -ForegroundColor Magenta
    Write-Host "Vamos fazer alguns ajustes para melhorar o desempenho dos seus jogos sem complica√ß√µes." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ativar Modo de Jogo do Windows
    Write-Host "Ativando o Modo de Jogo do Windows para priorizar recursos para jogos..." -ForegroundColor Yellow
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AllowAutoGameMode" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AutoGameModeEnabled" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Write-Host "Modo de Jogo do Windows ativado!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Desativar Game DVR e Game Bar
    Write-Host "O Game DVR e Game Bar podem reduzir o desempenho em jogos. Deseja desativ√°-los?" -ForegroundColor Yellow
    $confirmGameDVR = Read-Host "Desativar Game DVR e Game Bar? (s/n)"
    
    if ($confirmGameDVR -eq 's') {
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "UseNexusForGameBarEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\System\GameConfigStore" -Name "GameDVR_Enabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR" -Name "AppCaptureEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Write-Host "Game DVR e Game Bar desativados!" -ForegroundColor Green
    } else {
        Write-Host "Game DVR e Game Bar mantidos ativos." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Otimizar Plano de Energia para Jogos
    Write-Host "Configurando plano de energia para alto desempenho (ideal para jogos)..." -ForegroundColor Yellow
    powercfg.exe /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c
    Write-Host "Plano de energia configurado para alto desempenho!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Configura√ß√µes de Mouse
    Write-Host "Otimizando configura√ß√µes de mouse para jogos (precis√£o do ponteiro)..." -ForegroundColor Yellow
    $confirmMouseFix = Read-Host "Desativar a acelera√ß√£o do mouse para melhor precis√£o em jogos? (s/n)"
    
    if ($confirmMouseFix -eq 's') {
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseSpeed" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold1" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold2" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Write-Host "Acelera√ß√£o do mouse desativada para melhor precis√£o em jogos!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do mouse mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Otimizar Prioridade de CPU para Jogos
    Write-Host "Configurando prioridade de CPU para jogos..." -ForegroundColor Yellow
    Write-Host "Esta configura√ß√£o ajusta o sistema para dar mais prioridade aos jogos." -ForegroundColor DarkGray
    
    # Criar chave de registro para prioridade de jogos
    if (-not (Test-Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games")) {
        New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Force | Out-Null
    }
    
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "GPU Priority" -Type DWord -Value 8 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Priority" -Type DWord -Value 6 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Scheduling Category" -Type String -Value "High" -Force -ErrorAction SilentlyContinue
    
    Write-Host "Prioridade de CPU para jogos otimizada!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Verificar Driver de Placa de V√≠deo
    Write-Host "Verificando informa√ß√µes da placa de v√≠deo..." -ForegroundColor Yellow
    $gpuInfo = Get-WmiObject -Class Win32_VideoController | Select-Object Name, DriverVersion, CurrentHorizontalResolution, CurrentVerticalResolution
    
    foreach ($gpu in $gpuInfo) {
        Write-Host "Placa de v√≠deo: $($gpu.Name)" -ForegroundColor White
        Write-Host "Vers√£o do driver: $($gpu.DriverVersion)" -ForegroundColor White
        Write-Host "Resolu√ß√£o atual: $($gpu.CurrentHorizontalResolution) x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
      x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
    
    Write-Host "Recomenda√ß√£o: Mantenha seus drivers de v√≠deo atualizados para melhor desempenho em jogos!" -ForegroundColor Green
    Write-Host "Voc√™ pode baixar os drivers mais recentes nos sites oficiais da NVIDIA, AMD ou Intel." -ForegroundColor DarkGray
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nOtimiza√ß√µes para jogos conclu√≠das! Seus jogos devem rodar mais suaves agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleSecurityMaintenance {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Manuten√ß√£o de Seguran√ßa (Simplificado): Mantenha seu PC protegido! ---" -ForegroundColor DarkYellow
    Write-Host "Vamos verificar e melhorar a seguran√ßa do seu sistema com alguns ajustes simples." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Verificar Status do Windows Defender
    Write-Host "Verificando status do Windows Defender..." -ForegroundColor Yellow
    $defenderStatus = Get-MpComputerStatus
    
    Write-Host "Status do Windows Defender:" -ForegroundColor White
    Write-Host "Antiv√≠rus habilitado: $($defenderStatus.AntivirusEnabled)" -ForegroundColor $(if ($defenderStatus.AntivirusEnabled) { "Green" } else { "Red" })
    Write-Host "Prote√ß√£o em tempo real: $($defenderStatus.RealTimeProtectionEnabled)" -ForegroundColor $(if ($defenderStatus.RealTimeProtectionEnabled) { "Green" } else { "Red" })
    Write-Host "Defini√ß√µes de antiv√≠rus: $($defenderStatus.AntivirusSignatureVersion)" -ForegroundColor White
    Write-Host "√öltima atualiza√ß√£o: $($defenderStatus.AntivirusSignatureLastUpdated)" -ForegroundColor White
    Write-Host ""

    # Comando 2: Atualizar Defini√ß√µes do Windows Defender
    Write-Host "Atualizando defini√ß√µes do Windows Defender..." -ForegroundColor Yellow
    Update-MpSignature -ErrorAction SilentlyContinue
    Write-Host "Defini√ß√µes do Windows Defender atualizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Verificar Atualiza√ß√µes do Windows
    Write-Host "Verificando status das atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
            Write-Host "Recomenda√ß√£o: Execute o Windows Update para manter seu sistema seguro." -ForegroundColor Green
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Verificar Configura√ß√µes de Firewall
    Write-Host "Verificando status do Firewall do Windows..." -ForegroundColor Yellow
    $firewallStatus = Get-NetFirewallProfile
    
    foreach ($profile in $firewallStatus) {
        Write-Host "Perfil: $($profile.Name)" -ForegroundColor White
        Write-Host "Status: $($profile.Enabled)" -ForegroundColor $(if ($profile.Enabled) { "Green" } else { "Red" })
        Write-Host ""
    }
    
    $confirmFirewall = Read-Host "Deseja habilitar o Firewall em todos os perfis? (s/n)"
    if ($confirmFirewall -eq 's') {
        Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True
        Write-Host "Firewall habilitado em todos os perfis!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do Firewall mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Verificar Configura√ß√µes de UAC
    Write-Host "Verificando configura√ß√µes do Controle de Conta de Usu√°rio (UAC)..." -ForegroundColor Yellow
    $uacLevel = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -ErrorAction SilentlyContinue
    
    if ($uacLevel) {
        switch ($uacLevel.ConsentPromptBehaviorAdmin) {
            0 { $uacStatus = "Desativado (N√£o recomendado)" }
            1 { $uacStatus = "Baixo (N√£o recomendado)" }
            2 { $uacStatus = "M√©dio" }
            5 { $uacStatus = "Alto (Recomendado)" }
            default { $uacStatus = "Personalizado" }
        }
        
        Write-Host "N√≠vel atual do UAC: $uacStatus" -ForegroundColor $(if ($uacLevel.ConsentPromptBehaviorAdmin -ge 2) { "Green" } else { "Red" })
        
        $confirmUAC = Read-Host "Deseja configurar o UAC para o n√≠vel recomendado? (s/n)"
        if ($confirmUAC -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -Value 5 -Type DWord -Force -ErrorAction SilentlyContinue
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "PromptOnSecureDesktop" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
            Write-Host "UAC configurado para o n√≠vel recomendado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do UAC mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do UAC." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 6: Verificar Configura√ß√µes de SmartScreen
    Write-Host "Verificando configura√ß√µes do Windows SmartScreen..." -ForegroundColor Yellow
    $smartScreen = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -ErrorAction SilentlyContinue
    
    if ($smartScreen) {
        Write-Host "Status do SmartScreen: $($smartScreen.SmartScreenEnabled)" -ForegroundColor $(if ($smartScreen.SmartScreenEnabled -eq "RequireAdmin" -or $smartScreen.SmartScreenEnabled -eq "Warn") { "Green" } else { "Red" })
        
        $confirmSmartScreen = Read-Host "Deseja habilitar o SmartScreen para maior seguran√ßa? (s/n)"
        if ($confirmSmartScreen -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -Value "RequireAdmin" -Type String -Force -ErrorAction SilentlyContinue
            Write-Host "SmartScreen habilitado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do SmartScreen mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do SmartScreen." -ForegroundColor Red
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nManuten√ß√£o de seguran√ßa conclu√≠da! Seu sistema est√° mais protegido agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

# --- Fun√ß√µes para o Diagn√≥stico R√°pido e Sobre ---
function Invoke-QuickDiagnostic {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Diagn√≥stico R√°pido do Sistema ---" -ForegroundColor Yellow
    Write-Host "Vamos fazer uma verifica√ß√£o r√°pida do estado atual do seu PC." -ForegroundColor Gray
    Write-Host ""

    # Informa√ß√µes do Sistema
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    $sysInfo = Get-SystemInfo
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host ""

    # Uso de CPU
    Write-Host "=== Uso de CPU ===" -ForegroundColor Cyan
    $cpuLoad = (Get-WmiObject Win32_Processor).LoadPercentage
    Write-Host "Uso atual de CPU: $cpuLoad%" -ForegroundColor $(if ($cpuLoad -lt 70) { "Green" } elseif ($cpuLoad -lt 90) { "Yellow" } else { "Red" })
    Write-Host ""

    # Uso de Mem√≥ria
    Write-Host "=== Uso de Mem√≥ria ===" -ForegroundColor Cyan
    $os = Get-WmiObject Win32_OperatingSystem
    $totalMemory = [math]::Round($os.TotalVisibleMemorySize / 1MB, 2)
    $freeMemory = [math]::Round($os.FreePhysicalMemory / 1MB, 2)
    $usedMemory = [math]::Round($totalMemory - $freeMemory, 2)
    $memoryPercentage = [math]::Round(($usedMemory / $totalMemory) * 100, 2)
    
    Write-Host "Mem√≥ria Total: $totalMemory GB" -ForegroundColor White
    Write-Host "Mem√≥ria Usada: $usedMemory GB ($memoryPercentage%)" -ForegroundColor $(if ($memoryPercentage -lt 70) { "Green" } elseif ($memoryPercentage -lt 90) { "Yellow" } else { "Red" })
    Write-Host "Mem√≥ria Livre: $freeMemory GB" -ForegroundColor White
    Write-Host ""

    # Espa√ßo em Disco
    Write-Host "=== Espa√ßo em Disco ===" -ForegroundColor Cyan
    $drives = Get-PSDrive -PSProvider FileSystem
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        $percentFree = [math]::Round(($freeSpace / $totalSpace) * 100, 2)
        
        Write-Host "Drive $($drive.Name):" -ForegroundColor White
        Write-Host "  Total: $totalSpace GB" -ForegroundColor White
        Write-Host "  Usado: $usedSpace GB" -ForegroundColor White
        Write-Host "  Livre: $freeSpace GB ($percentFree%)" -ForegroundColor $(if ($percentFree -gt 20) { "Green" } elseif ($percentFree -gt 10) { "Yellow" } else { "Red" })
    }
    Write-Host ""

    # Processos que mais consomem recursos
    Write-Host "=== Top 5 Processos (CPU) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object CPU -Descending | Select-Object -First 5 ProcessName, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}}, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host ""

    Write-Host "=== Top 5 Processos (Mem√≥ria) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 5 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}}, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}} | Format-Table -AutoSize
    Write-Host ""

    # Status de Servi√ßos Cr√≠ticos
    Write-Host "=== Status de Servi√ßos Cr√≠ticos ===" -ForegroundColor Cyan
    $criticalServices = @("wuauserv", "WinDefend", "MpsSvc", "wscsvc")
    foreach ($service in $criticalServices) {
        $serviceStatus = Get-Service -Name $service -ErrorAction SilentlyContinue
        if ($serviceStatus) {
            Write-Host "$($serviceStatus.DisplayName): $($serviceStatus.Status)" -ForegroundColor $(if ($serviceStatus.Status -eq "Running") { "Green" } else { "Red" })
        }
    }
    Write-Host ""

    # Verificar Atualiza√ß√µes Pendentes
    Write-Host "=== Atualiza√ß√µes do Windows ===" -ForegroundColor Cyan
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Recomenda√ß√µes
    Write-Host "=== Recomenda√ß√µes ===" -ForegroundColor Cyan
    
    # Recomenda√ß√£o de Mem√≥ria
    if ($memoryPercentage -gt 80) {
        Write-Host "- Seu uso de mem√≥ria est√° alto. Considere fechar alguns programas ou usar a op√ß√£o 'Otimiza√ß√£o de Mem√≥ria'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Disco
    $lowDiskSpace = $false
    foreach ($drive in $drives) {
        $percentFree = [math]::Round(($drive.Free / ($drive.Free + $drive.Used)) * 100, 2)
        if ($percentFree -lt 15) {
            $lowDiskSpace = $true
            break
        }
    }
    
    if ($lowDiskSpace) {
        Write-Host "- Espa√ßo em disco baixo detectado. Considere usar a op√ß√£o 'Limpeza Geral do Sistema'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Atualiza√ß√µes
    if ($pendingUpdates -gt 0) {
        Write-Host "- Existem atualiza√ß√µes pendentes. Recomendamos atualizar seu sistema para maior seguran√ßa." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Inicializa√ß√£o
    $bootTime = $sysInfo.LastBootTime
    $uptime = (Get-Date) - $bootTime
    if ($uptime.Days -gt 7) {
        Write-Host "- Seu sistema est√° ligado h√° $($uptime.Days) dias. Considere reiniciar para aplicar atualiza√ß√µes e limpar a mem√≥ria." -ForegroundColor Yellow
    }
    
    Write-Host ""

    # Mensagem de conclus√£o
    Write-Host "`nDiagn√≥stico r√°pido conclu√≠do! Use as informa√ß√µes acima para decidir quais otimiza√ß√µes fazer." -ForegroundColor Green

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

function Show-AboutTORK {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Sobre o TORK ---" -ForegroundColor White
    Write-Host ""
    
    Write-Host "TORK - Otimizador para Windows" -ForegroundColor Cyan
    Write-Host "Vers√£o: 2.0" -ForegroundColor White
    Write-Host "Desenvolvido por: Partner77" -ForegroundColor White
    Write-Host ""
    
    Write-Host "=== Descri√ß√£o ===" -ForegroundColor Yellow
    Write-Host "O TORK √© uma ferramenta abrangente de otimiza√ß√£o para Windows, projetada para" -ForegroundColor Gray
    Write-Host "melhorar o desempenho do seu sistema atrav√©s de limpeza, ajustes e otimiza√ß√µes." -ForegroundColor Gray
    Write-Host "Ele oferece op√ß√µes simplificadas para usu√°rios comuns e op√ß√µes avan√ßadas para" -ForegroundColor Gray
    Write-Host "usu√°rios experientes que desejam um controle mais detalhado sobre o sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Recursos ===" -ForegroundColor Yellow
    Write-Host "- Limpeza completa do sistema" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√£o de mem√≥ria e inicializa√ß√£o" -ForegroundColor Gray
    Write-Host "- Ajustes de rede para melhor conectividade" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√µes visuais para melhor desempenho" -ForegroundColor Gray
    Write-Host "- Configura√ß√µes espec√≠ficas para jogos" -ForegroundColor Gray
    Write-Host "- Manuten√ß√£o de seguran√ßa" -ForegroundColor Gray
    Write-Host "- Diagn√≥stico r√°pido do sistema" -ForegroundColor Gray
    Write-Host "- Mais de 100 ajustes e otimiza√ß√µes avan√ßadas" -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Aviso Legal ===" -ForegroundColor Yellow
    Write-Host "Este software √© fornecido 'como est√°', sem garantias de qualquer tipo." -ForegroundColor Gray
    Write-Host "O autor n√£o se responsabiliza por quaisquer danos ou problemas causados pelo uso" -ForegroundColor Gray
    Write-Host "deste software. Use por sua conta e risco. Recomendamos sempre fazer backup" -ForegroundColor Gray
    Write-Host "dos seus dados importantes antes de realizar otimiza√ß√µes no sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Agradecimentos ===" -ForegroundColor Yellow
    Write-Host "Obrigado por escolher o TORK para otimizar seu sistema Windows!" -ForegroundColor Gray
    Write-Host "Esperamos que esta ferramenta ajude a melhorar o desempenho do seu PC." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "¬© 2023-2024 Partner77 - Todos os direitos reservados" -ForegroundColor Cyan
    Write-Host ""
    
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - LIMPEZA (Expandidas) ---
function Invoke-CleanUserTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Usu√°rio ---" -ForegroundColor Cyan
    Write-Host "Remove arquivos da pasta tempor√°ria do seu usu√°rio (`$env:TEMP`)." -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:TEMP..." -ForegroundColor Yellow
    $tempFiles = Get-ChildItem -Path $env:TEMP -Recurse -ErrorAction SilentlyContinue
    $tempFilesCount = ($tempFiles | Measure-Object).Count
    $tempFilesSize = ($tempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $tempFilesCount arquivos tempor√°rios ocupando aproximadamente $([math]::Round($tempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Sistema ---" -ForegroundColor Gray
    Write-Host "Remove arquivos da pasta tempor√°ria do Windows (`$env:SystemRoot\Temp`)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:SystemRoot\Temp..." -ForegroundColor Yellow
    $systemTempFiles = Get-ChildItem -Path "$env:SystemRoot\Temp" -Recurse -ErrorAction SilentlyContinue
    $systemTempFilesCount = ($systemTempFiles | Measure-Object).Count
    $systemTempFilesSize = ($systemTempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $systemTempFilesCount arquivos tempor√°rios do sistema ocupando aproximadamente $([math]::Round($systemTempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do sistema removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanDnsCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-EmptyRecycleBin {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Esvaziar Lixeira ---" -ForegroundColor Gray
    Write-Host "Esvazia a lixeira do usu√°rio logado." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar tamanho da lixeira antes de esvaziar
    Write-Host "Verificando tamanho da lixeira..." -ForegroundColor Yellow
    
    try {
        $shell = New-Object -ComObject Shell.Application
        $recycleBin = $shell.Namespace(0xA)
        $recycleBinItems = $recycleBin.Items()
        $recycleBinItemCount = $recycleBinItems.Count
        
        Write-Host "A lixeira cont√©m $recycleBinItemCount itens." -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o conte√∫do da lixeira." -ForegroundColor DarkGray
    }
    
    # Esvaziar a lixeira
    Write-Host "Executando: Esvaziando a lixeira..." -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanThumbnailCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Miniaturas ---" -ForegroundColor Green
    Write-Host "Remove o cache de miniaturas de arquivos (imagens, v√≠deos, etc.)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Limpando cache de miniaturas..." -ForegroundColor Yellow
    
    # Verificar tamanho do cache de miniaturas antes da limpeza
    $thumbnailPath = "$env:LOCALAPPDATA\Microsoft\Windows\Explorer"
    $thumbnailFiles = Get-ChildItem -Path $thumbnailPath -Filter "thumbcache_*.db" -ErrorAction SilentlyContinue
    $thumbnailFilesCount = ($thumbnailFiles | Measure-Object).Count
    $thumbnailFilesSize = ($thumbnailFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $thumbnailFilesCount arquivos de cache de miniaturas ocupando aproximadamente $([math]::Round($thumbnailFilesSize, 2)) MB." -ForegroundColor White
    
    # Limpar o cache de miniaturas
    Stop-Process -Name explorer -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Start-Process explorer
    
    Write-Host "Cache de miniaturas limpo com sucesso!" -ForegroundColor Green
    Write-Host "O Windows Explorer foi reiniciado para aplicar as altera√ß√µes." -ForegroundColor DarkGray
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de miniaturas:" -ForegroundColor Cyan
    Write-Host "- Navega√ß√£o mais r√°pida em pastas com muitas imagens ou v√≠deos" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de miniaturas corrompidas ou desatualizadas" -ForegroundColor DarkGray
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemLogs {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Logs do Sistema ---" -ForegroundColor Cyan
    Write-Host "Limpa os logs de eventos do sistema para liberar espa√ßo e melhorar o desempenho." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando logs do sistema..." -ForegroundColor Yellow
    
    # Verificar tamanho dos logs antes da limpeza
    $eventLogs = Get-WinEvent -ListLog * -ErrorAction SilentlyContinue | Where-Object { $_.RecordCount -gt 0 }
    $totalLogCount = ($eventLogs | Measure-Object).Count
    $total = ($eventLogs | Measure-Object -Property FileSize -Sum).Sum / 1MB
    
    Write-Host "Encontrados $totalLogCount logs de eventos ocupando aproximadamente $([math]::Round($total, 2)) MB." -ForegroundColor White
    
    # Limpar os logs principais
    Write-Host "Limpando logs principais do sistema..." -ForegroundColor Yellow
    
    $mainLogs = @("Application", "System", "Security")
    foreach ($log in $mainLogs) {
        try {
            $logSize = (Get-WinEvent -ListLog $log -ErrorAction SilentlyContinue).FileSize / 1MB
            $logRecords = (Get-WinEvent -ListLog $log -ErrorAction SilentlyContinue).RecordCount
            
            Write-Host "Log $log: $([math]::Round($logSize, 2)) MB com $logRecords registros" -ForegroundColor DarkGray
            wevtutil cl $log
            Write-Host "Log $log limpo com sucesso!" -ForegroundColor Green
        } catch {
            Write-Host "N√£o foi poss√≠vel limpar o log $log." -ForegroundColor Red
        }
    }
    
    # Perguntar se deseja limpar todos os outros logs
    $confirmAllLogs = Read-Host "Deseja limpar todos os outros logs do sistema? (s/n)"
    
    if ($confirmAllLogs -eq 's') {
        Write-Host "Limpando todos os logs do sistema... (isso pode levar algum tempo)" -ForegroundColor Yellow
        
        $otherLogs = $eventLogs | Where-Object { $_.LogName -notin $mainLogs }
        foreach ($log in $otherLogs) {
            try {
                wevtutil cl $log.LogName
            } catch {
                # Ignorar erros silenciosamente
            }
        }
        
        Write-Host "Todos os logs do sistema foram limpos!" -ForegroundColor Green
    } else {
        Write-Host "Apenas os logs principais foram limpos." -ForegroundColor Green
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanWindowsUpdateCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Atualiza√ß√µes do Windows ---" -ForegroundColor Yellow
    Write-Host "Limpa os arquivos tempor√°rios de atualiza√ß√µes do Windows para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando cache de atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    
    # Verificar tamanho da pasta SoftwareDistribution antes da limpeza
    $updateCachePath = "$env:SystemRoot\SoftwareDistribution\Download"
    $updateCacheFiles = Get-ChildItem -Path $updateCachePath -Recurse -ErrorAction SilentlyContinue
    $updateCacheSize = ($updateCacheFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "O cache de atualiza√ß√µes do Windows est√° ocupando aproximadamente $([math]::Round($updateCacheSize, 2)) MB." -ForegroundColor White
    
    # Parar o servi√ßo Windows Update
    Write-Host "Parando o servi√ßo Windows Update..." -ForegroundColor DarkGray
    Stop-Service -Name wuauserv -Force -ErrorAction SilentlyContinue
    
    # Limpar o cache de atualiza√ß√µes
    Write-Host "Limpando o cache de atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    
    # Iniciar o servi√ßo Windows Update novamente
    Write-Host "Iniciando o servi√ßo Windows Update..." -ForegroundColor DarkGray
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    
    Write-Host "Cache de atualiza√ß√µes do Windows limpo com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de atualiza√ß√µes:" -ForegroundColor Cyan
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray
    Write-Host "- Resolu√ß√£o de problemas com atualiza√ß√µes do Windows" -ForegroundColor DarkGray
    Write-Host "- Melhoria no desempenho do sistema" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanHibernationFile {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos de Hiberna√ß√£o ---" -ForegroundColor White
    Write-Host "Gerencia o arquivo de hiberna√ß√£o (hiberfil.sys) para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar status atual da hiberna√ß√£o
    Write-Host "Verificando status atual da hiberna√ß√£o..." -ForegroundColor Yellow
    $hibernationStatus = powercfg.exe /availablesleepstates | Select-String -Pattern "Hiberna√ß√£o"
    
    if ($hibernationStatus -match "Hiberna√ß√£o est√° desativada") {
        $currentStatus = "desativada"
    } else {
        $currentStatus = "ativada"
    }
    
    Write-Host "Status atual da hiberna√ß√£o: $currentStatus" -ForegroundColor White
    
    # Verificar tamanho do arquivo de hiberna√ß√£o (se existir)
    $systemDrive = $env:SystemDrive
    $hiberfilPath = "$systemDrive\hiberfil.sys"
    
    if (Test-Path -Path $hiberfilPath -ErrorAction SilentlyContinue) {
        try {
            $hiberfilSize = (Get-Item -Path $hiberfilPath -Force -ErrorAction SilentlyContinue).Length / 1GB
            Write-Host "Tamanho do arquivo de hiberna√ß√£o: $([math]::Round($hiberfilSize, 2)) GB" -ForegroundColor White
        } catch {
            Write-Host "N√£o foi poss√≠vel determinar o tamanho do arquivo de hiberna√ß√£o." -ForegroundColor DarkGray
        }
    } else {
        Write-Host "Arquivo de hiberna√ß√£o n√£o encontrado (j√° est√° desativado)." -ForegroundColor DarkGray
    }
    
    # Perguntar se deseja desativar ou ativar a hiberna√ß√£o
    if ($currentStatus -eq "ativada") {
        $confirmHibernation = Read-Host "Deseja desativar a hiberna√ß√£o para liberar espa√ßo em disco? (s/n)"
        
        if ($confirmHibernation -eq 's') {
            Write-Host "Desativando a hiberna√ß√£o..." -ForegroundColor Yellow
            powercfg.exe /hibernate off
            Write-Host "Hiberna√ß√£o desativada com sucesso! O arquivo hiberfil.sys foi removido." -ForegroundColor Green
        } else {
            Write-Host "Hiberna√ß√£o mantida ativada." -ForegroundColor Green
        }
    } else {
        $confirmHibernation = Read-Host "Deseja ativar a hiberna√ß√£o? (s/n)"
        
        if ($confirmHibernation -eq 's') {
            Write-Host "Ativando a hiberna√ß√£o..." -ForegroundColor Yellow
            powercfg.exe /hibernate on
            Write-Host "Hiberna√ß√£o ativada com sucesso! O arquivo hiberfil.sys foi criado." -ForegroundColor Green
            
            # Verificar novo tamanho do arquivo de hiberna√ß√£o
            if (Test-Path -Path $hiberfilPath -ErrorAction SilentlyContinue) {
                try {
                    $newHiberfilSize = (Get-Item -Path $hiberfilPath -Force -ErrorAction SilentlyContinue).Length / 1GB
                    Write-Host "Tamanho do novo arquivo de hiberna√ß√£o: $([math]::Round($newHiberfilSize, 2)) GB" -ForegroundColor White
                } catch {
                    Write-Host "N√£o foi poss√≠vel determinar o tamanho do novo arquivo de hiberna√ß√£o." -ForegroundColor DarkGray
                }
            }
        } else {
            Write-Host "Hiberna√ß√£o mantida desativada." -ForegroundColor Green
        }
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo foi afetado:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nInforma√ß√µes sobre a hiberna√ß√£o:" -ForegroundColor Cyan
    Write-Host "- O arquivo de hiberna√ß√£o (hiberfil.sys) geralmente ocupa espa√ßo equivalente a 75% da RAM instalada" -ForegroundColor DarkGray
    Write-Host "- Desativar a hiberna√ß√£o libera esse espa√ßo, mas voc√™ n√£o poder√° usar o modo de hiberna√ß√£o" -ForegroundColor DarkGray
    Write-Host "- A hiberna√ß√£o √© √∫til para laptops, pois salva o estado do sistema no disco antes de desligar" -ForegroundColor DarkGray
    Write-Host "- Para desktops, a hiberna√ß√£o geralmente √© menos necess√°ria" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanWinSxS {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Pasta WinSxS ---" -ForegroundColor Magenta
    Write-Host "Limpa componentes n√£o utilizados da pasta WinSxS para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "A pasta WinSxS (Windows Side-by-Side) armazena componentes do sistema e pode ocupar muito espa√ßo." -ForegroundColor White
    Write-Host "Esta limpeza √© segura e usa ferramentas oficiais do Windows para remover componentes n√£o utilizados." -ForegroundColor White
    Write-Host ""
    
    # Verificar tamanho da pasta WinSxS antes da limpeza
    Write-Host "Verificando tamanho da pasta WinSxS (isso pode levar algum tempo)..." -ForegroundColor Yellow
    
    try {
        $winSxSSize = (Get-ChildItem -Path "$env:SystemRoot\WinSxS" -Recurse -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum / 1GB
        Write-Host "Tamanho atual da pasta WinSxS: $([math]::Round($winSxSSize, 2)) GB" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel determinar o tamanho da pasta WinSxS." -ForegroundColor DarkGray
    }
    
    # Perguntar se deseja prosseguir com a limpeza
    $confirmCleanup = Read-Host "Deseja prosseguir com a limpeza da pasta WinSxS? (s/n)"
    
    if ($confirmCleanup -eq 's') {
        Write-Host "Executando limpeza de componentes n√£o utilizados (isso pode levar v√°rios minutos)..." -ForegroundColor Yellow
        
        # Executar limpeza de componentes
        Write-Host "Etapa 1: Limpeza de componentes..." -ForegroundColor DarkGray
        Dism.exe /Online /Cleanup-Image /StartComponentCleanup
        
        # Perguntar se deseja executar limpeza mais agressiva (com reset base)
        $confirmResetBase = Read-Host "Deseja executar uma limpeza mais profunda? (remove a capacidade de desinstalar atualiza√ß√µes) (s/n)"
        
        if ($confirmResetBase -eq 's') {
            Write-Host "Etapa 2: Executando limpeza profunda (isso pode levar muito tempo)..." -ForegroundColor DarkGray
            Dism.exe /Online /Cleanup-Image /StartComponentCleanup /ResetBase
            Write-Host "Limpeza profunda conclu√≠da!" -ForegroundColor Green
        }
        
        Write-Host "Limpeza da pasta WinSxS conclu√≠da com sucesso!" -ForegroundColor Green
        
        # Verificar tamanho da pasta WinSxS ap√≥s a limpeza
        try {
            $newWinSxSSize = (Get-ChildItem -Path "$env:SystemRoot\WinSxS" -Recurse -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum / 1GB
            $savedSpace = $winSxSSize - $newWinSxSSize
            
            Write-Host "Tamanho atual da pasta WinSxS: $([math]::Round($newWinSxSSize, 2)) GB" -ForegroundColor White
            Write-Host "Espa√ßo liberado: $([math]::Round($savedSpace, 2)) GB" -ForegroundColor Green
        } catch {
            Write-Host "N√£o foi poss√≠vel determinar o novo tamanho da pasta WinSxS." -ForegroundColor DarkGray
        }
    } else {
        Write-Host "Limpeza da pasta WinSxS cancelada." -ForegroundColor Yellow
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nInforma√ß√µes sobre a pasta WinSxS:" -ForegroundColor Cyan
    Write-Host "- A pasta WinSxS armazena componentes do sistema Windows e atualiza√ß√µes" -ForegroundColor DarkGray
    Write-Host "- N√£o √© recomendado excluir esta pasta manualmente" -ForegroundColor DarkGray
    Write-Host "- A limpeza realizada √© segura e usa ferramentas oficiais do Windows" -ForegroundColor DarkGray
    Write-Host "- Ap√≥s a limpeza profunda, n√£o ser√° poss√≠vel desinstalar algumas atualiza√ß√µes" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - REDE (Expandidas) ---
function Invoke-NetworkFlushDns {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Limpar Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-NetworkChangeDns {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Mudar Servidor DNS ---" -ForegroundColor Cyan
    Write-Host "Permite definir servidores DNS personalizados para suas conex√µes de rede." -ForegroundColor DarkGray
    Write-Host ""

    # Listar adaptadores de rede ativos
    Write-Host "Listando adaptadores de rede ativos..." -ForegroundColor Yellow
    $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" }
    
    if ($networkAdapters.Count -eq 0) {
        Write-Host "Nenhum adaptador de rede ativo encontrado." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    Write-Host "Adaptadores de rede ativos:" -ForegroundColor White
    $index = 1
    foreach ($adapter in $networkAdapters) {
        Write-Host "[$index] $($adapter.Name) - $($adapter.InterfaceDescription)" -ForegroundColor White
        $index++
    }
    Write-Host ""
    
    # Selecionar adaptador de rede
    $adapterChoice = Read-Host "Selecione o n√∫mero do adaptador que deseja configurar (ou 0 para voltar)"
    
    if ($adapterChoice -eq "0" -or $adapterChoice -eq "") {
        Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    $adapterIndex = [int]$adapterChoice - 1
    if ($adapterIndex -lt 0 -or $adapterIndex -ge $networkAdapters.Count) {
        Write-Host "Sele√ß√£o inv√°lida." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    $selectedAdapter = $networkAdapters[$adapterIndex]
    
    # Mostrar configura√ß√£o DNS atual
    Write-Host "Configura√ß√£o DNS atual para $($selectedAdapter.Name):" -ForegroundColor Yellow
    $currentDns = Get-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -AddressFamily IPv4 | Select-Object -ExpandProperty ServerAddresses
    
    if ($currentDns.Count -eq 0) {
        Write-Host "Nenhum servidor DNS configurado manualmente (usando DHCP)." -ForegroundColor DarkGray
    } else {
        foreach ($dns in $currentDns) {
            Write-Host $dns -ForegroundColor White
        }
    }
    Write-Host ""
    
    # Op√ß√µes de DNS
    Write-Host "Op√ß√µes de DNS:" -ForegroundColor Yellow
    Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
    Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
    Write-Host "[3] OpenDNS (208.67.222.222, 208.67.220.220)" -ForegroundColor White
    Write-Host "[4] Quad9 (9.9.9.9, 149.112.112.112)" -ForegroundColor White
    Write-Host "[5] AdGuard DNS (94.140.14.14, 94.140.15.15)" -ForegroundColor White
    Write-Host "[6] Inserir DNS personalizado" -ForegroundColor White
    Write-Host "[7] Usar DNS autom√°tico (DHCP)" -ForegroundColor White
    Write-Host "[0] Cancelar" -ForegroundColor White
    Write-Host ""
    
    $dnsChoice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($dnsChoice) {
        "1" {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            $dnsName = "Google DNS"
        }
        "2" {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            $dnsName = "Cloudflare DNS"
        }
        "3" {
            $primaryDns = "208.67.222.222"
            $secondaryDns = "208.67.220.220"
            $dnsName = "OpenDNS"
        }
        "4" {
            $primaryDns = "9.9.9.9"
            $secondaryDns = "149.112.112.112"
            $dnsName = "Quad9"
        }
        "5" {
            $primaryDns = "94.140.14.14"
            $secondaryDns = "94.140.15.15"
            $dnsName = "AdGuard DNS"
        }
        "6" {
            $primaryDns = Read-Host "Digite o endere√ßo do DNS prim√°rio"
            $secondaryDns = Read-Host "Digite o endere√ßo do DNS secund√°rio (ou deixe em branco)"
            $dnsName = "DNS Personalizado"
        }
        "7" {
            Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ResetServerAddresses
            Write-Host "Configura√ß√£o de DNS definida para autom√°tica (DHCP)." -ForegroundColor Green
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
        "0" {
            Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
        default {
            Write-Host "Op√ß√£o inv√°lida." -ForegroundColor Red
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
    }
    
    # Aplicar configura√ß√£o de DNS
    if ($secondaryDns -eq "") {
        Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ServerAddresses $primaryDns
    } else {
        Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ServerAddresses $primaryDns, $secondaryDns
    }
    
    Write-Host "Configura√ß√£o de DNS alterada para $dnsName." -ForegroundColor Green
    Write-Host "DNS Prim√°rio: $primaryDns" -ForegroundColor White
    if ($secondaryDns -ne "") {
        Write-Host "DNS Secund√°rio: $secondaryDns" -ForegroundColor White
    }
    
    # Limpar cache DNS ap√≥s a mudan√ßa
    Write-Host "Limpando cache DNS para aplicar as altera√ß√µes..." -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo." -ForegroundColor Green
    
    Write-Host "`nBenef√≠cios de usar servidores DNS alternativos:" -ForegroundColor Cyan
    Write-Host "- Maior velocidade de resolu√ß√£o de nomes" -ForegroundColor DarkGray
    Write-Host "- Melhor confiabilidade e disponibilidade" -ForegroundColor DarkGray
    Write-Host "- Alguns servidores oferecem prote√ß√£o adicional contra malware e phishing" -ForegroundColor DarkGray
    Write-Host "- Possibilidade de contornar bloqueios de conte√∫do baseados em DNS" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-NetworkReset {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Resetar Configura√ß√µes de Rede ---" -ForegroundColor White
    Write-Host "Reinicia os componentes de rede. Use como √∫ltimo recurso para solucionar problemas de conex√£o." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "!!! ATEN√á√ÉO: ESTE COMANDO VAI REINICIAR SUAS CONFIGURA√á√ïES DE REDE !!!" -ForegroundColor Red
    Write-Host "Sua conex√£o ser√° interrompida temporariamente e todas as configura√ß√µes de rede personalizadas ser√£o redefinidas." -ForegroundColor Yellow
    Write-Host "Isso inclui adaptadores de rede, configura√ß√µes de DNS, configura√ß√µes de proxy, etc." -ForegroundColor Yellow
    Write-Host ""
    
    Write-Host "Esta opera√ß√£o pode ajudar a resolver os seguintes problemas:" -ForegroundColor Cyan
    Write-Host "- Conex√µes de rede inst√°veis ou intermitentes" -ForegroundColor DarkGray
    Write-Host "- Problemas de DNS ou resolu√ß√£o de nomes" -ForegroundColor DarkGray
    Write-Host "- Problemas de conectividade ap√≥s instala√ß√£o de software ou atualiza√ß√µes" -ForegroundColor DarkGray
    Write-Host "- Erros de rede persistentes que n√£o s√£o resolvidos por outros m√©todos" -ForegroundColor DarkGray
    Write-Host ""
    
    $confirm = Read-Host "Tem certeza que deseja resetar as configura√ß√µes de rede? (digite 'sim' para confirmar)"
    
    if ($confirm -eq 'sim') {
        Write-Host "Iniciando reset de configura√ß√µes de rede..." -ForegroundColor Yellow
        
        # Etapa 1: Resetar pilha TCP/IP
        Write-Host "Etapa 1: Resetando pilha TCP/IP..." -ForegroundColor DarkGray
        netsh int ip reset
        
        # Etapa 2: Resetar cat√°logo Winsock
        Write-Host "Etapa 2: Resetando cat√°logo Winsock..." -ForegroundColor DarkGray
        netsh winsock reset
        
        # Etapa 3: Limpar cache DNS
        Write-Host "Etapa 3: Limpando cache DNS..." -ForegroundColor DarkGray
        ipconfig /flushdns
        
        # Etapa 4: Renovar configura√ß√µes DHCP
        Write-Host "Etapa 4: Renovando configura√ß√µes DHCP..." -ForegroundColor DarkGray
        ipconfig /release
        ipconfig /renew
        
        # Etapa 5: Reiniciar adaptadores de rede
        Write-Host "Etapa 5: Reiniciando adaptadores de rede..." -ForegroundColor DarkGray
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        
        Write-Host "Reset de configura√ß√µes de rede conclu√≠do!" -ForegroundColor Green
        Write-Host "Recomenda-se reiniciar o computador para aplicar todas as altera√ß√µes." -ForegroundColor Yellow
        
        $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (s/n)"
        if ($confirmRestart -eq 's') {
            Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
            Restart-Computer -Force
        } else {
            Write-Host "Rein√≠cio cancelado. Algumas altera√ß√µes podem n√£o ter efeito at√© que o computador seja reiniciado." -ForegroundColor Yellow
        }
    } else {
        Write-Host "Reset de configura√ß√µes de rede cancelado." -ForegroundColor Green
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-OptimizeTcpIp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Otimizar Configura√ß√µes TCP/IP ---" -ForegroundColor Green
    Write-Host "Ajusta configura√ß√µes avan√ßadas do TCP/IP para melhorar o desempenho da conex√£o." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o otimiza v√°rios par√¢metros TCP/IP para melhorar a velocidade e estabilidade da conex√£o." -ForegroundColor White
    Write-Host "As otimiza√ß√µes s√£o seguras e podem ser revertidas se necess√°rio." -ForegroundColor White
    Write-Host ""
    
    Write-Host "Configura√ß√µes atuais:" -ForegroundColor Yellow
    
    # Mostrar configura√ß√µes atuais
    Write-Host "Auto-Tuning Level:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Auto-Tuning Level"
    
    Write-Host "Congestion Provider:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Congestion Control Provider"
    
    Write-Host "ECN Capability:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "ECN Capability"
    
    Write-Host "Receive-Side Scaling (RSS):" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Receive-Side Scaling State"
    
    Write-Host ""
    $confirm = Read-Host "Deseja aplicar otimiza√ß√µes TCP/IP recomendadas? (s/n)"
    
    if ($confirm -eq 's') {
        Write-Host "Aplicando otimiza√ß√µes TCP/IP..." -ForegroundColor Yellow
        
        # Otimiza√ß√£o 1: Habilitar TCP Window Auto-Tuning
        Write-Host "Configurando TCP Auto-Tuning para 'normal'..." -ForegroundColor DarkGray
        netsh int tcp set global autotuninglevel=normal
        
        # Otimiza√ß√£o 2: Habilitar Receive-Side Scaling (RSS)
        Write-Host "Habilitando Receive-Side Scaling (RSS)..." -ForegroundColor DarkGray
        netsh int tcp set global rss=enabled
        
        # Otimiza√ß√£o 3: Configurar Congestion Provider para CTCP
        Write-Host "Configurando Congestion Provider para 'ctcp'..." -ForegroundColor DarkGray
        netsh int tcp set global congestionprovider=ctcp
        
        # Otimiza√ß√£o 4: Habilitar ECN Capability
        Write-Host "Habilitando ECN Capability..." -ForegroundColor DarkGray
        netsh int tcp set global ecncapability=enabled
        
        # Otimiza√ß√£o 5: Configurar NetDMA (se dispon√≠vel)
        Write-Host "Tentando configurar NetDMA..." -ForegroundColor DarkGray
        netsh int tcp set global netdma=enabled
        
        # Otimiza√ß√£o 6: Configurar tamanho de buffer TCP
        Write-Host "Configurando tamanho de buffer TCP..." -ForegroundColor DarkGray
        netsh int tcp set global chimney=enabled
        
        # Otimiza√ß√£o 7: Configurar QoS
        Write-Host "Configurando QoS..." -ForegroundColor DarkGray
        netsh int tcp set global timestamps=disabled
        
        Write-Host "Otimiza√ß√µes TCP/IP aplicadas com sucesso!" -ForegroundColor Green
        
        Write-Host "`nNovas configura√ß√µes:" -ForegroundColor Yellow
        
        # Mostrar novas configura√ß√µes
        Write-Host "Auto-Tuning Level:" -ForegroundColor DarkGray
        netsh int tcp show global | Select-String "Auto-Tuning Level"
        
        Write-Host "Congestion Provider:" -ForegroundColor DarkGray
        netsh int tcp show global | Select-String "Congestion Control Provider"
        
        Write-Host "ECN Capability:" -ForegroundColor DarkGray
        netsh int tcp show global | Select-String "ECN Capability"
        
        Write-Host "Receive-Side Scaling (RSS):" -ForegroundColor DarkGray
        netsh int tcp show global | Select-String "Receive-Side Scaling State"
        
        Write-Host "`nBenef√≠cios das otimiza√ß√µes TCP/IP:" -ForegroundColor Cyan
        Write-Host "- Melhor aproveitamento da largura de banda dispon√≠vel" -ForegroundColor DarkGray
        Write-Host "- Redu√ß√£o da lat√™ncia em conex√µes de internet" -ForegroundColor DarkGray
        Write-Host "- Melhor desempenho em downloads e uploads" -ForegroundColor DarkGray
        Write-Host "- Conex√µes mais est√°veis em redes congestionadas" -ForegroundColor DarkGray
        
        Write-Host "`nNota: Algumas altera√ß√µes podem requerer reinicializa√ß√£o para ter efeito completo." -ForegroundColor Yellow
        $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (s/n)"
        
        if ($confirmRestart -eq 's') {
            Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
            Restart-Computer -Force
        }
    } else {
        Write-Host "Otimiza√ß√µes TCP/IP canceladas." -ForegroundColor Yellow
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-CheckNetworkSpeed {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Verificar Velocidade da Conex√£o ---" -ForegroundColor Magenta
    Write-Host "Realiza testes para verificar a velocidade e qualidade da sua conex√£o com a internet." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o realiza testes b√°sicos para avaliar a velocidade e qualidade da sua conex√£o." -ForegroundColor White
    Write-Host "Nota: Para testes de velocidade mais precisos, recomendamos usar sites especializados como speedtest.net" -ForegroundColor White
    Write-Host ""
    
    # Teste 1: Verificar conectividade b√°sica
    Write-Host "Teste 1: Verificando conectividade b√°sica com a internet..." -ForegroundColor Yellow
    $pingGoogle = Test-Connection -ComputerName google.com -Count 4 -ErrorAction SilentlyContinue
    
    if ($pingGoogle) {
        $avgLatency = ($pingGoogle | Measure-Object -Property ResponseTime -Average).Average
        $maxLatency = ($pingGoogle | Measure-Object -Property ResponseTime -Maximum).Maximum
        $minLatency = ($pingGoogle | Measure-Object -Property ResponseTime -Minimum).Minimum
        
        Write-Host "Conectividade: OK" -ForegroundColor Green
        Write-Host "Lat√™ncia m√©dia: $avgLatency ms" -ForegroundColor $(if ($avgLatency -lt 50) { "Green" } elseif ($avgLatency -lt 100) { "Yellow" } else { "Red" })
        Write-Host "Lat√™ncia m√≠nima: $minLatency ms" -ForegroundColor Green
        Write-Host "Lat√™ncia m√°xima: $maxLatency ms" -ForegroundColor $(if ($maxLatency -lt 100) { "Green" } elseif ($maxLatency -lt 200) { "Yellow" } else { "Red" })
        
        # Avalia√ß√£o da qualidade da conex√£o
        if ($avgLatency -lt 30) {
            $qualidade = "Excelente"
            $cor = "Green"
        } elseif ($avgLatency -lt 60) {
            $qualidade = "Boa"
            $cor = "Green"
        } elseif ($avgLatency -lt 100) {
            $qualidade = "Razo√°vel"
            $cor = "Yellow"
        } else {
            $qualidade = "Ruim"
            $cor = "Red"
        }
        
        Write-Host "Qualidade da conex√£o: $qualidade" -ForegroundColor $cor
    } else {
        Write-Host "N√£o foi poss√≠vel conectar √† internet. Verifique sua conex√£o." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    Write-Host ""
    
    # Teste 2: Verificar resolu√ß√£o DNS
    Write-Host "Teste 2: Verificando velocidade de resolu√ß√£o DNS..." -ForegroundColor Yellow
    $domains = @("google.com", "microsoft.com", "amazon.com", "facebook.com", "youtube.com")
    $dnsResults = @()
    
    foreach ($domain in $domains) {
        $startTime = Get-Date
        try {
            $null = Resolve-DnsName -Name $domain -ErrorAction SilentlyContinue
            $endTime = Get-Date
            $timeSpan = New-TimeSpan -Start $startTime -End $endTime
            $dnsResults += [PSCustomObject]@{
                Domain = $domain
                Time = $timeSpan.TotalMilliseconds
                Status = "OK"
            }
        } catch {
            $dnsResults += [PSCustomObject]@{
                Domain = $domain
                Time = 0
                Status = "Falha"
            }
        }
    }
    
    $dnsResults | Format-Table -AutoSize
    
    $avgDnsTime = ($dnsResults | Where-Object { $_.Status -eq "OK" } | Measure-Object -Property Time -Average).Average
    Write-Host "Tempo m√©dio de resolu√ß√£o DNS: $([math]::Round($avgDnsTime, 2)) ms" -ForegroundColor $(if ($avgDnsTime -lt 50) { "Green" } elseif ($avgDnsTime -lt 100) { "Yellow" } else { "Red" })
    
    Write-Host ""
    
    # Teste 3: Verificar MTU
    Write-Host "Teste 3: Verificando MTU (Maximum Transmission Unit)..." -ForegroundColor Yellow
    
    $activeAdapter = Get-NetAdapter | Where-Object { $_.Status -eq "Up" } | Select-Object -First 1
    if ($activeAdapter) {
        $mtu = Get-NetIPInterface -InterfaceIndex $activeAdapter.ifIndex -AddressFamily IPv4 | Select-Object -ExpandProperty NlMtu
        Write-Host "MTU atual: $mtu bytes" -ForegroundColor White
        
        if ($mtu -eq 1500) {
            Write-Host "MTU est√° no valor padr√£o (1500), que √© ideal para a maioria das conex√µes." -ForegroundColor Green
        } elseif ($mtu -lt 1500) {
            Write-Host "MTU est√° abaixo do valor padr√£o. Isso pode afetar o desempenho em algumas situa√ß√µes." -ForegroundColor Yellow
        } else {
            Write-Host "MTU est√° acima do valor padr√£o. Isso pode causar fragmenta√ß√£o de pacotes em algumas redes." -ForegroundColor Yellow
        }
    } else {
        Write-Host "N√£o foi poss√≠vel determinar o MTU. Nenhum adaptador de rede ativo encontrado." -ForegroundColor Red
    }
    
    Write-Host ""
    
    # Teste 4: Verificar perda de pacotes
    Write-Host "Teste 4: Verificando perda de pacotes..." -ForegroundColor Yellow
    $packetLossTest = Test-Connection -ComputerName google.com -Count 50 -ErrorAction SilentlyContinue
    
    if ($packetLossTest) {
        $packetsSent = 50
        $packetsReceived = ($packetLossTest | Measure-Object).Count
        $packetsLost = $packetsSent - $packetsReceived
        $packetLossPercentage = ($packetsLost / $packetsSent) * 100
        
        Write-Host "Pacotes enviados: $packetsSent" -ForegroundColor White
        Write-Host "Pacotes recebidos: $packetsReceived" -ForegroundColor White
        Write-Host "Pacotes perdidos: $packetsLost" -ForegroundColor $(if ($packetsLost -eq 0) { "Green" } elseif ($packetsLost -lt 5) { "Yellow" } else { "Red" })
        Write-Host "Percentual de perda: $([math]::Round($packetLossPercentage, 2))%" -ForegroundColor $(if ($packetLossPercentage -eq 0) { "Green" } elseif ($packetLossPercentage -lt 10) { "Yellow" } else { "Red" })
        
        # Avalia√ß√£o da qualidade da conex√£o baseada na perda de pacotes
        if ($packetLossPercentage -eq 0) {
            Write-Host "Qualidade da conex√£o (perda de pacotes): Excelente" -ForegroundColor Green
        } elseif ($packetLossPercentage -lt 2) {
            Write-Host "Qualidade da conex√£o (perda de pacotes): Boa" -ForegroundColor Green
        } elseif ($packetLossPercentage -lt 5) {
            Write-Host "Qualidade da conex√£o (perda de pacotes): Razo√°vel" -ForegroundColor Yellow
        } else {
            Write-Host "Qualidade da conex√£o (perda de pacotes): Ruim" -ForegroundColor Red
        }
    } else {
        Write-Host "N√£o foi poss√≠vel realizar o teste de perda de pacotes." -ForegroundColor Red
    }
    
    Write-Host ""
    
    # Resumo e recomenda√ß√µes
    Write-Host "=== Resumo da An√°lise de Rede ===" -ForegroundColor Cyan
    
    # Recomenda√ß√µes baseadas nos resultados
    Write-Host "Recomenda√ß√µes:" -ForegroundColor Yellow
    
    if ($avgLatency -gt 100) {
        Write-Host "- Sua lat√™ncia est√° alta. Considere verificar outros dispositivos na rede ou contatar seu provedor." -ForegroundColor Yellow
    }
    
    if ($avgDnsTime -gt 100) {
        Write-Host "- A resolu√ß√£o DNS est√° lenta. Considere mudar para servidores DNS mais r√°pidos como Google (8.8.8.8) ou Cloudflare (1.1.1.1)." -ForegroundColor Yellow
    }
    
    if ($packetLossPercentage -gt 2) {
        Write-Host "- H√° perda significativa de pacotes. Verifique sua conex√£o f√≠sica ou contate seu provedor." -ForegroundColor Yellow
    }
    
    if ($mtu -ne 1500 -and $mtu -ne 0) {
        Write-Host "- Seu MTU n√£o est√° no valor padr√£o. Considere ajust√°-lo para 1500 para melhor desempenho." -ForegroundColor Yellow
    }
    
    if ($avgLatency -le 100 -and $avgDnsTime -le 100 -and $packetLossPercentage -le 2) {
        Write-Host "- Sua conex√£o parece estar em boas condi√ß√µes! N√£o h√° problemas significativos detectados." -ForegroundColor Green
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-ConfigureQoS {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Configurar QoS (Qualidade de Servi√ßo) ---" -ForegroundColor Gray
    Write-Host "Configura prioridades de tr√°fego de rede para melhorar o desempenho de aplica√ß√µes espec√≠ficas." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "O QoS (Quality of Service) permite priorizar certos tipos de tr√°fego de rede sobre outros." -ForegroundColor White
    Write-Host "Isso √© √∫til para garantir que aplica√ß√µes importantes como jogos, chamadas de v√≠deo ou streaming" -ForegroundColor White
    Write-Host "tenham prioridade sobre downloads ou atualiza√ß√µes em segundo plano." -ForegroundColor White
    Write-Host ""
    
    Write-Host "Op√ß√µes de configura√ß√£o de QoS:" -ForegroundColor Yellow
    Write-Host "[1] Configurar QoS para Jogos (prioriza tr√°fego de jogos)" -ForegroundColor White
    Write-Host "[2] Configurar QoS para Videoconfer√™ncia (prioriza Zoom, Teams, etc.)" -ForegroundColor White
    Write-Host "[3] Configurar QoS para Streaming (prioriza Netflix, YouTube, etc.)" -ForegroundColor White
    Write-Host "[4] Configurar QoS Personalizado" -ForegroundColor White
    Write-Host "[5] Desativar QoS" -ForegroundColor White
    Write-Host "[0] Voltar" -ForegroundColor White
    Write-Host ""
    
    $qosChoice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($qosChoice) {
        "1" {
            Write-Host "Configurando QoS para Jogos..." -ForegroundColor Yellow
            
            # Criar pol√≠tica de QoS para jogos
            Write-Host "Criando pol√≠tica de QoS para jogos..." -ForegroundColor DarkGray
            
            # Verificar se o servi√ßo QoS est√° em execu√ß√£o
            $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            if ($qosService -and $qosService.Status -ne "Running") {
                Write-Host "Iniciando servi√ßo QoS RSVP..." -ForegroundColor DarkGray
                Start-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            }
            
            # Configurar QoS para jogos usando netsh
            netsh advfirewall firewall add rule name="QoS-Games" dir=out action=allow protocol=UDP remoteport=3074,3478,3479,3480 enable=yes
            
            # Configurar prioridade para jogos
            if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS")) {
                New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Force | Out-Null
            }
            
            # Adicionar pol√≠tica para jogos
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Application Name" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Protocol" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Remote Port" -Value "3074,3478-3480" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "DSCP Value" -Value "46" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Throttle Rate" -Value "-1" -Type String
            
            Write-Host "QoS para Jogos configurado com sucesso!" -ForegroundColor Green
            Write-Host "Os jogos online agora ter√£o prioridade sobre outros tipos de tr√°fego." -ForegroundColor Green
        }
        "2" {
            Write-Host "Configurando QoS para Videoconfer√™ncia..." -ForegroundColor Yellow
            
            # Criar pol√≠tica de QoS para videoconfer√™ncia
            Write-Host "Criando pol√≠tica de QoS para videoconfer√™ncia..." -ForegroundColor DarkGray
            
            # Verificar se o servi√ßo QoS est√° em execu√ß√£o
            $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            if ($qosService -and $qosService.Status -ne "Running") {
                Write-Host "Iniciando servi√ßo QoS RSVP..." -ForegroundColor DarkGray
                Start-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            }
            
            # Configurar QoS para videoconfer√™ncia usando netsh
            netsh advfirewall firewall add rule name="QoS-VideoConference" dir=out action=allow protocol=UDP remoteport=3478-3479,8801-8810 enable=yes
            
            # Configurar prioridade para videoconfer√™ncia
            if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS")) {
                New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Force | Out-Null
            }
            
            # Adicionar pol√≠tica para Zoom
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Application Name" -Value "Zoom.exe" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Protocol" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Remote Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "DSCP Value" -Value "46" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Throttle Rate" -Value "-1" -Type String
            
            # Adicionar pol√≠tica para Teams
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Application Name" -Value "Teams.exe" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Protocol" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Remote Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "DSCP Value" -Value "46" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Throttle Rate" -Value "-1" -Type String
            
            Write-Host "QoS para Videoconfer√™ncia configurado com sucesso!" -ForegroundColor Green
            Write-Host "Aplicativos como Zoom e Teams agora ter√£o prioridade sobre outros tipos de tr√°fego." -ForegroundColor Green
        }
        "3" {
            Write-Host "Configurando QoS para Streaming..." -ForegroundColor Yellow
            
            # Criar pol√≠tica de QoS para streaming
            Write-Host "Criando pol√≠tica de QoS para streaming..." -ForegroundColor DarkGray
            
            # Verificar se o servi√ßo QoS est√° em execu√ß√£o
            $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            if ($qosService -and $qosService.Status -ne "Running") {
                Write-Host "Iniciando servi√ßo QoS RSVP..." -ForegroundColor DarkGray
                Start-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            }
            
            # Configurar QoS para streaming usando netsh
            netsh advfirewall firewall add rule name="QoS-Streaming" dir=out action=allow protocol=TCP remoteport=80,443 enable=yes
            
            # Configurar prioridade para streaming
            if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS")) {
                New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Force | Out-Null
            }
            
            # Adicionar pol√≠tica para navegadores (streaming)
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Application Name" -Value "*.exe" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Protocol" -Value "TCP" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Remote Port" -Value "80,443" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "DSCP Value" -Value "34" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Throttle Rate" -Value "-1" -Type String
            
            Write-Host "QoS para Streaming configurado com sucesso!" -ForegroundColor Green
            Write-Host "Servi√ßos de streaming como Netflix e YouTube agora ter√£o prioridade sobre outros tipos de tr√°fego." -ForegroundColor Green
        }
        "4" {
            Write-Host "Configurando QoS Personalizado..." -ForegroundColor Yellow
            
            # Solicitar informa√ß√µes para QoS personalizado
            $appName = Read-Host "Digite o nome do aplicativo (ex: chrome.exe, ou * para todos)"
            $protocol = Read-Host "Digite o protocolo (TCP, UDP, ou * para ambos)"
            $remotePorts = Read-Host "Digite as portas remotas (ex: 80,443, ou * para todas)"
            $priority = Read-Host "Digite o valor de prioridade DSCP (0-63, recomendado: 46 para alta prioridade)"
            
            # Verificar se o servi√ßo QoS est√° em execu√ß√£o
            $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            if ($qosService -and $qosService.Status -ne "Running") {
                Write-Host "Iniciando servi√ßo QoS RSVP..." -ForegroundColor DarkGray
                Start-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            }
            
            # Configurar QoS personalizado
            if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS")) {
                New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Force | Out-Null
            }
            
            # Adicionar pol√≠tica personalizada
            $policyName = "CustomQoS_" + (Get-Random)
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Application Name" -Value $appName -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Protocol" -Value $protocol -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Remote Port" -Value $remotePorts -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "DSCP Value" -Value $priority -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Throttle Rate" -Value "-1" -Type String
            
            Write-Host "QoS Personalizado configurado com sucesso!" -ForegroundColor Green
            Write-Host "A pol√≠tica de QoS personalizada foi criada com o nome: $policyName" -ForegroundColor Green
        }
        "5" {
            Write-Host "Desativando QoS..." -ForegroundColor Yellow
            
            # Remover pol√≠ticas de QoS
            if (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS") {
                Remove-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Recurse -Force
                Write-Host "Pol√≠ticas de QoS removidas." -ForegroundColor Green
            }
            
            # Remover regras de firewall relacionadas a QoS
            netsh advfirewall firewall delete rule name="QoS-Games"
            netsh advfirewall firewall delete rule name="QoS-VideoConference"
            netsh advfirewall firewall delete rule name="QoS-Streaming"
            
            # Parar servi√ßo QoS
            $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            if ($qosService) {
                Stop-Service -Name "QoS RSVP" -Force -ErrorAction SilentlyContinue
                Set-Service -Name "QoS RSVP" -Startup### Enhanced TORK Optimizer

I'll enhance the TORK optimizer with more comprehensive functionality across all features, starting with an expanded Simple Cleanup function and then improving all other options.

```powershell type="code"
# Define a preferencia de acao para erros (continua a execucao por padrao)
# Permite que o script tente rodar o m√°ximo poss√≠vel mesmo que alguns comandos encontrem problemas.
$ErrorActionPreference = 'SilentlyContinue' # N√£o exibe erros se um item n√£o puder ser processado, por exemplo.

# --- Funcao pra Centralizar Texto (Nosso Maestro de Alinhamento - s√≥ pra textos, n√£o pro bannerz√£o!) ---
# Deixa ela aqui, vai que a gente usa pra centralizar outra coisa, n√©?
function Centraliza($texto, $cor="White") {
    $largura = [console]::WindowWidth # Pega a largura da largura da janela agora
    # Calcula o espa√ßo pra botar o texto no meio. Pura matem√°tica da zoeira!
    $espacos = [Math]::Max(0, [Math]::Floor(($largura - $texto.Length) / 2))
    $linha = (" " * $espacos) + $texto # Cria a linha com os espa√ßos e o texto
    Write-Host $linha -ForegroundColor $cor # Manda pro console com a cor pedida
}

# --- Funcao que Desenha o Nosso Banner Irado do TORK! ---
# Esse √© o nosso outdoor digital no console! Ajustado pros espa√ßos que voc√™ mandou!
# Se as bordas ainda estiverem meio teimosas, √© o jeitinho do console mesmo, viu? üòâ
function Banner-TORK {
    # Nossas cores vibrantes para o banner!
    $CorBorda = "DarkCyan" # Mantido para a borda, combina com o ciano. Se quiser mudar, √© aqui!
    $CorLogo = "Green" # Cor vibrante
    $CorProjeto = "Cyan" # Cor vibrante
    $CorCopyright = "Gray" # Tom mais suave

    Write-Host "" # D√° um espacinho no topo, pra n√£o grudar
    Write-Host "                    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë          ‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë ‚ñà‚ñà‚ïî‚ïù                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ñà‚ñà‚ïó                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù                                          ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë           Bem-vindo ao TORK - Otimizador para Windows!                                ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë        Projeto de automacao, limpeza, manutencao e tweaks.                            ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë            (C) Partner77 - Todos os direitos reservados                               ‚ïë" -ForegroundColor $CorCopyright
    Write-Host "                    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor $CorBorda
    Write-Host "" # Espa√ßo embaixo
}

# --- Checagem de Permiss√µes de Administrador (O Guarda da Porta!) ---
# V√™ se a gente t√° rodando com poderes de admin, sen√£o n√£o d√° pra mexer no Windows direito.
function Test-Administrator {
    $currentUser = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())
    return $currentUser.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
}

if (-not (Test-Administrator)) {
    Write-Host "OPA! Calma l√°, patr√£o!" -ForegroundColor Red
    Write-Host "Pra usar o TORK e deixar o PC voando, preciso de super poderes de Administrador!" -ForegroundColor Yellow
    Write-Host "Fecha essa janela, clica com o bot√£o direito no arquivo do script e escolhe 'Executar como administrador'. A√≠ sim, tamo junto!" -ForegroundColor Yellow
    Read-Host "D√° um Enter quando terminar de ler, que a gente se v√™ na pr√≥xima..."
    Exit
}

Write-Host "Poderes de Administrador verificados! Bora nessa!" -ForegroundColor Green
Start-Sleep -Seconds 1

# --- Fun√ß√µes Utilit√°rias (Ferramentas que usamos em v√°rios lugares) ---
function Get-SystemInfo {
    $os = Get-CimInstance Win32_OperatingSystem
    $cs = Get-CimInstance Win32_ComputerSystem
    $proc = Get-CimInstance Win32_Processor
    $mem = Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property Capacity -Sum
    
    $info = @{
        "OSName" = $os.Caption
        "OSVersion" = $os.Version
        "OSBuild" = $os.BuildNumber
        "ComputerName" = $cs.Name
        "Manufacturer" = $cs.Manufacturer
        "Model" = $cs.Model
        "Processor" = $proc.Name
        "Memory" = [math]::Round($mem.Sum / 1GB, 2)
        "Architecture" = $os.OSArchitecture
        "InstallDate" = $os.InstallDate
        "LastBootTime" = $os.LastBootUpTime
    }
    
    return $info
}

function Show-SystemSummary {
    $sysInfo = Get-SystemInfo
    
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Computador: $($sysInfo.ComputerName)" -ForegroundColor White
    Write-Host "Fabricante: $($sysInfo.Manufacturer)" -ForegroundColor White
    Write-Host "Modelo: $($sysInfo.Model)" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "Instalado em: $($sysInfo.InstallDate)" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

function Get-DiskSpaceBefore {
    $drives = Get-PSDrive -PSProvider FileSystem
    $driveInfo = @{}
    
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        
        $driveInfo[$drive.Name] = @{
            "Free" = $freeSpace
            "Used" = $usedSpace
            "Total" = $totalSpace
        }
    }
    
    return $driveInfo
}

function Show-DiskSpaceComparison {
    param (
        $before
    )
    
    $after = Get-PSDrive -PSProvider FileSystem
    
    Write-Host "=== Compara√ß√£o de Espa√ßo em Disco ===" -ForegroundColor Cyan
    
    foreach ($drive in $after) {
        if ($before.ContainsKey($drive.Name)) {
            $freeSpaceAfter = [math]::Round($drive.Free / 1GB, 2)
            $freeSpaceBefore = $before[$drive.Name].Free
            $spaceRecovered = [math]::Round($freeSpaceAfter - $freeSpaceBefore, 2)
            
            Write-Host "Drive $($drive.Name):" -ForegroundColor White
            Write-Host "  Espa√ßo livre antes: $freeSpaceBefore GB" -ForegroundColor Gray
            Write-Host "  Espa√ßo livre agora: $freeSpaceAfter GB" -ForegroundColor Gray
            
            if ($spaceRecovered -gt 0) {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Green
            } else {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Yellow
            }
            Write-Host ""
        }
    }
    
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

# --- Fun√ß√µes dos Menus (Principal, Simplificado, Avan√ßado e Sub-menus) ---

# --- Menu Principal (A Bifurca√ß√£o do Destino! Simplificado vs Avan√ßado) ---
# √â aqui que o usu√°rio escolhe se quer ser um mago ou um cara pr√°tico!
function Show-MainMenu {
    do {
        Clear-Host # Limpa a tela pra organizar o menu
        Banner-TORK # Banner no topo, pra gente n√£o esquecer quem somos!
        Show-SystemSummary # Mostra um resumo do sistema

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "       MENU PRINCIPAL" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # As duas grandes estradas da otimiza√ß√£o! Cores variadas (repetindo)!
        Write-Host "[1] Otimiza√ß√£o Simplificada (Pra quem quer praticidade e resultado r√°pido!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o Avan√ßada (Pra quem curte mexer fundo e ter control total!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[3] Diagn√≥stico R√°pido do Sistema (Ver o que t√° rolando no PC)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[4] Sobre o TORK (Informa√ß√µes e cr√©ditos)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[0] Sair (Ah, que pena... Mas a porta t√° aberta!)" -ForegroundColor Red # Vermelho pra Sair - Ok

        Write-Host ""

        # Pergunta pro usu√°rio qual caminho ele escolhe, tipo Mestre Pok√©mon!
        $choice = Read-Host "Escolhe sua op√ß√£o, treinador!"

        # V√™ pra onde a gente vai com base na escolha
        switch ($choice) {
            "1" { Show-SimplifiedMenu } # Se escolheu 1, vai pro Menu Simplificado!
            "2" { Show-AdvancedMenu } # Se escolheu 2, vai pro Menu Avan√ßado!
            "3" { Invoke-QuickDiagnostic } # Nova fun√ß√£o de diagn√≥stico r√°pido
            "4" { Show-AboutTORK } # Nova fun√ß√£o de sobre
            "0" { Write-Host "Fechou! Valeu por usar o TORK! Volte sempre que seu PC pedir um g√°s! ;)" -ForegroundColor Green; Start-Sleep -Seconds 2; break } # Se escolheu 0, vaza (mas volta!)
            default {
                Write-Host "Eita! Op√ß√£o inv√°lida! Confere os n√∫meros e tenta de novo, bora l√°!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1 # D√° um tempinho pro usu√°rio ver a zoeira da mensagem
            }
        }
    } while ($choice -ne '0') # Repete o Menu Principal enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Simplificado (Aqui o TORK faz m√°gica r√°pida e segura!) ---
# Acessado pela op√ß√£o 1 do Menu Principal. Menos op√ß√µes, mais a√ß√£o direta!
function Show-SimplifiedMenu {
    do {
        Clear-Host # Limpa o palco pra esse menu!
        Banner-TORK # Nosso banner no topo, sempre presente!

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "   OTIMIZACAO SIMPLIFICADA" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes SIMPLIFICADAS - cada uma pode fazer um monte de coisa por baixo dos panos! Cores variadas (repetindo as prim√°rias/neon e adicionando outras)!
        Write-Host "[1] Limpeza Geral do Sistema (Tira o lixo que t√° pesando!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o de Mem√≥ria e Programas que Ligam com o Windows (Deixa tudo mais √°gil!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[3] Acelerar a Conex√£o com a Internet (Pra navegar sem gargalo!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[4] Deixar o Windows mais Leve Visualmente (Desativa uns efeitos pra ganhar desempenho!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Otimiza√ß√£o de Jogos (Configura√ß√µes pra melhorar FPS e desempenho)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[6] Manuten√ß√£o de Seguran√ßa (Verificar e corrigir problemas de seguran√ßa)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[7] RODAR TODAS as otimiza√ß√µes SIMPLIFICADAS! (Modo Turbo F√°cil!)" -ForegroundColor Red # Vermelho pra "Faz Tudo" - Destaque/Cuidado
        Write-Host "[0] Voltar ao Menu Principal (A gente te espera aqui!)" -ForegroundColor Gray # Cor neutra pra voltar

        Write-Host ""

        # Pergunta qual m√°gica simplificada o usu√°rio quer
        $choice = Read-Host "Escolhe sua m√°gica simplificada!"

        # V√™ qual m√°gica rodar
        switch ($choice) {
            "1" { Invoke-SimpleSystemCleanup } # Chama a fun√ß√£o de limpeza b√°sica
            "2" { Invoke-SimpleMemoryStartup } # Chama a fun√ß√£o pra mem√≥ria/inicializa√ß√£o
            "3" { Invoke-SimpleInternetOpt } # Chama a fun√ß√£o pra internet
            "4" { Invoke-SimpleVisualOpt } # Chama a fun√ß√£o pra visual
            "5" { Invoke-SimpleGamingOpt } # Nova fun√ß√£o para otimiza√ß√£o de jogos
            "6" { Invoke-SimpleSecurityMaintenance } # Nova fun√ß√£o para manuten√ß√£o de seguran√ßa
            "7" {
                # Rodar todas as simplificadas sequencialmente
                Write-Host "`nModo Turbo F√°cil ATIVADO! Rodando todas as otimiza√ß√µes SIMPLIFICADAS... segura pe√£o!`n" -ForegroundColor Yellow
                Invoke-SimpleSystemCleanup # Roda a 1
                Invoke-SimpleMemoryStartup # Roda a 2
                Invoke-SimpleInternetOpt # Roda a 3
                Invoke-SimpleVisualOpt # Roda a 4
                Invoke-SimpleGamingOpt # Roda a 5
                Invoke-SimpleSecurityMaintenance # Roda a 6
                Write-Host "`nShow! Todas as otimiza√ß√µes SIMPLIFICADAS foram executadas! PC t√° agradecendo! ;)`n" -ForegroundColor Green
                Read-Host "Aperta Enter pra voltar pro Menu Simplificado..." # Pausa no final do "Rodar Todas"
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-MainMenu
            default {
                Write-Host "Ops! Op√ß√£o inv√°lida no Menu Simplificado! Confere os n√∫meros e manda bala de novo!" -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Simplificado enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Avan√ßado (O Playground dos Magos do PC!) ---
# Acessado pela op√ß√£o 2 do Menu Principal. Aqui a gente mergulha fundo!
function Show-AdvancedMenu {
    do {
        Clear-Host # Limpa o palco pro menu avan√ßado!
        Banner-TORK # Nosso banner no topo, pra n√£o perder a pose!

        Write-Host "" # Espacinho maroto
        Write-Host "===============================" -ForegroundColor White
        Write-Host "      MENU AVANCADO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes do menu avan√ßado (as CATEGORIAS dos 200 poderes!) Cores variadas (repetindo)!
        Write-Host "[1] Limpeza e Manuten√ß√£o de Arquivos (Tirar a poeira digital!)" -ForegroundColor Cyan # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[2] Otimiza√ß√µes de Desempenho do Sistema (Deixar o motor roncando!)" -ForegroundColor Green # Cor variada
        Write-Host "[3] Configura√ß√µes e Otimiza√ß√µes de Rede (Pra internet voar baixo!)" -ForegroundColor Yellow # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[4] Gerenciamento e Otimiza√ß√£o de Servi√ßos do Windows (O que t√° rodando e n√£o precisa?!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Ferramentas de Diagn√≥stico e Verifica√ß√£o (Pra ver se t√° tudo nos conformes!)" -ForegroundColor Cyan # Cor repetida
        Write-Host "[6] Desabilitar/Gerenciar Recursos do Windows (Tirar o peso extra do sistema!)" -ForegroundColor Green # Cor repetida
        Write-Host "[7] Gerenciamento de Arquivos e Pastas Avan√ßado (Comandos ninja pra arquivos!)" -ForegroundColor Yellow # Cor repetida
        Write-Host "[8] Gerenciamento de Contas de Usu√°rio (Organizar a galera que usa o PC!)" -ForegroundColor White # Cor repetida
        Write-Host "[9] Otimiza√ß√£o para Jogos Avan√ßada (Tweaks pra gamers de verdade!)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Configura√ß√µes de Privacidade (Controle o que o Windows sabe sobre voc√™)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[11] Outras Configura√ß√µes e Tweaks Diversos (Aqueles ajustes secretos!)" -ForegroundColor Gray # Cor neutra/escura
        Write-Host "[0] Voltar ao Menu Principal (Pronto pra voltar pra estrada principal!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta pro mago qual categoria ele quer explorar
        $choice = Read-Host "Escolhe sua √°rea de magia, mago!"

        # V√™ pra onde a gente navega dentro do mundo avan√ßado
        switch ($choice) {
            "1" { Show-LimpezaManutencaoMenu } # CHAMA O SUB-MENU DE LIMPEZA
            "2" { Show-DesempenhoMenu } # Agora √© um sub-menu tamb√©m
            "3" { Show-ConfiguracoesRedeMenu } # CHAMA O SUB-MENU DE REDE
            "4" { Show-ServicosMenu } # Agora √© um sub-menu tamb√©m
            "5" { Show-DiagnosticoMenu } # Agora √© um sub-menu tamb√©m
            "6" { Show-RecursosMenu } # Agora √© um sub-menu tamb√©m
            "7" { Show-ArquivosPastasMenu } # Agora √© um sub-menu tamb√©m
            "8" { Show-UsuariosMenu } # Agora √© um sub-menu tamb√©m
            "9" { Show-JogosAvancadoMenu } # Novo sub-menu para jogos
            "10" { Show-PrivacidadeMenu } # Novo sub-menu para privacidade
            "11" { Show-OutrosMenu } # Agora √© um sub-menu tamb√©m
            "0" { break } # Sai do loop deste menu, voltando pro Menu Principal
            default {
                Write-Host "Humm, essa √°rea da magia ainda n√£o existe ou voc√™ digitou errado! Tenta de novo, mago!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Avan√ßado enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Limpeza e Manuten√ß√£o (Dentro do Avan√ßado!) ---
# Este menu lista as op√ß√µes ESPEC√çFICAS da categoria Limpeza no Menu Avan√ßado
function Show-LimpezaManutencaoMenu {
    do {
        Clear-Host # Limpa o palco pra este sub-menu!
        Banner-TORK # Banner no topo, sempre!

        Write-Host "" # Espacinho
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: LIMPEZA E MANUT." -ForegroundColor White # T√≠tulo menor pro sub-menu
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes ESPEC√çFICAS da categoria Limpeza. Cores variadas (repetindo cores)!
        Write-Host "[1] Limpar Arquivos Tempor√°rios do Usu√°rio (Tipo a pasta Temp!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[2] Limpar Arquivos Tempor√°rios do Sistema (Os tempor√°rios do Windows!)" -ForegroundColor Gray # Cor neutra (substitui DarkCyan)
        Write-Host "[3] Limpar Cache de DNS (Pra resolver nomes de site mais r√°pido!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[4] Esvaziar Lixeira (Adeus, arquivos deletados!)" -ForegroundColor Gray # Cor neutra (repetindo)
        Write-Host "[5] Limpar Cache de Miniaturas (Aqueles previews de imagem/v√≠deo!)" -ForegroundColor Green # Cor variada
        Write-Host "[6] Limpar Logs do Sistema (Arquivos de registro que acumulam)" -ForegroundColor Cyan # Nova op√ß√£o
        Write-Host "[7] Limpar Cache de Atualiza√ß√µes do Windows (Liberar espa√ßo de updates)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[8] Limpar Arquivos de Hiberna√ß√£o (Liberar o hiberfil.sys)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[9] Limpar Arquivos WinSxS (Pasta que ocupa muito espa√ßo)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Executar TODAS as limpezas acima (Faxina completa!)" -ForegroundColor Red # Nova op√ß√£o
        Write-Host "[0] Voltar ao Menu Avan√ßado (De volta pras categorias!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta qual limpeza espec√≠fica o mago quer fazer
        $choice = Read-Host "Escolhe a limpeza avan√ßada, mestre!"

        # V√™ qual fun√ß√£o de limpeza espec√≠fica chamar
        switch ($choice) {
            "1" { Invoke-CleanUserTemp } # Chama a fun√ß√£o pra Limpar Temp Usu√°rio
            "2" { Invoke-CleanSystemTemp } # Chama a fun√ß√£o pra Limpar Temp Sistema
            "3" { Invoke-CleanDnsCache } # Chama a fun√ß√£o pra Limpar Cache DNS
            "4" { Invoke-EmptyRecycleBin } # Chama a fun√ß√£o pra Esvaziar Lixeira
            "5" { Invoke-CleanThumbnailCache } # Chama a fun√ß√£o pra Limpar Cache de Miniaturas
            "6" { Invoke-CleanSystemLogs } # Nova fun√ß√£o para limpar logs do sistema
            "7" { Invoke-CleanWindowsUpdateCache } # Nova fun√ß√£o para limpar cache de updates
            "8" { Invoke-CleanHibernationFile } # Nova fun√ß√£o para limpar arquivo de hiberna√ß√£o
            "9" { Invoke-CleanWinSxS } # Nova fun√ß√£o para limpar pasta WinSxS
            "10" { 
                # Executa todas as limpezas em sequ√™ncia
                Write-Host "`nIniciando faxina completa do sistema! Isso pode demorar um pouco...`n" -ForegroundColor Yellow
                $diskSpaceBefore = Get-DiskSpaceBefore
                
                Invoke-CleanUserTemp
                Invoke-CleanSystemTemp
                Invoke-CleanDnsCache
                Invoke-EmptyRecycleBin
                Invoke-CleanThumbnailCache
                Invoke-CleanSystemLogs
                Invoke-CleanWindowsUpdateCache
                Invoke-CleanHibernationFile
                Invoke-CleanWinSxS
                
                Write-Host "`nFaxina completa finalizada! Veja quanto espa√ßo foi recuperado:`n" -ForegroundColor Green
                Show-DiskSpaceComparison -before $diskSpaceBefore
                Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-AdvancedMenu
            default {
                Write-Host "Essa tarefa de limpeza ainda n√£o t√° na lista! V√™ os n√∫meros e tenta de novo!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Sub-Menu Limpeza enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Desempenho (Dentro do Avan√ßado!) ---
function Show-DesempenhoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DESEMPENHO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Ajustar Efeitos Visuais para Melhor Desempenho" -ForegroundColor Green
        Write-Host "[2] Otimizar Disco do Sistema" -ForegroundColor Cyan
        Write-Host "[3] Limpar Arquivos Prefetch" -ForegroundColor Yellow
        Write-Host "[4] Definir Plano de Energia para Alto Desempenho" -ForegroundColor White
        Write-Host "[5] Otimizar Servi√ßo SuperFetch/SysMain" -ForegroundColor Magenta
        Write-Host "[6] Ajustar Tamanho da Mem√≥ria Virtual" -ForegroundColor Gray
        Write-Host "[7] Desativar Indexa√ß√£o de Arquivos" -ForegroundColor Green
        Write-Host "[8] Otimizar Inicializa√ß√£o do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de desempenho" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o de desempenho"

        switch ($choice) {
            "1" { Invoke-OptimizeVisualEffects }
            "2" { Invoke-OptimizeDisk }
            "3" { Invoke-CleanPrefetch }
            "4" { Invoke-SetHighPerformancePower }
            "5" { Invoke-OptimizeSuperFetch }
            "6" { Invoke-AdjustVirtualMemory }
            "7" { Invoke-DisableIndexing }
            "8" { Invoke-OptimizeStartup }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de desempenho...`n" -ForegroundColor Yellow
                Invoke-OptimizeVisualEffects
                Invoke-OptimizeDisk
                Invoke-CleanPrefetch
                Invoke-SetHighPerformancePower
                Invoke-OptimizeSuperFetch
                Invoke-AdjustVirtualMemory
                Invoke-DisableIndexing
                Invoke-OptimizeStartup
                Write-Host "`nTodas as otimiza√ß√µes de desempenho foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Configura√ß√µes de Rede (Dentro do Avan√ßado!) ---
function Show-ConfiguracoesRedeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: CONFIG. REDE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Limpar Cache de DNS" -ForegroundColor Yellow
        Write-Host "[2] Mudar Servidor DNS" -ForegroundColor Cyan
        Write-Host "[3] Resetar Configura√ß√µes de Rede" -ForegroundColor White
        Write-Host "[4] Otimizar Configura√ß√µes TCP/IP" -ForegroundColor Green
        Write-Host "[5] Verificar Velocidade da Conex√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar QoS (Qualidade de Servi√ßo)" -ForegroundColor Gray
        Write-Host "[7] Desativar IPv6 (Se n√£o estiver usando)" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Lat√™ncia de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de rede" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√£o de rede"

        switch ($choice) {
            "1" { Invoke-NetworkFlushDns }
            "2" { Invoke-NetworkChangeDns }
            "3" { Invoke-NetworkReset }
            "4" { Invoke-OptimizeTcpIp }
            "5" { Invoke-CheckNetworkSpeed }
            "6" { Invoke-ConfigureQoS }
            "7" { Invoke-DisableIPv6 }
            "8" { Invoke-OptimizeGamingLatency }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de rede...`n" -ForegroundColor Yellow
                Invoke-NetworkFlushDns
                Invoke-OptimizeTcpIp
                Invoke-CheckNetworkSpeed
                Invoke-ConfigureQoS
                Invoke-DisableIPv6
                Invoke-OptimizeGamingLatency
                Write-Host "`nTodas as otimiza√ß√µes de rede foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Rede..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Servi√ßos (Dentro do Avan√ßado!) ---
function Show-ServicosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: SERVICOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desabilitar Servi√ßo SuperFetch/SysMain" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Servi√ßo de Impress√£o" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Servi√ßo Windows Update" -ForegroundColor White
        Write-Host "[4] Listar Todos os Servi√ßos em Execu√ß√£o" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Otimizar Servi√ßos para Desempenho Geral" -ForegroundColor Gray
        Write-Host "[7] Restaurar Servi√ßos para Configura√ß√£o Padr√£o" -ForegroundColor Yellow
        Write-Host "[8] Desabilitar Servi√ßos Desnecess√°rios" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de servi√ßos"

        switch ($choice) {
            "1" { Invoke-ManageSuperFetch }
            "2" { Invoke-ManagePrintService }
            "3" { Invoke-ManageWindowsUpdate }
            "4" { Invoke-ListRunningServices }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-OptimizeServicesForPerformance }
            "7" { Invoke-RestoreDefaultServices }
            "8" { Invoke-DisableUnnecessaryServices }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Diagn√≥stico (Dentro do Avan√ßado!) ---
function Show-DiagnosticoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DIAGNOSTICO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Verificar Arquivos do Sistema (SFC)" -ForegroundColor Yellow
        Write-Host "[2] Reparar Imagem do Windows (DISM)" -ForegroundColor Cyan
        Write-Host "[3] Verificar Disco por Erros (CHKDSK)" -ForegroundColor White
        Write-Host "[4] Verificar Sa√∫de do Disco" -ForegroundColor Green
        Write-Host "[5] Verificar Drivers Desatualizados" -ForegroundColor Magenta
        Write-Host "[6] Verificar Problemas de Inicializa√ß√£o" -ForegroundColor Gray
        Write-Host "[7] Verificar Problemas de Mem√≥ria RAM" -ForegroundColor Yellow
        Write-Host "[8] Verificar Temperatura do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODOS os diagn√≥sticos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de diagn√≥stico"

        switch ($choice) {
            "1" { Invoke-SfcScan }
            "2" { Invoke-DismRepair }
            "3" { Invoke-ChkDsk }
            "4" { Invoke-CheckDiskHealth }
            "5" { Invoke-CheckDrivers }
            "6" { Invoke-CheckStartupIssues }
            "7" { Invoke-CheckMemory }
            "8" { Invoke-CheckTemperature }
            "9" {
                Write-Host "`nExecutando todos os diagn√≥sticos...`n" -ForegroundColor Yellow
                Invoke-SfcScan
                Invoke-DismRepair
                Invoke-CheckDiskHealth
                Invoke-CheckDrivers
                Invoke-CheckStartupIssues
                Invoke-CheckTemperature
                Write-Host "`nTodos os diagn√≥sticos foram conclu√≠dos!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Diagn√≥stico..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Recursos (Dentro do Avan√ßado!) ---
function Show-RecursosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: RECURSOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Gerenciar Hiberna√ß√£o" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Planos de Energia" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Recursos Opcionais do Windows" -ForegroundColor White
        Write-Host "[4] Gerenciar Mem√≥ria Virtual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Windows Defender" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Recursos de Telemetria" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Recursos de Inicializa√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Recursos de Seguran√ßa" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de recursos"

        switch ($choice) {
            "1" { Invoke-ManageHibernation }
            "2" { Invoke-ManagePowerPlans }
            "3" { Invoke-ManageOptionalFeatures }
            "4" { Invoke-ManageVirtualMemory }
            "5" { Invoke-ManageWindowsDefender }
            "6" { Invoke-ManageTelemetry }
            "7" { Invoke-ManageStartupResources }
            "8" { Invoke-ManageSecurityFeatures }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Arquivos e Pastas (Dentro do Avan√ßado!) ---
function Show-ArquivosPastasMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: ARQUIVOS E PASTAS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Encontrar Arquivos Grandes" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Arquivos" -ForegroundColor Cyan
        Write-Host "[3] Tomar Posse de Arquivos (TakeOwn)" -ForegroundColor White
        Write-Host "[4] Listar Conte√∫do de Pastas Espec√≠ficas" -ForegroundColor Green
        Write-Host "[5] Compactar Pastas para Economizar Espa√ßo" -ForegroundColor Magenta
        Write-Host "[6] Verificar Integridade de Arquivos" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Arquivos Ocultos e do Sistema" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Atributos de Arquivos" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de arquivos e pastas"

        switch ($choice) {
            "1" { Invoke-FindLargeFiles }
            "2" { Invoke-ManageFilePermissions }
            "3" { Invoke-TakeOwnership }
            "4" { Invoke-ListFolderContents }
            "5" { Invoke-CompressFolders }
            "6" { Invoke-VerifyFileIntegrity }
            "7" { Invoke-ManageHiddenSystemFiles }
            "8" { Invoke-ManageFileAttributes }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Usu√°rios (Dentro do Avan√ßado!) ---
function Show-UsuariosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: USUARIOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Listar Todos os Usu√°rios Locais" -ForegroundColor Yellow
        Write-Host "[2] Listar Todos os Grupos Locais" -ForegroundColor Cyan
        Write-Host "[3] Listar Membros de Grupos Espec√≠ficos" -ForegroundColor White
        Write-Host "[4] Mostrar Propriedades do Usu√°rio Atual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Contas de Usu√°rio" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Pol√≠ticas de Senha" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Permiss√µes de Usu√°rio" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar UAC (Controle de Conta de Usu√°rio)" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de usu√°rios"

        switch ($choice) {
            "1" { Invoke-ListLocalUsers }
            "2" { Invoke-ListLocalGroups }
            "3" { Invoke-ListGroupMembers }
            "4" { Invoke-ShowCurrentUserProperties }
            "5" { Invoke-ManageUserAccounts }
            "6" { Invoke-ManagePasswordPolicies }
            "7" { Invoke-ManageUserPermissions }
            "8" { Invoke-ManageUAC }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Jogos Avan√ßado (Dentro do Avan√ßado!) ---
function Show-JogosAvancadoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: JOGOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Otimizar Prioridade de CPU para Jogos" -ForegroundColor Yellow
        Write-Host "[2] Otimizar Configura√ß√µes de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[3] Otimizar Configura√ß√µes de GPU" -ForegroundColor White
        Write-Host "[4] Desativar Game DVR e Game Bar" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Configurar Modo de Jogo do Windows" -ForegroundColor Gray
        Write-Host "[7] Otimizar Configura√ß√µes de √Åudio para Jogos" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Configura√ß√µes de Input Lag" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes para jogos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o para jogos"

        switch ($choice) {
            "1" { Invoke-OptimizeCpuPriority }
            "2" { Invoke-OptimizeNetworkForGaming }
            "3" { Invoke-OptimizeGpuSettings }
            "4" { Invoke-DisableGameDvrBar }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-ConfigureGameMode }
            "7" { Invoke-OptimizeAudioForGaming }
            "8" { Invoke-OptimizeInputLag }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes para jogos...`n" -ForegroundColor Yellow
                Invoke-OptimizeCpuPriority
                Invoke-OptimizeNetworkForGaming
                Invoke-OptimizeGpuSettings
                Invoke-DisableGameDvrBar
                Invoke-OptimizeServicesForGaming
                Invoke-ConfigureGameMode
                Invoke-OptimizeAudioForGaming
                Invoke-OptimizeInputLag
                Write-Host "`nTodas as otimiza√ß√µes para jogos foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Jogos..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Privacidade (Dentro do Avan√ßado!) ---
function Show-PrivacidadeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: PRIVACIDADE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desativar Telemetria do Windows" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Aplicativos" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Hist√≥rico de Atividades" -ForegroundColor White
        Write-Host "[4] Gerenciar Diagn√≥stico e Feedback" -ForegroundColor Green
        Write-Host "[5] Gerenciar An√∫ncios Personalizados" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Localiza√ß√£o e Sensores" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Reconhecimento de Voz e Digita√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Sincroniza√ß√£o com a Microsoft" -ForegroundColor Cyan
        Write-Host "[9] Aplicar TODAS as configura√ß√µes de privacidade" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de privacidade"

        switch ($choice) {
            "1" { Invoke-DisableTelemetry }
            "2" { Invoke-ManageAppPermissions }
            "3" { Invoke-ManageActivityHistory }
            "4" { Invoke-ManageDiagnosticsFeedback }
            "5" { Invoke-ManagePersonalizedAds }
            "6" { Invoke-ManageLocationSensors }
            "7" { Invoke-ManageVoiceTyping }
            "8" { Invoke-ManageMicrosoftSync }
            "9" {
                Write-Host "`nAplicando todas as configura√ß√µes de privacidade...`n" -ForegroundColor Yellow
                Invoke-DisableTelemetry
                Invoke-ManageAppPermissions
                Invoke-ManageActivityHistory
                Invoke-ManageDiagnosticsFeedback
                Invoke-ManagePersonalizedAds
                Invoke-ManageLocationSensors
                Invoke-ManageVoiceTyping
                Invoke-ManageMicrosoftSync
                Write-Host "`nTodas as configura√ß√µes de privacidade foram aplicadas!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Privacidade..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Outros (Dentro do Avan√ßado!) ---
function Show-OutrosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: OUTROS TWEAKS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Mostrar Informa√ß√µes Detalhadas do Sistema" -ForegroundColor Yellow
        Write-Host "[2] Mostrar Configura√ß√£o Completa de Rede" -ForegroundColor Cyan
        Write-Host "[3] Reiniciar Explorer.exe" -ForegroundColor White
        Write-Host "[4] Limpar Cache de Atualiza√ß√µes do Windows" -ForegroundColor Green
        Write-Host "[5] Gerenciar Programas de Inicializa√ß√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar Op√ß√µes de Energia Avan√ßadas" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Configura√ß√µes de Armazenamento" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Configura√ß√µes de Notifica√ß√µes" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√µes diversas"

        switch ($choice) {
            "1" { Invoke-ShowDetailedSystemInfo }
            "2" { Invoke-ShowDetailedNetworkConfig }
            "3" { Invoke-RestartExplorer }
            "4" { Invoke-CleanWindowsUpdateCache }
            "5" { Invoke-ManageStartupPrograms }
            "6" { Invoke-ConfigureAdvancedPowerOptions }
            "7" { Invoke-ManageStorageSettings }
            "8" { Invoke-ManageNotificationSettings }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- Fun√ß√µes para as Secoes SIMPLIFICADAS (Expandidas) ---
function Invoke-SimpleSystemCleanup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza Geral do Sistema: Hora de varrer o lixo digital! ---" -ForegroundColor Green
    Write-Host "Essa op√ß√£o vai te ajudar a liberar espa√ßo e dar um f√¥lego pro PC tirando arquivos tempor√°rios, lixo da lixeira, etc. √â tipo faxina no computador!" -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Comando 1: Limpar Arquivos Tempor√°rios do Usu√°rio
    Write-Host "Bora come√ßar limpando os arquivos tempor√°rios do seu usu√°rio! Eles acumulam que √© uma beleza!" -ForegroundColor Yellow
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio limpos! Menos peso pro PC respirar! ;)" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Esvaziar a Lixeira
    Write-Host "Agora, vamos dar um fim definitivo naqueles arquivos na Lixeira. Eles s√≥ est√£o ocupando espa√ßo √† toa!" -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada! Espa√ßo recuperado com sucesso! R√°!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios do Windows
    Write-Host "Vamos limpar tamb√©m os tempor√°rios do pr√≥prio Windows. √Äs vezes, fica lixo escondido por l√°!" -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Limpar Cache de Navegadores Comuns
    Write-Host "Bora dar uma geral nos caches dos navegadores tamb√©m! Eles guardam um monte de coisa que pode pesar!" -ForegroundColor Yellow
    
    # Chrome
    Write-Host "Tentando limpar cache do Google Chrome..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Chrome limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Edge
    Write-Host "Tentando limpar cache do Microsoft Edge..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Edge limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Firefox
    Write-Host "Tentando limpar cache do Mozilla Firefox..." -ForegroundColor DarkGray
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\cache2\entries\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\startupCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\thumbnails\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Firefox limpo (pode n√£o ser completo, dependendo do perfil/uso)." -ForegroundColor DarkGray

    # Brave (se instalado)
    Write-Host "Tentando limpar cache do Brave Browser (se instalado)..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Brave limpo (se instalado e n√£o estiver rodando)." -ForegroundColor DarkGray

    Write-Host "Limpeza de caches de navegador conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Comando 5: Limpar Cache de Miniaturas
    Write-Host "Limpando cache de miniaturas do Windows (aquelas pr√©-visualiza√ß√µes de imagens e v√≠deos)..." -ForegroundColor Yellow
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Write-Host "Cache de miniaturas limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Limpar Arquivos de Log do Windows
    Write-Host "Limpando arquivos de log do Windows que podem ocupar espa√ßo..." -ForegroundColor Yellow
    wevtutil cl Application
    wevtutil cl System
    wevtutil cl Security
    Write-Host "Logs do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 7: Limpar Arquivos Tempor√°rios de Instala√ß√£o
    Write-Host "Limpando arquivos tempor√°rios de instala√ß√£o de programas..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Installer\$*\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios de instala√ß√£o limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 8: Limpar Arquivos de Atualiza√ß√£o do Windows
    Write-Host "Limpando arquivos de atualiza√ß√£o do Windows que podem ocupar bastante espa√ßo..." -ForegroundColor Yellow
    Stop-Service -Name wuauserv -ErrorAction SilentlyContinue
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    Write-Host "Arquivos de atualiza√ß√£o do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 9: Limpar Arquivos Prefetch
    Write-Host "Limpando arquivos prefetch para melhorar a inicializa√ß√£o..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Prefetch\*.pf" -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos prefetch limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 10: Executar Limpeza de Disco Integrada do Windows
    Write-Host "Executando a ferramenta de limpeza de disco integrada do Windows..." -ForegroundColor Yellow
    Start-Process -FilePath cleanmgr.exe -ArgumentList "/sagerun:1" -Wait -ErrorAction SilentlyContinue
    Write-Host "Limpeza de disco conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "Vamos ver quanto espa√ßo conseguimos recuperar com essa faxina:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nPronto! A faxina geral b√°sica foi feita! Seu PC agradece o espa√ßo extra! ;)" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu
    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleMemoryStartup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Mem√≥ria e Inicializa√ß√£o R√°pida: Deixa o PC ligando num piscar! ---" -ForegroundColor Yellow
    Write-Host "Aqui a gente d√° uma olhada na mem√≥ria RAM e nos programas que ligam junto com o Windows. Menos coisa ligando √† toa = PC mais r√°pido pra usar na hora!" -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Listar Programas de Inicializa√ß√£o
    Write-Host "Listando programas que iniciam com o Windows (pra voc√™ saber o que t√° rodando por baixo dos panos):" -ForegroundColor Yellow
    Get-CimInstance win32_startupcommand | Select-Object Name, command, Location | Format-Table -AutoSize
    Write-Host "Lista de programas de inicializa√ß√£o exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Servi√ßo SuperFetch/SysMain
    Write-Host "Otimizando o servi√ßo SuperFetch/SysMain para melhorar o desempenho..." -ForegroundColor Yellow
    $confirmSysMain = Read-Host "Deseja desativar o servi√ßo SysMain/SuperFetch? (s/n) - Recomendado para SSDs"
    if ($confirmSysMain -eq 's') {
        Set-Service -Name SysMain -StartupType Disabled -ErrorAction SilentlyContinue
        Stop-Service -Name SysMain -Force -ErrorAction SilentlyContinue
        Write-Host "Servi√ßo SysMain/SuperFetch desativado!" -ForegroundColor Green
    } else {
        Write-Host "Servi√ßo SysMain/SuperFetch mantido ativo." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios de Updates
    Write-Host "Limpando arquivos tempor√°rios de atualiza√ß√µes do Windows (podem ocupar bastante espa√ßo e afetar performance):" -ForegroundColor Yellow
    Dism /online /Cleanup-Image /StartComponentCleanup /ErrorAction SilentlyContinue
    Write-Host "Limpeza de componentes de atualiza√ß√£o iniciada (pode levar um tempo)." -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Mem√≥ria Virtual
    Write-Host "Otimizando configura√ß√µes de mem√≥ria virtual para melhor desempenho..." -ForegroundColor Yellow
    $totalRam = (Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property capacity -Sum).Sum / 1GB
    Write-Host "Seu sistema tem aproximadamente $totalRam GB de RAM." -ForegroundColor White
    
    $confirmPageFile = Read-Host "Deseja otimizar o arquivo de pagina√ß√£o (mem√≥ria virtual)? (s/n)"
    if ($confirmPageFile -eq 's') {
        # Calcula tamanho recomendado (1.5x a RAM para sistemas com menos de 8GB, 1x para sistemas com mais)
        $pageFileSize = if ($totalRam -lt 8) { [math]::Round($totalRam * 1.5) * 1024 } else { [math]::Round($totalRam) * 1024 }
        
        Write-Host "Configurando arquivo de pagina√ß√£o para tamanho fixo de $pageFileSize MB..." -ForegroundColor DarkGray
        $computerSystem = Get-WmiObject -Class Win32_ComputerSystem
        $computerSystem.AutomaticManagedPagefile = $false
        $computerSystem.Put() | Out-Null
        
        $pageFileSetting = Get-WmiObject -Class Win32_PageFileSetting
        if ($pageFileSetting) {
            $pageFileSetting.InitialSize = $pageFileSize
            $pageFileSetting.MaximumSize = $pageFileSize
            $pageFileSetting.Put() | Out-Null
        }
        Write-Host "Arquivo de pagina√ß√£o otimizado! (Requer reinicializa√ß√£o para aplicar totalmente)" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes de mem√≥ria virtual mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Listar os 10 Processos que mais usam mem√≥ria no momento
    Write-Host "Listando os 10 processos que mais consomem mem√≥ria agora:" -ForegroundColor Yellow
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host "Lista de processos exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Otimizar Inicializa√ß√£o do Windows
    Write-Host "Otimizando a inicializa√ß√£o do Windows..." -ForegroundColor Yellow
    # Desabilitar servi√ßos n√£o essenciais que podem atrasar a inicializa√ß√£o
    $startupServices = @(
        @{Name="DiagTrack"; DisplayName="Experi√™ncias do Usu√°rio Conectado e Telemetria"},
        @{Name="dmwappushservice"; DisplayName="Servi√ßo de Transfer√™ncia Inteligente em Segundo Plano (BITS)"},
        @{Name="MapsBroker"; DisplayName="Servi√ßo de Dados de Mapas"}
    )
    
    foreach ($service in $startupServices) {
        $confirmService = Read-Host "Deseja desativar o servi√ßo '$($service.DisplayName)' na inicializa√ß√£o? (s/n)"
        if ($confirmService -eq 's') {
            Set-Service -Name $service.Name -StartupType Disabled -ErrorAction SilentlyContinue
            Stop-Service -Name $service.Name -Force -ErrorAction SilentlyContinue
            Write-Host "Servi√ßo '$($service.DisplayName)' desativado!" -ForegroundColor Green
        } else {
            Write-Host "Servi√ßo '$($service.DisplayName)' mantido." -ForegroundColor Green
        }
    }
    Write-Host ""

    # Comando 7: Reiniciar o Computador (√ötil pra liberar mem√≥ria e aplicar mudan√ßas)
    Write-Host "Quer dar um 'refresh' geral no PC? Reiniciar pode ajudar!" -ForegroundColor Yellow
    $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (digite 'sim' para confirmar)"
    if ($confirmRestart -eq 'sim') {
        Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
        Restart-Computer -Force
    } else {
        Write-Host "Rein√≠cio cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o de mem√≥ria e inicializa√ß√£o!" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu (a n√£o ser que o PC tenha reiniciado)
    if ($confirmRestart -ne 'sim') {
        Write-Host ""
        Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
    }
}

function Invoke-SimpleInternetOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Acelerar a Conex√£o com a Internet (Simplificado): Diz adeus pro 'carregando...'! ---" -ForegroundColor Cyan
    Write-Host "Vamos fazer uns ajustes r√°pidos na sua conex√£o pra tentar deixar ela mais esperta." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Limpar Cache de DNS
    Write-Host "Limpando o cache de endere√ßos de internet (DNS) pra resolver nomes mais r√°pido!" -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Configura√ß√µes TCP/IP
    Write-Host "Otimizando configura√ß√µes TCP/IP para melhorar a velocidade de conex√£o..." -ForegroundColor Yellow
    
    # Habilitar TCP Window Auto-Tuning
    netsh int tcp set global autotuninglevel=normal
    Write-Host "TCP Auto-Tuning configurado para 'normal'." -ForegroundColor DarkGray
    
    # Otimizar par√¢metros de recebimento de pacotes
    netsh int tcp set global rss=enabled
    Write-Host "Receive-Side Scaling (RSS) habilitado." -ForegroundColor DarkGray
    
    # Otimizar congestion provider
    netsh int tcp set global congestionprovider=ctcp
    Write-Host "Congestion Provider configurado para 'ctcp'." -ForegroundColor DarkGray
    
    # Otimizar ECN capability
    netsh int tcp set global ecncapability=enabled
    Write-Host "ECN Capability habilitado." -ForegroundColor DarkGray
    
    Write-Host "Configura√ß√µes TCP/IP otimizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Reiniciar Adaptadores de Rede
    Write-Host "Dando um 'reset' r√°pido nas suas conex√µes de rede. Pode resolver uns pepinos!" -ForegroundColor Yellow
    $confirmResetAdapter = Read-Host "Isso vai desconectar brevemente sua internet. Continuar? (s/n)"
    if ($confirmResetAdapter -eq 's') {
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        Write-Host "Adaptadores de rede reiniciados." -ForegroundColor Green
    } else {
        Write-Host "Reset de adaptadores cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 4: Configurar DNS R√°pido
    Write-Host "Configurar DNS mais r√°pido pode melhorar sua navega√ß√£o!" -ForegroundColor Yellow
    $confirmDns = Read-Host "Deseja configurar DNS mais r√°pidos (Google ou Cloudflare)? (s/n)"
    if ($confirmDns -eq 's') {
        Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
        Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
        $dnsChoice = Read-Host "Escolha uma op√ß√£o (1 ou 2)"
        
        $primaryDns = ""
        $secondaryDns = ""
        
        if ($dnsChoice -eq '1') {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            Write-Host "Google DNS selecionado." -ForegroundColor DarkGray
        } elseif ($dnsChoice -eq '2') {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            Write-Host "Cloudflare DNS selecionado." -ForegroundColor DarkGray
        } else {
            Write-Host "Op√ß√£o inv√°lida. DNS n√£o alterado." -ForegroundColor Red
        }
        
        if ($primaryDns -ne "") {
            $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" -and ($_.InterfaceDescription -match "Ethernet" -or $_.InterfaceDescription -match "Wi-Fi" -or $_.InterfaceDescription -match "Wireless") }
            
            foreach ($adapter in $networkAdapters) {
                Write-Host "Configurando DNS para adaptador: $($adapter.Name)" -ForegroundColor DarkGray
                Set-DnsClientServerAddress -InterfaceIndex $adapter.ifIndex -ServerAddresses ($primaryDns, $secondaryDns)
            }
            
            Write-Host "DNS configurado! Sua navega√ß√£o deve ficar mais r√°pida agora." -ForegroundColor Green
        }
    } else {
        Write-Host "Configura√ß√£o de DNS mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Mostrar Status B√°sico da Conex√£o
    Write-Host "Mostrando um resumo b√°sico da sua configura√ß√£o de rede atual:" -ForegroundColor Yellow
    ipconfig /all | Select-String -Pattern "IPv4", "DNS", "Gateway", "DHCP", "Subnet", "Physical Address"
    Write-Host "Status b√°sico da rede exibido." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Testar a conex√£o com a internet
    Write-Host "Testando a conex√£o com a internet (ping para google.com)..." -ForegroundColor Yellow
    Test-Connection -Count 4 google.com -ErrorAction SilentlyContinue
    Write-Host "Teste de conex√£o finalizado." -ForegroundColor Green
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o b√°sica de internet!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleVisualOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Deixar o Windows mais Leve Visualmente (Simplificado): Desempenho antes da beleza! ---" -ForegroundColor White
    Write-Host "Ajustes r√°pidos pra desativar efeitos visuais que podem pesar, liberando recursos pro que importa." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ajustar Efeitos Visuais
    Write-Host "Voc√™ quer desativar ou ativar as anima√ß√µes e efeitos visuais do Windows?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Efeitos Visuais (Pra ganhar desempenho)" -ForegroundColor Green
    Write-Host "[2] Configurar para Melhor Apar√™ncia (Mais bonito, mas mais pesado)" -ForegroundColor White
    Write-Host "[3] Deixar o Windows Escolher (Configura√ß√£o padr√£o)" -ForegroundColor Cyan
    $choiceVisual = Read-Host "Escolha [1], [2] ou [3]"

    if ($choiceVisual -eq '1') {
        Write-Host "Desativando efeitos visuais para melhor desempenho..." -ForegroundColor Yellow
        # Valor 2 = Ajustar para melhor desempenho (desativa a maioria dos efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 2 -Type DWord -Force -ErrorAction SilentlyContinue
        
        # Desativar anima√ß√µes individuais
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop' -Name 'UserPreferencesMask' -Value ([byte[]](0x90, 0x12, 0x01, 0x80)) -Type Binary -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop\WindowMetrics' -Name 'MinAnimate' -Value 0 -Type String -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'ListviewAlphaSelect' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'TaskbarAnimations' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        
        Write-Host "Efeitos visuais desativados para melhor desempenho!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '2') {
        Write-Host "Configurando para melhor apar√™ncia (todos os efeitos visuais ativados)..." -ForegroundColor Yellow
        # Valor 1 = Ajustar para melhor apar√™ncia (ativa todos os efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Efeitos visuais configurados para melhor apar√™ncia!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '3') {
        Write-Host "Deixando o Windows escolher automaticamente (configura√ß√£o padr√£o)..." -ForegroundColor Yellow
        # Valor 0 = Deixar o Windows escolher
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Configura√ß√£o visual definida para padr√£o do Windows!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa nos efeitos visuais foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 2: Ativar/Desativar Efeitos de Transpar√™ncia
    Write-Host "E os efeitos de transpar√™ncia do Windows (tipo na barra de tarefas)?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Transpar√™ncia (Mais leve)" -ForegroundColor Green
    Write-Host "[2] Ativar Transpar√™ncia (Mais 'bonito')" -ForegroundColor White
    $choiceTransp = Read-Host "Escolha [1] ou [2]"

    if ($choiceTransp -eq '1') {
        Write-Host "Desativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 0 = Desativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia desativada!" -ForegroundColor Green
    } elseif ($choiceTransp -eq '2') {
        Write-Host "Ativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 1 = Ativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia ativada!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa na transpar√™ncia foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 3: Configurar Tema Claro/Escuro
    Write-Host "Voc√™ prefere tema claro ou escuro? O tema escuro pode ser mais confort√°vel para os olhos." -ForegroundColor Yellow
    Write-Host "[1] Tema Escuro (Dark Mode)" -ForegroundColor DarkGray
    Write-Host "[2] Tema Claro (Light Mode)" -ForegroundColor White
    $choiceTheme = Read-Host "Escolha [1] ou [2]"

    if ($choiceTheme -eq '1') {
        Write-Host "Configurando tema escuro..." -ForegroundColor Yellow
        # Valor 0 = Tema Escuro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema escuro configurado!" -ForegroundColor Green
    } elseif ($choiceTheme -eq '2') {
        Write-Host "Configurando tema claro..." -ForegroundColor Yellow
        # Valor 1 = Tema Claro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema claro configurado!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa no tema foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Configurar Resolu√ß√£o de Tela
    Write-Host "Deseja ajustar a resolu√ß√£o da tela? Resolu√ß√µes menores podem melhorar o desempenho em PCs mais antigos." -ForegroundColor Yellow
    $confirmResolution = Read-Host "Deseja ver e ajustar a resolu√ß√£o da tela? (s/n)"
    
    if ($confirmResolution -eq 's') {
        # Mostrar resolu√ß√£o atual
        $currentResolution = Get-WmiObject -Class Win32_VideoController | Select-Object -ExpandProperty VideoModeDescription
        Write-Host "Resolu√ß√£o atual: $currentResolution" -ForegroundColor White
        
        # Abrir configura√ß√µes de exibi√ß√£o do Windows
        Write-Host "Abrindo configura√ß√µes de exibi√ß√£o do Windows..." -ForegroundColor DarkGray
        Start-Process "ms-settings:display"
        Write-Host "Ajuste a resolu√ß√£o conforme necess√°rio na janela de configura√ß√µes que foi aberta." -ForegroundColor Green
        
        $waitForSettings = Read-Host "Pressione Enter quando terminar de ajustar as configura√ß√µes de exibi√ß√£o"
    } else {
        Write-Host "Configura√ß√£o de resolu√ß√£o mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizados os ajustes visuais b√°sicos!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleGamingOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Jogos (Simplificado): Mais FPS, menos lag! ---" -ForegroundColor Magenta
    Write-Host "Vamos fazer alguns ajustes para melhorar o desempenho dos seus jogos sem complica√ß√µes." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ativar Modo de Jogo do Windows
    Write-Host "Ativando o Modo de Jogo do Windows para priorizar recursos para jogos..." -ForegroundColor Yellow
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AllowAutoGameMode" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AutoGameModeEnabled" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Write-Host "Modo de Jogo do Windows ativado!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Desativar Game DVR e Game Bar
    Write-Host "O Game DVR e Game Bar podem reduzir o desempenho em jogos. Deseja desativ√°-los?" -ForegroundColor Yellow
    $confirmGameDVR = Read-Host "Desativar Game DVR e Game Bar? (s/n)"
    
    if ($confirmGameDVR -eq 's') {
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "UseNexusForGameBarEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\System\GameConfigStore" -Name "GameDVR_Enabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR" -Name "AppCaptureEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Write-Host "Game DVR e Game Bar desativados!" -ForegroundColor Green
    } else {
        Write-Host "Game DVR e Game Bar mantidos ativos." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Otimizar Plano de Energia para Jogos
    Write-Host "Configurando plano de energia para alto desempenho (ideal para jogos)..." -ForegroundColor Yellow
    powercfg.exe /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c
    Write-Host "Plano de energia configurado para alto desempenho!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Configura√ß√µes de Mouse
    Write-Host "Otimizando configura√ß√µes de mouse para jogos (precis√£o do ponteiro)..." -ForegroundColor Yellow
    $confirmMouseFix = Read-Host "Desativar a acelera√ß√£o do mouse para melhor precis√£o em jogos? (s/n)"
    
    if ($confirmMouseFix -eq 's') {
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseSpeed" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold1" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold2" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Write-Host "Acelera√ß√£o do mouse desativada para melhor precis√£o em jogos!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do mouse mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Otimizar Prioridade de CPU para Jogos
    Write-Host "Configurando prioridade de CPU para jogos..." -ForegroundColor Yellow
    Write-Host "Esta configura√ß√£o ajusta o sistema para dar mais prioridade aos jogos." -ForegroundColor DarkGray
    
    # Criar chave de registro para prioridade de jogos
    if (-not (Test-Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games")) {
        New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Force | Out-Null
    }
    
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "GPU Priority" -Type DWord -Value 8 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Priority" -Type DWord -Value 6 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Scheduling Category" -Type String -Value "High" -Force -ErrorAction SilentlyContinue
    
    Write-Host "Prioridade de CPU para jogos otimizada!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Verificar Driver de Placa de V√≠deo
    Write-Host "Verificando informa√ß√µes da placa de v√≠deo..." -ForegroundColor Yellow
    $gpuInfo = Get-WmiObject -Class Win32_VideoController | Select-Object Name, DriverVersion, CurrentHorizontalResolution, CurrentVerticalResolution
    
    foreach ($gpu in $gpuInfo) {
        Write-Host "Placa de v√≠deo: $($gpu.Name)" -ForegroundColor White
        Write-Host "Vers√£o do driver: $($gpu.DriverVersion)" -ForegroundColor White
        Write-Host "Resolu√ß√£o atual: $($gpu.CurrentHorizontalResolution) x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
      x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
    
    Write-Host "Recomenda√ß√£o: Mantenha seus drivers de v√≠deo atualizados para melhor desempenho em jogos!" -ForegroundColor Green
    Write-Host "Voc√™ pode baixar os drivers mais recentes nos sites oficiais da NVIDIA, AMD ou Intel." -ForegroundColor DarkGray
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nOtimiza√ß√µes para jogos conclu√≠das! Seus jogos devem rodar mais suaves agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleSecurityMaintenance {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Manuten√ß√£o de Seguran√ßa (Simplificado): Mantenha seu PC protegido! ---" -ForegroundColor DarkYellow
    Write-Host "Vamos verificar e melhorar a seguran√ßa do seu sistema com alguns ajustes simples." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Verificar Status do Windows Defender
    Write-Host "Verificando status do Windows Defender..." -ForegroundColor Yellow
    $defenderStatus = Get-MpComputerStatus
    
    Write-Host "Status do Windows Defender:" -ForegroundColor White
    Write-Host "Antiv√≠rus habilitado: $($defenderStatus.AntivirusEnabled)" -ForegroundColor $(if ($defenderStatus.AntivirusEnabled) { "Green" } else { "Red" })
    Write-Host "Prote√ß√£o em tempo real: $($defenderStatus.RealTimeProtectionEnabled)" -ForegroundColor $(if ($defenderStatus.RealTimeProtectionEnabled) { "Green" } else { "Red" })
    Write-Host "Defini√ß√µes de antiv√≠rus: $($defenderStatus.AntivirusSignatureVersion)" -ForegroundColor White
    Write-Host "√öltima atualiza√ß√£o: $($defenderStatus.AntivirusSignatureLastUpdated)" -ForegroundColor White
    Write-Host ""

    # Comando 2: Atualizar Defini√ß√µes do Windows Defender
    Write-Host "Atualizando defini√ß√µes do Windows Defender..." -ForegroundColor Yellow
    Update-MpSignature -ErrorAction SilentlyContinue
    Write-Host "Defini√ß√µes do Windows Defender atualizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Verificar Atualiza√ß√µes do Windows
    Write-Host "Verificando status das atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
            Write-Host "Recomenda√ß√£o: Execute o Windows Update para manter seu sistema seguro." -ForegroundColor Green
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Verificar Configura√ß√µes de Firewall
    Write-Host "Verificando status do Firewall do Windows..." -ForegroundColor Yellow
    $firewallStatus = Get-NetFirewallProfile
    
    foreach ($profile in $firewallStatus) {
        Write-Host "Perfil: $($profile.Name)" -ForegroundColor White
        Write-Host "Status: $($profile.Enabled)" -ForegroundColor $(if ($profile.Enabled) { "Green" } else { "Red" })
        Write-Host ""
    }
    
    $confirmFirewall = Read-Host "Deseja habilitar o Firewall em todos os perfis? (s/n)"
    if ($confirmFirewall -eq 's') {
        Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True
        Write-Host "Firewall habilitado em todos os perfis!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do Firewall mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Verificar Configura√ß√µes de UAC
    Write-Host "Verificando configura√ß√µes do Controle de Conta de Usu√°rio (UAC)..." -ForegroundColor Yellow
    $uacLevel = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -ErrorAction SilentlyContinue
    
    if ($uacLevel) {
        switch ($uacLevel.ConsentPromptBehaviorAdmin) {
            0 { $uacStatus = "Desativado (N√£o recomendado)" }
            1 { $uacStatus = "Baixo (N√£o recomendado)" }
            2 { $uacStatus = "M√©dio" }
            5 { $uacStatus = "Alto (Recomendado)" }
            default { $uacStatus = "Personalizado" }
        }
        
        Write-Host "N√≠vel atual do UAC: $uacStatus" -ForegroundColor $(if ($uacLevel.ConsentPromptBehaviorAdmin -ge 2) { "Green" } else { "Red" })
        
        $confirmUAC = Read-Host "Deseja configurar o UAC para o n√≠vel recomendado? (s/n)"
        if ($confirmUAC -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -Value 5 -Type DWord -Force -ErrorAction SilentlyContinue
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "PromptOnSecureDesktop" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
            Write-Host "UAC configurado para o n√≠vel recomendado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do UAC mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do UAC." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 6: Verificar Configura√ß√µes de SmartScreen
    Write-Host "Verificando configura√ß√µes do Windows SmartScreen..." -ForegroundColor Yellow
    $smartScreen = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -ErrorAction SilentlyContinue
    
    if ($smartScreen) {
        Write-Host "Status do SmartScreen: $($smartScreen.SmartScreenEnabled)" -ForegroundColor $(if ($smartScreen.SmartScreenEnabled -eq "RequireAdmin" -or $smartScreen.SmartScreenEnabled -eq "Warn") { "Green" } else { "Red" })
        
        $confirmSmartScreen = Read-Host "Deseja habilitar o SmartScreen para maior seguran√ßa? (s/n)"
        if ($confirmSmartScreen -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -Value "RequireAdmin" -Type String -Force -ErrorAction SilentlyContinue
            Write-Host "SmartScreen habilitado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do SmartScreen mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do SmartScreen." -ForegroundColor Red
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nManuten√ß√£o de seguran√ßa conclu√≠da! Seu sistema est√° mais protegido agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

# --- Fun√ß√µes para o Diagn√≥stico R√°pido e Sobre ---
function Invoke-QuickDiagnostic {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Diagn√≥stico R√°pido do Sistema ---" -ForegroundColor Yellow
    Write-Host "Vamos fazer uma verifica√ß√£o r√°pida do estado atual do seu PC." -ForegroundColor Gray
    Write-Host ""

    # Informa√ß√µes do Sistema
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    $sysInfo = Get-SystemInfo
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host ""

    # Uso de CPU
    Write-Host "=== Uso de CPU ===" -ForegroundColor Cyan
    $cpuLoad = (Get-WmiObject Win32_Processor).LoadPercentage
    Write-Host "Uso atual de CPU: $cpuLoad%" -ForegroundColor $(if ($cpuLoad -lt 70) { "Green" } elseif ($cpuLoad -lt 90) { "Yellow" } else { "Red" })
    Write-Host ""

    # Uso de Mem√≥ria
    Write-Host "=== Uso de Mem√≥ria ===" -ForegroundColor Cyan
    $os = Get-WmiObject Win32_OperatingSystem
    $totalMemory = [math]::Round($os.TotalVisibleMemorySize / 1MB, 2)
    $freeMemory = [math]::Round($os.FreePhysicalMemory / 1MB, 2)
    $usedMemory = [math]::Round($totalMemory - $freeMemory, 2)
    $memoryPercentage = [math]::Round(($usedMemory / $totalMemory) * 100, 2)
    
    Write-Host "Mem√≥ria Total: $totalMemory GB" -ForegroundColor White
    Write-Host "Mem√≥ria Usada: $usedMemory GB ($memoryPercentage%)" -ForegroundColor $(if ($memoryPercentage -lt 70) { "Green" } elseif ($memoryPercentage -lt 90) { "Yellow" } else { "Red" })
    Write-Host "Mem√≥ria Livre: $freeMemory GB" -ForegroundColor White
    Write-Host ""

    # Espa√ßo em Disco
    Write-Host "=== Espa√ßo em Disco ===" -ForegroundColor Cyan
    $drives = Get-PSDrive -PSProvider FileSystem
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        $percentFree = [math]::Round(($freeSpace / $totalSpace) * 100, 2)
        
        Write-Host "Drive $($drive.Name):" -ForegroundColor White
        Write-Host "  Total: $totalSpace GB" -ForegroundColor White
        Write-Host "  Usado: $usedSpace GB" -ForegroundColor White
        Write-Host "  Livre: $freeSpace GB ($percentFree%)" -ForegroundColor $(if ($percentFree -gt 20) { "Green" } elseif ($percentFree -gt 10) { "Yellow" } else { "Red" })
    }
    Write-Host ""

    # Processos que mais consomem recursos
    Write-Host "=== Top 5 Processos (CPU) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object CPU -Descending | Select-Object -First 5 ProcessName, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}}, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host ""

    Write-Host "=== Top 5 Processos (Mem√≥ria) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 5 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}}, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}} | Format-Table -AutoSize
    Write-Host ""

    # Status de Servi√ßos Cr√≠ticos
    Write-Host "=== Status de Servi√ßos Cr√≠ticos ===" -ForegroundColor Cyan
    $criticalServices = @("wuauserv", "WinDefend", "MpsSvc", "wscsvc")
    foreach ($service in $criticalServices) {
        $serviceStatus = Get-Service -Name $service -ErrorAction SilentlyContinue
        if ($serviceStatus) {
            Write-Host "$($serviceStatus.DisplayName): $($serviceStatus.Status)" -ForegroundColor $(if ($serviceStatus.Status -eq "Running") { "Green" } else { "Red" })
        }
    }
    Write-Host ""

    # Verificar Atualiza√ß√µes Pendentes
    Write-Host "=== Atualiza√ß√µes do Windows ===" -ForegroundColor Cyan
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Recomenda√ß√µes
    Write-Host "=== Recomenda√ß√µes ===" -ForegroundColor Cyan
    
    # Recomenda√ß√£o de Mem√≥ria
    if ($memoryPercentage -gt 80) {
        Write-Host "- Seu uso de mem√≥ria est√° alto. Considere fechar alguns programas ou usar a op√ß√£o 'Otimiza√ß√£o de Mem√≥ria'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Disco
    $lowDiskSpace = $false
    foreach ($drive in $drives) {
        $percentFree = [math]::Round(($drive.Free / ($drive.Free + $drive.Used)) * 100, 2)
        if ($percentFree -lt 15) {
            $lowDiskSpace = $true
            break
        }
    }
    
    if ($lowDiskSpace) {
        Write-Host "- Espa√ßo em disco baixo detectado. Considere usar a op√ß√£o 'Limpeza Geral do Sistema'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Atualiza√ß√µes
    if ($pendingUpdates -gt 0) {
        Write-Host "- Existem atualiza√ß√µes pendentes. Recomendamos atualizar seu sistema para maior seguran√ßa." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Inicializa√ß√£o
    $bootTime = $sysInfo.LastBootTime
    $uptime = (Get-Date) - $bootTime
    if ($uptime.Days -gt 7) {
        Write-Host "- Seu sistema est√° ligado h√° $($uptime.Days) dias. Considere reiniciar para aplicar atualiza√ß√µes e limpar a mem√≥ria." -ForegroundColor Yellow
    }
    
    Write-Host ""

    # Mensagem de conclus√£o
    Write-Host "`nDiagn√≥stico r√°pido conclu√≠do! Use as informa√ß√µes acima para decidir quais otimiza√ß√µes fazer." -ForegroundColor Green

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

function Show-AboutTORK {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Sobre o TORK ---" -ForegroundColor White
    Write-Host ""
    
    Write-Host "TORK - Otimizador para Windows" -ForegroundColor Cyan
    Write-Host "Vers√£o: 2.0" -ForegroundColor White
    Write-Host "Desenvolvido por: Partner77" -ForegroundColor White
    Write-Host ""
    
    Write-Host "=== Descri√ß√£o ===" -ForegroundColor Yellow
    Write-Host "O TORK √© uma ferramenta abrangente de otimiza√ß√£o para Windows, projetada para" -ForegroundColor Gray
    Write-Host "melhorar o desempenho do seu sistema atrav√©s de limpeza, ajustes e otimiza√ß√µes." -ForegroundColor Gray
    Write-Host "Ele oferece op√ß√µes simplificadas para usu√°rios comuns e op√ß√µes avan√ßadas para" -ForegroundColor Gray
    Write-Host "usu√°rios experientes que desejam um controle mais detalhado sobre o sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Recursos ===" -ForegroundColor Yellow
    Write-Host "- Limpeza completa do sistema" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√£o de mem√≥ria e inicializa√ß√£o" -ForegroundColor Gray
    Write-Host "- Ajustes de rede para melhor conectividade" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√µes visuais para melhor desempenho" -ForegroundColor Gray
    Write-Host "- Configura√ß√µes espec√≠ficas para jogos" -ForegroundColor Gray
    Write-Host "- Manuten√ß√£o de seguran√ßa" -ForegroundColor Gray
    Write-Host "- Diagn√≥stico r√°pido do sistema" -ForegroundColor Gray
    Write-Host "- Mais de 100 ajustes e otimiza√ß√µes avan√ßadas" -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Aviso Legal ===" -ForegroundColor Yellow
    Write-Host "Este software √© fornecido 'como est√°', sem garantias de qualquer tipo." -ForegroundColor Gray
    Write-Host "O autor n√£o se responsabiliza por quaisquer danos ou problemas causados pelo uso" -ForegroundColor Gray
    Write-Host "deste software. Use por sua conta e risco. Recomendamos sempre fazer backup" -ForegroundColor Gray
    Write-Host "dos seus dados importantes antes de realizar otimiza√ß√µes no sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Agradecimentos ===" -ForegroundColor Yellow
    Write-Host "Obrigado por escolher o TORK para otimizar seu sistema Windows!" -ForegroundColor Gray
    Write-Host "Esperamos que esta ferramenta ajude a melhorar o desempenho do seu PC." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "¬© 2023-2024 Partner77 - Todos os direitos reservados" -ForegroundColor Cyan
    Write-Host ""
    
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - LIMPEZA (Expandidas) ---
function Invoke-CleanUserTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Usu√°rio ---" -ForegroundColor Cyan
    Write-Host "Remove arquivos da pasta tempor√°ria do seu usu√°rio (`$env:TEMP`)." -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:TEMP..." -ForegroundColor Yellow
    $tempFiles = Get-ChildItem -Path $env:TEMP -Recurse -ErrorAction SilentlyContinue
    $tempFilesCount = ($tempFiles | Measure-Object).Count
    $tempFilesSize = ($tempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $tempFilesCount arquivos tempor√°rios ocupando aproximadamente $([math]::Round($tempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Sistema ---" -ForegroundColor Gray
    Write-Host "Remove arquivos da pasta tempor√°ria do Windows (`$env:SystemRoot\Temp`)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:SystemRoot\Temp..." -ForegroundColor Yellow
    $systemTempFiles = Get-ChildItem -Path "$env:SystemRoot\Temp" -Recurse -ErrorAction SilentlyContinue
    $systemTempFilesCount = ($systemTempFiles | Measure-Object).Count
    $systemTempFilesSize = ($systemTempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $systemTempFilesCount arquivos tempor√°rios do sistema ocupando aproximadamente $([math]::Round($systemTempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do sistema removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanDnsCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-EmptyRecycleBin {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Esvaziar Lixeira ---" -ForegroundColor Gray
    Write-Host "Esvazia a lixeira do usu√°rio logado." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar tamanho da lixeira antes de esvaziar
    Write-Host "Verificando tamanho da lixeira..." -ForegroundColor Yellow
    
    try {
        $shell = New-Object -ComObject Shell.Application
        $recycleBin = $shell.Namespace(0xA)
        $recycleBinItems = $recycleBin.Items()
        $recycleBinItemCount = $recycleBinItems.Count
        
        Write-Host "A lixeira cont√©m $recycleBinItemCount itens." -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o conte√∫do da lixeira." -ForegroundColor DarkGray
    }
    
    # Esvaziar a lixeira
    Write-Host "Executando: Esvaziando a lixeira..." -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanThumbnailCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Miniaturas ---" -ForegroundColor Green
    Write-Host "Remove o cache de miniaturas de arquivos (imagens, v√≠deos, etc.)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Limpando cache de miniaturas..." -ForegroundColor Yellow
    
    # Verificar tamanho do cache de miniaturas antes da limpeza
    $thumbnailPath = "$env:LOCALAPPDATA\Microsoft\Windows\Explorer"
    $thumbnailFiles = Get-ChildItem -Path $thumbnailPath -Filter "thumbcache_*.db" -ErrorAction SilentlyContinue
    $thumbnailFilesCount = ($thumbnailFiles | Measure-Object).Count
    $thumbnailFilesSize = ($thumbnailFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $thumbnailFilesCount arquivos de cache de miniaturas ocupando aproximadamente $([math]::Round($thumbnailFilesSize, 2)) MB." -ForegroundColor White
    
    # Limpar o cache de miniaturas
    Stop-Process -Name explorer -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Start-Process explorer
    
    Write-Host "Cache de miniaturas limpo com sucesso!" -ForegroundColor Green
    Write-Host "O Windows Explorer foi reiniciado para aplicar as altera√ß√µes." -ForegroundColor DarkGray
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de miniaturas:" -ForegroundColor Cyan
    Write-Host "- Navega√ß√£o mais r√°pida em pastas com muitas imagens ou v√≠deos" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de miniaturas corrompidas ou desatualizadas" -ForegroundColor DarkGray
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemLogs {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Logs do Sistema ---" -ForegroundColor Cyan
    Write-Host "Limpa os logs de eventos do sistema para liberar espa√ßo e melhorar o desempenho." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando logs do sistema..." -ForegroundColor Yellow
    
    # Verificar tamanho dos logs antes da limpeza
    $eventLogs = Get-WinEvent -ListLog * -ErrorAction SilentlyContinue | Where-Object { $_.RecordCount -gt 0 }
    $totalLogCount = ($eventLogs | Measure-Object).Count
    $total### Enhanced TORK Optimizer

I'll enhance the TORK optimizer with more comprehensive functionality across all features, starting with an expanded Simple Cleanup function and then improving all other options.

```powershell type="code"
# Define a preferencia de acao para erros (continua a execucao por padrao)
# Permite que o script tente rodar o m√°ximo poss√≠vel mesmo que alguns comandos encontrem problemas.
$ErrorActionPreference = 'SilentlyContinue' # N√£o exibe erros se um item n√£o puder ser processado, por exemplo.

# --- Funcao pra Centralizar Texto (Nosso Maestro de Alinhamento - s√≥ pra textos, n√£o pro bannerz√£o!) ---
# Deixa ela aqui, vai que a gente usa pra centralizar outra coisa, n√©?
function Centraliza($texto, $cor="White") {
    $largura = [console]::WindowWidth # Pega a largura da largura da janela agora
    # Calcula o espa√ßo pra botar o texto no meio. Pura matem√°tica da zoeira!
    $espacos = [Math]::Max(0, [Math]::Floor(($largura - $texto.Length) / 2))
    $linha = (" " * $espacos) + $texto # Cria a linha com os espa√ßos e o texto
    Write-Host $linha -ForegroundColor $cor # Manda pro console com a cor pedida
}

# --- Funcao que Desenha o Nosso Banner Irado do TORK! ---
# Esse √© o nosso outdoor digital no console! Ajustado pros espa√ßos que voc√™ mandou!
# Se as bordas ainda estiverem meio teimosas, √© o jeitinho do console mesmo, viu? üòâ
function Banner-TORK {
    # Nossas cores vibrantes para o banner!
    $CorBorda = "DarkCyan" # Mantido para a borda, combina com o ciano. Se quiser mudar, √© aqui!
    $CorLogo = "Green" # Cor vibrante
    $CorProjeto = "Cyan" # Cor vibrante
    $CorCopyright = "Gray" # Tom mais suave

    Write-Host "" # D√° um espacinho no topo, pra n√£o grudar
    Write-Host "                    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë          ‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë ‚ñà‚ñà‚ïî‚ïù                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ñà‚ñà‚ïó                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù                                          ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë           Bem-vindo ao TORK - Otimizador para Windows!                                ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë        Projeto de automacao, limpeza, manutencao e tweaks.                            ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë            (C) Partner77 - Todos os direitos reservados                               ‚ïë" -ForegroundColor $CorCopyright
    Write-Host "                    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor $CorBorda
    Write-Host "" # Espa√ßo embaixo
}

# --- Checagem de Permiss√µes de Administrador (O Guarda da Porta!) ---
# V√™ se a gente t√° rodando com poderes de admin, sen√£o n√£o d√° pra mexer no Windows direito.
function Test-Administrator {
    $currentUser = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())
    return $currentUser.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
}

if (-not (Test-Administrator)) {
    Write-Host "OPA! Calma l√°, patr√£o!" -ForegroundColor Red
    Write-Host "Pra usar o TORK e deixar o PC voando, preciso de super poderes de Administrador!" -ForegroundColor Yellow
    Write-Host "Fecha essa janela, clica com o bot√£o direito no arquivo do script e escolhe 'Executar como administrador'. A√≠ sim, tamo junto!" -ForegroundColor Yellow
    Read-Host "D√° um Enter quando terminar de ler, que a gente se v√™ na pr√≥xima..."
    Exit
}

Write-Host "Poderes de Administrador verificados! Bora nessa!" -ForegroundColor Green
Start-Sleep -Seconds 1

# --- Fun√ß√µes Utilit√°rias (Ferramentas que usamos em v√°rios lugares) ---
function Get-SystemInfo {
    $os = Get-CimInstance Win32_OperatingSystem
    $cs = Get-CimInstance Win32_ComputerSystem
    $proc = Get-CimInstance Win32_Processor
    $mem = Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property Capacity -Sum
    
    $info = @{
        "OSName" = $os.Caption
        "OSVersion" = $os.Version
        "OSBuild" = $os.BuildNumber
        "ComputerName" = $cs.Name
        "Manufacturer" = $cs.Manufacturer
        "Model" = $cs.Model
        "Processor" = $proc.Name
        "Memory" = [math]::Round($mem.Sum / 1GB, 2)
        "Architecture" = $os.OSArchitecture
        "InstallDate" = $os.InstallDate
        "LastBootTime" = $os.LastBootUpTime
    }
    
    return $info
}

function Show-SystemSummary {
    $sysInfo = Get-SystemInfo
    
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Computador: $($sysInfo.ComputerName)" -ForegroundColor White
    Write-Host "Fabricante: $($sysInfo.Manufacturer)" -ForegroundColor White
    Write-Host "Modelo: $($sysInfo.Model)" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "Instalado em: $($sysInfo.InstallDate)" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

function Get-DiskSpaceBefore {
    $drives = Get-PSDrive -PSProvider FileSystem
    $driveInfo = @{}
    
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        
        $driveInfo[$drive.Name] = @{
            "Free" = $freeSpace
            "Used" = $usedSpace
            "Total" = $totalSpace
        }
    }
    
    return $driveInfo
}

function Show-DiskSpaceComparison {
    param (
        $before
    )
    
    $after = Get-PSDrive -PSProvider FileSystem
    
    Write-Host "=== Compara√ß√£o de Espa√ßo em Disco ===" -ForegroundColor Cyan
    
    foreach ($drive in $after) {
        if ($before.ContainsKey($drive.Name)) {
            $freeSpaceAfter = [math]::Round($drive.Free / 1GB, 2)
            $freeSpaceBefore = $before[$drive.Name].Free
            $spaceRecovered = [math]::Round($freeSpaceAfter - $freeSpaceBefore, 2)
            
            Write-Host "Drive $($drive.Name):" -ForegroundColor White
            Write-Host "  Espa√ßo livre antes: $freeSpaceBefore GB" -ForegroundColor Gray
            Write-Host "  Espa√ßo livre agora: $freeSpaceAfter GB" -ForegroundColor Gray
            
            if ($spaceRecovered -gt 0) {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Green
            } else {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Yellow
            }
            Write-Host ""
        }
    }
    
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

# --- Fun√ß√µes dos Menus (Principal, Simplificado, Avan√ßado e Sub-menus) ---

# --- Menu Principal (A Bifurca√ß√£o do Destino! Simplificado vs Avan√ßado) ---
# √â aqui que o usu√°rio escolhe se quer ser um mago ou um cara pr√°tico!
function Show-MainMenu {
    do {
        Clear-Host # Limpa a tela pra organizar o menu
        Banner-TORK # Banner no topo, pra gente n√£o esquecer quem somos!
        Show-SystemSummary # Mostra um resumo do sistema

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "       MENU PRINCIPAL" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # As duas grandes estradas da otimiza√ß√£o! Cores variadas (repetindo)!
        Write-Host "[1] Otimiza√ß√£o Simplificada (Pra quem quer praticidade e resultado r√°pido!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o Avan√ßada (Pra quem curte mexer fundo e ter control total!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[3] Diagn√≥stico R√°pido do Sistema (Ver o que t√° rolando no PC)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[4] Sobre o TORK (Informa√ß√µes e cr√©ditos)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[0] Sair (Ah, que pena... Mas a porta t√° aberta!)" -ForegroundColor Red # Vermelho pra Sair - Ok

        Write-Host ""

        # Pergunta pro usu√°rio qual caminho ele escolhe, tipo Mestre Pok√©mon!
        $choice = Read-Host "Escolhe sua op√ß√£o, treinador!"

        # V√™ pra onde a gente vai com base na escolha
        switch ($choice) {
            "1" { Show-SimplifiedMenu } # Se escolheu 1, vai pro Menu Simplificado!
            "2" { Show-AdvancedMenu } # Se escolheu 2, vai pro Menu Avan√ßado!
            "3" { Invoke-QuickDiagnostic } # Nova fun√ß√£o de diagn√≥stico r√°pido
            "4" { Show-AboutTORK } # Nova fun√ß√£o de sobre
            "0" { Write-Host "Fechou! Valeu por usar o TORK! Volte sempre que seu PC pedir um g√°s! ;)" -ForegroundColor Green; Start-Sleep -Seconds 2; break } # Se escolheu 0, vaza (mas volta!)
            default {
                Write-Host "Eita! Op√ß√£o inv√°lida! Confere os n√∫meros e tenta de novo, bora l√°!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1 # D√° um tempinho pro usu√°rio ver a zoeira da mensagem
            }
        }
    } while ($choice -ne '0') # Repete o Menu Principal enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Simplificado (Aqui o TORK faz m√°gica r√°pida e segura!) ---
# Acessado pela op√ß√£o 1 do Menu Principal. Menos op√ß√µes, mais a√ß√£o direta!
function Show-SimplifiedMenu {
    do {
        Clear-Host # Limpa o palco pra esse menu!
        Banner-TORK # Nosso banner no topo, sempre presente!

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "   OTIMIZACAO SIMPLIFICADA" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes SIMPLIFICADAS - cada uma pode fazer um monte de coisa por baixo dos panos! Cores variadas (repetindo as prim√°rias/neon e adicionando outras)!
        Write-Host "[1] Limpeza Geral do Sistema (Tira o lixo que t√° pesando!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o de Mem√≥ria e Programas que Ligam com o Windows (Deixa tudo mais √°gil!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[3] Acelerar a Conex√£o com a Internet (Pra navegar sem gargalo!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[4] Deixar o Windows mais Leve Visualmente (Desativa uns efeitos pra ganhar desempenho!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Otimiza√ß√£o de Jogos (Configura√ß√µes pra melhorar FPS e desempenho)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[6] Manuten√ß√£o de Seguran√ßa (Verificar e corrigir problemas de seguran√ßa)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[7] RODAR TODAS as otimiza√ß√µes SIMPLIFICADAS! (Modo Turbo F√°cil!)" -ForegroundColor Red # Vermelho pra "Faz Tudo" - Destaque/Cuidado
        Write-Host "[0] Voltar ao Menu Principal (A gente te espera aqui!)" -ForegroundColor Gray # Cor neutra pra voltar

        Write-Host ""

        # Pergunta qual m√°gica simplificada o usu√°rio quer
        $choice = Read-Host "Escolhe sua m√°gica simplificada!"

        # V√™ qual m√°gica rodar
        switch ($choice) {
            "1" { Invoke-SimpleSystemCleanup } # Chama a fun√ß√£o de limpeza b√°sica
            "2" { Invoke-SimpleMemoryStartup } # Chama a fun√ß√£o pra mem√≥ria/inicializa√ß√£o
            "3" { Invoke-SimpleInternetOpt } # Chama a fun√ß√£o pra internet
            "4" { Invoke-SimpleVisualOpt } # Chama a fun√ß√£o pra visual
            "5" { Invoke-SimpleGamingOpt } # Nova fun√ß√£o para otimiza√ß√£o de jogos
            "6" { Invoke-SimpleSecurityMaintenance } # Nova fun√ß√£o para manuten√ß√£o de seguran√ßa
            "7" {
                # Rodar todas as simplificadas sequencialmente
                Write-Host "`nModo Turbo F√°cil ATIVADO! Rodando todas as otimiza√ß√µes SIMPLIFICADAS... segura pe√£o!`n" -ForegroundColor Yellow
                Invoke-SimpleSystemCleanup # Roda a 1
                Invoke-SimpleMemoryStartup # Roda a 2
                Invoke-SimpleInternetOpt # Roda a 3
                Invoke-SimpleVisualOpt # Roda a 4
                Invoke-SimpleGamingOpt # Roda a 5
                Invoke-SimpleSecurityMaintenance # Roda a 6
                Write-Host "`nShow! Todas as otimiza√ß√µes SIMPLIFICADAS foram executadas! PC t√° agradecendo! ;)`n" -ForegroundColor Green
                Read-Host "Aperta Enter pra voltar pro Menu Simplificado..." # Pausa no final do "Rodar Todas"
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-MainMenu
            default {
                Write-Host "Ops! Op√ß√£o inv√°lida no Menu Simplificado! Confere os n√∫meros e manda bala de novo!" -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Simplificado enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Avan√ßado (O Playground dos Magos do PC!) ---
# Acessado pela op√ß√£o 2 do Menu Principal. Aqui a gente mergulha fundo!
function Show-AdvancedMenu {
    do {
        Clear-Host # Limpa o palco pro menu avan√ßado!
        Banner-TORK # Nosso banner no topo, pra n√£o perder a pose!

        Write-Host "" # Espacinho maroto
        Write-Host "===============================" -ForegroundColor White
        Write-Host "      MENU AVANCADO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes do menu avan√ßado (as CATEGORIAS dos 200 poderes!) Cores variadas (repetindo)!
        Write-Host "[1] Limpeza e Manuten√ß√£o de Arquivos (Tirar a poeira digital!)" -ForegroundColor Cyan # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[2] Otimiza√ß√µes de Desempenho do Sistema (Deixar o motor roncando!)" -ForegroundColor Green # Cor variada
        Write-Host "[3] Configura√ß√µes e Otimiza√ß√µes de Rede (Pra internet voar baixo!)" -ForegroundColor Yellow # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[4] Gerenciamento e Otimiza√ß√£o de Servi√ßos do Windows (O que t√° rodando e n√£o precisa?!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Ferramentas de Diagn√≥stico e Verifica√ß√£o (Pra ver se t√° tudo nos conformes!)" -ForegroundColor Cyan # Cor repetida
        Write-Host "[6] Desabilitar/Gerenciar Recursos do Windows (Tirar o peso extra do sistema!)" -ForegroundColor Green # Cor repetida
        Write-Host "[7] Gerenciamento de Arquivos e Pastas Avan√ßado (Comandos ninja pra arquivos!)" -ForegroundColor Yellow # Cor repetida
        Write-Host "[8] Gerenciamento de Contas de Usu√°rio (Organizar a galera que usa o PC!)" -ForegroundColor White # Cor repetida
        Write-Host "[9] Otimiza√ß√£o para Jogos Avan√ßada (Tweaks pra gamers de verdade!)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Configura√ß√µes de Privacidade (Controle o que o Windows sabe sobre voc√™)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[11] Outras Configura√ß√µes e Tweaks Diversos (Aqueles ajustes secretos!)" -ForegroundColor Gray # Cor neutra/escura
        Write-Host "[0] Voltar ao Menu Principal (Pronto pra voltar pra estrada principal!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta pro mago qual categoria ele quer explorar
        $choice = Read-Host "Escolhe sua √°rea de magia, mago!"

        # V√™ pra onde a gente navega dentro do mundo avan√ßado
        switch ($choice) {
            "1" { Show-LimpezaManutencaoMenu } # CHAMA O SUB-MENU DE LIMPEZA
            "2" { Show-DesempenhoMenu } # Agora √© um sub-menu tamb√©m
            "3" { Show-ConfiguracoesRedeMenu } # CHAMA O SUB-MENU DE REDE
            "4" { Show-ServicosMenu } # Agora √© um sub-menu tamb√©m
            "5" { Show-DiagnosticoMenu } # Agora √© um sub-menu tamb√©m
            "6" { Show-RecursosMenu } # Agora √© um sub-menu tamb√©m
            "7" { Show-ArquivosPastasMenu } # Agora √© um sub-menu tamb√©m
            "8" { Show-UsuariosMenu } # Agora √© um sub-menu tamb√©m
            "9" { Show-JogosAvancadoMenu } # Novo sub-menu para jogos
            "10" { Show-PrivacidadeMenu } # Novo sub-menu para privacidade
            "11" { Show-OutrosMenu } # Agora √© um sub-menu tamb√©m
            "0" { break } # Sai do loop deste menu, voltando pro Menu Principal
            default {
                Write-Host "Humm, essa √°rea da magia ainda n√£o existe ou voc√™ digitou errado! Tenta de novo, mago!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Avan√ßado enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Limpeza e Manuten√ß√£o (Dentro do Avan√ßado!) ---
# Este menu lista as op√ß√µes ESPEC√çFICAS da categoria Limpeza no Menu Avan√ßado
function Show-LimpezaManutencaoMenu {
    do {
        Clear-Host # Limpa o palco pra este sub-menu!
        Banner-TORK # Banner no topo, sempre!

        Write-Host "" # Espacinho
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: LIMPEZA E MANUT." -ForegroundColor White # T√≠tulo menor pro sub-menu
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes ESPEC√çFICAS da categoria Limpeza. Cores variadas (repetindo cores)!
        Write-Host "[1] Limpar Arquivos Tempor√°rios do Usu√°rio (Tipo a pasta Temp!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[2] Limpar Arquivos Tempor√°rios do Sistema (Os tempor√°rios do Windows!)" -ForegroundColor Gray # Cor neutra (substitui DarkCyan)
        Write-Host "[3] Limpar Cache de DNS (Pra resolver nomes de site mais r√°pido!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[4] Esvaziar Lixeira (Adeus, arquivos deletados!)" -ForegroundColor Gray # Cor neutra (repetindo)
        Write-Host "[5] Limpar Cache de Miniaturas (Aqueles previews de imagem/v√≠deo!)" -ForegroundColor Green # Cor variada
        Write-Host "[6] Limpar Logs do Sistema (Arquivos de registro que acumulam)" -ForegroundColor Cyan # Nova op√ß√£o
        Write-Host "[7] Limpar Cache de Atualiza√ß√µes do Windows (Liberar espa√ßo de updates)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[8] Limpar Arquivos de Hiberna√ß√£o (Liberar o hiberfil.sys)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[9] Limpar Arquivos WinSxS (Pasta que ocupa muito espa√ßo)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Executar TODAS as limpezas acima (Faxina completa!)" -ForegroundColor Red # Nova op√ß√£o
        Write-Host "[0] Voltar ao Menu Avan√ßado (De volta pras categorias!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta qual limpeza espec√≠fica o mago quer fazer
        $choice = Read-Host "Escolhe a limpeza avan√ßada, mestre!"

        # V√™ qual fun√ß√£o de limpeza espec√≠fica chamar
        switch ($choice) {
            "1" { Invoke-CleanUserTemp } # Chama a fun√ß√£o pra Limpar Temp Usu√°rio
            "2" { Invoke-CleanSystemTemp } # Chama a fun√ß√£o pra Limpar Temp Sistema
            "3" { Invoke-CleanDnsCache } # Chama a fun√ß√£o pra Limpar Cache DNS
            "4" { Invoke-EmptyRecycleBin } # Chama a fun√ß√£o pra Esvaziar Lixeira
            "5" { Invoke-CleanThumbnailCache } # Chama a fun√ß√£o pra Limpar Cache de Miniaturas
            "6" { Invoke-CleanSystemLogs } # Nova fun√ß√£o para limpar logs do sistema
            "7" { Invoke-CleanWindowsUpdateCache } # Nova fun√ß√£o para limpar cache de updates
            "8" { Invoke-CleanHibernationFile } # Nova fun√ß√£o para limpar arquivo de hiberna√ß√£o
            "9" { Invoke-CleanWinSxS } # Nova fun√ß√£o para limpar pasta WinSxS
            "10" { 
                # Executa todas as limpezas em sequ√™ncia
                Write-Host "`nIniciando faxina completa do sistema! Isso pode demorar um pouco...`n" -ForegroundColor Yellow
                $diskSpaceBefore = Get-DiskSpaceBefore
                
                Invoke-CleanUserTemp
                Invoke-CleanSystemTemp
                Invoke-CleanDnsCache
                Invoke-EmptyRecycleBin
                Invoke-CleanThumbnailCache
                Invoke-CleanSystemLogs
                Invoke-CleanWindowsUpdateCache
                Invoke-CleanHibernationFile
                Invoke-CleanWinSxS
                
                Write-Host "`nFaxina completa finalizada! Veja quanto espa√ßo foi recuperado:`n" -ForegroundColor Green
                Show-DiskSpaceComparison -before $diskSpaceBefore
                Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-AdvancedMenu
            default {
                Write-Host "Essa tarefa de limpeza ainda n√£o t√° na lista! V√™ os n√∫meros e tenta de novo!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Sub-Menu Limpeza enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Desempenho (Dentro do Avan√ßado!) ---
function Show-DesempenhoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DESEMPENHO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Ajustar Efeitos Visuais para Melhor Desempenho" -ForegroundColor Green
        Write-Host "[2] Otimizar Disco do Sistema" -ForegroundColor Cyan
        Write-Host "[3] Limpar Arquivos Prefetch" -ForegroundColor Yellow
        Write-Host "[4] Definir Plano de Energia para Alto Desempenho" -ForegroundColor White
        Write-Host "[5] Otimizar Servi√ßo SuperFetch/SysMain" -ForegroundColor Magenta
        Write-Host "[6] Ajustar Tamanho da Mem√≥ria Virtual" -ForegroundColor Gray
        Write-Host "[7] Desativar Indexa√ß√£o de Arquivos" -ForegroundColor Green
        Write-Host "[8] Otimizar Inicializa√ß√£o do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de desempenho" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o de desempenho"

        switch ($choice) {
            "1" { Invoke-OptimizeVisualEffects }
            "2" { Invoke-OptimizeDisk }
            "3" { Invoke-CleanPrefetch }
            "4" { Invoke-SetHighPerformancePower }
            "5" { Invoke-OptimizeSuperFetch }
            "6" { Invoke-AdjustVirtualMemory }
            "7" { Invoke-DisableIndexing }
            "8" { Invoke-OptimizeStartup }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de desempenho...`n" -ForegroundColor Yellow
                Invoke-OptimizeVisualEffects
                Invoke-OptimizeDisk
                Invoke-CleanPrefetch
                Invoke-SetHighPerformancePower
                Invoke-OptimizeSuperFetch
                Invoke-AdjustVirtualMemory
                Invoke-DisableIndexing
                Invoke-OptimizeStartup
                Write-Host "`nTodas as otimiza√ß√µes de desempenho foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Configura√ß√µes de Rede (Dentro do Avan√ßado!) ---
function Show-ConfiguracoesRedeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: CONFIG. REDE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Limpar Cache de DNS" -ForegroundColor Yellow
        Write-Host "[2] Mudar Servidor DNS" -ForegroundColor Cyan
        Write-Host "[3] Resetar Configura√ß√µes de Rede" -ForegroundColor White
        Write-Host "[4] Otimizar Configura√ß√µes TCP/IP" -ForegroundColor Green
        Write-Host "[5] Verificar Velocidade da Conex√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar QoS (Qualidade de Servi√ßo)" -ForegroundColor Gray
        Write-Host "[7] Desativar IPv6 (Se n√£o estiver usando)" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Lat√™ncia de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de rede" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√£o de rede"

        switch ($choice) {
            "1" { Invoke-NetworkFlushDns }
            "2" { Invoke-NetworkChangeDns }
            "3" { Invoke-NetworkReset }
            "4" { Invoke-OptimizeTcpIp }
            "5" { Invoke-CheckNetworkSpeed }
            "6" { Invoke-ConfigureQoS }
            "7" { Invoke-DisableIPv6 }
            "8" { Invoke-OptimizeGamingLatency }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de rede...`n" -ForegroundColor Yellow
                Invoke-NetworkFlushDns
                Invoke-OptimizeTcpIp
                Invoke-CheckNetworkSpeed
                Invoke-ConfigureQoS
                Invoke-DisableIPv6
                Invoke-OptimizeGamingLatency
                Write-Host "`nTodas as otimiza√ß√µes de rede foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Rede..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Servi√ßos (Dentro do Avan√ßado!) ---
function Show-ServicosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: SERVICOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desabilitar Servi√ßo SuperFetch/SysMain" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Servi√ßo de Impress√£o" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Servi√ßo Windows Update" -ForegroundColor White
        Write-Host "[4] Listar Todos os Servi√ßos em Execu√ß√£o" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Otimizar Servi√ßos para Desempenho Geral" -ForegroundColor Gray
        Write-Host "[7] Restaurar Servi√ßos para Configura√ß√£o Padr√£o" -ForegroundColor Yellow
        Write-Host "[8] Desabilitar Servi√ßos Desnecess√°rios" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de servi√ßos"

        switch ($choice) {
            "1" { Invoke-ManageSuperFetch }
            "2" { Invoke-ManagePrintService }
            "3" { Invoke-ManageWindowsUpdate }
            "4" { Invoke-ListRunningServices }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-OptimizeServicesForPerformance }
            "7" { Invoke-RestoreDefaultServices }
            "8" { Invoke-DisableUnnecessaryServices }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Diagn√≥stico (Dentro do Avan√ßado!) ---
function Show-DiagnosticoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DIAGNOSTICO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Verificar Arquivos do Sistema (SFC)" -ForegroundColor Yellow
        Write-Host "[2] Reparar Imagem do Windows (DISM)" -ForegroundColor Cyan
        Write-Host "[3] Verificar Disco por Erros (CHKDSK)" -ForegroundColor White
        Write-Host "[4] Verificar Sa√∫de do Disco" -ForegroundColor Green
        Write-Host "[5] Verificar Drivers Desatualizados" -ForegroundColor Magenta
        Write-Host "[6] Verificar Problemas de Inicializa√ß√£o" -ForegroundColor Gray
        Write-Host "[7] Verificar Problemas de Mem√≥ria RAM" -ForegroundColor Yellow
        Write-Host "[8] Verificar Temperatura do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODOS os diagn√≥sticos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de diagn√≥stico"

        switch ($choice) {
            "1" { Invoke-SfcScan }
            "2" { Invoke-DismRepair }
            "3" { Invoke-ChkDsk }
            "4" { Invoke-CheckDiskHealth }
            "5" { Invoke-CheckDrivers }
            "6" { Invoke-CheckStartupIssues }
            "7" { Invoke-CheckMemory }
            "8" { Invoke-CheckTemperature }
            "9" {
                Write-Host "`nExecutando todos os diagn√≥sticos...`n" -ForegroundColor Yellow
                Invoke-SfcScan
                Invoke-DismRepair
                Invoke-CheckDiskHealth
                Invoke-CheckDrivers
                Invoke-CheckStartupIssues
                Invoke-CheckTemperature
                Write-Host "`nTodos os diagn√≥sticos foram conclu√≠dos!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Diagn√≥stico..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Recursos (Dentro do Avan√ßado!) ---
function Show-RecursosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: RECURSOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Gerenciar Hiberna√ß√£o" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Planos de Energia" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Recursos Opcionais do Windows" -ForegroundColor White
        Write-Host "[4] Gerenciar Mem√≥ria Virtual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Windows Defender" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Recursos de Telemetria" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Recursos de Inicializa√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Recursos de Seguran√ßa" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de recursos"

        switch ($choice) {
            "1" { Invoke-ManageHibernation }
            "2" { Invoke-ManagePowerPlans }
            "3" { Invoke-ManageOptionalFeatures }
            "4" { Invoke-ManageVirtualMemory }
            "5" { Invoke-ManageWindowsDefender }
            "6" { Invoke-ManageTelemetry }
            "7" { Invoke-ManageStartupResources }
            "8" { Invoke-ManageSecurityFeatures }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Arquivos e Pastas (Dentro do Avan√ßado!) ---
function Show-ArquivosPastasMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: ARQUIVOS E PASTAS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Encontrar Arquivos Grandes" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Arquivos" -ForegroundColor Cyan
        Write-Host "[3] Tomar Posse de Arquivos (TakeOwn)" -ForegroundColor White
        Write-Host "[4] Listar Conte√∫do de Pastas Espec√≠ficas" -ForegroundColor Green
        Write-Host "[5] Compactar Pastas para Economizar Espa√ßo" -ForegroundColor Magenta
        Write-Host "[6] Verificar Integridade de Arquivos" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Arquivos Ocultos e do Sistema" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Atributos de Arquivos" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de arquivos e pastas"

        switch ($choice) {
            "1" { Invoke-FindLargeFiles }
            "2" { Invoke-ManageFilePermissions }
            "3" { Invoke-TakeOwnership }
            "4" { Invoke-ListFolderContents }
            "5" { Invoke-CompressFolders }
            "6" { Invoke-VerifyFileIntegrity }
            "7" { Invoke-ManageHiddenSystemFiles }
            "8" { Invoke-ManageFileAttributes }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Usu√°rios (Dentro do Avan√ßado!) ---
function Show-UsuariosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: USUARIOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Listar Todos os Usu√°rios Locais" -ForegroundColor Yellow
        Write-Host "[2] Listar Todos os Grupos Locais" -ForegroundColor Cyan
        Write-Host "[3] Listar Membros de Grupos Espec√≠ficos" -ForegroundColor White
        Write-Host "[4] Mostrar Propriedades do Usu√°rio Atual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Contas de Usu√°rio" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Pol√≠ticas de Senha" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Permiss√µes de Usu√°rio" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar UAC (Controle de Conta de Usu√°rio)" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de usu√°rios"

        switch ($choice) {
            "1" { Invoke-ListLocalUsers }
            "2" { Invoke-ListLocalGroups }
            "3" { Invoke-ListGroupMembers }
            "4" { Invoke-ShowCurrentUserProperties }
            "5" { Invoke-ManageUserAccounts }
            "6" { Invoke-ManagePasswordPolicies }
            "7" { Invoke-ManageUserPermissions }
            "8" { Invoke-ManageUAC }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Jogos Avan√ßado (Dentro do Avan√ßado!) ---
function Show-JogosAvancadoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: JOGOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Otimizar Prioridade de CPU para Jogos" -ForegroundColor Yellow
        Write-Host "[2] Otimizar Configura√ß√µes de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[3] Otimizar Configura√ß√µes de GPU" -ForegroundColor White
        Write-Host "[4] Desativar Game DVR e Game Bar" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Configurar Modo de Jogo do Windows" -ForegroundColor Gray
        Write-Host "[7] Otimizar Configura√ß√µes de √Åudio para Jogos" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Configura√ß√µes de Input Lag" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes para jogos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o para jogos"

        switch ($choice) {
            "1" { Invoke-OptimizeCpuPriority }
            "2" { Invoke-OptimizeNetworkForGaming }
            "3" { Invoke-OptimizeGpuSettings }
            "4" { Invoke-DisableGameDvrBar }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-ConfigureGameMode }
            "7" { Invoke-OptimizeAudioForGaming }
            "8" { Invoke-OptimizeInputLag }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes para jogos...`n" -ForegroundColor Yellow
                Invoke-OptimizeCpuPriority
                Invoke-OptimizeNetworkForGaming
                Invoke-OptimizeGpuSettings
                Invoke-DisableGameDvrBar
                Invoke-OptimizeServicesForGaming
                Invoke-ConfigureGameMode
                Invoke-OptimizeAudioForGaming
                Invoke-OptimizeInputLag
                Write-Host "`nTodas as otimiza√ß√µes para jogos foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Jogos..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Privacidade (Dentro do Avan√ßado!) ---
function Show-PrivacidadeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: PRIVACIDADE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desativar Telemetria do Windows" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Aplicativos" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Hist√≥rico de Atividades" -ForegroundColor White
        Write-Host "[4] Gerenciar Diagn√≥stico e Feedback" -ForegroundColor Green
        Write-Host "[5] Gerenciar An√∫ncios Personalizados" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Localiza√ß√£o e Sensores" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Reconhecimento de Voz e Digita√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Sincroniza√ß√£o com a Microsoft" -ForegroundColor Cyan
        Write-Host "[9] Aplicar TODAS as configura√ß√µes de privacidade" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de privacidade"

        switch ($choice) {
            "1" { Invoke-DisableTelemetry }
            "2" { Invoke-ManageAppPermissions }
            "3" { Invoke-ManageActivityHistory }
            "4" { Invoke-ManageDiagnosticsFeedback }
            "5" { Invoke-ManagePersonalizedAds }
            "6" { Invoke-ManageLocationSensors }
            "7" { Invoke-ManageVoiceTyping }
            "8" { Invoke-ManageMicrosoftSync }
            "9" {
                Write-Host "`nAplicando todas as configura√ß√µes de privacidade...`n" -ForegroundColor Yellow
                Invoke-DisableTelemetry
                Invoke-ManageAppPermissions
                Invoke-ManageActivityHistory
                Invoke-ManageDiagnosticsFeedback
                Invoke-ManagePersonalizedAds
                Invoke-ManageLocationSensors
                Invoke-ManageVoiceTyping
                Invoke-ManageMicrosoftSync
                Write-Host "`nTodas as configura√ß√µes de privacidade foram aplicadas!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Privacidade..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Outros (Dentro do Avan√ßado!) ---
function Show-OutrosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: OUTROS TWEAKS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Mostrar Informa√ß√µes Detalhadas do Sistema" -ForegroundColor Yellow
        Write-Host "[2] Mostrar Configura√ß√£o Completa de Rede" -ForegroundColor Cyan
        Write-Host "[3] Reiniciar Explorer.exe" -ForegroundColor White
        Write-Host "[4] Limpar Cache de Atualiza√ß√µes do Windows" -ForegroundColor Green
        Write-Host "[5] Gerenciar Programas de Inicializa√ß√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar Op√ß√µes de Energia Avan√ßadas" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Configura√ß√µes de Armazenamento" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Configura√ß√µes de Notifica√ß√µes" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√µes diversas"

        switch ($choice) {
            "1" { Invoke-ShowDetailedSystemInfo }
            "2" { Invoke-ShowDetailedNetworkConfig }
            "3" { Invoke-RestartExplorer }
            "4" { Invoke-CleanWindowsUpdateCache }
            "5" { Invoke-ManageStartupPrograms }
            "6" { Invoke-ConfigureAdvancedPowerOptions }
            "7" { Invoke-ManageStorageSettings }
            "8" { Invoke-ManageNotificationSettings }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- Fun√ß√µes para as Secoes SIMPLIFICADAS (Expandidas) ---
function Invoke-SimpleSystemCleanup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza Geral do Sistema: Hora de varrer o lixo digital! ---" -ForegroundColor Green
    Write-Host "Essa op√ß√£o vai te ajudar a liberar espa√ßo e dar um f√¥lego pro PC tirando arquivos tempor√°rios, lixo da lixeira, etc. √â tipo faxina no computador!" -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Comando 1: Limpar Arquivos Tempor√°rios do Usu√°rio
    Write-Host "Bora come√ßar limpando os arquivos tempor√°rios do seu usu√°rio! Eles acumulam que √© uma beleza!" -ForegroundColor Yellow
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio limpos! Menos peso pro PC respirar! ;)" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Esvaziar a Lixeira
    Write-Host "Agora, vamos dar um fim definitivo naqueles arquivos na Lixeira. Eles s√≥ est√£o ocupando espa√ßo √† toa!" -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada! Espa√ßo recuperado com sucesso! R√°!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios do Windows
    Write-Host "Vamos limpar tamb√©m os tempor√°rios do pr√≥prio Windows. √Äs vezes, fica lixo escondido por l√°!" -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Limpar Cache de Navegadores Comuns
    Write-Host "Bora dar uma geral nos caches dos navegadores tamb√©m! Eles guardam um monte de coisa que pode pesar!" -ForegroundColor Yellow
    
    # Chrome
    Write-Host "Tentando limpar cache do Google Chrome..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Chrome limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Edge
    Write-Host "Tentando limpar cache do Microsoft Edge..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Edge limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Firefox
    Write-Host "Tentando limpar cache do Mozilla Firefox..." -ForegroundColor DarkGray
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\cache2\entries\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\startupCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\thumbnails\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Firefox limpo (pode n√£o ser completo, dependendo do perfil/uso)." -ForegroundColor DarkGray

    # Brave (se instalado)
    Write-Host "Tentando limpar cache do Brave Browser (se instalado)..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Brave limpo (se instalado e n√£o estiver rodando)." -ForegroundColor DarkGray

    Write-Host "Limpeza de caches de navegador conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Comando 5: Limpar Cache de Miniaturas
    Write-Host "Limpando cache de miniaturas do Windows (aquelas pr√©-visualiza√ß√µes de imagens e v√≠deos)..." -ForegroundColor Yellow
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Write-Host "Cache de miniaturas limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Limpar Arquivos de Log do Windows
    Write-Host "Limpando arquivos de log do Windows que podem ocupar espa√ßo..." -ForegroundColor Yellow
    wevtutil cl Application
    wevtutil cl System
    wevtutil cl Security
    Write-Host "Logs do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 7: Limpar Arquivos Tempor√°rios de Instala√ß√£o
    Write-Host "Limpando arquivos tempor√°rios de instala√ß√£o de programas..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Installer\$*\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios de instala√ß√£o limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 8: Limpar Arquivos de Atualiza√ß√£o do Windows
    Write-Host "Limpando arquivos de atualiza√ß√£o do Windows que podem ocupar bastante espa√ßo..." -ForegroundColor Yellow
    Stop-Service -Name wuauserv -ErrorAction SilentlyContinue
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    Write-Host "Arquivos de atualiza√ß√£o do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 9: Limpar Arquivos Prefetch
    Write-Host "Limpando arquivos prefetch para melhorar a inicializa√ß√£o..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Prefetch\*.pf" -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos prefetch limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 10: Executar Limpeza de Disco Integrada do Windows
    Write-Host "Executando a ferramenta de limpeza de disco integrada do Windows..." -ForegroundColor Yellow
    Start-Process -FilePath cleanmgr.exe -ArgumentList "/sagerun:1" -Wait -ErrorAction SilentlyContinue
    Write-Host "Limpeza de disco conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "Vamos ver quanto espa√ßo conseguimos recuperar com essa faxina:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nPronto! A faxina geral b√°sica foi feita! Seu PC agradece o espa√ßo extra! ;)" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu
    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleMemoryStartup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Mem√≥ria e Inicializa√ß√£o R√°pida: Deixa o PC ligando num piscar! ---" -ForegroundColor Yellow
    Write-Host "Aqui a gente d√° uma olhada na mem√≥ria RAM e nos programas que ligam junto com o Windows. Menos coisa ligando √† toa = PC mais r√°pido pra usar na hora!" -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Listar Programas de Inicializa√ß√£o
    Write-Host "Listando programas que iniciam com o Windows (pra voc√™ saber o que t√° rodando por baixo dos panos):" -ForegroundColor Yellow
    Get-CimInstance win32_startupcommand | Select-Object Name, command, Location | Format-Table -AutoSize
    Write-Host "Lista de programas de inicializa√ß√£o exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Servi√ßo SuperFetch/SysMain
    Write-Host "Otimizando o servi√ßo SuperFetch/SysMain para melhorar o desempenho..." -ForegroundColor Yellow
    $confirmSysMain = Read-Host "Deseja desativar o servi√ßo SysMain/SuperFetch? (s/n) - Recomendado para SSDs"
    if ($confirmSysMain -eq 's') {
        Set-Service -Name SysMain -StartupType Disabled -ErrorAction SilentlyContinue
        Stop-Service -Name SysMain -Force -ErrorAction SilentlyContinue
        Write-Host "Servi√ßo SysMain/SuperFetch desativado!" -ForegroundColor Green
    } else {
        Write-Host "Servi√ßo SysMain/SuperFetch mantido ativo." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios de Updates
    Write-Host "Limpando arquivos tempor√°rios de atualiza√ß√µes do Windows (podem ocupar bastante espa√ßo e afetar performance):" -ForegroundColor Yellow
    Dism /online /Cleanup-Image /StartComponentCleanup /ErrorAction SilentlyContinue
    Write-Host "Limpeza de componentes de atualiza√ß√£o iniciada (pode levar um tempo)." -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Mem√≥ria Virtual
    Write-Host "Otimizando configura√ß√µes de mem√≥ria virtual para melhor desempenho..." -ForegroundColor Yellow
    $totalRam = (Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property capacity -Sum).Sum / 1GB
    Write-Host "Seu sistema tem aproximadamente $totalRam GB de RAM." -ForegroundColor White
    
    $confirmPageFile = Read-Host "Deseja otimizar o arquivo de pagina√ß√£o (mem√≥ria virtual)? (s/n)"
    if ($confirmPageFile -eq 's') {
        # Calcula tamanho recomendado (1.5x a RAM para sistemas com menos de 8GB, 1x para sistemas com mais)
        $pageFileSize = if ($totalRam -lt 8) { [math]::Round($totalRam * 1.5) * 1024 } else { [math]::Round($totalRam) * 1024 }
        
        Write-Host "Configurando arquivo de pagina√ß√£o para tamanho fixo de $pageFileSize MB..." -ForegroundColor DarkGray
        $computerSystem = Get-WmiObject -Class Win32_ComputerSystem
        $computerSystem.AutomaticManagedPagefile = $false
        $computerSystem.Put() | Out-Null
        
        $pageFileSetting = Get-WmiObject -Class Win32_PageFileSetting
        if ($pageFileSetting) {
            $pageFileSetting.InitialSize = $pageFileSize
            $pageFileSetting.MaximumSize = $pageFileSize
            $pageFileSetting.Put() | Out-Null
        }
        Write-Host "Arquivo de pagina√ß√£o otimizado! (Requer reinicializa√ß√£o para aplicar totalmente)" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes de mem√≥ria virtual mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Listar os 10 Processos que mais usam mem√≥ria no momento
    Write-Host "Listando os 10 processos que mais consomem mem√≥ria agora:" -ForegroundColor Yellow
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host "Lista de processos exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Otimizar Inicializa√ß√£o do Windows
    Write-Host "Otimizando a inicializa√ß√£o do Windows..." -ForegroundColor Yellow
    # Desabilitar servi√ßos n√£o essenciais que podem atrasar a inicializa√ß√£o
    $startupServices = @(
        @{Name="DiagTrack"; DisplayName="Experi√™ncias do Usu√°rio Conectado e Telemetria"},
        @{Name="dmwappushservice"; DisplayName="Servi√ßo de Transfer√™ncia Inteligente em Segundo Plano (BITS)"},
        @{Name="MapsBroker"; DisplayName="Servi√ßo de Dados de Mapas"}
    )
    
    foreach ($service in $startupServices) {
        $confirmService = Read-Host "Deseja desativar o servi√ßo '$($service.DisplayName)' na inicializa√ß√£o? (s/n)"
        if ($confirmService -eq 's') {
            Set-Service -Name $service.Name -StartupType Disabled -ErrorAction SilentlyContinue
            Stop-Service -Name $service.Name -Force -ErrorAction SilentlyContinue
            Write-Host "Servi√ßo '$($service.DisplayName)' desativado!" -ForegroundColor Green
        } else {
            Write-Host "Servi√ßo '$($service.DisplayName)' mantido." -ForegroundColor Green
        }
    }
    Write-Host ""

    # Comando 7: Reiniciar o Computador (√ötil pra liberar mem√≥ria e aplicar mudan√ßas)
    Write-Host "Quer dar um 'refresh' geral no PC? Reiniciar pode ajudar!" -ForegroundColor Yellow
    $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (digite 'sim' para confirmar)"
    if ($confirmRestart -eq 'sim') {
        Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
        Restart-Computer -Force
    } else {
        Write-Host "Rein√≠cio cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o de mem√≥ria e inicializa√ß√£o!" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu (a n√£o ser que o PC tenha reiniciado)
    if ($confirmRestart -ne 'sim') {
        Write-Host ""
        Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
    }
}

function Invoke-SimpleInternetOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Acelerar a Conex√£o com a Internet (Simplificado): Diz adeus pro 'carregando...'! ---" -ForegroundColor Cyan
    Write-Host "Vamos fazer uns ajustes r√°pidos na sua conex√£o pra tentar deixar ela mais esperta." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Limpar Cache de DNS
    Write-Host "Limpando o cache de endere√ßos de internet (DNS) pra resolver nomes mais r√°pido!" -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Configura√ß√µes TCP/IP
    Write-Host "Otimizando configura√ß√µes TCP/IP para melhorar a velocidade de conex√£o..." -ForegroundColor Yellow
    
    # Habilitar TCP Window Auto-Tuning
    netsh int tcp set global autotuninglevel=normal
    Write-Host "TCP Auto-Tuning configurado para 'normal'." -ForegroundColor DarkGray
    
    # Otimizar par√¢metros de recebimento de pacotes
    netsh int tcp set global rss=enabled
    Write-Host "Receive-Side Scaling (RSS) habilitado." -ForegroundColor DarkGray
    
    # Otimizar congestion provider
    netsh int tcp set global congestionprovider=ctcp
    Write-Host "Congestion Provider configurado para 'ctcp'." -ForegroundColor DarkGray
    
    # Otimizar ECN capability
    netsh int tcp set global ecncapability=enabled
    Write-Host "ECN Capability habilitado." -ForegroundColor DarkGray
    
    Write-Host "Configura√ß√µes TCP/IP otimizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Reiniciar Adaptadores de Rede
    Write-Host "Dando um 'reset' r√°pido nas suas conex√µes de rede. Pode resolver uns pepinos!" -ForegroundColor Yellow
    $confirmResetAdapter = Read-Host "Isso vai desconectar brevemente sua internet. Continuar? (s/n)"
    if ($confirmResetAdapter -eq 's') {
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        Write-Host "Adaptadores de rede reiniciados." -ForegroundColor Green
    } else {
        Write-Host "Reset de adaptadores cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 4: Configurar DNS R√°pido
    Write-Host "Configurar DNS mais r√°pido pode melhorar sua navega√ß√£o!" -ForegroundColor Yellow
    $confirmDns = Read-Host "Deseja configurar DNS mais r√°pidos (Google ou Cloudflare)? (s/n)"
    if ($confirmDns -eq 's') {
        Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
        Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
        $dnsChoice = Read-Host "Escolha uma op√ß√£o (1 ou 2)"
        
        $primaryDns = ""
        $secondaryDns = ""
        
        if ($dnsChoice -eq '1') {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            Write-Host "Google DNS selecionado." -ForegroundColor DarkGray
        } elseif ($dnsChoice -eq '2') {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            Write-Host "Cloudflare DNS selecionado." -ForegroundColor DarkGray
        } else {
            Write-Host "Op√ß√£o inv√°lida. DNS n√£o alterado." -ForegroundColor Red
        }
        
        if ($primaryDns -ne "") {
            $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" -and ($_.InterfaceDescription -match "Ethernet" -or $_.InterfaceDescription -match "Wi-Fi" -or $_.InterfaceDescription -match "Wireless") }
            
            foreach ($adapter in $networkAdapters) {
                Write-Host "Configurando DNS para adaptador: $($adapter.Name)" -ForegroundColor DarkGray
                Set-DnsClientServerAddress -InterfaceIndex $adapter.ifIndex -ServerAddresses ($primaryDns, $secondaryDns)
            }
            
            Write-Host "DNS configurado! Sua navega√ß√£o deve ficar mais r√°pida agora." -ForegroundColor Green
        }
    } else {
        Write-Host "Configura√ß√£o de DNS mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Mostrar Status B√°sico da Conex√£o
    Write-Host "Mostrando um resumo b√°sico da sua configura√ß√£o de rede atual:" -ForegroundColor Yellow
    ipconfig /all | Select-String -Pattern "IPv4", "DNS", "Gateway", "DHCP", "Subnet", "Physical Address"
    Write-Host "Status b√°sico da rede exibido." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Testar a conex√£o com a internet
    Write-Host "Testando a conex√£o com a internet (ping para google.com)..." -ForegroundColor Yellow
    Test-Connection -Count 4 google.com -ErrorAction SilentlyContinue
    Write-Host "Teste de conex√£o finalizado." -ForegroundColor Green
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o b√°sica de internet!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleVisualOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Deixar o Windows mais Leve Visualmente (Simplificado): Desempenho antes da beleza! ---" -ForegroundColor White
    Write-Host "Ajustes r√°pidos pra desativar efeitos visuais que podem pesar, liberando recursos pro que importa." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ajustar Efeitos Visuais
    Write-Host "Voc√™ quer desativar ou ativar as anima√ß√µes e efeitos visuais do Windows?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Efeitos Visuais (Pra ganhar desempenho)" -ForegroundColor Green
    Write-Host "[2] Configurar para Melhor Apar√™ncia (Mais bonito, mas mais pesado)" -ForegroundColor White
    Write-Host "[3] Deixar o Windows Escolher (Configura√ß√£o padr√£o)" -ForegroundColor Cyan
    $choiceVisual = Read-Host "Escolha [1], [2] ou [3]"

    if ($choiceVisual -eq '1') {
        Write-Host "Desativando efeitos visuais para melhor desempenho..." -ForegroundColor Yellow
        # Valor 2 = Ajustar para melhor desempenho (desativa a maioria dos efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 2 -Type DWord -Force -ErrorAction SilentlyContinue
        
        # Desativar anima√ß√µes individuais
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop' -Name 'UserPreferencesMask' -Value ([byte[]](0x90, 0x12, 0x01, 0x80)) -Type Binary -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop\WindowMetrics' -Name 'MinAnimate' -Value 0 -Type String -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'ListviewAlphaSelect' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'TaskbarAnimations' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        
        Write-Host "Efeitos visuais desativados para melhor desempenho!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '2') {
        Write-Host "Configurando para melhor apar√™ncia (todos os efeitos visuais ativados)..." -ForegroundColor Yellow
        # Valor 1 = Ajustar para melhor apar√™ncia (ativa todos os efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Efeitos visuais configurados para melhor apar√™ncia!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '3') {
        Write-Host "Deixando o Windows escolher automaticamente (configura√ß√£o padr√£o)..." -ForegroundColor Yellow
        # Valor 0 = Deixar o Windows escolher
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Configura√ß√£o visual definida para padr√£o do Windows!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa nos efeitos visuais foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 2: Ativar/Desativar Efeitos de Transpar√™ncia
    Write-Host "E os efeitos de transpar√™ncia do Windows (tipo na barra de tarefas)?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Transpar√™ncia (Mais leve)" -ForegroundColor Green
    Write-Host "[2] Ativar Transpar√™ncia (Mais 'bonito')" -ForegroundColor White
    $choiceTransp = Read-Host "Escolha [1] ou [2]"

    if ($choiceTransp -eq '1') {
        Write-Host "Desativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 0 = Desativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia desativada!" -ForegroundColor Green
    } elseif ($choiceTransp -eq '2') {
        Write-Host "Ativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 1 = Ativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia ativada!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa na transpar√™ncia foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 3: Configurar Tema Claro/Escuro
    Write-Host "Voc√™ prefere tema claro ou escuro? O tema escuro pode ser mais confort√°vel para os olhos." -ForegroundColor Yellow
    Write-Host "[1] Tema Escuro (Dark Mode)" -ForegroundColor DarkGray
    Write-Host "[2] Tema Claro (Light Mode)" -ForegroundColor White
    $choiceTheme = Read-Host "Escolha [1] ou [2]"

    if ($choiceTheme -eq '1') {
        Write-Host "Configurando tema escuro..." -ForegroundColor Yellow
        # Valor 0 = Tema Escuro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema escuro configurado!" -ForegroundColor Green
    } elseif ($choiceTheme -eq '2') {
        Write-Host "Configurando tema claro..." -ForegroundColor Yellow
        # Valor 1 = Tema Claro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema claro configurado!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa no tema foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Configurar Resolu√ß√£o de Tela
    Write-Host "Deseja ajustar a resolu√ß√£o da tela? Resolu√ß√µes menores podem melhorar o desempenho em PCs mais antigos." -ForegroundColor Yellow
    $confirmResolution = Read-Host "Deseja ver e ajustar a resolu√ß√£o da tela? (s/n)"
    
    if ($confirmResolution -eq 's') {
        # Mostrar resolu√ß√£o atual
        $currentResolution = Get-WmiObject -Class Win32_VideoController | Select-Object -ExpandProperty VideoModeDescription
        Write-Host "Resolu√ß√£o atual: $currentResolution" -ForegroundColor White
        
        # Abrir configura√ß√µes de exibi√ß√£o do Windows
        Write-Host "Abrindo configura√ß√µes de exibi√ß√£o do Windows..." -ForegroundColor DarkGray
        Start-Process "ms-settings:display"
        Write-Host "Ajuste a resolu√ß√£o conforme necess√°rio na janela de configura√ß√µes que foi aberta." -ForegroundColor Green
        
        $waitForSettings = Read-Host "Pressione Enter quando terminar de ajustar as configura√ß√µes de exibi√ß√£o"
    } else {
        Write-Host "Configura√ß√£o de resolu√ß√£o mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizados os ajustes visuais b√°sicos!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleGamingOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Jogos (Simplificado): Mais FPS, menos lag! ---" -ForegroundColor Magenta
    Write-Host "Vamos fazer alguns ajustes para melhorar o desempenho dos seus jogos sem complica√ß√µes." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ativar Modo de Jogo do Windows
    Write-Host "Ativando o Modo de Jogo do Windows para priorizar recursos para jogos..." -ForegroundColor Yellow
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AllowAutoGameMode" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AutoGameModeEnabled" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Write-Host "Modo de Jogo do Windows ativado!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Desativar Game DVR e Game Bar
    Write-Host "O Game DVR e Game Bar podem reduzir o desempenho em jogos. Deseja desativ√°-los?" -ForegroundColor Yellow
    $confirmGameDVR = Read-Host "Desativar Game DVR e Game Bar? (s/n)"
    
    if ($confirmGameDVR -eq 's') {
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "UseNexusForGameBarEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\System\GameConfigStore" -Name "GameDVR_Enabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR" -Name "AppCaptureEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Write-Host "Game DVR e Game Bar desativados!" -ForegroundColor Green
    } else {
        Write-Host "Game DVR e Game Bar mantidos ativos." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Otimizar Plano de Energia para Jogos
    Write-Host "Configurando plano de energia para alto desempenho (ideal para jogos)..." -ForegroundColor Yellow
    powercfg.exe /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c
    Write-Host "Plano de energia configurado para alto desempenho!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Configura√ß√µes de Mouse
    Write-Host "Otimizando configura√ß√µes de mouse para jogos (precis√£o do ponteiro)..." -ForegroundColor Yellow
    $confirmMouseFix = Read-Host "Desativar a acelera√ß√£o do mouse para melhor precis√£o em jogos? (s/n)"
    
    if ($confirmMouseFix -eq 's') {
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseSpeed" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold1" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold2" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Write-Host "Acelera√ß√£o do mouse desativada para melhor precis√£o em jogos!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do mouse mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Otimizar Prioridade de CPU para Jogos
    Write-Host "Configurando prioridade de CPU para jogos..." -ForegroundColor Yellow
    Write-Host "Esta configura√ß√£o ajusta o sistema para dar mais prioridade aos jogos." -ForegroundColor DarkGray
    
    # Criar chave de registro para prioridade de jogos
    if (-not (Test-Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games")) {
        New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Force | Out-Null
    }
    
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "GPU Priority" -Type DWord -Value 8 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Priority" -Type DWord -Value 6 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Scheduling Category" -Type String -Value "High" -Force -ErrorAction SilentlyContinue
    
    Write-Host "Prioridade de CPU para jogos otimizada!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Verificar Driver de Placa de V√≠deo
    Write-Host "Verificando informa√ß√µes da placa de v√≠deo..." -ForegroundColor Yellow
    $gpuInfo = Get-WmiObject -Class Win32_VideoController | Select-Object Name, DriverVersion, CurrentHorizontalResolution, CurrentVerticalResolution
    
    foreach ($gpu in $gpuInfo) {
        Write-Host "Placa de v√≠deo: $($gpu.Name)" -ForegroundColor White
        Write-Host "Vers√£o do driver: $($gpu.DriverVersion)" -ForegroundColor White
        Write-Host "Resolu√ß√£o atual: $($gpu.CurrentHorizontalResolution) x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
      x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
    
    Write-Host "Recomenda√ß√£o: Mantenha seus drivers de v√≠deo atualizados para melhor desempenho em jogos!" -ForegroundColor Green
    Write-Host "Voc√™ pode baixar os drivers mais recentes nos sites oficiais da NVIDIA, AMD ou Intel." -ForegroundColor DarkGray
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nOtimiza√ß√µes para jogos conclu√≠das! Seus jogos devem rodar mais suaves agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleSecurityMaintenance {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Manuten√ß√£o de Seguran√ßa (Simplificado): Mantenha seu PC protegido! ---" -ForegroundColor DarkYellow
    Write-Host "Vamos verificar e melhorar a seguran√ßa do seu sistema com alguns ajustes simples." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Verificar Status do Windows Defender
    Write-Host "Verificando status do Windows Defender..." -ForegroundColor Yellow
    $defenderStatus = Get-MpComputerStatus
    
    Write-Host "Status do Windows Defender:" -ForegroundColor White
    Write-Host "Antiv√≠rus habilitado: $($defenderStatus.AntivirusEnabled)" -ForegroundColor $(if ($defenderStatus.AntivirusEnabled) { "Green" } else { "Red" })
    Write-Host "Prote√ß√£o em tempo real: $($defenderStatus.RealTimeProtectionEnabled)" -ForegroundColor $(if ($defenderStatus.RealTimeProtectionEnabled) { "Green" } else { "Red" })
    Write-Host "Defini√ß√µes de antiv√≠rus: $($defenderStatus.AntivirusSignatureVersion)" -ForegroundColor White
    Write-Host "√öltima atualiza√ß√£o: $($defenderStatus.AntivirusSignatureLastUpdated)" -ForegroundColor White
    Write-Host ""

    # Comando 2: Atualizar Defini√ß√µes do Windows Defender
    Write-Host "Atualizando defini√ß√µes do Windows Defender..." -ForegroundColor Yellow
    Update-MpSignature -ErrorAction SilentlyContinue
    Write-Host "Defini√ß√µes do Windows Defender atualizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Verificar Atualiza√ß√µes do Windows
    Write-Host "Verificando status das atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
            Write-Host "Recomenda√ß√£o: Execute o Windows Update para manter seu sistema seguro." -ForegroundColor Green
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Verificar Configura√ß√µes de Firewall
    Write-Host "Verificando status do Firewall do Windows..." -ForegroundColor Yellow
    $firewallStatus = Get-NetFirewallProfile
    
    foreach ($profile in $firewallStatus) {
        Write-Host "Perfil: $($profile.Name)" -ForegroundColor White
        Write-Host "Status: $($profile.Enabled)" -ForegroundColor $(if ($profile.Enabled) { "Green" } else { "Red" })
        Write-Host ""
    }
    
    $confirmFirewall = Read-Host "Deseja habilitar o Firewall em todos os perfis? (s/n)"
    if ($confirmFirewall -eq 's') {
        Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True
        Write-Host "Firewall habilitado em todos os perfis!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do Firewall mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Verificar Configura√ß√µes de UAC
    Write-Host "Verificando configura√ß√µes do Controle de Conta de Usu√°rio (UAC)..." -ForegroundColor Yellow
    $uacLevel = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -ErrorAction SilentlyContinue
    
    if ($uacLevel) {
        switch ($uacLevel.ConsentPromptBehaviorAdmin) {
            0 { $uacStatus = "Desativado (N√£o recomendado)" }
            1 { $uacStatus = "Baixo (N√£o recomendado)" }
            2 { $uacStatus = "M√©dio" }
            5 { $uacStatus = "Alto (Recomendado)" }
            default { $uacStatus = "Personalizado" }
        }
        
        Write-Host "N√≠vel atual do UAC: $uacStatus" -ForegroundColor $(if ($uacLevel.ConsentPromptBehaviorAdmin -ge 2) { "Green" } else { "Red" })
        
        $confirmUAC = Read-Host "Deseja configurar o UAC para o n√≠vel recomendado? (s/n)"
        if ($confirmUAC -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -Value 5 -Type DWord -Force -ErrorAction SilentlyContinue
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "PromptOnSecureDesktop" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
            Write-Host "UAC configurado para o n√≠vel recomendado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do UAC mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do UAC." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 6: Verificar Configura√ß√µes de SmartScreen
    Write-Host "Verificando configura√ß√µes do Windows SmartScreen..." -ForegroundColor Yellow
    $smartScreen = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -ErrorAction SilentlyContinue
    
    if ($smartScreen) {
        Write-Host "Status do SmartScreen: $($smartScreen.SmartScreenEnabled)" -ForegroundColor $(if ($smartScreen.SmartScreenEnabled -eq "RequireAdmin" -or $smartScreen.SmartScreenEnabled -eq "Warn") { "Green" } else { "Red" })
        
        $confirmSmartScreen = Read-Host "Deseja habilitar o SmartScreen para maior seguran√ßa? (s/n)"
        if ($confirmSmartScreen -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -Value "RequireAdmin" -Type String -Force -ErrorAction SilentlyContinue
            Write-Host "SmartScreen habilitado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do SmartScreen mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do SmartScreen." -ForegroundColor Red
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nManuten√ß√£o de seguran√ßa conclu√≠da! Seu sistema est√° mais protegido agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

# --- Fun√ß√µes para o Diagn√≥stico R√°pido e Sobre ---
function Invoke-QuickDiagnostic {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Diagn√≥stico R√°pido do Sistema ---" -ForegroundColor Yellow
    Write-Host "Vamos fazer uma verifica√ß√£o r√°pida do estado atual do seu PC." -ForegroundColor Gray
    Write-Host ""

    # Informa√ß√µes do Sistema
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    $sysInfo = Get-SystemInfo
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host ""

    # Uso de CPU
    Write-Host "=== Uso de CPU ===" -ForegroundColor Cyan
    $cpuLoad = (Get-WmiObject Win32_Processor).LoadPercentage
    Write-Host "Uso atual de CPU: $cpuLoad%" -ForegroundColor $(if ($cpuLoad -lt 70) { "Green" } elseif ($cpuLoad -lt 90) { "Yellow" } else { "Red" })
    Write-Host ""

    # Uso de Mem√≥ria
    Write-Host "=== Uso de Mem√≥ria ===" -ForegroundColor Cyan
    $os = Get-WmiObject Win32_OperatingSystem
    $totalMemory = [math]::Round($os.TotalVisibleMemorySize / 1MB, 2)
    $freeMemory = [math]::Round($os.FreePhysicalMemory / 1MB, 2)
    $usedMemory = [math]::Round($totalMemory - $freeMemory, 2)
    $memoryPercentage = [math]::Round(($usedMemory / $totalMemory) * 100, 2)
    
    Write-Host "Mem√≥ria Total: $totalMemory GB" -ForegroundColor White
    Write-Host "Mem√≥ria Usada: $usedMemory GB ($memoryPercentage%)" -ForegroundColor $(if ($memoryPercentage -lt 70) { "Green" } elseif ($memoryPercentage -lt 90) { "Yellow" } else { "Red" })
    Write-Host "Mem√≥ria Livre: $freeMemory GB" -ForegroundColor White
    Write-Host ""

    # Espa√ßo em Disco
    Write-Host "=== Espa√ßo em Disco ===" -ForegroundColor Cyan
    $drives = Get-PSDrive -PSProvider FileSystem
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        $percentFree = [math]::Round(($freeSpace / $totalSpace) * 100, 2)
        
        Write-Host "Drive $($drive.Name):" -ForegroundColor White
        Write-Host "  Total: $totalSpace GB" -ForegroundColor White
        Write-Host "  Usado: $usedSpace GB" -ForegroundColor White
        Write-Host "  Livre: $freeSpace GB ($percentFree%)" -ForegroundColor $(if ($percentFree -gt 20) { "Green" } elseif ($percentFree -gt 10) { "Yellow" } else { "Red" })
    }
    Write-Host ""

    # Processos que mais consomem recursos
    Write-Host "=== Top 5 Processos (CPU) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object CPU -Descending | Select-Object -First 5 ProcessName, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}}, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host ""

    Write-Host "=== Top 5 Processos (Mem√≥ria) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 5 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}}, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}} | Format-Table -AutoSize
    Write-Host ""

    # Status de Servi√ßos Cr√≠ticos
    Write-Host "=== Status de Servi√ßos Cr√≠ticos ===" -ForegroundColor Cyan
    $criticalServices = @("wuauserv", "WinDefend", "MpsSvc", "wscsvc")
    foreach ($service in $criticalServices) {
        $serviceStatus = Get-Service -Name $service -ErrorAction SilentlyContinue
        if ($serviceStatus) {
            Write-Host "$($serviceStatus.DisplayName): $($serviceStatus.Status)" -ForegroundColor $(if ($serviceStatus.Status -eq "Running") { "Green" } else { "Red" })
        }
    }
    Write-Host ""

    # Verificar Atualiza√ß√µes Pendentes
    Write-Host "=== Atualiza√ß√µes do Windows ===" -ForegroundColor Cyan
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Recomenda√ß√µes
    Write-Host "=== Recomenda√ß√µes ===" -ForegroundColor Cyan
    
    # Recomenda√ß√£o de Mem√≥ria
    if ($memoryPercentage -gt 80) {
        Write-Host "- Seu uso de mem√≥ria est√° alto. Considere fechar alguns programas ou usar a op√ß√£o 'Otimiza√ß√£o de Mem√≥ria'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Disco
    $lowDiskSpace = $false
    foreach ($drive in $drives) {
        $percentFree = [math]::Round(($drive.Free / ($drive.Free + $drive.Used)) * 100, 2)
        if ($percentFree -lt 15) {
            $lowDiskSpace = $true
            break
        }
    }
    
    if ($lowDiskSpace) {
        Write-Host "- Espa√ßo em disco baixo detectado. Considere usar a op√ß√£o 'Limpeza Geral do Sistema'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Atualiza√ß√µes
    if ($pendingUpdates -gt 0) {
        Write-Host "- Existem atualiza√ß√µes pendentes. Recomendamos atualizar seu sistema para maior seguran√ßa." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Inicializa√ß√£o
    $bootTime = $sysInfo.LastBootTime
    $uptime = (Get-Date) - $bootTime
    if ($uptime.Days -gt 7) {
        Write-Host "- Seu sistema est√° ligado h√° $($uptime.Days) dias. Considere reiniciar para aplicar atualiza√ß√µes e limpar a mem√≥ria." -ForegroundColor Yellow
    }
    
    Write-Host ""

    # Mensagem de conclus√£o
    Write-Host "`nDiagn√≥stico r√°pido conclu√≠do! Use as informa√ß√µes acima para decidir quais otimiza√ß√µes fazer." -ForegroundColor Green

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

function Show-AboutTORK {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Sobre o TORK ---" -ForegroundColor White
    Write-Host ""
    
    Write-Host "TORK - Otimizador para Windows" -ForegroundColor Cyan
    Write-Host "Vers√£o: 2.0" -ForegroundColor White
    Write-Host "Desenvolvido por: Partner77" -ForegroundColor White
    Write-Host ""
    
    Write-Host "=== Descri√ß√£o ===" -ForegroundColor Yellow
    Write-Host "O TORK √© uma ferramenta abrangente de otimiza√ß√£o para Windows, projetada para" -ForegroundColor Gray
    Write-Host "melhorar o desempenho do seu sistema atrav√©s de limpeza, ajustes e otimiza√ß√µes." -ForegroundColor Gray
    Write-Host "Ele oferece op√ß√µes simplificadas para usu√°rios comuns e op√ß√µes avan√ßadas para" -ForegroundColor Gray
    Write-Host "usu√°rios experientes que desejam um controle mais detalhado sobre o sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Recursos ===" -ForegroundColor Yellow
    Write-Host "- Limpeza completa do sistema" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√£o de mem√≥ria e inicializa√ß√£o" -ForegroundColor Gray
    Write-Host "- Ajustes de rede para melhor conectividade" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√µes visuais para melhor desempenho" -ForegroundColor Gray
    Write-Host "- Configura√ß√µes espec√≠ficas para jogos" -ForegroundColor Gray
    Write-Host "- Manuten√ß√£o de seguran√ßa" -ForegroundColor Gray
    Write-Host "- Diagn√≥stico r√°pido do sistema" -ForegroundColor Gray
    Write-Host "- Mais de 100 ajustes e otimiza√ß√µes avan√ßadas" -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Aviso Legal ===" -ForegroundColor Yellow
    Write-Host "Este software √© fornecido 'como est√°', sem garantias de qualquer tipo." -ForegroundColor Gray
    Write-Host "O autor n√£o se responsabiliza por quaisquer danos ou problemas causados pelo uso" -ForegroundColor Gray
    Write-Host "deste software. Use por sua conta e risco. Recomendamos sempre fazer backup" -ForegroundColor Gray
    Write-Host "dos seus dados importantes antes de realizar otimiza√ß√µes no sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Agradecimentos ===" -ForegroundColor Yellow
    Write-Host "Obrigado por escolher o TORK para otimizar seu sistema Windows!" -ForegroundColor Gray
    Write-Host "Esperamos que esta ferramenta ajude a melhorar o desempenho do seu PC." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "¬© 2023-2024 Partner77 - Todos os direitos reservados" -ForegroundColor Cyan
    Write-Host ""
    
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - LIMPEZA (Expandidas) ---
function Invoke-CleanUserTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Usu√°rio ---" -ForegroundColor Cyan
    Write-Host "Remove arquivos da pasta tempor√°ria do seu usu√°rio (`$env:TEMP`)." -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:TEMP..." -ForegroundColor Yellow
    $tempFiles = Get-ChildItem -Path $env:TEMP -Recurse -ErrorAction SilentlyContinue
    $tempFilesCount = ($tempFiles | Measure-Object).Count
    $tempFilesSize = ($tempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $tempFilesCount arquivos tempor√°rios ocupando aproximadamente $([math]::Round($tempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Sistema ---" -ForegroundColor Gray
    Write-Host "Remove arquivos da pasta tempor√°ria do Windows (`$env:SystemRoot\Temp`)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:SystemRoot\Temp..." -ForegroundColor Yellow
    $systemTempFiles = Get-ChildItem -Path "$env:SystemRoot\Temp" -Recurse -ErrorAction SilentlyContinue
    $systemTempFilesCount = ($systemTempFiles | Measure-Object).Count
    $systemTempFilesSize = ($systemTempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $systemTempFilesCount arquivos tempor√°rios do sistema ocupando aproximadamente $([math]::Round($systemTempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do sistema removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanDnsCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-EmptyRecycleBin {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Esvaziar Lixeira ---" -ForegroundColor Gray
    Write-Host "Esvazia a lixeira do usu√°rio logado." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar tamanho da lixeira antes de esvaziar
    Write-Host "Verificando tamanho da lixeira..." -ForegroundColor Yellow
    
    try {
        $shell = New-Object -ComObject Shell.Application
        $recycleBin = $shell.Namespace(0xA)
        $recycleBinItems = $recycleBin.Items()
        $recycleBinItemCount = $recycleBinItems.Count
        
        Write-Host "A lixeira cont√©m $recycleBinItemCount itens." -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o conte√∫do da lixeira." -ForegroundColor DarkGray
    }
    
    # Esvaziar a lixeira
    Write-Host "Executando: Esvaziando a lixeira..." -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanThumbnailCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Miniaturas ---" -ForegroundColor Green
    Write-Host "Remove o cache de miniaturas de arquivos (imagens, v√≠deos, etc.)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Limpando cache de miniaturas..." -ForegroundColor Yellow
    
    # Verificar tamanho do cache de miniaturas antes da limpeza
    $thumbnailPath = "$env:LOCALAPPDATA\Microsoft\Windows\Explorer"
    $thumbnailFiles = Get-ChildItem -Path $thumbnailPath -Filter "thumbcache_*.db" -ErrorAction SilentlyContinue
    $thumbnailFilesCount = ($thumbnailFiles | Measure-Object).Count
    $thumbnailFilesSize = ($thumbnailFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $thumbnailFilesCount arquivos de cache de miniaturas ocupando aproximadamente $([math]::Round($thumbnailFilesSize, 2)) MB." -ForegroundColor White
    
    # Limpar o cache de miniaturas
    Stop-Process -Name explorer -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Start-Process explorer
    
    Write-Host "Cache de miniaturas limpo com sucesso!" -ForegroundColor Green
    Write-Host "O Windows Explorer foi reiniciado para aplicar as altera√ß√µes." -ForegroundColor DarkGray
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de miniaturas:" -ForegroundColor Cyan
    Write-Host "- Navega√ß√£o mais r√°pida em pastas com muitas imagens ou v√≠deos" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de miniaturas corrompidas ou desatualizadas" -ForegroundColor DarkGray
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemLogs {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Logs do Sistema ---" -ForegroundColor Cyan
    Write-Host "Limpa os logs de eventos do sistema para liberar espa√ßo e melhorar o desempenho." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando logs do sistema..." -ForegroundColor Yellow
    
    # Verificar tamanho dos logs antes da limpeza
    $eventLogs = Get-WinEvent -ListLog * -ErrorAction SilentlyContinue | Where-Object { $_.RecordCount -gt 0 }
    $totalLogCount = ($eventLogs | Measure-Object).Count
    $total = ($eventLogs | Measure-Object -Property FileSize -Sum).Sum / 1MB
    
    Write-Host "Encontrados $totalLogCount logs de eventos ocupando aproximadamente $([math]::Round($total, 2)) MB." -ForegroundColor White
    
    # Limpar os logs principais
    Write-Host "Limpando logs principais do sistema..." -ForegroundColor Yellow
    
    $mainLogs = @("Application", "System", "Security")
    foreach ($log in $mainLogs) {
        try {
            $logSize = (Get-WinEvent -ListLog $log -ErrorAction SilentlyContinue).FileSize / 1MB
            $logRecords = (Get-WinEvent -ListLog $log -ErrorAction SilentlyContinue).RecordCount
            
            Write-Host "Log $log: $([math]::Round($logSize, 2)) MB com $logRecords registros" -ForegroundColor DarkGray
            wevtutil cl $log
            Write-Host "Log $log limpo com sucesso!" -ForegroundColor Green
        } catch {
            Write-Host "N√£o foi poss√≠vel limpar o log $log." -ForegroundColor Red
        }
    }
    
    # Perguntar se deseja limpar todos os outros logs
    $confirmAllLogs = Read-Host "Deseja limpar todos os outros logs do sistema? (s/n)"
    
    if ($confirmAllLogs -eq 's') {
        Write-Host "Limpando todos os logs do sistema... (isso pode levar algum tempo)" -ForegroundColor Yellow
        
        $otherLogs = $eventLogs | Where-Object { $_.LogName -notin $mainLogs }
        foreach ($log in $otherLogs) {
            try {
                wevtutil cl $log.LogName
            } catch {
                # Ignorar erros silenciosamente
            }
        }
        
        Write-Host "Todos os logs do sistema foram limpos!" -ForegroundColor Green
    } else {
        Write-Host "Apenas os logs principais foram limpos." -ForegroundColor Green
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanWindowsUpdateCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Atualiza√ß√µes do Windows ---" -ForegroundColor Yellow
    Write-Host "Limpa os arquivos tempor√°rios de atualiza√ß√µes do Windows para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando cache de atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    
    # Verificar tamanho da pasta SoftwareDistribution antes da limpeza
    $updateCachePath = "$env:SystemRoot\SoftwareDistribution\Download"
    $updateCacheFiles = Get-ChildItem -Path $updateCachePath -Recurse -ErrorAction SilentlyContinue
    $updateCacheSize = ($updateCacheFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "O cache de atualiza√ß√µes do Windows est√° ocupando aproximadamente $([math]::Round($updateCacheSize, 2)) MB." -ForegroundColor White
    
    # Parar o servi√ßo Windows Update
    Write-Host "Parando o servi√ßo Windows Update..." -ForegroundColor DarkGray
    Stop-Service -Name wuauserv -Force -ErrorAction SilentlyContinue
    
    # Limpar o cache de atualiza√ß√µes
    Write-Host "Limpando o cache de atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    
    # Iniciar o servi√ßo Windows Update novamente
    Write-Host "Iniciando o servi√ßo Windows Update..." -ForegroundColor DarkGray
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    
    Write-Host "Cache de atualiza√ß√µes do Windows limpo com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de atualiza√ß√µes:" -ForegroundColor Cyan
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray
    Write-Host "- Resolu√ß√£o de problemas com atualiza√ß√µes do Windows" -ForegroundColor DarkGray
    Write-Host "- Melhoria no desempenho do sistema" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanHibernationFile {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos de Hiberna√ß√£o ---" -ForegroundColor White
    Write-Host "Gerencia o arquivo de hiberna√ß√£o (hiberfil.sys) para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar status atual da hiberna√ß√£o
    Write-Host "Verificando status atual da hiberna√ß√£o..." -ForegroundColor Yellow
    $hibernationStatus = powercfg.exe /availablesleepstates | Select-String -Pattern "Hiberna√ß√£o"
    
    if ($hibernationStatus -match "Hiberna√ß√£o est√° desativada") {
        $currentStatus = "desativada"
    } else {
        $currentStatus = "ativada"
    }
    
    Write-Host "Status atual da hiberna√ß√£o: $currentStatus" -ForegroundColor White
    
    # Verificar tamanho do arquivo de hiberna√ß√£o (se existir)
    $systemDrive = $env:SystemDrive
    $hiberfilPath = "$systemDrive\hiberfil.sys"
    
    if (Test-Path -Path $hiberfilPath -ErrorAction SilentlyContinue) {
        try {
            $hiberfilSize = (Get-Item -Path $hiberfilPath -Force -ErrorAction SilentlyContinue).Length / 1GB
            Write-Host "Tamanho do arquivo de hiberna√ß√£o: $([math]::Round($hiberfilSize, 2)) GB" -ForegroundColor White
        } catch {
            Write-Host "N√£o foi poss√≠vel determinar o tamanho do arquivo de hiberna√ß√£o." -ForegroundColor DarkGray
        }
    } else {
        Write-Host "Arquivo de hiberna√ß√£o n√£o encontrado (j√° est√° desativado)." -ForegroundColor DarkGray
    }
    
    # Perguntar se deseja desativar ou ativar a hiberna√ß√£o
    if ($currentStatus -eq "ativada") {
        $confirmHibernation = Read-Host "Deseja desativar a hiberna√ß√£o para liberar espa√ßo em disco? (s/n)"
        
        if ($confirmHibernation -eq 's') {
            Write-Host "Desativando a hiberna√ß√£o..." -ForegroundColor Yellow
            powercfg.exe /hibernate off
            Write-Host "Hiberna√ß√£o desativada com sucesso! O arquivo hiberfil.sys foi removido." -ForegroundColor Green
        } else {
            Write-Host "Hiberna√ß√£o mantida ativada." -ForegroundColor Green
        }
    } else {
        $confirmHibernation = Read-Host "Deseja ativar a hiberna√ß√£o? (s/n)"
        
        if ($confirmHibernation -eq 's') {
            Write-Host "Ativando a hiberna√ß√£o..." -ForegroundColor Yellow
            powercfg.exe /hibernate on
            Write-Host "Hiberna√ß√£o ativada com sucesso! O arquivo hiberfil.sys foi criado." -ForegroundColor Green
            
            # Verificar novo tamanho do arquivo de hiberna√ß√£o
            if (Test-Path -Path $hiberfilPath -ErrorAction SilentlyContinue) {
                try {
                    $newHiberfilSize = (Get-Item -Path $hiberfilPath -Force -ErrorAction SilentlyContinue).Length / 1GB
                    Write-Host "Tamanho do novo arquivo de hiberna√ß√£o: $([math]::Round($newHiberfilSize, 2)) GB" -ForegroundColor White
                } catch {
                    Write-Host "N√£o foi poss√≠vel determinar o tamanho do novo arquivo de hiberna√ß√£o." -ForegroundColor DarkGray
                }
            }
        } else {
            Write-Host "Hiberna√ß√£o mantida desativada." -ForegroundColor Green
        }
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo foi afetado:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nInforma√ß√µes sobre a hiberna√ß√£o:" -ForegroundColor Cyan
    Write-Host "- O arquivo de hiberna√ß√£o (hiberfil.sys) geralmente ocupa espa√ßo equivalente a 75% da RAM instalada" -ForegroundColor DarkGray
    Write-Host "- Desativar a hiberna√ß√£o libera esse espa√ßo, mas voc√™ n√£o poder√° usar o modo de hiberna√ß√£o" -ForegroundColor DarkGray
    Write-Host "- A hiberna√ß√£o √© √∫til para laptops, pois salva o estado do sistema no disco antes de desligar" -ForegroundColor DarkGray
    Write-Host "- Para desktops, a hiberna√ß√£o geralmente √© menos necess√°ria" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanWinSxS {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Pasta WinSxS ---" -ForegroundColor Magenta
    Write-Host "Limpa componentes n√£o utilizados da pasta WinSxS para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "A pasta WinSxS (Windows Side-by-Side) armazena componentes do sistema e pode ocupar muito espa√ßo." -ForegroundColor White
    Write-Host "Esta limpeza √© segura e usa ferramentas oficiais do Windows para remover componentes n√£o utilizados." -ForegroundColor White
    Write-Host ""
    
    # Verificar tamanho da pasta WinSxS antes da limpeza
    Write-Host "Verificando tamanho da pasta WinSxS (isso pode levar algum tempo)..." -ForegroundColor Yellow
    
    try {
        $winSxSSize = (Get-ChildItem -Path "$env:SystemRoot\WinSxS" -Recurse -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum / 1GB
        Write-Host "Tamanho atual da pasta WinSxS: $([math]::Round($winSxSSize, 2)) GB" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel determinar o tamanho da pasta WinSxS." -ForegroundColor DarkGray
    }
    
    # Perguntar se deseja prosseguir com a limpeza
    $confirmCleanup = Read-Host "Deseja prosseguir com a limpeza da pasta WinSxS? (s/n)"
    
    if ($confirmCleanup -eq 's') {
        Write-Host "Executando limpeza de componentes n√£o utilizados (isso pode levar v√°rios minutos)..." -ForegroundColor Yellow
        
        # Executar limpeza de componentes
        Write-Host "Etapa 1: Limpeza de componentes..." -ForegroundColor DarkGray
        Dism.exe /Online /Cleanup-Image /StartComponentCleanup
        
        # Perguntar se deseja executar limpeza mais agressiva (com reset base)
        $confirmResetBase = Read-Host "Deseja executar uma limpeza mais profunda? (remove a capacidade de desinstalar atualiza√ß√µes) (s/n)"
        
        if ($confirmResetBase -eq 's') {
            Write-Host "Etapa 2: Executando limpeza profunda (isso pode levar muito tempo)..." -ForegroundColor DarkGray
            Dism.exe /Online /Cleanup-Image /StartComponentCleanup /ResetBase
            Write-Host "Limpeza profunda conclu√≠da!" -ForegroundColor Green
        }
        
        Write-Host "Limpeza da pasta WinSxS conclu√≠da com sucesso!" -ForegroundColor Green
        
        # Verificar tamanho da pasta WinSxS ap√≥s a limpeza
        try {
            $newWinSxSSize = (Get-ChildItem -Path "$env:SystemRoot\WinSxS" -Recurse -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum / 1GB
            $savedSpace = $winSxSSize - $newWinSxSSize
            
            Write-Host "Tamanho atual da pasta WinSxS: $([math]::Round($newWinSxSSize, 2)) GB" -ForegroundColor White
            Write-Host "Espa√ßo liberado: $([math]::Round($savedSpace, 2)) GB" -ForegroundColor Green
        } catch {
            Write-Host "N√£o foi poss√≠vel determinar o novo tamanho da pasta WinSxS." -ForegroundColor DarkGray
        }
    } else {
        Write-Host "Limpeza da pasta WinSxS cancelada." -ForegroundColor Yellow
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nInforma√ß√µes sobre a pasta WinSxS:" -ForegroundColor Cyan
    Write-Host "- A pasta WinSxS armazena componentes do sistema Windows e atualiza√ß√µes" -ForegroundColor DarkGray
    Write-Host "- N√£o √© recomendado excluir esta pasta manualmente" -ForegroundColor DarkGray
    Write-Host "- A limpeza realizada √© segura e usa ferramentas oficiais do Windows" -ForegroundColor DarkGray
    Write-Host "- Ap√≥s a limpeza profunda, n√£o ser√° poss√≠vel desinstalar algumas atualiza√ß√µes" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - REDE (Expandidas) ---
function Invoke-NetworkFlushDns {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Limpar Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-NetworkChangeDns {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Mudar Servidor DNS ---" -ForegroundColor Cyan
    Write-Host "Permite definir servidores DNS personalizados para suas conex√µes de rede." -ForegroundColor DarkGray
    Write-Host ""

    # Listar adaptadores de rede ativos
    Write-Host "Listando adaptadores de rede ativos..." -ForegroundColor Yellow
    $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" }
    
    if ($networkAdapters.Count -eq 0) {
        Write-Host "Nenhum adaptador de rede ativo encontrado." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    Write-Host "Adaptadores de rede ativos:" -ForegroundColor White
    $index = 1
    foreach ($adapter in $networkAdapters) {
        Write-Host "[$index] $($adapter.Name) - $($adapter.InterfaceDescription)" -ForegroundColor White
        $index++
    }
    Write-Host ""
    
    # Selecionar adaptador de rede
    $adapterChoice = Read-Host "Selecione o n√∫mero do adaptador que deseja configurar (ou 0 para voltar)"
    
    if ($adapterChoice -eq "0" -or $adapterChoice -eq "") {
        Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    $adapterIndex = [int]$adapterChoice - 1
    if ($adapterIndex -lt 0 -or $adapterIndex -ge $networkAdapters.Count) {
        Write-Host "Sele√ß√£o inv√°lida." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    $selectedAdapter = $networkAdapters[$adapterIndex]
    
    # Mostrar configura√ß√£o DNS atual
    Write-Host "Configura√ß√£o DNS atual para $($selectedAdapter.Name):" -ForegroundColor Yellow
    $currentDns = Get-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -AddressFamily IPv4 | Select-Object -ExpandProperty ServerAddresses
    
    if ($currentDns.Count -eq 0) {
        Write-Host "Nenhum servidor DNS configurado manualmente (usando DHCP)." -ForegroundColor DarkGray
    } else {
        foreach ($dns in $currentDns) {
            Write-Host $dns -ForegroundColor White
        }
    }
    Write-Host ""
    
    # Op√ß√µes de DNS
    Write-Host "Op√ß√µes de DNS:" -ForegroundColor Yellow
    Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
    Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
    Write-Host "[3] OpenDNS (208.67.222.222, 208.67.220.220)" -ForegroundColor White
    Write-Host "[4] Quad9 (9.9.9.9, 149.112.112.112)" -ForegroundColor White
    Write-Host "[5] AdGuard DNS (94.140.14.14, 94.140.15.15)" -ForegroundColor White
    Write-Host "[6] Inserir DNS personalizado" -ForegroundColor White
    Write-Host "[7] Usar DNS autom√°tico (DHCP)" -ForegroundColor White
    Write-Host "[0] Cancelar" -ForegroundColor White
    Write-Host ""
    
    $dnsChoice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($dnsChoice) {
        "1" {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            $dnsName = "Google DNS"
        }
        "2" {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            $dnsName = "Cloudflare DNS"
        }
        "3" {
            $primaryDns = "208.67.222.222"
            $secondaryDns = "208.67.220.220"
            $dnsName = "OpenDNS"
        }
        "4" {
            $primaryDns = "9.9.9.9"
            $secondaryDns = "149.112.112.112"
            $dnsName = "Quad9"
        }
        "5" {
            $primaryDns = "94.140.14.14"
            $secondaryDns = "94.140.15.15"
            $dnsName = "AdGuard DNS"
        }
        "6" {
            $primaryDns = Read-Host "Digite o endere√ßo do DNS prim√°rio"
            $secondaryDns = Read-Host "Digite o endere√ßo do DNS secund√°rio (ou deixe em branco)"
            $dnsName = "DNS Personalizado"
        }
        "7" {
            Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ResetServerAddresses
            Write-Host "Configura√ß√£o de DNS definida para autom√°tica (DHCP)." -ForegroundColor Green
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
        "0" {
            Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
        default {
            Write-Host "Op√ß√£o inv√°lida." -ForegroundColor Red
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
    }
    
    # Aplicar configura√ß√£o de DNS
    if ($secondaryDns -eq "") {
        Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ServerAddresses $primaryDns
    } else {
        Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ServerAddresses $primaryDns, $secondaryDns
    }
    
    Write-Host "Configura√ß√£o de DNS alterada para $dnsName." -ForegroundColor Green
    Write-Host "DNS Prim√°rio: $primaryDns" -ForegroundColor White
    if ($secondaryDns -ne "") {
        Write-Host "DNS Secund√°rio: $secondaryDns" -ForegroundColor White
    }
    
    # Limpar cache DNS ap√≥s a mudan√ßa
    Write-Host "Limpando cache DNS para aplicar as altera√ß√µes..." -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo." -ForegroundColor Green
    
    Write-Host "`nBenef√≠cios de usar servidores DNS alternativos:" -ForegroundColor Cyan
    Write-Host "- Maior velocidade de resolu√ß√£o de nomes" -ForegroundColor DarkGray
    Write-Host "- Melhor confiabilidade e disponibilidade" -ForegroundColor DarkGray
    Write-Host "- Alguns servidores oferecem prote√ß√£o adicional contra malware e phishing" -ForegroundColor DarkGray
    Write-Host "- Possibilidade de contornar bloqueios de conte√∫do baseados em DNS" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-NetworkReset {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Resetar Configura√ß√µes de Rede ---" -ForegroundColor White
    Write-Host "Reinicia os componentes de rede. Use como √∫ltimo recurso para solucionar problemas de conex√£o." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "!!! ATEN√á√ÉO: ESTE COMANDO VAI REINICIAR SUAS CONFIGURA√á√ïES DE REDE !!!" -ForegroundColor Red
    Write-Host "Sua conex√£o ser√° interrompida temporariamente e todas as configura√ß√µes de rede personalizadas ser√£o redefinidas." -ForegroundColor Yellow
    Write-Host "Isso inclui adaptadores de rede, configura√ß√µes de DNS, configura√ß√µes de proxy, etc." -ForegroundColor Yellow
    Write-Host ""
    
    Write-Host "Esta opera√ß√£o pode ajudar a resolver os seguintes problemas:" -ForegroundColor Cyan
    Write-Host "- Conex√µes de rede inst√°veis ou intermitentes" -ForegroundColor DarkGray
    Write-Host "- Problemas de DNS ou resolu√ß√£o de nomes" -ForegroundColor DarkGray
    Write-Host "- Problemas de conectividade ap√≥s instala√ß√£o de software ou atualiza√ß√µes" -ForegroundColor DarkGray
    Write-Host "- Erros de rede persistentes que n√£o s√£o resolvidos por outros m√©todos" -ForegroundColor DarkGray
    Write-Host ""
    
    $confirm = Read-Host "Tem certeza que deseja resetar as configura√ß√µes de rede? (digite 'sim' para confirmar)"
    
    if ($confirm -eq 'sim') {
        Write-Host "Iniciando reset de configura√ß√µes de rede..." -ForegroundColor Yellow
        
        # Etapa 1: Resetar pilha TCP/IP
        Write-Host "Etapa 1: Resetando pilha TCP/IP..." -ForegroundColor DarkGray
        netsh int ip reset
        
        # Etapa 2: Resetar cat√°logo Winsock
        Write-Host "Etapa 2: Resetando cat√°logo Winsock..." -ForegroundColor DarkGray
        netsh winsock reset
        
        # Etapa 3: Limpar cache DNS
        Write-Host "Etapa 3: Limpando cache DNS..." -ForegroundColor DarkGray
        ipconfig /flushdns
        
        # Etapa 4: Renovar configura√ß√µes DHCP
        Write-Host "Etapa 4: Renovando configura√ß√µes DHCP..." -ForegroundColor DarkGray
        ipconfig /release
        ipconfig /renew
        
        # Etapa 5: Reiniciar adaptadores de rede
        Write-Host "Etapa 5: Reiniciando adaptadores de rede..." -ForegroundColor DarkGray
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        
        Write-Host "Reset de configura√ß√µes de rede conclu√≠do!" -ForegroundColor Green
        Write-Host "Recomenda-se reiniciar o computador para aplicar todas as altera√ß√µes." -ForegroundColor Yellow
        
        $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (s/n)"
        if ($confirmRestart -eq 's') {
            Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
            Restart-Computer -Force
        } else {
            Write-Host "Rein√≠cio cancelado. Algumas altera√ß√µes podem n√£o ter efeito at√© que o computador seja reiniciado." -ForegroundColor Yellow
        }
    } else {
        Write-Host "Reset de configura√ß√µes de rede cancelado." -ForegroundColor Green
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-OptimizeTcpIp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Otimizar Configura√ß√µes TCP/IP ---" -ForegroundColor Green
    Write-Host "Ajusta configura√ß√µes avan√ßadas do TCP/IP para melhorar o desempenho da conex√£o." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o otimiza v√°rios par√¢metros TCP/IP para melhorar a velocidade e estabilidade da conex√£o." -ForegroundColor White
    Write-Host "As otimiza√ß√µes s√£o seguras e podem ser revertidas se necess√°rio." -ForegroundColor White
    Write-Host ""
    
    Write-Host "Configura√ß√µes atuais:" -ForegroundColor Yellow
    
    # Mostrar configura√ß√µes atuais
    Write-Host "Auto-Tuning Level:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Auto-Tuning Level"
    
    Write-Host "Congestion Provider:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Congestion Control Provider"
    
    Write-Host "ECN Capability:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "ECN Capability"
    
    Write-Host "Receive-Side Scaling (RSS):" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Receive-Side Scaling State"
    
    Write-Host ""
    $confirm = Read-Host "Deseja aplicar otimiza√ß√µes TCP/IP recomendadas? (s/n)"
    
    if ($confirm -eq 's') {
        Write-Host "Aplicando otimiza√ß√µes TCP/IP..." -ForegroundColor Yellow
        
        # Otimiza√ß√£o 1: Habilitar TCP Window Auto-Tuning
        Write-Host "Configurando TCP Auto-Tuning para 'normal'..." -ForegroundColor DarkGray
        netsh int tcp set global### Enhanced TORK Optimizer

I'll enhance the TORK optimizer with more comprehensive functionality across all features, starting with an expanded Simple Cleanup function and then improving all other options.

```powershell type="code"
# Define a preferencia de acao para erros (continua a execucao por padrao)
# Permite que o script tente rodar o m√°ximo poss√≠vel mesmo que alguns comandos encontrem problemas.
$ErrorActionPreference = 'SilentlyContinue' # N√£o exibe erros se um item n√£o puder ser processado, por exemplo.

# --- Funcao pra Centralizar Texto (Nosso Maestro de Alinhamento - s√≥ pra textos, n√£o pro bannerz√£o!) ---
# Deixa ela aqui, vai que a gente usa pra centralizar outra coisa, n√©?
function Centraliza($texto, $cor="White") {
    $largura = [console]::WindowWidth # Pega a largura da largura da janela agora
    # Calcula o espa√ßo pra botar o texto no meio. Pura matem√°tica da zoeira!
    $espacos = [Math]::Max(0, [Math]::Floor(($largura - $texto.Length) / 2))
    $linha = (" " * $espacos) + $texto # Cria a linha com os espa√ßos e o texto
    Write-Host $linha -ForegroundColor $cor # Manda pro console com a cor pedida
}

# --- Funcao que Desenha o Nosso Banner Irado do TORK! ---
# Esse √© o nosso outdoor digital no console! Ajustado pros espa√ßos que voc√™ mandou!
# Se as bordas ainda estiverem meio teimosas, √© o jeitinho do console mesmo, viu? üòâ
function Banner-TORK {
    # Nossas cores vibrantes para o banner!
    $CorBorda = "DarkCyan" # Mantido para a borda, combina com o ciano. Se quiser mudar, √© aqui!
    $CorLogo = "Green" # Cor vibrante
    $CorProjeto = "Cyan" # Cor vibrante
    $CorCopyright = "Gray" # Tom mais suave

    Write-Host "" # D√° um espacinho no topo, pra n√£o grudar
    Write-Host "                    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë          ‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë ‚ñà‚ñà‚ïî‚ïù                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ñà‚ñà‚ïó                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù                                          ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë           Bem-vindo ao TORK - Otimizador para Windows!                                ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë        Projeto de automacao, limpeza, manutencao e tweaks.                            ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë            (C) Partner77 - Todos os direitos reservados                               ‚ïë" -ForegroundColor $CorCopyright
    Write-Host "                    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor $CorBorda
    Write-Host "" # Espa√ßo embaixo
}

# --- Checagem de Permiss√µes de Administrador (O Guarda da Porta!) ---
# V√™ se a gente t√° rodando com poderes de admin, sen√£o n√£o d√° pra mexer no Windows direito.
function Test-Administrator {
    $currentUser = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())
    return $currentUser.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
}

if (-not (Test-Administrator)) {
    Write-Host "OPA! Calma l√°, patr√£o!" -ForegroundColor Red
    Write-Host "Pra usar o TORK e deixar o PC voando, preciso de super poderes de Administrador!" -ForegroundColor Yellow
    Write-Host "Fecha essa janela, clica com o bot√£o direito no arquivo do script e escolhe 'Executar como administrador'. A√≠ sim, tamo junto!" -ForegroundColor Yellow
    Read-Host "D√° um Enter quando terminar de ler, que a gente se v√™ na pr√≥xima..."
    Exit
}

Write-Host "Poderes de Administrador verificados! Bora nessa!" -ForegroundColor Green
Start-Sleep -Seconds 1

# --- Fun√ß√µes Utilit√°rias (Ferramentas que usamos em v√°rios lugares) ---
function Get-SystemInfo {
    $os = Get-CimInstance Win32_OperatingSystem
    $cs = Get-CimInstance Win32_ComputerSystem
    $proc = Get-CimInstance Win32_Processor
    $mem = Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property Capacity -Sum
    
    $info = @{
        "OSName" = $os.Caption
        "OSVersion" = $os.Version
        "OSBuild" = $os.BuildNumber
        "ComputerName" = $cs.Name
        "Manufacturer" = $cs.Manufacturer
        "Model" = $cs.Model
        "Processor" = $proc.Name
        "Memory" = [math]::Round($mem.Sum / 1GB, 2)
        "Architecture" = $os.OSArchitecture
        "InstallDate" = $os.InstallDate
        "LastBootTime" = $os.LastBootUpTime
    }
    
    return $info
}

function Show-SystemSummary {
    $sysInfo = Get-SystemInfo
    
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Computador: $($sysInfo.ComputerName)" -ForegroundColor White
    Write-Host "Fabricante: $($sysInfo.Manufacturer)" -ForegroundColor White
    Write-Host "Modelo: $($sysInfo.Model)" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "Instalado em: $($sysInfo.InstallDate)" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

function Get-DiskSpaceBefore {
    $drives = Get-PSDrive -PSProvider FileSystem
    $driveInfo = @{}
    
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        
        $driveInfo[$drive.Name] = @{
            "Free" = $freeSpace
            "Used" = $usedSpace
            "Total" = $totalSpace
        }
    }
    
    return $driveInfo
}

function Show-DiskSpaceComparison {
    param (
        $before
    )
    
    $after = Get-PSDrive -PSProvider FileSystem
    
    Write-Host "=== Compara√ß√£o de Espa√ßo em Disco ===" -ForegroundColor Cyan
    
    foreach ($drive in $after) {
        if ($before.ContainsKey($drive.Name)) {
            $freeSpaceAfter = [math]::Round($drive.Free / 1GB, 2)
            $freeSpaceBefore = $before[$drive.Name].Free
            $spaceRecovered = [math]::Round($freeSpaceAfter - $freeSpaceBefore, 2)
            
            Write-Host "Drive $($drive.Name):" -ForegroundColor White
            Write-Host "  Espa√ßo livre antes: $freeSpaceBefore GB" -ForegroundColor Gray
            Write-Host "  Espa√ßo livre agora: $freeSpaceAfter GB" -ForegroundColor Gray
            
            if ($spaceRecovered -gt 0) {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Green
            } else {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Yellow
            }
            Write-Host ""
        }
    }
    
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

# --- Fun√ß√µes dos Menus (Principal, Simplificado, Avan√ßado e Sub-menus) ---

# --- Menu Principal (A Bifurca√ß√£o do Destino! Simplificado vs Avan√ßado) ---
# √â aqui que o usu√°rio escolhe se quer ser um mago ou um cara pr√°tico!
function Show-MainMenu {
    do {
        Clear-Host # Limpa a tela pra organizar o menu
        Banner-TORK # Banner no topo, pra gente n√£o esquecer quem somos!
        Show-SystemSummary # Mostra um resumo do sistema

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "       MENU PRINCIPAL" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # As duas grandes estradas da otimiza√ß√£o! Cores variadas (repetindo)!
        Write-Host "[1] Otimiza√ß√£o Simplificada (Pra quem quer praticidade e resultado r√°pido!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o Avan√ßada (Pra quem curte mexer fundo e ter control total!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[3] Diagn√≥stico R√°pido do Sistema (Ver o que t√° rolando no PC)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[4] Sobre o TORK (Informa√ß√µes e cr√©ditos)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[0] Sair (Ah, que pena... Mas a porta t√° aberta!)" -ForegroundColor Red # Vermelho pra Sair - Ok

        Write-Host ""

        # Pergunta pro usu√°rio qual caminho ele escolhe, tipo Mestre Pok√©mon!
        $choice = Read-Host "Escolhe sua op√ß√£o, treinador!"

        # V√™ pra onde a gente vai com base na escolha
        switch ($choice) {
            "1" { Show-SimplifiedMenu } # Se escolheu 1, vai pro Menu Simplificado!
            "2" { Show-AdvancedMenu } # Se escolheu 2, vai pro Menu Avan√ßado!
            "3" { Invoke-QuickDiagnostic } # Nova fun√ß√£o de diagn√≥stico r√°pido
            "4" { Show-AboutTORK } # Nova fun√ß√£o de sobre
            "0" { Write-Host "Fechou! Valeu por usar o TORK! Volte sempre que seu PC pedir um g√°s! ;)" -ForegroundColor Green; Start-Sleep -Seconds 2; break } # Se escolheu 0, vaza (mas volta!)
            default {
                Write-Host "Eita! Op√ß√£o inv√°lida! Confere os n√∫meros e tenta de novo, bora l√°!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1 # D√° um tempinho pro usu√°rio ver a zoeira da mensagem
            }
        }
    } while ($choice -ne '0') # Repete o Menu Principal enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Simplificado (Aqui o TORK faz m√°gica r√°pida e segura!) ---
# Acessado pela op√ß√£o 1 do Menu Principal. Menos op√ß√µes, mais a√ß√£o direta!
function Show-SimplifiedMenu {
    do {
        Clear-Host # Limpa o palco pra esse menu!
        Banner-TORK # Nosso banner no topo, sempre presente!

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "   OTIMIZACAO SIMPLIFICADA" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes SIMPLIFICADAS - cada uma pode fazer um monte de coisa por baixo dos panos! Cores variadas (repetindo as prim√°rias/neon e adicionando outras)!
        Write-Host "[1] Limpeza Geral do Sistema (Tira o lixo que t√° pesando!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o de Mem√≥ria e Programas que Ligam com o Windows (Deixa tudo mais √°gil!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[3] Acelerar a Conex√£o com a Internet (Pra navegar sem gargalo!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[4] Deixar o Windows mais Leve Visualmente (Desativa uns efeitos pra ganhar desempenho!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Otimiza√ß√£o de Jogos (Configura√ß√µes pra melhorar FPS e desempenho)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[6] Manuten√ß√£o de Seguran√ßa (Verificar e corrigir problemas de seguran√ßa)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[7] RODAR TODAS as otimiza√ß√µes SIMPLIFICADAS! (Modo Turbo F√°cil!)" -ForegroundColor Red # Vermelho pra "Faz Tudo" - Destaque/Cuidado
        Write-Host "[0] Voltar ao Menu Principal (A gente te espera aqui!)" -ForegroundColor Gray # Cor neutra pra voltar

        Write-Host ""

        # Pergunta qual m√°gica simplificada o usu√°rio quer
        $choice = Read-Host "Escolhe sua m√°gica simplificada!"

        # V√™ qual m√°gica rodar
        switch ($choice) {
            "1" { Invoke-SimpleSystemCleanup } # Chama a fun√ß√£o de limpeza b√°sica
            "2" { Invoke-SimpleMemoryStartup } # Chama a fun√ß√£o pra mem√≥ria/inicializa√ß√£o
            "3" { Invoke-SimpleInternetOpt } # Chama a fun√ß√£o pra internet
            "4" { Invoke-SimpleVisualOpt } # Chama a fun√ß√£o pra visual
            "5" { Invoke-SimpleGamingOpt } # Nova fun√ß√£o para otimiza√ß√£o de jogos
            "6" { Invoke-SimpleSecurityMaintenance } # Nova fun√ß√£o para manuten√ß√£o de seguran√ßa
            "7" {
                # Rodar todas as simplificadas sequencialmente
                Write-Host "`nModo Turbo F√°cil ATIVADO! Rodando todas as otimiza√ß√µes SIMPLIFICADAS... segura pe√£o!`n" -ForegroundColor Yellow
                Invoke-SimpleSystemCleanup # Roda a 1
                Invoke-SimpleMemoryStartup # Roda a 2
                Invoke-SimpleInternetOpt # Roda a 3
                Invoke-SimpleVisualOpt # Roda a 4
                Invoke-SimpleGamingOpt # Roda a 5
                Invoke-SimpleSecurityMaintenance # Roda a 6
                Write-Host "`nShow! Todas as otimiza√ß√µes SIMPLIFICADAS foram executadas! PC t√° agradecendo! ;)`n" -ForegroundColor Green
                Read-Host "Aperta Enter pra voltar pro Menu Simplificado..." # Pausa no final do "Rodar Todas"
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-MainMenu
            default {
                Write-Host "Ops! Op√ß√£o inv√°lida no Menu Simplificado! Confere os n√∫meros e manda bala de novo!" -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Simplificado enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Avan√ßado (O Playground dos Magos do PC!) ---
# Acessado pela op√ß√£o 2 do Menu Principal. Aqui a gente mergulha fundo!
function Show-AdvancedMenu {
    do {
        Clear-Host # Limpa o palco pro menu avan√ßado!
        Banner-TORK # Nosso banner no topo, pra n√£o perder a pose!

        Write-Host "" # Espacinho maroto
        Write-Host "===============================" -ForegroundColor White
        Write-Host "      MENU AVANCADO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes do menu avan√ßado (as CATEGORIAS dos 200 poderes!) Cores variadas (repetindo)!
        Write-Host "[1] Limpeza e Manuten√ß√£o de Arquivos (Tirar a poeira digital!)" -ForegroundColor Cyan # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[2] Otimiza√ß√µes de Desempenho do Sistema (Deixar o motor roncando!)" -ForegroundColor Green # Cor variada
        Write-Host "[3] Configura√ß√µes e Otimiza√ß√µes de Rede (Pra internet voar baixo!)" -ForegroundColor Yellow # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[4] Gerenciamento e Otimiza√ß√£o de Servi√ßos do Windows (O que t√° rodando e n√£o precisa?!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Ferramentas de Diagn√≥stico e Verifica√ß√£o (Pra ver se t√° tudo nos conformes!)" -ForegroundColor Cyan # Cor repetida
        Write-Host "[6] Desabilitar/Gerenciar Recursos do Windows (Tirar o peso extra do sistema!)" -ForegroundColor Green # Cor repetida
        Write-Host "[7] Gerenciamento de Arquivos e Pastas Avan√ßado (Comandos ninja pra arquivos!)" -ForegroundColor Yellow # Cor repetida
        Write-Host "[8] Gerenciamento de Contas de Usu√°rio (Organizar a galera que usa o PC!)" -ForegroundColor White # Cor repetida
        Write-Host "[9] Otimiza√ß√£o para Jogos Avan√ßada (Tweaks pra gamers de verdade!)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Configura√ß√µes de Privacidade (Controle o que o Windows sabe sobre voc√™)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[11] Outras Configura√ß√µes e Tweaks Diversos (Aqueles ajustes secretos!)" -ForegroundColor Gray # Cor neutra/escura
        Write-Host "[0] Voltar ao Menu Principal (Pronto pra voltar pra estrada principal!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta pro mago qual categoria ele quer explorar
        $choice = Read-Host "Escolhe sua √°rea de magia, mago!"

        # V√™ pra onde a gente navega dentro do mundo avan√ßado
        switch ($choice) {
            "1" { Show-LimpezaManutencaoMenu } # CHAMA O SUB-MENU DE LIMPEZA
            "2" { Show-DesempenhoMenu } # Agora √© um sub-menu tamb√©m
            "3" { Show-ConfiguracoesRedeMenu } # CHAMA O SUB-MENU DE REDE
            "4" { Show-ServicosMenu } # Agora √© um sub-menu tamb√©m
            "5" { Show-DiagnosticoMenu } # Agora √© um sub-menu tamb√©m
            "6" { Show-RecursosMenu } # Agora √© um sub-menu tamb√©m
            "7" { Show-ArquivosPastasMenu } # Agora √© um sub-menu tamb√©m
            "8" { Show-UsuariosMenu } # Agora √© um sub-menu tamb√©m
            "9" { Show-JogosAvancadoMenu } # Novo sub-menu para jogos
            "10" { Show-PrivacidadeMenu } # Novo sub-menu para privacidade
            "11" { Show-OutrosMenu } # Agora √© um sub-menu tamb√©m
            "0" { break } # Sai do loop deste menu, voltando pro Menu Principal
            default {
                Write-Host "Humm, essa √°rea da magia ainda n√£o existe ou voc√™ digitou errado! Tenta de novo, mago!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Avan√ßado enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Limpeza e Manuten√ß√£o (Dentro do Avan√ßado!) ---
# Este menu lista as op√ß√µes ESPEC√çFICAS da categoria Limpeza no Menu Avan√ßado
function Show-LimpezaManutencaoMenu {
    do {
        Clear-Host # Limpa o palco pra este sub-menu!
        Banner-TORK # Banner no topo, sempre!

        Write-Host "" # Espacinho
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: LIMPEZA E MANUT." -ForegroundColor White # T√≠tulo menor pro sub-menu
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes ESPEC√çFICAS da categoria Limpeza. Cores variadas (repetindo cores)!
        Write-Host "[1] Limpar Arquivos Tempor√°rios do Usu√°rio (Tipo a pasta Temp!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[2] Limpar Arquivos Tempor√°rios do Sistema (Os tempor√°rios do Windows!)" -ForegroundColor Gray # Cor neutra (substitui DarkCyan)
        Write-Host "[3] Limpar Cache de DNS (Pra resolver nomes de site mais r√°pido!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[4] Esvaziar Lixeira (Adeus, arquivos deletados!)" -ForegroundColor Gray # Cor neutra (repetindo)
        Write-Host "[5] Limpar Cache de Miniaturas (Aqueles previews de imagem/v√≠deo!)" -ForegroundColor Green # Cor variada
        Write-Host "[6] Limpar Logs do Sistema (Arquivos de registro que acumulam)" -ForegroundColor Cyan # Nova op√ß√£o
        Write-Host "[7] Limpar Cache de Atualiza√ß√µes do Windows (Liberar espa√ßo de updates)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[8] Limpar Arquivos de Hiberna√ß√£o (Liberar o hiberfil.sys)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[9] Limpar Arquivos WinSxS (Pasta que ocupa muito espa√ßo)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Executar TODAS as limpezas acima (Faxina completa!)" -ForegroundColor Red # Nova op√ß√£o
        Write-Host "[0] Voltar ao Menu Avan√ßado (De volta pras categorias!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta qual limpeza espec√≠fica o mago quer fazer
        $choice = Read-Host "Escolhe a limpeza avan√ßada, mestre!"

        # V√™ qual fun√ß√£o de limpeza espec√≠fica chamar
        switch ($choice) {
            "1" { Invoke-CleanUserTemp } # Chama a fun√ß√£o pra Limpar Temp Usu√°rio
            "2" { Invoke-CleanSystemTemp } # Chama a fun√ß√£o pra Limpar Temp Sistema
            "3" { Invoke-CleanDnsCache } # Chama a fun√ß√£o pra Limpar Cache DNS
            "4" { Invoke-EmptyRecycleBin } # Chama a fun√ß√£o pra Esvaziar Lixeira
            "5" { Invoke-CleanThumbnailCache } # Chama a fun√ß√£o pra Limpar Cache de Miniaturas
            "6" { Invoke-CleanSystemLogs } # Nova fun√ß√£o para limpar logs do sistema
            "7" { Invoke-CleanWindowsUpdateCache } # Nova fun√ß√£o para limpar cache de updates
            "8" { Invoke-CleanHibernationFile } # Nova fun√ß√£o para limpar arquivo de hiberna√ß√£o
            "9" { Invoke-CleanWinSxS } # Nova fun√ß√£o para limpar pasta WinSxS
            "10" { 
                # Executa todas as limpezas em sequ√™ncia
                Write-Host "`nIniciando faxina completa do sistema! Isso pode demorar um pouco...`n" -ForegroundColor Yellow
                $diskSpaceBefore = Get-DiskSpaceBefore
                
                Invoke-CleanUserTemp
                Invoke-CleanSystemTemp
                Invoke-CleanDnsCache
                Invoke-EmptyRecycleBin
                Invoke-CleanThumbnailCache
                Invoke-CleanSystemLogs
                Invoke-CleanWindowsUpdateCache
                Invoke-CleanHibernationFile
                Invoke-CleanWinSxS
                
                Write-Host "`nFaxina completa finalizada! Veja quanto espa√ßo foi recuperado:`n" -ForegroundColor Green
                Show-DiskSpaceComparison -before $diskSpaceBefore
                Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-AdvancedMenu
            default {
                Write-Host "Essa tarefa de limpeza ainda n√£o t√° na lista! V√™ os n√∫meros e tenta de novo!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Sub-Menu Limpeza enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Desempenho (Dentro do Avan√ßado!) ---
function Show-DesempenhoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DESEMPENHO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Ajustar Efeitos Visuais para Melhor Desempenho" -ForegroundColor Green
        Write-Host "[2] Otimizar Disco do Sistema" -ForegroundColor Cyan
        Write-Host "[3] Limpar Arquivos Prefetch" -ForegroundColor Yellow
        Write-Host "[4] Definir Plano de Energia para Alto Desempenho" -ForegroundColor White
        Write-Host "[5] Otimizar Servi√ßo SuperFetch/SysMain" -ForegroundColor Magenta
        Write-Host "[6] Ajustar Tamanho da Mem√≥ria Virtual" -ForegroundColor Gray
        Write-Host "[7] Desativar Indexa√ß√£o de Arquivos" -ForegroundColor Green
        Write-Host "[8] Otimizar Inicializa√ß√£o do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de desempenho" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o de desempenho"

        switch ($choice) {
            "1" { Invoke-OptimizeVisualEffects }
            "2" { Invoke-OptimizeDisk }
            "3" { Invoke-CleanPrefetch }
            "4" { Invoke-SetHighPerformancePower }
            "5" { Invoke-OptimizeSuperFetch }
            "6" { Invoke-AdjustVirtualMemory }
            "7" { Invoke-DisableIndexing }
            "8" { Invoke-OptimizeStartup }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de desempenho...`n" -ForegroundColor Yellow
                Invoke-OptimizeVisualEffects
                Invoke-OptimizeDisk
                Invoke-CleanPrefetch
                Invoke-SetHighPerformancePower
                Invoke-OptimizeSuperFetch
                Invoke-AdjustVirtualMemory
                Invoke-DisableIndexing
                Invoke-OptimizeStartup
                Write-Host "`nTodas as otimiza√ß√µes de desempenho foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Configura√ß√µes de Rede (Dentro do Avan√ßado!) ---
function Show-ConfiguracoesRedeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: CONFIG. REDE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Limpar Cache de DNS" -ForegroundColor Yellow
        Write-Host "[2] Mudar Servidor DNS" -ForegroundColor Cyan
        Write-Host "[3] Resetar Configura√ß√µes de Rede" -ForegroundColor White
        Write-Host "[4] Otimizar Configura√ß√µes TCP/IP" -ForegroundColor Green
        Write-Host "[5] Verificar Velocidade da Conex√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar QoS (Qualidade de Servi√ßo)" -ForegroundColor Gray
        Write-Host "[7] Desativar IPv6 (Se n√£o estiver usando)" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Lat√™ncia de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de rede" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√£o de rede"

        switch ($choice) {
            "1" { Invoke-NetworkFlushDns }
            "2" { Invoke-NetworkChangeDns }
            "3" { Invoke-NetworkReset }
            "4" { Invoke-OptimizeTcpIp }
            "5" { Invoke-CheckNetworkSpeed }
            "6" { Invoke-ConfigureQoS }
            "7" { Invoke-DisableIPv6 }
            "8" { Invoke-OptimizeGamingLatency }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de rede...`n" -ForegroundColor Yellow
                Invoke-NetworkFlushDns
                Invoke-OptimizeTcpIp
                Invoke-CheckNetworkSpeed
                Invoke-ConfigureQoS
                Invoke-DisableIPv6
                Invoke-OptimizeGamingLatency
                Write-Host "`nTodas as otimiza√ß√µes de rede foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Rede..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Servi√ßos (Dentro do Avan√ßado!) ---
function Show-ServicosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: SERVICOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desabilitar Servi√ßo SuperFetch/SysMain" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Servi√ßo de Impress√£o" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Servi√ßo Windows Update" -ForegroundColor White
        Write-Host "[4] Listar Todos os Servi√ßos em Execu√ß√£o" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Otimizar Servi√ßos para Desempenho Geral" -ForegroundColor Gray
        Write-Host "[7] Restaurar Servi√ßos para Configura√ß√£o Padr√£o" -ForegroundColor Yellow
        Write-Host "[8] Desabilitar Servi√ßos Desnecess√°rios" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de servi√ßos"

        switch ($choice) {
            "1" { Invoke-ManageSuperFetch }
            "2" { Invoke-ManagePrintService }
            "3" { Invoke-ManageWindowsUpdate }
            "4" { Invoke-ListRunningServices }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-OptimizeServicesForPerformance }
            "7" { Invoke-RestoreDefaultServices }
            "8" { Invoke-DisableUnnecessaryServices }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Diagn√≥stico (Dentro do Avan√ßado!) ---
function Show-DiagnosticoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DIAGNOSTICO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Verificar Arquivos do Sistema (SFC)" -ForegroundColor Yellow
        Write-Host "[2] Reparar Imagem do Windows (DISM)" -ForegroundColor Cyan
        Write-Host "[3] Verificar Disco por Erros (CHKDSK)" -ForegroundColor White
        Write-Host "[4] Verificar Sa√∫de do Disco" -ForegroundColor Green
        Write-Host "[5] Verificar Drivers Desatualizados" -ForegroundColor Magenta
        Write-Host "[6] Verificar Problemas de Inicializa√ß√£o" -ForegroundColor Gray
        Write-Host "[7] Verificar Problemas de Mem√≥ria RAM" -ForegroundColor Yellow
        Write-Host "[8] Verificar Temperatura do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODOS os diagn√≥sticos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de diagn√≥stico"

        switch ($choice) {
            "1" { Invoke-SfcScan }
            "2" { Invoke-DismRepair }
            "3" { Invoke-ChkDsk }
            "4" { Invoke-CheckDiskHealth }
            "5" { Invoke-CheckDrivers }
            "6" { Invoke-CheckStartupIssues }
            "7" { Invoke-CheckMemory }
            "8" { Invoke-CheckTemperature }
            "9" {
                Write-Host "`nExecutando todos os diagn√≥sticos...`n" -ForegroundColor Yellow
                Invoke-SfcScan
                Invoke-DismRepair
                Invoke-CheckDiskHealth
                Invoke-CheckDrivers
                Invoke-CheckStartupIssues
                Invoke-CheckTemperature
                Write-Host "`nTodos os diagn√≥sticos foram conclu√≠dos!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Diagn√≥stico..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Recursos (Dentro do Avan√ßado!) ---
function Show-RecursosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: RECURSOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Gerenciar Hiberna√ß√£o" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Planos de Energia" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Recursos Opcionais do Windows" -ForegroundColor White
        Write-Host "[4] Gerenciar Mem√≥ria Virtual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Windows Defender" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Recursos de Telemetria" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Recursos de Inicializa√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Recursos de Seguran√ßa" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de recursos"

        switch ($choice) {
            "1" { Invoke-ManageHibernation }
            "2" { Invoke-ManagePowerPlans }
            "3" { Invoke-ManageOptionalFeatures }
            "4" { Invoke-ManageVirtualMemory }
            "5" { Invoke-ManageWindowsDefender }
            "6" { Invoke-ManageTelemetry }
            "7" { Invoke-ManageStartupResources }
            "8" { Invoke-ManageSecurityFeatures }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Arquivos e Pastas (Dentro do Avan√ßado!) ---
function Show-ArquivosPastasMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: ARQUIVOS E PASTAS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Encontrar Arquivos Grandes" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Arquivos" -ForegroundColor Cyan
        Write-Host "[3] Tomar Posse de Arquivos (TakeOwn)" -ForegroundColor White
        Write-Host "[4] Listar Conte√∫do de Pastas Espec√≠ficas" -ForegroundColor Green
        Write-Host "[5] Compactar Pastas para Economizar Espa√ßo" -ForegroundColor Magenta
        Write-Host "[6] Verificar Integridade de Arquivos" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Arquivos Ocultos e do Sistema" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Atributos de Arquivos" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de arquivos e pastas"

        switch ($choice) {
            "1" { Invoke-FindLargeFiles }
            "2" { Invoke-ManageFilePermissions }
            "3" { Invoke-TakeOwnership }
            "4" { Invoke-ListFolderContents }
            "5" { Invoke-CompressFolders }
            "6" { Invoke-VerifyFileIntegrity }
            "7" { Invoke-ManageHiddenSystemFiles }
            "8" { Invoke-ManageFileAttributes }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Usu√°rios (Dentro do Avan√ßado!) ---
function Show-UsuariosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: USUARIOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Listar Todos os Usu√°rios Locais" -ForegroundColor Yellow
        Write-Host "[2] Listar Todos os Grupos Locais" -ForegroundColor Cyan
        Write-Host "[3] Listar Membros de Grupos Espec√≠ficos" -ForegroundColor White
        Write-Host "[4] Mostrar Propriedades do Usu√°rio Atual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Contas de Usu√°rio" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Pol√≠ticas de Senha" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Permiss√µes de Usu√°rio" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar UAC (Controle de Conta de Usu√°rio)" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de usu√°rios"

        switch ($choice) {
            "1" { Invoke-ListLocalUsers }
            "2" { Invoke-ListLocalGroups }
            "3" { Invoke-ListGroupMembers }
            "4" { Invoke-ShowCurrentUserProperties }
            "5" { Invoke-ManageUserAccounts }
            "6" { Invoke-ManagePasswordPolicies }
            "7" { Invoke-ManageUserPermissions }
            "8" { Invoke-ManageUAC }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Jogos Avan√ßado (Dentro do Avan√ßado!) ---
function Show-JogosAvancadoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: JOGOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Otimizar Prioridade de CPU para Jogos" -ForegroundColor Yellow
        Write-Host "[2] Otimizar Configura√ß√µes de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[3] Otimizar Configura√ß√µes de GPU" -ForegroundColor White
        Write-Host "[4] Desativar Game DVR e Game Bar" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Configurar Modo de Jogo do Windows" -ForegroundColor Gray
        Write-Host "[7] Otimizar Configura√ß√µes de √Åudio para Jogos" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Configura√ß√µes de Input Lag" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes para jogos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o para jogos"

        switch ($choice) {
            "1" { Invoke-OptimizeCpuPriority }
            "2" { Invoke-OptimizeNetworkForGaming }
            "3" { Invoke-OptimizeGpuSettings }
            "4" { Invoke-DisableGameDvrBar }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-ConfigureGameMode }
            "7" { Invoke-OptimizeAudioForGaming }
            "8" { Invoke-OptimizeInputLag }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes para jogos...`n" -ForegroundColor Yellow
                Invoke-OptimizeCpuPriority
                Invoke-OptimizeNetworkForGaming
                Invoke-OptimizeGpuSettings
                Invoke-DisableGameDvrBar
                Invoke-OptimizeServicesForGaming
                Invoke-ConfigureGameMode
                Invoke-OptimizeAudioForGaming
                Invoke-OptimizeInputLag
                Write-Host "`nTodas as otimiza√ß√µes para jogos foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Jogos..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Privacidade (Dentro do Avan√ßado!) ---
function Show-PrivacidadeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: PRIVACIDADE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desativar Telemetria do Windows" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Aplicativos" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Hist√≥rico de Atividades" -ForegroundColor White
        Write-Host "[4] Gerenciar Diagn√≥stico e Feedback" -ForegroundColor Green
        Write-Host "[5] Gerenciar An√∫ncios Personalizados" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Localiza√ß√£o e Sensores" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Reconhecimento de Voz e Digita√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Sincroniza√ß√£o com a Microsoft" -ForegroundColor Cyan
        Write-Host "[9] Aplicar TODAS as configura√ß√µes de privacidade" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de privacidade"

        switch ($choice) {
            "1" { Invoke-DisableTelemetry }
            "2" { Invoke-ManageAppPermissions }
            "3" { Invoke-ManageActivityHistory }
            "4" { Invoke-ManageDiagnosticsFeedback }
            "5" { Invoke-ManagePersonalizedAds }
            "6" { Invoke-ManageLocationSensors }
            "7" { Invoke-ManageVoiceTyping }
            "8" { Invoke-ManageMicrosoftSync }
            "9" {
                Write-Host "`nAplicando todas as configura√ß√µes de privacidade...`n" -ForegroundColor Yellow
                Invoke-DisableTelemetry
                Invoke-ManageAppPermissions
                Invoke-ManageActivityHistory
                Invoke-ManageDiagnosticsFeedback
                Invoke-ManagePersonalizedAds
                Invoke-ManageLocationSensors
                Invoke-ManageVoiceTyping
                Invoke-ManageMicrosoftSync
                Write-Host "`nTodas as configura√ß√µes de privacidade foram aplicadas!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Privacidade..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Outros (Dentro do Avan√ßado!) ---
function Show-OutrosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: OUTROS TWEAKS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Mostrar Informa√ß√µes Detalhadas do Sistema" -ForegroundColor Yellow
        Write-Host "[2] Mostrar Configura√ß√£o Completa de Rede" -ForegroundColor Cyan
        Write-Host "[3] Reiniciar Explorer.exe" -ForegroundColor White
        Write-Host "[4] Limpar Cache de Atualiza√ß√µes do Windows" -ForegroundColor Green
        Write-Host "[5] Gerenciar Programas de Inicializa√ß√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar Op√ß√µes de Energia Avan√ßadas" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Configura√ß√µes de Armazenamento" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Configura√ß√µes de Notifica√ß√µes" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√µes diversas"

        switch ($choice) {
            "1" { Invoke-ShowDetailedSystemInfo }
            "2" { Invoke-ShowDetailedNetworkConfig }
            "3" { Invoke-RestartExplorer }
            "4" { Invoke-CleanWindowsUpdateCache }
            "5" { Invoke-ManageStartupPrograms }
            "6" { Invoke-ConfigureAdvancedPowerOptions }
            "7" { Invoke-ManageStorageSettings }
            "8" { Invoke-ManageNotificationSettings }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- Fun√ß√µes para as Secoes SIMPLIFICADAS (Expandidas) ---
function Invoke-SimpleSystemCleanup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza Geral do Sistema: Hora de varrer o lixo digital! ---" -ForegroundColor Green
    Write-Host "Essa op√ß√£o vai te ajudar a liberar espa√ßo e dar um f√¥lego pro PC tirando arquivos tempor√°rios, lixo da lixeira, etc. √â tipo faxina no computador!" -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Comando 1: Limpar Arquivos Tempor√°rios do Usu√°rio
    Write-Host "Bora come√ßar limpando os arquivos tempor√°rios do seu usu√°rio! Eles acumulam que √© uma beleza!" -ForegroundColor Yellow
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio limpos! Menos peso pro PC respirar! ;)" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Esvaziar a Lixeira
    Write-Host "Agora, vamos dar um fim definitivo naqueles arquivos na Lixeira. Eles s√≥ est√£o ocupando espa√ßo √† toa!" -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada! Espa√ßo recuperado com sucesso! R√°!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios do Windows
    Write-Host "Vamos limpar tamb√©m os tempor√°rios do pr√≥prio Windows. √Äs vezes, fica lixo escondido por l√°!" -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Limpar Cache de Navegadores Comuns
    Write-Host "Bora dar uma geral nos caches dos navegadores tamb√©m! Eles guardam um monte de coisa que pode pesar!" -ForegroundColor Yellow
    
    # Chrome
    Write-Host "Tentando limpar cache do Google Chrome..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Chrome limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Edge
    Write-Host "Tentando limpar cache do Microsoft Edge..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Edge limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Firefox
    Write-Host "Tentando limpar cache do Mozilla Firefox..." -ForegroundColor DarkGray
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\cache2\entries\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\startupCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\thumbnails\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Firefox limpo (pode n√£o ser completo, dependendo do perfil/uso)." -ForegroundColor DarkGray

    # Brave (se instalado)
    Write-Host "Tentando limpar cache do Brave Browser (se instalado)..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Brave limpo (se instalado e n√£o estiver rodando)." -ForegroundColor DarkGray

    Write-Host "Limpeza de caches de navegador conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Comando 5: Limpar Cache de Miniaturas
    Write-Host "Limpando cache de miniaturas do Windows (aquelas pr√©-visualiza√ß√µes de imagens e v√≠deos)..." -ForegroundColor Yellow
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Write-Host "Cache de miniaturas limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Limpar Arquivos de Log do Windows
    Write-Host "Limpando arquivos de log do Windows que podem ocupar espa√ßo..." -ForegroundColor Yellow
    wevtutil cl Application
    wevtutil cl System
    wevtutil cl Security
    Write-Host "Logs do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 7: Limpar Arquivos Tempor√°rios de Instala√ß√£o
    Write-Host "Limpando arquivos tempor√°rios de instala√ß√£o de programas..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Installer\$*\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios de instala√ß√£o limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 8: Limpar Arquivos de Atualiza√ß√£o do Windows
    Write-Host "Limpando arquivos de atualiza√ß√£o do Windows que podem ocupar bastante espa√ßo..." -ForegroundColor Yellow
    Stop-Service -Name wuauserv -ErrorAction SilentlyContinue
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    Write-Host "Arquivos de atualiza√ß√£o do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 9: Limpar Arquivos Prefetch
    Write-Host "Limpando arquivos prefetch para melhorar a inicializa√ß√£o..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Prefetch\*.pf" -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos prefetch limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 10: Executar Limpeza de Disco Integrada do Windows
    Write-Host "Executando a ferramenta de limpeza de disco integrada do Windows..." -ForegroundColor Yellow
    Start-Process -FilePath cleanmgr.exe -ArgumentList "/sagerun:1" -Wait -ErrorAction SilentlyContinue
    Write-Host "Limpeza de disco conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "Vamos ver quanto espa√ßo conseguimos recuperar com essa faxina:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nPronto! A faxina geral b√°sica foi feita! Seu PC agradece o espa√ßo extra! ;)" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu
    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleMemoryStartup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Mem√≥ria e Inicializa√ß√£o R√°pida: Deixa o PC ligando num piscar! ---" -ForegroundColor Yellow
    Write-Host "Aqui a gente d√° uma olhada na mem√≥ria RAM e nos programas que ligam junto com o Windows. Menos coisa ligando √† toa = PC mais r√°pido pra usar na hora!" -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Listar Programas de Inicializa√ß√£o
    Write-Host "Listando programas que iniciam com o Windows (pra voc√™ saber o que t√° rodando por baixo dos panos):" -ForegroundColor Yellow
    Get-CimInstance win32_startupcommand | Select-Object Name, command, Location | Format-Table -AutoSize
    Write-Host "Lista de programas de inicializa√ß√£o exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Servi√ßo SuperFetch/SysMain
    Write-Host "Otimizando o servi√ßo SuperFetch/SysMain para melhorar o desempenho..." -ForegroundColor Yellow
    $confirmSysMain = Read-Host "Deseja desativar o servi√ßo SysMain/SuperFetch? (s/n) - Recomendado para SSDs"
    if ($confirmSysMain -eq 's') {
        Set-Service -Name SysMain -StartupType Disabled -ErrorAction SilentlyContinue
        Stop-Service -Name SysMain -Force -ErrorAction SilentlyContinue
        Write-Host "Servi√ßo SysMain/SuperFetch desativado!" -ForegroundColor Green
    } else {
        Write-Host "Servi√ßo SysMain/SuperFetch mantido ativo." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios de Updates
    Write-Host "Limpando arquivos tempor√°rios de atualiza√ß√µes do Windows (podem ocupar bastante espa√ßo e afetar performance):" -ForegroundColor Yellow
    Dism /online /Cleanup-Image /StartComponentCleanup /ErrorAction SilentlyContinue
    Write-Host "Limpeza de componentes de atualiza√ß√£o iniciada (pode levar um tempo)." -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Mem√≥ria Virtual
    Write-Host "Otimizando configura√ß√µes de mem√≥ria virtual para melhor desempenho..." -ForegroundColor Yellow
    $totalRam = (Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property capacity -Sum).Sum / 1GB
    Write-Host "Seu sistema tem aproximadamente $totalRam GB de RAM." -ForegroundColor White
    
    $confirmPageFile = Read-Host "Deseja otimizar o arquivo de pagina√ß√£o (mem√≥ria virtual)? (s/n)"
    if ($confirmPageFile -eq 's') {
        # Calcula tamanho recomendado (1.5x a RAM para sistemas com menos de 8GB, 1x para sistemas com mais)
        $pageFileSize = if ($totalRam -lt 8) { [math]::Round($totalRam * 1.5) * 1024 } else { [math]::Round($totalRam) * 1024 }
        
        Write-Host "Configurando arquivo de pagina√ß√£o para tamanho fixo de $pageFileSize MB..." -ForegroundColor DarkGray
        $computerSystem = Get-WmiObject -Class Win32_ComputerSystem
        $computerSystem.AutomaticManagedPagefile = $false
        $computerSystem.Put() | Out-Null
        
        $pageFileSetting = Get-WmiObject -Class Win32_PageFileSetting
        if ($pageFileSetting) {
            $pageFileSetting.InitialSize = $pageFileSize
            $pageFileSetting.MaximumSize = $pageFileSize
            $pageFileSetting.Put() | Out-Null
        }
        Write-Host "Arquivo de pagina√ß√£o otimizado! (Requer reinicializa√ß√£o para aplicar totalmente)" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes de mem√≥ria virtual mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Listar os 10 Processos que mais usam mem√≥ria no momento
    Write-Host "Listando os 10 processos que mais consomem mem√≥ria agora:" -ForegroundColor Yellow
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host "Lista de processos exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Otimizar Inicializa√ß√£o do Windows
    Write-Host "Otimizando a inicializa√ß√£o do Windows..." -ForegroundColor Yellow
    # Desabilitar servi√ßos n√£o essenciais que podem atrasar a inicializa√ß√£o
    $startupServices = @(
        @{Name="DiagTrack"; DisplayName="Experi√™ncias do Usu√°rio Conectado e Telemetria"},
        @{Name="dmwappushservice"; DisplayName="Servi√ßo de Transfer√™ncia Inteligente em Segundo Plano (BITS)"},
        @{Name="MapsBroker"; DisplayName="Servi√ßo de Dados de Mapas"}
    )
    
    foreach ($service in $startupServices) {
        $confirmService = Read-Host "Deseja desativar o servi√ßo '$($service.DisplayName)' na inicializa√ß√£o? (s/n)"
        if ($confirmService -eq 's') {
            Set-Service -Name $service.Name -StartupType Disabled -ErrorAction SilentlyContinue
            Stop-Service -Name $service.Name -Force -ErrorAction SilentlyContinue
            Write-Host "Servi√ßo '$($service.DisplayName)' desativado!" -ForegroundColor Green
        } else {
            Write-Host "Servi√ßo '$($service.DisplayName)' mantido." -ForegroundColor Green
        }
    }
    Write-Host ""

    # Comando 7: Reiniciar o Computador (√ötil pra liberar mem√≥ria e aplicar mudan√ßas)
    Write-Host "Quer dar um 'refresh' geral no PC? Reiniciar pode ajudar!" -ForegroundColor Yellow
    $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (digite 'sim' para confirmar)"
    if ($confirmRestart -eq 'sim') {
        Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
        Restart-Computer -Force
    } else {
        Write-Host "Rein√≠cio cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o de mem√≥ria e inicializa√ß√£o!" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu (a n√£o ser que o PC tenha reiniciado)
    if ($confirmRestart -ne 'sim') {
        Write-Host ""
        Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
    }
}

function Invoke-SimpleInternetOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Acelerar a Conex√£o com a Internet (Simplificado): Diz adeus pro 'carregando...'! ---" -ForegroundColor Cyan
    Write-Host "Vamos fazer uns ajustes r√°pidos na sua conex√£o pra tentar deixar ela mais esperta." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Limpar Cache de DNS
    Write-Host "Limpando o cache de endere√ßos de internet (DNS) pra resolver nomes mais r√°pido!" -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Configura√ß√µes TCP/IP
    Write-Host "Otimizando configura√ß√µes TCP/IP para melhorar a velocidade de conex√£o..." -ForegroundColor Yellow
    
    # Habilitar TCP Window Auto-Tuning
    netsh int tcp set global autotuninglevel=normal
    Write-Host "TCP Auto-Tuning configurado para 'normal'." -ForegroundColor DarkGray
    
    # Otimizar par√¢metros de recebimento de pacotes
    netsh int tcp set global rss=enabled
    Write-Host "Receive-Side Scaling (RSS) habilitado." -ForegroundColor DarkGray
    
    # Otimizar congestion provider
    netsh int tcp set global congestionprovider=ctcp
    Write-Host "Congestion Provider configurado para 'ctcp'." -ForegroundColor DarkGray
    
    # Otimizar ECN capability
    netsh int tcp set global ecncapability=enabled
    Write-Host "ECN Capability habilitado." -ForegroundColor DarkGray
    
    Write-Host "Configura√ß√µes TCP/IP otimizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Reiniciar Adaptadores de Rede
    Write-Host "Dando um 'reset' r√°pido nas suas conex√µes de rede. Pode resolver uns pepinos!" -ForegroundColor Yellow
    $confirmResetAdapter = Read-Host "Isso vai desconectar brevemente sua internet. Continuar? (s/n)"
    if ($confirmResetAdapter -eq 's') {
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        Write-Host "Adaptadores de rede reiniciados." -ForegroundColor Green
    } else {
        Write-Host "Reset de adaptadores cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 4: Configurar DNS R√°pido
    Write-Host "Configurar DNS mais r√°pido pode melhorar sua navega√ß√£o!" -ForegroundColor Yellow
    $confirmDns = Read-Host "Deseja configurar DNS mais r√°pidos (Google ou Cloudflare)? (s/n)"
    if ($confirmDns -eq 's') {
        Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
        Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
        $dnsChoice = Read-Host "Escolha uma op√ß√£o (1 ou 2)"
        
        $primaryDns = ""
        $secondaryDns = ""
        
        if ($dnsChoice -eq '1') {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            Write-Host "Google DNS selecionado." -ForegroundColor DarkGray
        } elseif ($dnsChoice -eq '2') {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            Write-Host "Cloudflare DNS selecionado." -ForegroundColor DarkGray
        } else {
            Write-Host "Op√ß√£o inv√°lida. DNS n√£o alterado." -ForegroundColor Red
        }
        
        if ($primaryDns -ne "") {
            $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" -and ($_.InterfaceDescription -match "Ethernet" -or $_.InterfaceDescription -match "Wi-Fi" -or $_.InterfaceDescription -match "Wireless") }
            
            foreach ($adapter in $networkAdapters) {
                Write-Host "Configurando DNS para adaptador: $($adapter.Name)" -ForegroundColor DarkGray
                Set-DnsClientServerAddress -InterfaceIndex $adapter.ifIndex -ServerAddresses ($primaryDns, $secondaryDns)
            }
            
            Write-Host "DNS configurado! Sua navega√ß√£o deve ficar mais r√°pida agora." -ForegroundColor Green
        }
    } else {
        Write-Host "Configura√ß√£o de DNS mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Mostrar Status B√°sico da Conex√£o
    Write-Host "Mostrando um resumo b√°sico da sua configura√ß√£o de rede atual:" -ForegroundColor Yellow
    ipconfig /all | Select-String -Pattern "IPv4", "DNS", "Gateway", "DHCP", "Subnet", "Physical Address"
    Write-Host "Status b√°sico da rede exibido." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Testar a conex√£o com a internet
    Write-Host "Testando a conex√£o com a internet (ping para google.com)..." -ForegroundColor Yellow
    Test-Connection -Count 4 google.com -ErrorAction SilentlyContinue
    Write-Host "Teste de conex√£o finalizado." -ForegroundColor Green
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o b√°sica de internet!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleVisualOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Deixar o Windows mais Leve Visualmente (Simplificado): Desempenho antes da beleza! ---" -ForegroundColor White
    Write-Host "Ajustes r√°pidos pra desativar efeitos visuais que podem pesar, liberando recursos pro que importa." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ajustar Efeitos Visuais
    Write-Host "Voc√™ quer desativar ou ativar as anima√ß√µes e efeitos visuais do Windows?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Efeitos Visuais (Pra ganhar desempenho)" -ForegroundColor Green
    Write-Host "[2] Configurar para Melhor Apar√™ncia (Mais bonito, mas mais pesado)" -ForegroundColor White
    Write-Host "[3] Deixar o Windows Escolher (Configura√ß√£o padr√£o)" -ForegroundColor Cyan
    $choiceVisual = Read-Host "Escolha [1], [2] ou [3]"

    if ($choiceVisual -eq '1') {
        Write-Host "Desativando efeitos visuais para melhor desempenho..." -ForegroundColor Yellow
        # Valor 2 = Ajustar para melhor desempenho (desativa a maioria dos efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 2 -Type DWord -Force -ErrorAction SilentlyContinue
        
        # Desativar anima√ß√µes individuais
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop' -Name 'UserPreferencesMask' -Value ([byte[]](0x90, 0x12, 0x01, 0x80)) -Type Binary -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop\WindowMetrics' -Name 'MinAnimate' -Value 0 -Type String -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'ListviewAlphaSelect' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'TaskbarAnimations' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        
        Write-Host "Efeitos visuais desativados para melhor desempenho!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '2') {
        Write-Host "Configurando para melhor apar√™ncia (todos os efeitos visuais ativados)..." -ForegroundColor Yellow
        # Valor 1 = Ajustar para melhor apar√™ncia (ativa todos os efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Efeitos visuais configurados para melhor apar√™ncia!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '3') {
        Write-Host "Deixando o Windows escolher automaticamente (configura√ß√£o padr√£o)..." -ForegroundColor Yellow
        # Valor 0 = Deixar o Windows escolher
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Configura√ß√£o visual definida para padr√£o do Windows!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa nos efeitos visuais foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 2: Ativar/Desativar Efeitos de Transpar√™ncia
    Write-Host "E os efeitos de transpar√™ncia do Windows (tipo na barra de tarefas)?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Transpar√™ncia (Mais leve)" -ForegroundColor Green
    Write-Host "[2] Ativar Transpar√™ncia (Mais 'bonito')" -ForegroundColor White
    $choiceTransp = Read-Host "Escolha [1] ou [2]"

    if ($choiceTransp -eq '1') {
        Write-Host "Desativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 0 = Desativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia desativada!" -ForegroundColor Green
    } elseif ($choiceTransp -eq '2') {
        Write-Host "Ativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 1 = Ativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia ativada!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa na transpar√™ncia foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 3: Configurar Tema Claro/Escuro
    Write-Host "Voc√™ prefere tema claro ou escuro? O tema escuro pode ser mais confort√°vel para os olhos." -ForegroundColor Yellow
    Write-Host "[1] Tema Escuro (Dark Mode)" -ForegroundColor DarkGray
    Write-Host "[2] Tema Claro (Light Mode)" -ForegroundColor White
    $choiceTheme = Read-Host "Escolha [1] ou [2]"

    if ($choiceTheme -eq '1') {
        Write-Host "Configurando tema escuro..." -ForegroundColor Yellow
        # Valor 0 = Tema Escuro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema escuro configurado!" -ForegroundColor Green
    } elseif ($choiceTheme -eq '2') {
        Write-Host "Configurando tema claro..." -ForegroundColor Yellow
        # Valor 1 = Tema Claro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema claro configurado!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa no tema foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Configurar Resolu√ß√£o de Tela
    Write-Host "Deseja ajustar a resolu√ß√£o da tela? Resolu√ß√µes menores podem melhorar o desempenho em PCs mais antigos." -ForegroundColor Yellow
    $confirmResolution = Read-Host "Deseja ver e ajustar a resolu√ß√£o da tela? (s/n)"
    
    if ($confirmResolution -eq 's') {
        # Mostrar resolu√ß√£o atual
        $currentResolution = Get-WmiObject -Class Win32_VideoController | Select-Object -ExpandProperty VideoModeDescription
        Write-Host "Resolu√ß√£o atual: $currentResolution" -ForegroundColor White
        
        # Abrir configura√ß√µes de exibi√ß√£o do Windows
        Write-Host "Abrindo configura√ß√µes de exibi√ß√£o do Windows..." -ForegroundColor DarkGray
        Start-Process "ms-settings:display"
        Write-Host "Ajuste a resolu√ß√£o conforme necess√°rio na janela de configura√ß√µes que foi aberta." -ForegroundColor Green
        
        $waitForSettings = Read-Host "Pressione Enter quando terminar de ajustar as configura√ß√µes de exibi√ß√£o"
    } else {
        Write-Host "Configura√ß√£o de resolu√ß√£o mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizados os ajustes visuais b√°sicos!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleGamingOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Jogos (Simplificado): Mais FPS, menos lag! ---" -ForegroundColor Magenta
    Write-Host "Vamos fazer alguns ajustes para melhorar o desempenho dos seus jogos sem complica√ß√µes." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ativar Modo de Jogo do Windows
    Write-Host "Ativando o Modo de Jogo do Windows para priorizar recursos para jogos..." -ForegroundColor Yellow
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AllowAutoGameMode" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AutoGameModeEnabled" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Write-Host "Modo de Jogo do Windows ativado!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Desativar Game DVR e Game Bar
    Write-Host "O Game DVR e Game Bar podem reduzir o desempenho em jogos. Deseja desativ√°-los?" -ForegroundColor Yellow
    $confirmGameDVR = Read-Host "Desativar Game DVR e Game Bar? (s/n)"
    
    if ($confirmGameDVR -eq 's') {
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "UseNexusForGameBarEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\System\GameConfigStore" -Name "GameDVR_Enabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR" -Name "AppCaptureEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Write-Host "Game DVR e Game Bar desativados!" -ForegroundColor Green
    } else {
        Write-Host "Game DVR e Game Bar mantidos ativos." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Otimizar Plano de Energia para Jogos
    Write-Host "Configurando plano de energia para alto desempenho (ideal para jogos)..." -ForegroundColor Yellow
    powercfg.exe /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c
    Write-Host "Plano de energia configurado para alto desempenho!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Configura√ß√µes de Mouse
    Write-Host "Otimizando configura√ß√µes de mouse para jogos (precis√£o do ponteiro)..." -ForegroundColor Yellow
    $confirmMouseFix = Read-Host "Desativar a acelera√ß√£o do mouse para melhor precis√£o em jogos? (s/n)"
    
    if ($confirmMouseFix -eq 's') {
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseSpeed" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold1" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold2" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Write-Host "Acelera√ß√£o do mouse desativada para melhor precis√£o em jogos!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do mouse mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Otimizar Prioridade de CPU para Jogos
    Write-Host "Configurando prioridade de CPU para jogos..." -ForegroundColor Yellow
    Write-Host "Esta configura√ß√£o ajusta o sistema para dar mais prioridade aos jogos." -ForegroundColor DarkGray
    
    # Criar chave de registro para prioridade de jogos
    if (-not (Test-Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games")) {
        New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Force | Out-Null
    }
    
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "GPU Priority" -Type DWord -Value 8 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Priority" -Type DWord -Value 6 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Scheduling Category" -Type String -Value "High" -Force -ErrorAction SilentlyContinue
    
    Write-Host "Prioridade de CPU para jogos otimizada!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Verificar Driver de Placa de V√≠deo
    Write-Host "Verificando informa√ß√µes da placa de v√≠deo..." -ForegroundColor Yellow
    $gpuInfo = Get-WmiObject -Class Win32_VideoController | Select-Object Name, DriverVersion, CurrentHorizontalResolution, CurrentVerticalResolution
    
    foreach ($gpu in $gpuInfo) {
        Write-Host "Placa de v√≠deo: $($gpu.Name)" -ForegroundColor White
        Write-Host "Vers√£o do driver: $($gpu.DriverVersion)" -ForegroundColor White
        Write-Host "Resolu√ß√£o atual: $($gpu.CurrentHorizontalResolution) x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
      x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
    
    Write-Host "Recomenda√ß√£o: Mantenha seus drivers de v√≠deo atualizados para melhor desempenho em jogos!" -ForegroundColor Green
    Write-Host "Voc√™ pode baixar os drivers mais recentes nos sites oficiais da NVIDIA, AMD ou Intel." -ForegroundColor DarkGray
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nOtimiza√ß√µes para jogos conclu√≠das! Seus jogos devem rodar mais suaves agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleSecurityMaintenance {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Manuten√ß√£o de Seguran√ßa (Simplificado): Mantenha seu PC protegido! ---" -ForegroundColor DarkYellow
    Write-Host "Vamos verificar e melhorar a seguran√ßa do seu sistema com alguns ajustes simples." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Verificar Status do Windows Defender
    Write-Host "Verificando status do Windows Defender..." -ForegroundColor Yellow
    $defenderStatus = Get-MpComputerStatus
    
    Write-Host "Status do Windows Defender:" -ForegroundColor White
    Write-Host "Antiv√≠rus habilitado: $($defenderStatus.AntivirusEnabled)" -ForegroundColor $(if ($defenderStatus.AntivirusEnabled) { "Green" } else { "Red" })
    Write-Host "Prote√ß√£o em tempo real: $($defenderStatus.RealTimeProtectionEnabled)" -ForegroundColor $(if ($defenderStatus.RealTimeProtectionEnabled) { "Green" } else { "Red" })
    Write-Host "Defini√ß√µes de antiv√≠rus: $($defenderStatus.AntivirusSignatureVersion)" -ForegroundColor White
    Write-Host "√öltima atualiza√ß√£o: $($defenderStatus.AntivirusSignatureLastUpdated)" -ForegroundColor White
    Write-Host ""

    # Comando 2: Atualizar Defini√ß√µes do Windows Defender
    Write-Host "Atualizando defini√ß√µes do Windows Defender..." -ForegroundColor Yellow
    Update-MpSignature -ErrorAction SilentlyContinue
    Write-Host "Defini√ß√µes do Windows Defender atualizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Verificar Atualiza√ß√µes do Windows
    Write-Host "Verificando status das atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
            Write-Host "Recomenda√ß√£o: Execute o Windows Update para manter seu sistema seguro." -ForegroundColor Green
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Verificar Configura√ß√µes de Firewall
    Write-Host "Verificando status do Firewall do Windows..." -ForegroundColor Yellow
    $firewallStatus = Get-NetFirewallProfile
    
    foreach ($profile in $firewallStatus) {
        Write-Host "Perfil: $($profile.Name)" -ForegroundColor White
        Write-Host "Status: $($profile.Enabled)" -ForegroundColor $(if ($profile.Enabled) { "Green" } else { "Red" })
        Write-Host ""
    }
    
    $confirmFirewall = Read-Host "Deseja habilitar o Firewall em todos os perfis? (s/n)"
    if ($confirmFirewall -eq 's') {
        Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True
        Write-Host "Firewall habilitado em todos os perfis!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do Firewall mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Verificar Configura√ß√µes de UAC
    Write-Host "Verificando configura√ß√µes do Controle de Conta de Usu√°rio (UAC)..." -ForegroundColor Yellow
    $uacLevel = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -ErrorAction SilentlyContinue
    
    if ($uacLevel) {
        switch ($uacLevel.ConsentPromptBehaviorAdmin) {
            0 { $uacStatus = "Desativado (N√£o recomendado)" }
            1 { $uacStatus = "Baixo (N√£o recomendado)" }
            2 { $uacStatus = "M√©dio" }
            5 { $uacStatus = "Alto (Recomendado)" }
            default { $uacStatus = "Personalizado" }
        }
        
        Write-Host "N√≠vel atual do UAC: $uacStatus" -ForegroundColor $(if ($uacLevel.ConsentPromptBehaviorAdmin -ge 2) { "Green" } else { "Red" })
        
        $confirmUAC = Read-Host "Deseja configurar o UAC para o n√≠vel recomendado? (s/n)"
        if ($confirmUAC -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -Value 5 -Type DWord -Force -ErrorAction SilentlyContinue
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "PromptOnSecureDesktop" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
            Write-Host "UAC configurado para o n√≠vel recomendado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do UAC mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do UAC." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 6: Verificar Configura√ß√µes de SmartScreen
    Write-Host "Verificando configura√ß√µes do Windows SmartScreen..." -ForegroundColor Yellow
    $smartScreen = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -ErrorAction SilentlyContinue
    
    if ($smartScreen) {
        Write-Host "Status do SmartScreen: $($smartScreen.SmartScreenEnabled)" -ForegroundColor $(if ($smartScreen.SmartScreenEnabled -eq "RequireAdmin" -or $smartScreen.SmartScreenEnabled -eq "Warn") { "Green" } else { "Red" })
        
        $confirmSmartScreen = Read-Host "Deseja habilitar o SmartScreen para maior seguran√ßa? (s/n)"
        if ($confirmSmartScreen -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -Value "RequireAdmin" -Type String -Force -ErrorAction SilentlyContinue
            Write-Host "SmartScreen habilitado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do SmartScreen mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do SmartScreen." -ForegroundColor Red
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nManuten√ß√£o de seguran√ßa conclu√≠da! Seu sistema est√° mais protegido agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

# --- Fun√ß√µes para o Diagn√≥stico R√°pido e Sobre ---
function Invoke-QuickDiagnostic {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Diagn√≥stico R√°pido do Sistema ---" -ForegroundColor Yellow
    Write-Host "Vamos fazer uma verifica√ß√£o r√°pida do estado atual do seu PC." -ForegroundColor Gray
    Write-Host ""

    # Informa√ß√µes do Sistema
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    $sysInfo = Get-SystemInfo
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host ""

    # Uso de CPU
    Write-Host "=== Uso de CPU ===" -ForegroundColor Cyan
    $cpuLoad = (Get-WmiObject Win32_Processor).LoadPercentage
    Write-Host "Uso atual de CPU: $cpuLoad%" -ForegroundColor $(if ($cpuLoad -lt 70) { "Green" } elseif ($cpuLoad -lt 90) { "Yellow" } else { "Red" })
    Write-Host ""

    # Uso de Mem√≥ria
    Write-Host "=== Uso de Mem√≥ria ===" -ForegroundColor Cyan
    $os = Get-WmiObject Win32_OperatingSystem
    $totalMemory = [math]::Round($os.TotalVisibleMemorySize / 1MB, 2)
    $freeMemory = [math]::Round($os.FreePhysicalMemory / 1MB, 2)
    $usedMemory = [math]::Round($totalMemory - $freeMemory, 2)
    $memoryPercentage = [math]::Round(($usedMemory / $totalMemory) * 100, 2)
    
    Write-Host "Mem√≥ria Total: $totalMemory GB" -ForegroundColor White
    Write-Host "Mem√≥ria Usada: $usedMemory GB ($memoryPercentage%)" -ForegroundColor $(if ($memoryPercentage -lt 70) { "Green" } elseif ($memoryPercentage -lt 90) { "Yellow" } else { "Red" })
    Write-Host "Mem√≥ria Livre: $freeMemory GB" -ForegroundColor White
    Write-Host ""

    # Espa√ßo em Disco
    Write-Host "=== Espa√ßo em Disco ===" -ForegroundColor Cyan
    $drives = Get-PSDrive -PSProvider FileSystem
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        $percentFree = [math]::Round(($freeSpace / $totalSpace) * 100, 2)
        
        Write-Host "Drive $($drive.Name):" -ForegroundColor White
        Write-Host "  Total: $totalSpace GB" -ForegroundColor White
        Write-Host "  Usado: $usedSpace GB" -ForegroundColor White
        Write-Host "  Livre: $freeSpace GB ($percentFree%)" -ForegroundColor $(if ($percentFree -gt 20) { "Green" } elseif ($percentFree -gt 10) { "Yellow" } else { "Red" })
    }
    Write-Host ""

    # Processos que mais consomem recursos
    Write-Host "=== Top 5 Processos (CPU) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object CPU -Descending | Select-Object -First 5 ProcessName, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}}, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host ""

    Write-Host "=== Top 5 Processos (Mem√≥ria) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 5 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}}, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}} | Format-Table -AutoSize
    Write-Host ""

    # Status de Servi√ßos Cr√≠ticos
    Write-Host "=== Status de Servi√ßos Cr√≠ticos ===" -ForegroundColor Cyan
    $criticalServices = @("wuauserv", "WinDefend", "MpsSvc", "wscsvc")
    foreach ($service in $criticalServices) {
        $serviceStatus = Get-Service -Name $service -ErrorAction SilentlyContinue
        if ($serviceStatus) {
            Write-Host "$($serviceStatus.DisplayName): $($serviceStatus.Status)" -ForegroundColor $(if ($serviceStatus.Status -eq "Running") { "Green" } else { "Red" })
        }
    }
    Write-Host ""

    # Verificar Atualiza√ß√µes Pendentes
    Write-Host "=== Atualiza√ß√µes do Windows ===" -ForegroundColor Cyan
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Recomenda√ß√µes
    Write-Host "=== Recomenda√ß√µes ===" -ForegroundColor Cyan
    
    # Recomenda√ß√£o de Mem√≥ria
    if ($memoryPercentage -gt 80) {
        Write-Host "- Seu uso de mem√≥ria est√° alto. Considere fechar alguns programas ou usar a op√ß√£o 'Otimiza√ß√£o de Mem√≥ria'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Disco
    $lowDiskSpace = $false
    foreach ($drive in $drives) {
        $percentFree = [math]::Round(($drive.Free / ($drive.Free + $drive.Used)) * 100, 2)
        if ($percentFree -lt 15) {
            $lowDiskSpace = $true
            break
        }
    }
    
    if ($lowDiskSpace) {
        Write-Host "- Espa√ßo em disco baixo detectado. Considere usar a op√ß√£o 'Limpeza Geral do Sistema'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Atualiza√ß√µes
    if ($pendingUpdates -gt 0) {
        Write-Host "- Existem atualiza√ß√µes pendentes. Recomendamos atualizar seu sistema para maior seguran√ßa." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Inicializa√ß√£o
    $bootTime = $sysInfo.LastBootTime
    $uptime = (Get-Date) - $bootTime
    if ($uptime.Days -gt 7) {
        Write-Host "- Seu sistema est√° ligado h√° $($uptime.Days) dias. Considere reiniciar para aplicar atualiza√ß√µes e limpar a mem√≥ria." -ForegroundColor Yellow
    }
    
    Write-Host ""

    # Mensagem de conclus√£o
    Write-Host "`nDiagn√≥stico r√°pido conclu√≠do! Use as informa√ß√µes acima para decidir quais otimiza√ß√µes fazer." -ForegroundColor Green

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

function Show-AboutTORK {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Sobre o TORK ---" -ForegroundColor White
    Write-Host ""
    
    Write-Host "TORK - Otimizador para Windows" -ForegroundColor Cyan
    Write-Host "Vers√£o: 2.0" -ForegroundColor White
    Write-Host "Desenvolvido por: Partner77" -ForegroundColor White
    Write-Host ""
    
    Write-Host "=== Descri√ß√£o ===" -ForegroundColor Yellow
    Write-Host "O TORK √© uma ferramenta abrangente de otimiza√ß√£o para Windows, projetada para" -ForegroundColor Gray
    Write-Host "melhorar o desempenho do seu sistema atrav√©s de limpeza, ajustes e otimiza√ß√µes." -ForegroundColor Gray
    Write-Host "Ele oferece op√ß√µes simplificadas para usu√°rios comuns e op√ß√µes avan√ßadas para" -ForegroundColor Gray
    Write-Host "usu√°rios experientes que desejam um controle mais detalhado sobre o sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Recursos ===" -ForegroundColor Yellow
    Write-Host "- Limpeza completa do sistema" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√£o de mem√≥ria e inicializa√ß√£o" -ForegroundColor Gray
    Write-Host "- Ajustes de rede para melhor conectividade" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√µes visuais para melhor desempenho" -ForegroundColor Gray
    Write-Host "- Configura√ß√µes espec√≠ficas para jogos" -ForegroundColor Gray
    Write-Host "- Manuten√ß√£o de seguran√ßa" -ForegroundColor Gray
    Write-Host "- Diagn√≥stico r√°pido do sistema" -ForegroundColor Gray
    Write-Host "- Mais de 100 ajustes e otimiza√ß√µes avan√ßadas" -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Aviso Legal ===" -ForegroundColor Yellow
    Write-Host "Este software √© fornecido 'como est√°', sem garantias de qualquer tipo." -ForegroundColor Gray
    Write-Host "O autor n√£o se responsabiliza por quaisquer danos ou problemas causados pelo uso" -ForegroundColor Gray
    Write-Host "deste software. Use por sua conta e risco. Recomendamos sempre fazer backup" -ForegroundColor Gray
    Write-Host "dos seus dados importantes antes de realizar otimiza√ß√µes no sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Agradecimentos ===" -ForegroundColor Yellow
    Write-Host "Obrigado por escolher o TORK para otimizar seu sistema Windows!" -ForegroundColor Gray
    Write-Host "Esperamos que esta ferramenta ajude a melhorar o desempenho do seu PC." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "¬© 2023-2024 Partner77 - Todos os direitos reservados" -ForegroundColor Cyan
    Write-Host ""
    
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - LIMPEZA (Expandidas) ---
function Invoke-CleanUserTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Usu√°rio ---" -ForegroundColor Cyan
    Write-Host "Remove arquivos da pasta tempor√°ria do seu usu√°rio (`$env:TEMP`)." -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:TEMP..." -ForegroundColor Yellow
    $tempFiles = Get-ChildItem -Path $env:TEMP -Recurse -ErrorAction SilentlyContinue
    $tempFilesCount = ($tempFiles | Measure-Object).Count
    $tempFilesSize = ($tempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $tempFilesCount arquivos tempor√°rios ocupando aproximadamente $([math]::Round($tempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Sistema ---" -ForegroundColor Gray
    Write-Host "Remove arquivos da pasta tempor√°ria do Windows (`$env:SystemRoot\Temp`)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:SystemRoot\Temp..." -ForegroundColor Yellow
    $systemTempFiles = Get-ChildItem -Path "$env:SystemRoot\Temp" -Recurse -ErrorAction SilentlyContinue
    $systemTempFilesCount = ($systemTempFiles | Measure-Object).Count
    $systemTempFilesSize = ($systemTempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $systemTempFilesCount arquivos tempor√°rios do sistema ocupando aproximadamente $([math]::Round($systemTempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do sistema removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanDnsCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-EmptyRecycleBin {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Esvaziar Lixeira ---" -ForegroundColor Gray
    Write-Host "Esvazia a lixeira do usu√°rio logado." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar tamanho da lixeira antes de esvaziar
    Write-Host "Verificando tamanho da lixeira..." -ForegroundColor Yellow
    
    try {
        $shell = New-Object -ComObject Shell.Application
        $recycleBin = $shell.Namespace(0xA)
        $recycleBinItems = $recycleBin.Items()
        $recycleBinItemCount = $recycleBinItems.Count
        
        Write-Host "A lixeira cont√©m $recycleBinItemCount itens." -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o conte√∫do da lixeira." -ForegroundColor DarkGray
    }
    
    # Esvaziar a lixeira
    Write-Host "Executando: Esvaziando a lixeira..." -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanThumbnailCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Miniaturas ---" -ForegroundColor Green
    Write-Host "Remove o cache de miniaturas de arquivos (imagens, v√≠deos, etc.)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Limpando cache de miniaturas..." -ForegroundColor Yellow
    
    # Verificar tamanho do cache de miniaturas antes da limpeza
    $thumbnailPath = "$env:LOCALAPPDATA\Microsoft\Windows\Explorer"
    $thumbnailFiles = Get-ChildItem -Path $thumbnailPath -Filter "thumbcache_*.db" -ErrorAction SilentlyContinue
    $thumbnailFilesCount = ($thumbnailFiles | Measure-Object).Count
    $thumbnailFilesSize = ($thumbnailFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $thumbnailFilesCount arquivos de cache de miniaturas ocupando aproximadamente $([math]::Round($thumbnailFilesSize, 2)) MB." -ForegroundColor White
    
    # Limpar o cache de miniaturas
    Stop-Process -Name explorer -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Start-Process explorer
    
    Write-Host "Cache de miniaturas limpo com sucesso!" -ForegroundColor Green
    Write-Host "O Windows Explorer foi reiniciado para aplicar as altera√ß√µes." -ForegroundColor DarkGray
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de miniaturas:" -ForegroundColor Cyan
    Write-Host "- Navega√ß√£o mais r√°pida em pastas com muitas imagens ou v√≠deos" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de miniaturas corrompidas ou desatualizadas" -ForegroundColor DarkGray
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemLogs {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Logs do Sistema ---" -ForegroundColor Cyan
    Write-Host "Limpa os logs de eventos do sistema para liberar espa√ßo e melhorar o desempenho." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando logs do sistema..." -ForegroundColor Yellow
    
    # Verificar tamanho dos logs antes da limpeza
    $eventLogs = Get-WinEvent -ListLog * -ErrorAction SilentlyContinue | Where-Object { $_.RecordCount -gt 0 }
    $totalLogCount = ($eventLogs | Measure-Object).Count
    $total### Enhanced TORK Optimizer

I'll enhance the TORK optimizer with more comprehensive functionality across all features, starting with an expanded Simple Cleanup function and then improving all other options.

```powershell type="code"
# Define a preferencia de acao para erros (continua a execucao por padrao)
# Permite que o script tente rodar o m√°ximo poss√≠vel mesmo que alguns comandos encontrem problemas.
$ErrorActionPreference = 'SilentlyContinue' # N√£o exibe erros se um item n√£o puder ser processado, por exemplo.

# --- Funcao pra Centralizar Texto (Nosso Maestro de Alinhamento - s√≥ pra textos, n√£o pro bannerz√£o!) ---
# Deixa ela aqui, vai que a gente usa pra centralizar outra coisa, n√©?
function Centraliza($texto, $cor="White") {
    $largura = [console]::WindowWidth # Pega a largura da largura da janela agora
    # Calcula o espa√ßo pra botar o texto no meio. Pura matem√°tica da zoeira!
    $espacos = [Math]::Max(0, [Math]::Floor(($largura - $texto.Length) / 2))
    $linha = (" " * $espacos) + $texto # Cria a linha com os espa√ßos e o texto
    Write-Host $linha -ForegroundColor $cor # Manda pro console com a cor pedida
}

# --- Funcao que Desenha o Nosso Banner Irado do TORK! ---
# Esse √© o nosso outdoor digital no console! Ajustado pros espa√ßos que voc√™ mandou!
# Se as bordas ainda estiverem meio teimosas, √© o jeitinho do console mesmo, viu? üòâ
function Banner-TORK {
    # Nossas cores vibrantes para o banner!
    $CorBorda = "DarkCyan" # Mantido para a borda, combina com o ciano. Se quiser mudar, √© aqui!
    $CorLogo = "Green" # Cor vibrante
    $CorProjeto = "Cyan" # Cor vibrante
    $CorCopyright = "Gray" # Tom mais suave

    Write-Host "" # D√° um espacinho no topo, pra n√£o grudar
    Write-Host "                    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë          ‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë ‚ñà‚ñà‚ïî‚ïù                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ñà‚ñà‚ïó                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù                                          ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë           Bem-vindo ao TORK - Otimizador para Windows!                                ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë        Projeto de automacao, limpeza, manutencao e tweaks.                            ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë            (C) Partner77 - Todos os direitos reservados                               ‚ïë" -ForegroundColor $CorCopyright
    Write-Host "                    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor $CorBorda
    Write-Host "" # Espa√ßo embaixo
}

# --- Checagem de Permiss√µes de Administrador (O Guarda da Porta!) ---
# V√™ se a gente t√° rodando com poderes de admin, sen√£o n√£o d√° pra mexer no Windows direito.
function Test-Administrator {
    $currentUser = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())
    return $currentUser.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
}

if (-not (Test-Administrator)) {
    Write-Host "OPA! Calma l√°, patr√£o!" -ForegroundColor Red
    Write-Host "Pra usar o TORK e deixar o PC voando, preciso de super poderes de Administrador!" -ForegroundColor Yellow
    Write-Host "Fecha essa janela, clica com o bot√£o direito no arquivo do script e escolhe 'Executar como administrador'. A√≠ sim, tamo junto!" -ForegroundColor Yellow
    Read-Host "D√° um Enter quando terminar de ler, que a gente se v√™ na pr√≥xima..."
    Exit
}

Write-Host "Poderes de Administrador verificados! Bora nessa!" -ForegroundColor Green
Start-Sleep -Seconds 1

# --- Fun√ß√µes Utilit√°rias (Ferramentas que usamos em v√°rios lugares) ---
function Get-SystemInfo {
    $os = Get-CimInstance Win32_OperatingSystem
    $cs = Get-CimInstance Win32_ComputerSystem
    $proc = Get-CimInstance Win32_Processor
    $mem = Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property Capacity -Sum
    
    $info = @{
        "OSName" = $os.Caption
        "OSVersion" = $os.Version
        "OSBuild" = $os.BuildNumber
        "ComputerName" = $cs.Name
        "Manufacturer" = $cs.Manufacturer
        "Model" = $cs.Model
        "Processor" = $proc.Name
        "Memory" = [math]::Round($mem.Sum / 1GB, 2)
        "Architecture" = $os.OSArchitecture
        "InstallDate" = $os.InstallDate
        "LastBootTime" = $os.LastBootUpTime
    }
    
    return $info
}

function Show-SystemSummary {
    $sysInfo = Get-SystemInfo
    
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Computador: $($sysInfo.ComputerName)" -ForegroundColor White
    Write-Host "Fabricante: $($sysInfo.Manufacturer)" -ForegroundColor White
    Write-Host "Modelo: $($sysInfo.Model)" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "Instalado em: $($sysInfo.InstallDate)" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

function Get-DiskSpaceBefore {
    $drives = Get-PSDrive -PSProvider FileSystem
    $driveInfo = @{}
    
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        
        $driveInfo[$drive.Name] = @{
            "Free" = $freeSpace
            "Used" = $usedSpace
            "Total" = $totalSpace
        }
    }
    
    return $driveInfo
}

function Show-DiskSpaceComparison {
    param (
        $before
    )
    
    $after = Get-PSDrive -PSProvider FileSystem
    
    Write-Host "=== Compara√ß√£o de Espa√ßo em Disco ===" -ForegroundColor Cyan
    
    foreach ($drive in $after) {
        if ($before.ContainsKey($drive.Name)) {
            $freeSpaceAfter = [math]::Round($drive.Free / 1GB, 2)
            $freeSpaceBefore = $before[$drive.Name].Free
            $spaceRecovered = [math]::Round($freeSpaceAfter - $freeSpaceBefore, 2)
            
            Write-Host "Drive $($drive.Name):" -ForegroundColor White
            Write-Host "  Espa√ßo livre antes: $freeSpaceBefore GB" -ForegroundColor Gray
            Write-Host "  Espa√ßo livre agora: $freeSpaceAfter GB" -ForegroundColor Gray
            
            if ($spaceRecovered -gt 0) {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Green
            } else {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Yellow
            }
            Write-Host ""
        }
    }
    
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

# --- Fun√ß√µes dos Menus (Principal, Simplificado, Avan√ßado e Sub-menus) ---

# --- Menu Principal (A Bifurca√ß√£o do Destino! Simplificado vs Avan√ßado) ---
# √â aqui que o usu√°rio escolhe se quer ser um mago ou um cara pr√°tico!
function Show-MainMenu {
    do {
        Clear-Host # Limpa a tela pra organizar o menu
        Banner-TORK # Banner no topo, pra gente n√£o esquecer quem somos!
        Show-SystemSummary # Mostra um resumo do sistema

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "       MENU PRINCIPAL" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # As duas grandes estradas da otimiza√ß√£o! Cores variadas (repetindo)!
        Write-Host "[1] Otimiza√ß√£o Simplificada (Pra quem quer praticidade e resultado r√°pido!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o Avan√ßada (Pra quem curte mexer fundo e ter control total!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[3] Diagn√≥stico R√°pido do Sistema (Ver o que t√° rolando no PC)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[4] Sobre o TORK (Informa√ß√µes e cr√©ditos)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[0] Sair (Ah, que pena... Mas a porta t√° aberta!)" -ForegroundColor Red # Vermelho pra Sair - Ok

        Write-Host ""

        # Pergunta pro usu√°rio qual caminho ele escolhe, tipo Mestre Pok√©mon!
        $choice = Read-Host "Escolhe sua op√ß√£o, treinador!"

        # V√™ pra onde a gente vai com base na escolha
        switch ($choice) {
            "1" { Show-SimplifiedMenu } # Se escolheu 1, vai pro Menu Simplificado!
            "2" { Show-AdvancedMenu } # Se escolheu 2, vai pro Menu Avan√ßado!
            "3" { Invoke-QuickDiagnostic } # Nova fun√ß√£o de diagn√≥stico r√°pido
            "4" { Show-AboutTORK } # Nova fun√ß√£o de sobre
            "0" { Write-Host "Fechou! Valeu por usar o TORK! Volte sempre que seu PC pedir um g√°s! ;)" -ForegroundColor Green; Start-Sleep -Seconds 2; break } # Se escolheu 0, vaza (mas volta!)
            default {
                Write-Host "Eita! Op√ß√£o inv√°lida! Confere os n√∫meros e tenta de novo, bora l√°!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1 # D√° um tempinho pro usu√°rio ver a zoeira da mensagem
            }
        }
    } while ($choice -ne '0') # Repete o Menu Principal enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Simplificado (Aqui o TORK faz m√°gica r√°pida e segura!) ---
# Acessado pela op√ß√£o 1 do Menu Principal. Menos op√ß√µes, mais a√ß√£o direta!
function Show-SimplifiedMenu {
    do {
        Clear-Host # Limpa o palco pra esse menu!
        Banner-TORK # Nosso banner no topo, sempre presente!

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "   OTIMIZACAO SIMPLIFICADA" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes SIMPLIFICADAS - cada uma pode fazer um monte de coisa por baixo dos panos! Cores variadas (repetindo as prim√°rias/neon e adicionando outras)!
        Write-Host "[1] Limpeza Geral do Sistema (Tira o lixo que t√° pesando!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o de Mem√≥ria e Programas que Ligam com o Windows (Deixa tudo mais √°gil!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[3] Acelerar a Conex√£o com a Internet (Pra navegar sem gargalo!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[4] Deixar o Windows mais Leve Visualmente (Desativa uns efeitos pra ganhar desempenho!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Otimiza√ß√£o de Jogos (Configura√ß√µes pra melhorar FPS e desempenho)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[6] Manuten√ß√£o de Seguran√ßa (Verificar e corrigir problemas de seguran√ßa)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[7] RODAR TODAS as otimiza√ß√µes SIMPLIFICADAS! (Modo Turbo F√°cil!)" -ForegroundColor Red # Vermelho pra "Faz Tudo" - Destaque/Cuidado
        Write-Host "[0] Voltar ao Menu Principal (A gente te espera aqui!)" -ForegroundColor Gray # Cor neutra pra voltar

        Write-Host ""

        # Pergunta qual m√°gica simplificada o usu√°rio quer
        $choice = Read-Host "Escolhe sua m√°gica simplificada!"

        # V√™ qual m√°gica rodar
        switch ($choice) {
            "1" { Invoke-SimpleSystemCleanup } # Chama a fun√ß√£o de limpeza b√°sica
            "2" { Invoke-SimpleMemoryStartup } # Chama a fun√ß√£o pra mem√≥ria/inicializa√ß√£o
            "3" { Invoke-SimpleInternetOpt } # Chama a fun√ß√£o pra internet
            "4" { Invoke-SimpleVisualOpt } # Chama a fun√ß√£o pra visual
            "5" { Invoke-SimpleGamingOpt } # Nova fun√ß√£o para otimiza√ß√£o de jogos
            "6" { Invoke-SimpleSecurityMaintenance } # Nova fun√ß√£o para manuten√ß√£o de seguran√ßa
            "7" {
                # Rodar todas as simplificadas sequencialmente
                Write-Host "`nModo Turbo F√°cil ATIVADO! Rodando todas as otimiza√ß√µes SIMPLIFICADAS... segura pe√£o!`n" -ForegroundColor Yellow
                Invoke-SimpleSystemCleanup # Roda a 1
                Invoke-SimpleMemoryStartup # Roda a 2
                Invoke-SimpleInternetOpt # Roda a 3
                Invoke-SimpleVisualOpt # Roda a 4
                Invoke-SimpleGamingOpt # Roda a 5
                Invoke-SimpleSecurityMaintenance # Roda a 6
                Write-Host "`nShow! Todas as otimiza√ß√µes SIMPLIFICADAS foram executadas! PC t√° agradecendo! ;)`n" -ForegroundColor Green
                Read-Host "Aperta Enter pra voltar pro Menu Simplificado..." # Pausa no final do "Rodar Todas"
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-MainMenu
            default {
                Write-Host "Ops! Op√ß√£o inv√°lida no Menu Simplificado! Confere os n√∫meros e manda bala de novo!" -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Simplificado enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Avan√ßado (O Playground dos Magos do PC!) ---
# Acessado pela op√ß√£o 2 do Menu Principal. Aqui a gente mergulha fundo!
function Show-AdvancedMenu {
    do {
        Clear-Host # Limpa o palco pro menu avan√ßado!
        Banner-TORK # Nosso banner no topo, pra n√£o perder a pose!

        Write-Host "" # Espacinho maroto
        Write-Host "===============================" -ForegroundColor White
        Write-Host "      MENU AVANCADO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes do menu avan√ßado (as CATEGORIAS dos 200 poderes!) Cores variadas (repetindo)!
        Write-Host "[1] Limpeza e Manuten√ß√£o de Arquivos (Tirar a poeira digital!)" -ForegroundColor Cyan # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[2] Otimiza√ß√µes de Desempenho do Sistema (Deixar o motor roncando!)" -ForegroundColor Green # Cor variada
        Write-Host "[3] Configura√ß√µes e Otimiza√ß√µes de Rede (Pra internet voar baixo!)" -ForegroundColor Yellow # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[4] Gerenciamento e Otimiza√ß√£o de Servi√ßos do Windows (O que t√° rodando e n√£o precisa?!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Ferramentas de Diagn√≥stico e Verifica√ß√£o (Pra ver se t√° tudo nos conformes!)" -ForegroundColor Cyan # Cor repetida
        Write-Host "[6] Desabilitar/Gerenciar Recursos do Windows (Tirar o peso extra do sistema!)" -ForegroundColor Green # Cor repetida
        Write-Host "[7] Gerenciamento de Arquivos e Pastas Avan√ßado (Comandos ninja pra arquivos!)" -ForegroundColor Yellow # Cor repetida
        Write-Host "[8] Gerenciamento de Contas de Usu√°rio (Organizar a galera que usa o PC!)" -ForegroundColor White # Cor repetida
        Write-Host "[9] Otimiza√ß√£o para Jogos Avan√ßada (Tweaks pra gamers de verdade!)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Configura√ß√µes de Privacidade (Controle o que o Windows sabe sobre voc√™)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[11] Outras Configura√ß√µes e Tweaks Diversos (Aqueles ajustes secretos!)" -ForegroundColor Gray # Cor neutra/escura
        Write-Host "[0] Voltar ao Menu Principal (Pronto pra voltar pra estrada principal!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta pro mago qual categoria ele quer explorar
        $choice = Read-Host "Escolhe sua √°rea de magia, mago!"

        # V√™ pra onde a gente navega dentro do mundo avan√ßado
        switch ($choice) {
            "1" { Show-LimpezaManutencaoMenu } # CHAMA O SUB-MENU DE LIMPEZA
            "2" { Show-DesempenhoMenu } # Agora √© um sub-menu tamb√©m
            "3" { Show-ConfiguracoesRedeMenu } # CHAMA O SUB-MENU DE REDE
            "4" { Show-ServicosMenu } # Agora √© um sub-menu tamb√©m
            "5" { Show-DiagnosticoMenu } # Agora √© um sub-menu tamb√©m
            "6" { Show-RecursosMenu } # Agora √© um sub-menu tamb√©m
            "7" { Show-ArquivosPastasMenu } # Agora √© um sub-menu tamb√©m
            "8" { Show-UsuariosMenu } # Agora √© um sub-menu tamb√©m
            "9" { Show-JogosAvancadoMenu } # Novo sub-menu para jogos
            "10" { Show-PrivacidadeMenu } # Novo sub-menu para privacidade
            "11" { Show-OutrosMenu } # Agora √© um sub-menu tamb√©m
            "0" { break } # Sai do loop deste menu, voltando pro Menu Principal
            default {
                Write-Host "Humm, essa √°rea da magia ainda n√£o existe ou voc√™ digitou errado! Tenta de novo, mago!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Avan√ßado enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Limpeza e Manuten√ß√£o (Dentro do Avan√ßado!) ---
# Este menu lista as op√ß√µes ESPEC√çFICAS da categoria Limpeza no Menu Avan√ßado
function Show-LimpezaManutencaoMenu {
    do {
        Clear-Host # Limpa o palco pra este sub-menu!
        Banner-TORK # Banner no topo, sempre!

        Write-Host "" # Espacinho
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: LIMPEZA E MANUT." -ForegroundColor White # T√≠tulo menor pro sub-menu
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes ESPEC√çFICAS da categoria Limpeza. Cores variadas (repetindo cores)!
        Write-Host "[1] Limpar Arquivos Tempor√°rios do Usu√°rio (Tipo a pasta Temp!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[2] Limpar Arquivos Tempor√°rios do Sistema (Os tempor√°rios do Windows!)" -ForegroundColor Gray # Cor neutra (substitui DarkCyan)
        Write-Host "[3] Limpar Cache de DNS (Pra resolver nomes de site mais r√°pido!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[4] Esvaziar Lixeira (Adeus, arquivos deletados!)" -ForegroundColor Gray # Cor neutra (repetindo)
        Write-Host "[5] Limpar Cache de Miniaturas (Aqueles previews de imagem/v√≠deo!)" -ForegroundColor Green # Cor variada
        Write-Host "[6] Limpar Logs do Sistema (Arquivos de registro que acumulam)" -ForegroundColor Cyan # Nova op√ß√£o
        Write-Host "[7] Limpar Cache de Atualiza√ß√µes do Windows (Liberar espa√ßo de updates)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[8] Limpar Arquivos de Hiberna√ß√£o (Liberar o hiberfil.sys)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[9] Limpar Arquivos WinSxS (Pasta que ocupa muito espa√ßo)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Executar TODAS as limpezas acima (Faxina completa!)" -ForegroundColor Red # Nova op√ß√£o
        Write-Host "[0] Voltar ao Menu Avan√ßado (De volta pras categorias!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta qual limpeza espec√≠fica o mago quer fazer
        $choice = Read-Host "Escolhe a limpeza avan√ßada, mestre!"

        # V√™ qual fun√ß√£o de limpeza espec√≠fica chamar
        switch ($choice) {
            "1" { Invoke-CleanUserTemp } # Chama a fun√ß√£o pra Limpar Temp Usu√°rio
            "2" { Invoke-CleanSystemTemp } # Chama a fun√ß√£o pra Limpar Temp Sistema
            "3" { Invoke-CleanDnsCache } # Chama a fun√ß√£o pra Limpar Cache DNS
            "4" { Invoke-EmptyRecycleBin } # Chama a fun√ß√£o pra Esvaziar Lixeira
            "5" { Invoke-CleanThumbnailCache } # Chama a fun√ß√£o pra Limpar Cache de Miniaturas
            "6" { Invoke-CleanSystemLogs } # Nova fun√ß√£o para limpar logs do sistema
            "7" { Invoke-CleanWindowsUpdateCache } # Nova fun√ß√£o para limpar cache de updates
            "8" { Invoke-CleanHibernationFile } # Nova fun√ß√£o para limpar arquivo de hiberna√ß√£o
            "9" { Invoke-CleanWinSxS } # Nova fun√ß√£o para limpar pasta WinSxS
            "10" { 
                # Executa todas as limpezas em sequ√™ncia
                Write-Host "`nIniciando faxina completa do sistema! Isso pode demorar um pouco...`n" -ForegroundColor Yellow
                $diskSpaceBefore = Get-DiskSpaceBefore
                
                Invoke-CleanUserTemp
                Invoke-CleanSystemTemp
                Invoke-CleanDnsCache
                Invoke-EmptyRecycleBin
                Invoke-CleanThumbnailCache
                Invoke-CleanSystemLogs
                Invoke-CleanWindowsUpdateCache
                Invoke-CleanHibernationFile
                Invoke-CleanWinSxS
                
                Write-Host "`nFaxina completa finalizada! Veja quanto espa√ßo foi recuperado:`n" -ForegroundColor Green
                Show-DiskSpaceComparison -before $diskSpaceBefore
                Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-AdvancedMenu
            default {
                Write-Host "Essa tarefa de limpeza ainda n√£o t√° na lista! V√™ os n√∫meros e tenta de novo!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Sub-Menu Limpeza enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Desempenho (Dentro do Avan√ßado!) ---
function Show-DesempenhoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DESEMPENHO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Ajustar Efeitos Visuais para Melhor Desempenho" -ForegroundColor Green
        Write-Host "[2] Otimizar Disco do Sistema" -ForegroundColor Cyan
        Write-Host "[3] Limpar Arquivos Prefetch" -ForegroundColor Yellow
        Write-Host "[4] Definir Plano de Energia para Alto Desempenho" -ForegroundColor White
        Write-Host "[5] Otimizar Servi√ßo SuperFetch/SysMain" -ForegroundColor Magenta
        Write-Host "[6] Ajustar Tamanho da Mem√≥ria Virtual" -ForegroundColor Gray
        Write-Host "[7] Desativar Indexa√ß√£o de Arquivos" -ForegroundColor Green
        Write-Host "[8] Otimizar Inicializa√ß√£o do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de desempenho" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o de desempenho"

        switch ($choice) {
            "1" { Invoke-OptimizeVisualEffects }
            "2" { Invoke-OptimizeDisk }
            "3" { Invoke-CleanPrefetch }
            "4" { Invoke-SetHighPerformancePower }
            "5" { Invoke-OptimizeSuperFetch }
            "6" { Invoke-AdjustVirtualMemory }
            "7" { Invoke-DisableIndexing }
            "8" { Invoke-OptimizeStartup }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de desempenho...`n" -ForegroundColor Yellow
                Invoke-OptimizeVisualEffects
                Invoke-OptimizeDisk
                Invoke-CleanPrefetch
                Invoke-SetHighPerformancePower
                Invoke-OptimizeSuperFetch
                Invoke-AdjustVirtualMemory
                Invoke-DisableIndexing
                Invoke-OptimizeStartup
                Write-Host "`nTodas as otimiza√ß√µes de desempenho foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Configura√ß√µes de Rede (Dentro do Avan√ßado!) ---
function Show-ConfiguracoesRedeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: CONFIG. REDE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Limpar Cache de DNS" -ForegroundColor Yellow
        Write-Host "[2] Mudar Servidor DNS" -ForegroundColor Cyan
        Write-Host "[3] Resetar Configura√ß√µes de Rede" -ForegroundColor White
        Write-Host "[4] Otimizar Configura√ß√µes TCP/IP" -ForegroundColor Green
        Write-Host "[5] Verificar Velocidade da Conex√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar QoS (Qualidade de Servi√ßo)" -ForegroundColor Gray
        Write-Host "[7] Desativar IPv6 (Se n√£o estiver usando)" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Lat√™ncia de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de rede" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√£o de rede"

        switch ($choice) {
            "1" { Invoke-NetworkFlushDns }
            "2" { Invoke-NetworkChangeDns }
            "3" { Invoke-NetworkReset }
            "4" { Invoke-OptimizeTcpIp }
            "5" { Invoke-CheckNetworkSpeed }
            "6" { Invoke-ConfigureQoS }
            "7" { Invoke-DisableIPv6 }
            "8" { Invoke-OptimizeGamingLatency }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de rede...`n" -ForegroundColor Yellow
                Invoke-NetworkFlushDns
                Invoke-OptimizeTcpIp
                Invoke-CheckNetworkSpeed
                Invoke-ConfigureQoS
                Invoke-DisableIPv6
                Invoke-OptimizeGamingLatency
                Write-Host "`nTodas as otimiza√ß√µes de rede foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Rede..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Servi√ßos (Dentro do Avan√ßado!) ---
function Show-ServicosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: SERVICOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desabilitar Servi√ßo SuperFetch/SysMain" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Servi√ßo de Impress√£o" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Servi√ßo Windows Update" -ForegroundColor White
        Write-Host "[4] Listar Todos os Servi√ßos em Execu√ß√£o" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Otimizar Servi√ßos para Desempenho Geral" -ForegroundColor Gray
        Write-Host "[7] Restaurar Servi√ßos para Configura√ß√£o Padr√£o" -ForegroundColor Yellow
        Write-Host "[8] Desabilitar Servi√ßos Desnecess√°rios" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de servi√ßos"

        switch ($choice) {
            "1" { Invoke-ManageSuperFetch }
            "2" { Invoke-ManagePrintService }
            "3" { Invoke-ManageWindowsUpdate }
            "4" { Invoke-ListRunningServices }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-OptimizeServicesForPerformance }
            "7" { Invoke-RestoreDefaultServices }
            "8" { Invoke-DisableUnnecessaryServices }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Diagn√≥stico (Dentro do Avan√ßado!) ---
function Show-DiagnosticoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DIAGNOSTICO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Verificar Arquivos do Sistema (SFC)" -ForegroundColor Yellow
        Write-Host "[2] Reparar Imagem do Windows (DISM)" -ForegroundColor Cyan
        Write-Host "[3] Verificar Disco por Erros (CHKDSK)" -ForegroundColor White
        Write-Host "[4] Verificar Sa√∫de do Disco" -ForegroundColor Green
        Write-Host "[5] Verificar Drivers Desatualizados" -ForegroundColor Magenta
        Write-Host "[6] Verificar Problemas de Inicializa√ß√£o" -ForegroundColor Gray
        Write-Host "[7] Verificar Problemas de Mem√≥ria RAM" -ForegroundColor Yellow
        Write-Host "[8] Verificar Temperatura do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODOS os diagn√≥sticos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de diagn√≥stico"

        switch ($choice) {
            "1" { Invoke-SfcScan }
            "2" { Invoke-DismRepair }
            "3" { Invoke-ChkDsk }
            "4" { Invoke-CheckDiskHealth }
            "5" { Invoke-CheckDrivers }
            "6" { Invoke-CheckStartupIssues }
            "7" { Invoke-CheckMemory }
            "8" { Invoke-CheckTemperature }
            "9" {
                Write-Host "`nExecutando todos os diagn√≥sticos...`n" -ForegroundColor Yellow
                Invoke-SfcScan
                Invoke-DismRepair
                Invoke-CheckDiskHealth
                Invoke-CheckDrivers
                Invoke-CheckStartupIssues
                Invoke-CheckTemperature
                Write-Host "`nTodos os diagn√≥sticos foram conclu√≠dos!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Diagn√≥stico..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Recursos (Dentro do Avan√ßado!) ---
function Show-RecursosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: RECURSOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Gerenciar Hiberna√ß√£o" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Planos de Energia" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Recursos Opcionais do Windows" -ForegroundColor White
        Write-Host "[4] Gerenciar Mem√≥ria Virtual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Windows Defender" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Recursos de Telemetria" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Recursos de Inicializa√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Recursos de Seguran√ßa" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de recursos"

        switch ($choice) {
            "1" { Invoke-ManageHibernation }
            "2" { Invoke-ManagePowerPlans }
            "3" { Invoke-ManageOptionalFeatures }
            "4" { Invoke-ManageVirtualMemory }
            "5" { Invoke-ManageWindowsDefender }
            "6" { Invoke-ManageTelemetry }
            "7" { Invoke-ManageStartupResources }
            "8" { Invoke-ManageSecurityFeatures }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Arquivos e Pastas (Dentro do Avan√ßado!) ---
function Show-ArquivosPastasMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: ARQUIVOS E PASTAS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Encontrar Arquivos Grandes" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Arquivos" -ForegroundColor Cyan
        Write-Host "[3] Tomar Posse de Arquivos (TakeOwn)" -ForegroundColor White
        Write-Host "[4] Listar Conte√∫do de Pastas Espec√≠ficas" -ForegroundColor Green
        Write-Host "[5] Compactar Pastas para Economizar Espa√ßo" -ForegroundColor Magenta
        Write-Host "[6] Verificar Integridade de Arquivos" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Arquivos Ocultos e do Sistema" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Atributos de Arquivos" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de arquivos e pastas"

        switch ($choice) {
            "1" { Invoke-FindLargeFiles }
            "2" { Invoke-ManageFilePermissions }
            "3" { Invoke-TakeOwnership }
            "4" { Invoke-ListFolderContents }
            "5" { Invoke-CompressFolders }
            "6" { Invoke-VerifyFileIntegrity }
            "7" { Invoke-ManageHiddenSystemFiles }
            "8" { Invoke-ManageFileAttributes }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Usu√°rios (Dentro do Avan√ßado!) ---
function Show-UsuariosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: USUARIOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Listar Todos os Usu√°rios Locais" -ForegroundColor Yellow
        Write-Host "[2] Listar Todos os Grupos Locais" -ForegroundColor Cyan
        Write-Host "[3] Listar Membros de Grupos Espec√≠ficos" -ForegroundColor White
        Write-Host "[4] Mostrar Propriedades do Usu√°rio Atual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Contas de Usu√°rio" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Pol√≠ticas de Senha" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Permiss√µes de Usu√°rio" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar UAC (Controle de Conta de Usu√°rio)" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de usu√°rios"

        switch ($choice) {
            "1" { Invoke-ListLocalUsers }
            "2" { Invoke-ListLocalGroups }
            "3" { Invoke-ListGroupMembers }
            "4" { Invoke-ShowCurrentUserProperties }
            "5" { Invoke-ManageUserAccounts }
            "6" { Invoke-ManagePasswordPolicies }
            "7" { Invoke-ManageUserPermissions }
            "8" { Invoke-ManageUAC }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Jogos Avan√ßado (Dentro do Avan√ßado!) ---
function Show-JogosAvancadoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: JOGOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Otimizar Prioridade de CPU para Jogos" -ForegroundColor Yellow
        Write-Host "[2] Otimizar Configura√ß√µes de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[3] Otimizar Configura√ß√µes de GPU" -ForegroundColor White
        Write-Host "[4] Desativar Game DVR e Game Bar" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Configurar Modo de Jogo do Windows" -ForegroundColor Gray
        Write-Host "[7] Otimizar Configura√ß√µes de √Åudio para Jogos" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Configura√ß√µes de Input Lag" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes para jogos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o para jogos"

        switch ($choice) {
            "1" { Invoke-OptimizeCpuPriority }
            "2" { Invoke-OptimizeNetworkForGaming }
            "3" { Invoke-OptimizeGpuSettings }
            "4" { Invoke-DisableGameDvrBar }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-ConfigureGameMode }
            "7" { Invoke-OptimizeAudioForGaming }
            "8" { Invoke-OptimizeInputLag }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes para jogos...`n" -ForegroundColor Yellow
                Invoke-OptimizeCpuPriority
                Invoke-OptimizeNetworkForGaming
                Invoke-OptimizeGpuSettings
                Invoke-DisableGameDvrBar
                Invoke-OptimizeServicesForGaming
                Invoke-ConfigureGameMode
                Invoke-OptimizeAudioForGaming
                Invoke-OptimizeInputLag
                Write-Host "`nTodas as otimiza√ß√µes para jogos foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Jogos..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Privacidade (Dentro do Avan√ßado!) ---
function Show-PrivacidadeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: PRIVACIDADE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desativar Telemetria do Windows" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Aplicativos" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Hist√≥rico de Atividades" -ForegroundColor White
        Write-Host "[4] Gerenciar Diagn√≥stico e Feedback" -ForegroundColor Green
        Write-Host "[5] Gerenciar An√∫ncios Personalizados" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Localiza√ß√£o e Sensores" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Reconhecimento de Voz e Digita√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Sincroniza√ß√£o com a Microsoft" -ForegroundColor Cyan
        Write-Host "[9] Aplicar TODAS as configura√ß√µes de privacidade" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de privacidade"

        switch ($choice) {
            "1" { Invoke-DisableTelemetry }
            "2" { Invoke-ManageAppPermissions }
            "3" { Invoke-ManageActivityHistory }
            "4" { Invoke-ManageDiagnosticsFeedback }
            "5" { Invoke-ManagePersonalizedAds }
            "6" { Invoke-ManageLocationSensors }
            "7" { Invoke-ManageVoiceTyping }
            "8" { Invoke-ManageMicrosoftSync }
            "9" {
                Write-Host "`nAplicando todas as configura√ß√µes de privacidade...`n" -ForegroundColor Yellow
                Invoke-DisableTelemetry
                Invoke-ManageAppPermissions
                Invoke-ManageActivityHistory
                Invoke-ManageDiagnosticsFeedback
                Invoke-ManagePersonalizedAds
                Invoke-ManageLocationSensors
                Invoke-ManageVoiceTyping
                Invoke-ManageMicrosoftSync
                Write-Host "`nTodas as configura√ß√µes de privacidade foram aplicadas!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Privacidade..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Outros (Dentro do Avan√ßado!) ---
function Show-OutrosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: OUTROS TWEAKS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Mostrar Informa√ß√µes Detalhadas do Sistema" -ForegroundColor Yellow
        Write-Host "[2] Mostrar Configura√ß√£o Completa de Rede" -ForegroundColor Cyan
        Write-Host "[3] Reiniciar Explorer.exe" -ForegroundColor White
        Write-Host "[4] Limpar Cache de Atualiza√ß√µes do Windows" -ForegroundColor Green
        Write-Host "[5] Gerenciar Programas de Inicializa√ß√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar Op√ß√µes de Energia Avan√ßadas" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Configura√ß√µes de Armazenamento" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Configura√ß√µes de Notifica√ß√µes" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√µes diversas"

        switch ($choice) {
            "1" { Invoke-ShowDetailedSystemInfo }
            "2" { Invoke-ShowDetailedNetworkConfig }
            "3" { Invoke-RestartExplorer }
            "4" { Invoke-CleanWindowsUpdateCache }
            "5" { Invoke-ManageStartupPrograms }
            "6" { Invoke-ConfigureAdvancedPowerOptions }
            "7" { Invoke-ManageStorageSettings }
            "8" { Invoke-ManageNotificationSettings }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- Fun√ß√µes para as Secoes SIMPLIFICADAS (Expandidas) ---
function Invoke-SimpleSystemCleanup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza Geral do Sistema: Hora de varrer o lixo digital! ---" -ForegroundColor Green
    Write-Host "Essa op√ß√£o vai te ajudar a liberar espa√ßo e dar um f√¥lego pro PC tirando arquivos tempor√°rios, lixo da lixeira, etc. √â tipo faxina no computador!" -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Comando 1: Limpar Arquivos Tempor√°rios do Usu√°rio
    Write-Host "Bora come√ßar limpando os arquivos tempor√°rios do seu usu√°rio! Eles acumulam que √© uma beleza!" -ForegroundColor Yellow
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio limpos! Menos peso pro PC respirar! ;)" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Esvaziar a Lixeira
    Write-Host "Agora, vamos dar um fim definitivo naqueles arquivos na Lixeira. Eles s√≥ est√£o ocupando espa√ßo √† toa!" -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada! Espa√ßo recuperado com sucesso! R√°!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios do Windows
    Write-Host "Vamos limpar tamb√©m os tempor√°rios do pr√≥prio Windows. √Äs vezes, fica lixo escondido por l√°!" -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Limpar Cache de Navegadores Comuns
    Write-Host "Bora dar uma geral nos caches dos navegadores tamb√©m! Eles guardam um monte de coisa que pode pesar!" -ForegroundColor Yellow
    
    # Chrome
    Write-Host "Tentando limpar cache do Google Chrome..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Chrome limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Edge
    Write-Host "Tentando limpar cache do Microsoft Edge..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Edge limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Firefox
    Write-Host "Tentando limpar cache do Mozilla Firefox..." -ForegroundColor DarkGray
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\cache2\entries\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\startupCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\thumbnails\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Firefox limpo (pode n√£o ser completo, dependendo do perfil/uso)." -ForegroundColor DarkGray

    # Brave (se instalado)
    Write-Host "Tentando limpar cache do Brave Browser (se instalado)..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Brave limpo (se instalado e n√£o estiver rodando)." -ForegroundColor DarkGray

    Write-Host "Limpeza de caches de navegador conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Comando 5: Limpar Cache de Miniaturas
    Write-Host "Limpando cache de miniaturas do Windows (aquelas pr√©-visualiza√ß√µes de imagens e v√≠deos)..." -ForegroundColor Yellow
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Write-Host "Cache de miniaturas limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Limpar Arquivos de Log do Windows
    Write-Host "Limpando arquivos de log do Windows que podem ocupar espa√ßo..." -ForegroundColor Yellow
    wevtutil cl Application
    wevtutil cl System
    wevtutil cl Security
    Write-Host "Logs do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 7: Limpar Arquivos Tempor√°rios de Instala√ß√£o
    Write-Host "Limpando arquivos tempor√°rios de instala√ß√£o de programas..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Installer\$*\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios de instala√ß√£o limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 8: Limpar Arquivos de Atualiza√ß√£o do Windows
    Write-Host "Limpando arquivos de atualiza√ß√£o do Windows que podem ocupar bastante espa√ßo..." -ForegroundColor Yellow
    Stop-Service -Name wuauserv -ErrorAction SilentlyContinue
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    Write-Host "Arquivos de atualiza√ß√£o do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 9: Limpar Arquivos Prefetch
    Write-Host "Limpando arquivos prefetch para melhorar a inicializa√ß√£o..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Prefetch\*.pf" -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos prefetch limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 10: Executar Limpeza de Disco Integrada do Windows
    Write-Host "Executando a ferramenta de limpeza de disco integrada do Windows..." -ForegroundColor Yellow
    Start-Process -FilePath cleanmgr.exe -ArgumentList "/sagerun:1" -Wait -ErrorAction SilentlyContinue
    Write-Host "Limpeza de disco conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "Vamos ver quanto espa√ßo conseguimos recuperar com essa faxina:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nPronto! A faxina geral b√°sica foi feita! Seu PC agradece o espa√ßo extra! ;)" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu
    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleMemoryStartup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Mem√≥ria e Inicializa√ß√£o R√°pida: Deixa o PC ligando num piscar! ---" -ForegroundColor Yellow
    Write-Host "Aqui a gente d√° uma olhada na mem√≥ria RAM e nos programas que ligam junto com o Windows. Menos coisa ligando √† toa = PC mais r√°pido pra usar na hora!" -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Listar Programas de Inicializa√ß√£o
    Write-Host "Listando programas que iniciam com o Windows (pra voc√™ saber o que t√° rodando por baixo dos panos):" -ForegroundColor Yellow
    Get-CimInstance win32_startupcommand | Select-Object Name, command, Location | Format-Table -AutoSize
    Write-Host "Lista de programas de inicializa√ß√£o exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Servi√ßo SuperFetch/SysMain
    Write-Host "Otimizando o servi√ßo SuperFetch/SysMain para melhorar o desempenho..." -ForegroundColor Yellow
    $confirmSysMain = Read-Host "Deseja desativar o servi√ßo SysMain/SuperFetch? (s/n) - Recomendado para SSDs"
    if ($confirmSysMain -eq 's') {
        Set-Service -Name SysMain -StartupType Disabled -ErrorAction SilentlyContinue
        Stop-Service -Name SysMain -Force -ErrorAction SilentlyContinue
        Write-Host "Servi√ßo SysMain/SuperFetch desativado!" -ForegroundColor Green
    } else {
        Write-Host "Servi√ßo SysMain/SuperFetch mantido ativo." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios de Updates
    Write-Host "Limpando arquivos tempor√°rios de atualiza√ß√µes do Windows (podem ocupar bastante espa√ßo e afetar performance):" -ForegroundColor Yellow
    Dism /online /Cleanup-Image /StartComponentCleanup /ErrorAction SilentlyContinue
    Write-Host "Limpeza de componentes de atualiza√ß√£o iniciada (pode levar um tempo)." -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Mem√≥ria Virtual
    Write-Host "Otimizando configura√ß√µes de mem√≥ria virtual para melhor desempenho..." -ForegroundColor Yellow
    $totalRam = (Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property capacity -Sum).Sum / 1GB
    Write-Host "Seu sistema tem aproximadamente $totalRam GB de RAM." -ForegroundColor White
    
    $confirmPageFile = Read-Host "Deseja otimizar o arquivo de pagina√ß√£o (mem√≥ria virtual)? (s/n)"
    if ($confirmPageFile -eq 's') {
        # Calcula tamanho recomendado (1.5x a RAM para sistemas com menos de 8GB, 1x para sistemas com mais)
        $pageFileSize = if ($totalRam -lt 8) { [math]::Round($totalRam * 1.5) * 1024 } else { [math]::Round($totalRam) * 1024 }
        
        Write-Host "Configurando arquivo de pagina√ß√£o para tamanho fixo de $pageFileSize MB..." -ForegroundColor DarkGray
        $computerSystem = Get-WmiObject -Class Win32_ComputerSystem
        $computerSystem.AutomaticManagedPagefile = $false
        $computerSystem.Put() | Out-Null
        
        $pageFileSetting = Get-WmiObject -Class Win32_PageFileSetting
        if ($pageFileSetting) {
            $pageFileSetting.InitialSize = $pageFileSize
            $pageFileSetting.MaximumSize = $pageFileSize
            $pageFileSetting.Put() | Out-Null
        }
        Write-Host "Arquivo de pagina√ß√£o otimizado! (Requer reinicializa√ß√£o para aplicar totalmente)" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes de mem√≥ria virtual mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Listar os 10 Processos que mais usam mem√≥ria no momento
    Write-Host "Listando os 10 processos que mais consomem mem√≥ria agora:" -ForegroundColor Yellow
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host "Lista de processos exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Otimizar Inicializa√ß√£o do Windows
    Write-Host "Otimizando a inicializa√ß√£o do Windows..." -ForegroundColor Yellow
    # Desabilitar servi√ßos n√£o essenciais que podem atrasar a inicializa√ß√£o
    $startupServices = @(
        @{Name="DiagTrack"; DisplayName="Experi√™ncias do Usu√°rio Conectado e Telemetria"},
        @{Name="dmwappushservice"; DisplayName="Servi√ßo de Transfer√™ncia Inteligente em Segundo Plano (BITS)"},
        @{Name="MapsBroker"; DisplayName="Servi√ßo de Dados de Mapas"}
    )
    
    foreach ($service in $startupServices) {
        $confirmService = Read-Host "Deseja desativar o servi√ßo '$($service.DisplayName)' na inicializa√ß√£o? (s/n)"
        if ($confirmService -eq 's') {
            Set-Service -Name $service.Name -StartupType Disabled -ErrorAction SilentlyContinue
            Stop-Service -Name $service.Name -Force -ErrorAction SilentlyContinue
            Write-Host "Servi√ßo '$($service.DisplayName)' desativado!" -ForegroundColor Green
        } else {
            Write-Host "Servi√ßo '$($service.DisplayName)' mantido." -ForegroundColor Green
        }
    }
    Write-Host ""

    # Comando 7: Reiniciar o Computador (√ötil pra liberar mem√≥ria e aplicar mudan√ßas)
    Write-Host "Quer dar um 'refresh' geral no PC? Reiniciar pode ajudar!" -ForegroundColor Yellow
    $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (digite 'sim' para confirmar)"
    if ($confirmRestart -eq 'sim') {
        Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
        Restart-Computer -Force
    } else {
        Write-Host "Rein√≠cio cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o de mem√≥ria e inicializa√ß√£o!" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu (a n√£o ser que o PC tenha reiniciado)
    if ($confirmRestart -ne 'sim') {
        Write-Host ""
        Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
    }
}

function Invoke-SimpleInternetOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Acelerar a Conex√£o com a Internet (Simplificado): Diz adeus pro 'carregando...'! ---" -ForegroundColor Cyan
    Write-Host "Vamos fazer uns ajustes r√°pidos na sua conex√£o pra tentar deixar ela mais esperta." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Limpar Cache de DNS
    Write-Host "Limpando o cache de endere√ßos de internet (DNS) pra resolver nomes mais r√°pido!" -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Configura√ß√µes TCP/IP
    Write-Host "Otimizando configura√ß√µes TCP/IP para melhorar a velocidade de conex√£o..." -ForegroundColor Yellow
    
    # Habilitar TCP Window Auto-Tuning
    netsh int tcp set global autotuninglevel=normal
    Write-Host "TCP Auto-Tuning configurado para 'normal'." -ForegroundColor DarkGray
    
    # Otimizar par√¢metros de recebimento de pacotes
    netsh int tcp set global rss=enabled
    Write-Host "Receive-Side Scaling (RSS) habilitado." -ForegroundColor DarkGray
    
    # Otimizar congestion provider
    netsh int tcp set global congestionprovider=ctcp
    Write-Host "Congestion Provider configurado para 'ctcp'." -ForegroundColor DarkGray
    
    # Otimizar ECN capability
    netsh int tcp set global ecncapability=enabled
    Write-Host "ECN Capability habilitado." -ForegroundColor DarkGray
    
    Write-Host "Configura√ß√µes TCP/IP otimizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Reiniciar Adaptadores de Rede
    Write-Host "Dando um 'reset' r√°pido nas suas conex√µes de rede. Pode resolver uns pepinos!" -ForegroundColor Yellow
    $confirmResetAdapter = Read-Host "Isso vai desconectar brevemente sua internet. Continuar? (s/n)"
    if ($confirmResetAdapter -eq 's') {
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        Write-Host "Adaptadores de rede reiniciados." -ForegroundColor Green
    } else {
        Write-Host "Reset de adaptadores cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 4: Configurar DNS R√°pido
    Write-Host "Configurar DNS mais r√°pido pode melhorar sua navega√ß√£o!" -ForegroundColor Yellow
    $confirmDns = Read-Host "Deseja configurar DNS mais r√°pidos (Google ou Cloudflare)? (s/n)"
    if ($confirmDns -eq 's') {
        Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
        Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
        $dnsChoice = Read-Host "Escolha uma op√ß√£o (1 ou 2)"
        
        $primaryDns = ""
        $secondaryDns = ""
        
        if ($dnsChoice -eq '1') {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            Write-Host "Google DNS selecionado." -ForegroundColor DarkGray
        } elseif ($dnsChoice -eq '2') {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            Write-Host "Cloudflare DNS selecionado." -ForegroundColor DarkGray
        } else {
            Write-Host "Op√ß√£o inv√°lida. DNS n√£o alterado." -ForegroundColor Red
        }
        
        if ($primaryDns -ne "") {
            $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" -and ($_.InterfaceDescription -match "Ethernet" -or $_.InterfaceDescription -match "Wi-Fi" -or $_.InterfaceDescription -match "Wireless") }
            
            foreach ($adapter in $networkAdapters) {
                Write-Host "Configurando DNS para adaptador: $($adapter.Name)" -ForegroundColor DarkGray
                Set-DnsClientServerAddress -InterfaceIndex $adapter.ifIndex -ServerAddresses ($primaryDns, $secondaryDns)
            }
            
            Write-Host "DNS configurado! Sua navega√ß√£o deve ficar mais r√°pida agora." -ForegroundColor Green
        }
    } else {
        Write-Host "Configura√ß√£o de DNS mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Mostrar Status B√°sico da Conex√£o
    Write-Host "Mostrando um resumo b√°sico da sua configura√ß√£o de rede atual:" -ForegroundColor Yellow
    ipconfig /all | Select-String -Pattern "IPv4", "DNS", "Gateway", "DHCP", "Subnet", "Physical Address"
    Write-Host "Status b√°sico da rede exibido." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Testar a conex√£o com a internet
    Write-Host "Testando a conex√£o com a internet (ping para google.com)..." -ForegroundColor Yellow
    Test-Connection -Count 4 google.com -ErrorAction SilentlyContinue
    Write-Host "Teste de conex√£o finalizado." -ForegroundColor Green
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o b√°sica de internet!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleVisualOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Deixar o Windows mais Leve Visualmente (Simplificado): Desempenho antes da beleza! ---" -ForegroundColor White
    Write-Host "Ajustes r√°pidos pra desativar efeitos visuais que podem pesar, liberando recursos pro que importa." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ajustar Efeitos Visuais
    Write-Host "Voc√™ quer desativar ou ativar as anima√ß√µes e efeitos visuais do Windows?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Efeitos Visuais (Pra ganhar desempenho)" -ForegroundColor Green
    Write-Host "[2] Configurar para Melhor Apar√™ncia (Mais bonito, mas mais pesado)" -ForegroundColor White
    Write-Host "[3] Deixar o Windows Escolher (Configura√ß√£o padr√£o)" -ForegroundColor Cyan
    $choiceVisual = Read-Host "Escolha [1], [2] ou [3]"

    if ($choiceVisual -eq '1') {
        Write-Host "Desativando efeitos visuais para melhor desempenho..." -ForegroundColor Yellow
        # Valor 2 = Ajustar para melhor desempenho (desativa a maioria dos efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 2 -Type DWord -Force -ErrorAction SilentlyContinue
        
        # Desativar anima√ß√µes individuais
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop' -Name 'UserPreferencesMask' -Value ([byte[]](0x90, 0x12, 0x01, 0x80)) -Type Binary -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop\WindowMetrics' -Name 'MinAnimate' -Value 0 -Type String -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'ListviewAlphaSelect' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'TaskbarAnimations' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        
        Write-Host "Efeitos visuais desativados para melhor desempenho!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '2') {
        Write-Host "Configurando para melhor apar√™ncia (todos os efeitos visuais ativados)..." -ForegroundColor Yellow
        # Valor 1 = Ajustar para melhor apar√™ncia (ativa todos os efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Efeitos visuais configurados para melhor apar√™ncia!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '3') {
        Write-Host "Deixando o Windows escolher automaticamente (configura√ß√£o padr√£o)..." -ForegroundColor Yellow
        # Valor 0 = Deixar o Windows escolher
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Configura√ß√£o visual definida para padr√£o do Windows!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa nos efeitos visuais foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 2: Ativar/Desativar Efeitos de Transpar√™ncia
    Write-Host "E os efeitos de transpar√™ncia do Windows (tipo na barra de tarefas)?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Transpar√™ncia (Mais leve)" -ForegroundColor Green
    Write-Host "[2] Ativar Transpar√™ncia (Mais 'bonito')" -ForegroundColor White
    $choiceTransp = Read-Host "Escolha [1] ou [2]"

    if ($choiceTransp -eq '1') {
        Write-Host "Desativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 0 = Desativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia desativada!" -ForegroundColor Green
    } elseif ($choiceTransp -eq '2') {
        Write-Host "Ativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 1 = Ativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia ativada!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa na transpar√™ncia foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 3: Configurar Tema Claro/Escuro
    Write-Host "Voc√™ prefere tema claro ou escuro? O tema escuro pode ser mais confort√°vel para os olhos." -ForegroundColor Yellow
    Write-Host "[1] Tema Escuro (Dark Mode)" -ForegroundColor DarkGray
    Write-Host "[2] Tema Claro (Light Mode)" -ForegroundColor White
    $choiceTheme = Read-Host "Escolha [1] ou [2]"

    if ($choiceTheme -eq '1') {
        Write-Host "Configurando tema escuro..." -ForegroundColor Yellow
        # Valor 0 = Tema Escuro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema escuro configurado!" -ForegroundColor Green
    } elseif ($choiceTheme -eq '2') {
        Write-Host "Configurando tema claro..." -ForegroundColor Yellow
        # Valor 1 = Tema Claro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema claro configurado!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa no tema foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Configurar Resolu√ß√£o de Tela
    Write-Host "Deseja ajustar a resolu√ß√£o da tela? Resolu√ß√µes menores podem melhorar o desempenho em PCs mais antigos." -ForegroundColor Yellow
    $confirmResolution = Read-Host "Deseja ver e ajustar a resolu√ß√£o da tela? (s/n)"
    
    if ($confirmResolution -eq 's') {
        # Mostrar resolu√ß√£o atual
        $currentResolution = Get-WmiObject -Class Win32_VideoController | Select-Object -ExpandProperty VideoModeDescription
        Write-Host "Resolu√ß√£o atual: $currentResolution" -ForegroundColor White
        
        # Abrir configura√ß√µes de exibi√ß√£o do Windows
        Write-Host "Abrindo configura√ß√µes de exibi√ß√£o do Windows..." -ForegroundColor DarkGray
        Start-Process "ms-settings:display"
        Write-Host "Ajuste a resolu√ß√£o conforme necess√°rio na janela de configura√ß√µes que foi aberta." -ForegroundColor Green
        
        $waitForSettings = Read-Host "Pressione Enter quando terminar de ajustar as configura√ß√µes de exibi√ß√£o"
    } else {
        Write-Host "Configura√ß√£o de resolu√ß√£o mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizados os ajustes visuais b√°sicos!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleGamingOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Jogos (Simplificado): Mais FPS, menos lag! ---" -ForegroundColor Magenta
    Write-Host "Vamos fazer alguns ajustes para melhorar o desempenho dos seus jogos sem complica√ß√µes." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ativar Modo de Jogo do Windows
    Write-Host "Ativando o Modo de Jogo do Windows para priorizar recursos para jogos..." -ForegroundColor Yellow
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AllowAutoGameMode" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AutoGameModeEnabled" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Write-Host "Modo de Jogo do Windows ativado!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Desativar Game DVR e Game Bar
    Write-Host "O Game DVR e Game Bar podem reduzir o desempenho em jogos. Deseja desativ√°-los?" -ForegroundColor Yellow
    $confirmGameDVR = Read-Host "Desativar Game DVR e Game Bar? (s/n)"
    
    if ($confirmGameDVR -eq 's') {
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "UseNexusForGameBarEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\System\GameConfigStore" -Name "GameDVR_Enabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR" -Name "AppCaptureEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Write-Host "Game DVR e Game Bar desativados!" -ForegroundColor Green
    } else {
        Write-Host "Game DVR e Game Bar mantidos ativos." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Otimizar Plano de Energia para Jogos
    Write-Host "Configurando plano de energia para alto desempenho (ideal para jogos)..." -ForegroundColor Yellow
    powercfg.exe /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c
    Write-Host "Plano de energia configurado para alto desempenho!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Configura√ß√µes de Mouse
    Write-Host "Otimizando configura√ß√µes de mouse para jogos (precis√£o do ponteiro)..." -ForegroundColor Yellow
    $confirmMouseFix = Read-Host "Desativar a acelera√ß√£o do mouse para melhor precis√£o em jogos? (s/n)"
    
    if ($confirmMouseFix -eq 's') {
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseSpeed" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold1" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold2" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Write-Host "Acelera√ß√£o do mouse desativada para melhor precis√£o em jogos!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do mouse mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Otimizar Prioridade de CPU para Jogos
    Write-Host "Configurando prioridade de CPU para jogos..." -ForegroundColor Yellow
    Write-Host "Esta configura√ß√£o ajusta o sistema para dar mais prioridade aos jogos." -ForegroundColor DarkGray
    
    # Criar chave de registro para prioridade de jogos
    if (-not (Test-Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games")) {
        New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Force | Out-Null
    }
    
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "GPU Priority" -Type DWord -Value 8 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Priority" -Type DWord -Value 6 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Scheduling Category" -Type String -Value "High" -Force -ErrorAction SilentlyContinue
    
    Write-Host "Prioridade de CPU para jogos otimizada!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Verificar Driver de Placa de V√≠deo
    Write-Host "Verificando informa√ß√µes da placa de v√≠deo..." -ForegroundColor Yellow
    $gpuInfo = Get-WmiObject -Class Win32_VideoController | Select-Object Name, DriverVersion, CurrentHorizontalResolution, CurrentVerticalResolution
    
    foreach ($gpu in $gpuInfo) {
        Write-Host "Placa de v√≠deo: $($gpu.Name)" -ForegroundColor White
        Write-Host "Vers√£o do driver: $($gpu.DriverVersion)" -ForegroundColor White
        Write-Host "Resolu√ß√£o atual: $($gpu.CurrentHorizontalResolution) x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
      x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
    
    Write-Host "Recomenda√ß√£o: Mantenha seus drivers de v√≠deo atualizados para melhor desempenho em jogos!" -ForegroundColor Green
    Write-Host "Voc√™ pode baixar os drivers mais recentes nos sites oficiais da NVIDIA, AMD ou Intel." -ForegroundColor DarkGray
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nOtimiza√ß√µes para jogos conclu√≠das! Seus jogos devem rodar mais suaves agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleSecurityMaintenance {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Manuten√ß√£o de Seguran√ßa (Simplificado): Mantenha seu PC protegido! ---" -ForegroundColor DarkYellow
    Write-Host "Vamos verificar e melhorar a seguran√ßa do seu sistema com alguns ajustes simples." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Verificar Status do Windows Defender
    Write-Host "Verificando status do Windows Defender..." -ForegroundColor Yellow
    $defenderStatus = Get-MpComputerStatus
    
    Write-Host "Status do Windows Defender:" -ForegroundColor White
    Write-Host "Antiv√≠rus habilitado: $($defenderStatus.AntivirusEnabled)" -ForegroundColor $(if ($defenderStatus.AntivirusEnabled) { "Green" } else { "Red" })
    Write-Host "Prote√ß√£o em tempo real: $($defenderStatus.RealTimeProtectionEnabled)" -ForegroundColor $(if ($defenderStatus.RealTimeProtectionEnabled) { "Green" } else { "Red" })
    Write-Host "Defini√ß√µes de antiv√≠rus: $($defenderStatus.AntivirusSignatureVersion)" -ForegroundColor White
    Write-Host "√öltima atualiza√ß√£o: $($defenderStatus.AntivirusSignatureLastUpdated)" -ForegroundColor White
    Write-Host ""

    # Comando 2: Atualizar Defini√ß√µes do Windows Defender
    Write-Host "Atualizando defini√ß√µes do Windows Defender..." -ForegroundColor Yellow
    Update-MpSignature -ErrorAction SilentlyContinue
    Write-Host "Defini√ß√µes do Windows Defender atualizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Verificar Atualiza√ß√µes do Windows
    Write-Host "Verificando status das atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
            Write-Host "Recomenda√ß√£o: Execute o Windows Update para manter seu sistema seguro." -ForegroundColor Green
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Verificar Configura√ß√µes de Firewall
    Write-Host "Verificando status do Firewall do Windows..." -ForegroundColor Yellow
    $firewallStatus = Get-NetFirewallProfile
    
    foreach ($profile in $firewallStatus) {
        Write-Host "Perfil: $($profile.Name)" -ForegroundColor White
        Write-Host "Status: $($profile.Enabled)" -ForegroundColor $(if ($profile.Enabled) { "Green" } else { "Red" })
        Write-Host ""
    }
    
    $confirmFirewall = Read-Host "Deseja habilitar o Firewall em todos os perfis? (s/n)"
    if ($confirmFirewall -eq 's') {
        Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True
        Write-Host "Firewall habilitado em todos os perfis!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do Firewall mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Verificar Configura√ß√µes de UAC
    Write-Host "Verificando configura√ß√µes do Controle de Conta de Usu√°rio (UAC)..." -ForegroundColor Yellow
    $uacLevel = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -ErrorAction SilentlyContinue
    
    if ($uacLevel) {
        switch ($uacLevel.ConsentPromptBehaviorAdmin) {
            0 { $uacStatus = "Desativado (N√£o recomendado)" }
            1 { $uacStatus = "Baixo (N√£o recomendado)" }
            2 { $uacStatus = "M√©dio" }
            5 { $uacStatus = "Alto (Recomendado)" }
            default { $uacStatus = "Personalizado" }
        }
        
        Write-Host "N√≠vel atual do UAC: $uacStatus" -ForegroundColor $(if ($uacLevel.ConsentPromptBehaviorAdmin -ge 2) { "Green" } else { "Red" })
        
        $confirmUAC = Read-Host "Deseja configurar o UAC para o n√≠vel recomendado? (s/n)"
        if ($confirmUAC -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -Value 5 -Type DWord -Force -ErrorAction SilentlyContinue
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "PromptOnSecureDesktop" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
            Write-Host "UAC configurado para o n√≠vel recomendado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do UAC mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do UAC." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 6: Verificar Configura√ß√µes de SmartScreen
    Write-Host "Verificando configura√ß√µes do Windows SmartScreen..." -ForegroundColor Yellow
    $smartScreen = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -ErrorAction SilentlyContinue
    
    if ($smartScreen) {
        Write-Host "Status do SmartScreen: $($smartScreen.SmartScreenEnabled)" -ForegroundColor $(if ($smartScreen.SmartScreenEnabled -eq "RequireAdmin" -or $smartScreen.SmartScreenEnabled -eq "Warn") { "Green" } else { "Red" })
        
        $confirmSmartScreen = Read-Host "Deseja habilitar o SmartScreen para maior seguran√ßa? (s/n)"
        if ($confirmSmartScreen -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -Value "RequireAdmin" -Type String -Force -ErrorAction SilentlyContinue
            Write-Host "SmartScreen habilitado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do SmartScreen mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do SmartScreen." -ForegroundColor Red
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nManuten√ß√£o de seguran√ßa conclu√≠da! Seu sistema est√° mais protegido agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

# --- Fun√ß√µes para o Diagn√≥stico R√°pido e Sobre ---
function Invoke-QuickDiagnostic {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Diagn√≥stico R√°pido do Sistema ---" -ForegroundColor Yellow
    Write-Host "Vamos fazer uma verifica√ß√£o r√°pida do estado atual do seu PC." -ForegroundColor Gray
    Write-Host ""

    # Informa√ß√µes do Sistema
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    $sysInfo = Get-SystemInfo
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host ""

    # Uso de CPU
    Write-Host "=== Uso de CPU ===" -ForegroundColor Cyan
    $cpuLoad = (Get-WmiObject Win32_Processor).LoadPercentage
    Write-Host "Uso atual de CPU: $cpuLoad%" -ForegroundColor $(if ($cpuLoad -lt 70) { "Green" } elseif ($cpuLoad -lt 90) { "Yellow" } else { "Red" })
    Write-Host ""

    # Uso de Mem√≥ria
    Write-Host "=== Uso de Mem√≥ria ===" -ForegroundColor Cyan
    $os = Get-WmiObject Win32_OperatingSystem
    $totalMemory = [math]::Round($os.TotalVisibleMemorySize / 1MB, 2)
    $freeMemory = [math]::Round($os.FreePhysicalMemory / 1MB, 2)
    $usedMemory = [math]::Round($totalMemory - $freeMemory, 2)
    $memoryPercentage = [math]::Round(($usedMemory / $totalMemory) * 100, 2)
    
    Write-Host "Mem√≥ria Total: $totalMemory GB" -ForegroundColor White
    Write-Host "Mem√≥ria Usada: $usedMemory GB ($memoryPercentage%)" -ForegroundColor $(if ($memoryPercentage -lt 70) { "Green" } elseif ($memoryPercentage -lt 90) { "Yellow" } else { "Red" })
    Write-Host "Mem√≥ria Livre: $freeMemory GB" -ForegroundColor White
    Write-Host ""

    # Espa√ßo em Disco
    Write-Host "=== Espa√ßo em Disco ===" -ForegroundColor Cyan
    $drives = Get-PSDrive -PSProvider FileSystem
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        $percentFree = [math]::Round(($freeSpace / $totalSpace) * 100, 2)
        
        Write-Host "Drive $($drive.Name):" -ForegroundColor White
        Write-Host "  Total: $totalSpace GB" -ForegroundColor White
        Write-Host "  Usado: $usedSpace GB" -ForegroundColor White
        Write-Host "  Livre: $freeSpace GB ($percentFree%)" -ForegroundColor $(if ($percentFree -gt 20) { "Green" } elseif ($percentFree -gt 10) { "Yellow" } else { "Red" })
    }
    Write-Host ""

    # Processos que mais consomem recursos
    Write-Host "=== Top 5 Processos (CPU) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object CPU -Descending | Select-Object -First 5 ProcessName, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}}, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host ""

    Write-Host "=== Top 5 Processos (Mem√≥ria) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 5 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}}, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}} | Format-Table -AutoSize
    Write-Host ""

    # Status de Servi√ßos Cr√≠ticos
    Write-Host "=== Status de Servi√ßos Cr√≠ticos ===" -ForegroundColor Cyan
    $criticalServices = @("wuauserv", "WinDefend", "MpsSvc", "wscsvc")
    foreach ($service in $criticalServices) {
        $serviceStatus = Get-Service -Name $service -ErrorAction SilentlyContinue
        if ($serviceStatus) {
            Write-Host "$($serviceStatus.DisplayName): $($serviceStatus.Status)" -ForegroundColor $(if ($serviceStatus.Status -eq "Running") { "Green" } else { "Red" })
        }
    }
    Write-Host ""

    # Verificar Atualiza√ß√µes Pendentes
    Write-Host "=== Atualiza√ß√µes do Windows ===" -ForegroundColor Cyan
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Recomenda√ß√µes
    Write-Host "=== Recomenda√ß√µes ===" -ForegroundColor Cyan
    
    # Recomenda√ß√£o de Mem√≥ria
    if ($memoryPercentage -gt 80) {
        Write-Host "- Seu uso de mem√≥ria est√° alto. Considere fechar alguns programas ou usar a op√ß√£o 'Otimiza√ß√£o de Mem√≥ria'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Disco
    $lowDiskSpace = $false
    foreach ($drive in $drives) {
        $percentFree = [math]::Round(($drive.Free / ($drive.Free + $drive.Used)) * 100, 2)
        if ($percentFree -lt 15) {
            $lowDiskSpace = $true
            break
        }
    }
    
    if ($lowDiskSpace) {
        Write-Host "- Espa√ßo em disco baixo detectado. Considere usar a op√ß√£o 'Limpeza Geral do Sistema'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Atualiza√ß√µes
    if ($pendingUpdates -gt 0) {
        Write-Host "- Existem atualiza√ß√µes pendentes. Recomendamos atualizar seu sistema para maior seguran√ßa." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Inicializa√ß√£o
    $bootTime = $sysInfo.LastBootTime
    $uptime = (Get-Date) - $bootTime
    if ($uptime.Days -gt 7) {
        Write-Host "- Seu sistema est√° ligado h√° $($uptime.Days) dias. Considere reiniciar para aplicar atualiza√ß√µes e limpar a mem√≥ria." -ForegroundColor Yellow
    }
    
    Write-Host ""

    # Mensagem de conclus√£o
    Write-Host "`nDiagn√≥stico r√°pido conclu√≠do! Use as informa√ß√µes acima para decidir quais otimiza√ß√µes fazer." -ForegroundColor Green

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

function Show-AboutTORK {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Sobre o TORK ---" -ForegroundColor White
    Write-Host ""
    
    Write-Host "TORK - Otimizador para Windows" -ForegroundColor Cyan
    Write-Host "Vers√£o: 2.0" -ForegroundColor White
    Write-Host "Desenvolvido por: Partner77" -ForegroundColor White
    Write-Host ""
    
    Write-Host "=== Descri√ß√£o ===" -ForegroundColor Yellow
    Write-Host "O TORK √© uma ferramenta abrangente de otimiza√ß√£o para Windows, projetada para" -ForegroundColor Gray
    Write-Host "melhorar o desempenho do seu sistema atrav√©s de limpeza, ajustes e otimiza√ß√µes." -ForegroundColor Gray
    Write-Host "Ele oferece op√ß√µes simplificadas para usu√°rios comuns e op√ß√µes avan√ßadas para" -ForegroundColor Gray
    Write-Host "usu√°rios experientes que desejam um controle mais detalhado sobre o sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Recursos ===" -ForegroundColor Yellow
    Write-Host "- Limpeza completa do sistema" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√£o de mem√≥ria e inicializa√ß√£o" -ForegroundColor Gray
    Write-Host "- Ajustes de rede para melhor conectividade" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√µes visuais para melhor desempenho" -ForegroundColor Gray
    Write-Host "- Configura√ß√µes espec√≠ficas para jogos" -ForegroundColor Gray
    Write-Host "- Manuten√ß√£o de seguran√ßa" -ForegroundColor Gray
    Write-Host "- Diagn√≥stico r√°pido do sistema" -ForegroundColor Gray
    Write-Host "- Mais de 100 ajustes e otimiza√ß√µes avan√ßadas" -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Aviso Legal ===" -ForegroundColor Yellow
    Write-Host "Este software √© fornecido 'como est√°', sem garantias de qualquer tipo." -ForegroundColor Gray
    Write-Host "O autor n√£o se responsabiliza por quaisquer danos ou problemas causados pelo uso" -ForegroundColor Gray
    Write-Host "deste software. Use por sua conta e risco. Recomendamos sempre fazer backup" -ForegroundColor Gray
    Write-Host "dos seus dados importantes antes de realizar otimiza√ß√µes no sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Agradecimentos ===" -ForegroundColor Yellow
    Write-Host "Obrigado por escolher o TORK para otimizar seu sistema Windows!" -ForegroundColor Gray
    Write-Host "Esperamos que esta ferramenta ajude a melhorar o desempenho do seu PC." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "¬© 2023-2024 Partner77 - Todos os direitos reservados" -ForegroundColor Cyan
    Write-Host ""
    
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - LIMPEZA (Expandidas) ---
function Invoke-CleanUserTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Usu√°rio ---" -ForegroundColor Cyan
    Write-Host "Remove arquivos da pasta tempor√°ria do seu usu√°rio (`$env:TEMP`)." -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:TEMP..." -ForegroundColor Yellow
    $tempFiles = Get-ChildItem -Path $env:TEMP -Recurse -ErrorAction SilentlyContinue
    $tempFilesCount = ($tempFiles | Measure-Object).Count
    $tempFilesSize = ($tempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $tempFilesCount arquivos tempor√°rios ocupando aproximadamente $([math]::Round($tempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Sistema ---" -ForegroundColor Gray
    Write-Host "Remove arquivos da pasta tempor√°ria do Windows (`$env:SystemRoot\Temp`)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:SystemRoot\Temp..." -ForegroundColor Yellow
    $systemTempFiles = Get-ChildItem -Path "$env:SystemRoot\Temp" -Recurse -ErrorAction SilentlyContinue
    $systemTempFilesCount = ($systemTempFiles | Measure-Object).Count
    $systemTempFilesSize = ($systemTempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $systemTempFilesCount arquivos tempor√°rios do sistema ocupando aproximadamente $([math]::Round($systemTempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do sistema removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanDnsCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-EmptyRecycleBin {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Esvaziar Lixeira ---" -ForegroundColor Gray
    Write-Host "Esvazia a lixeira do usu√°rio logado." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar tamanho da lixeira antes de esvaziar
    Write-Host "Verificando tamanho da lixeira..." -ForegroundColor Yellow
    
    try {
        $shell = New-Object -ComObject Shell.Application
        $recycleBin = $shell.Namespace(0xA)
        $recycleBinItems = $recycleBin.Items()
        $recycleBinItemCount = $recycleBinItems.Count
        
        Write-Host "A lixeira cont√©m $recycleBinItemCount itens." -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o conte√∫do da lixeira." -ForegroundColor DarkGray
    }
    
    # Esvaziar a lixeira
    Write-Host "Executando: Esvaziando a lixeira..." -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanThumbnailCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Miniaturas ---" -ForegroundColor Green
    Write-Host "Remove o cache de miniaturas de arquivos (imagens, v√≠deos, etc.)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Limpando cache de miniaturas..." -ForegroundColor Yellow
    
    # Verificar tamanho do cache de miniaturas antes da limpeza
    $thumbnailPath = "$env:LOCALAPPDATA\Microsoft\Windows\Explorer"
    $thumbnailFiles = Get-ChildItem -Path $thumbnailPath -Filter "thumbcache_*.db" -ErrorAction SilentlyContinue
    $thumbnailFilesCount = ($thumbnailFiles | Measure-Object).Count
    $thumbnailFilesSize = ($thumbnailFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $thumbnailFilesCount arquivos de cache de miniaturas ocupando aproximadamente $([math]::Round($thumbnailFilesSize, 2)) MB." -ForegroundColor White
    
    # Limpar o cache de miniaturas
    Stop-Process -Name explorer -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Start-Process explorer
    
    Write-Host "Cache de miniaturas limpo com sucesso!" -ForegroundColor Green
    Write-Host "O Windows Explorer foi reiniciado para aplicar as altera√ß√µes." -ForegroundColor DarkGray
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de miniaturas:" -ForegroundColor Cyan
    Write-Host "- Navega√ß√£o mais r√°pida em pastas com muitas imagens ou v√≠deos" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de miniaturas corrompidas ou desatualizadas" -ForegroundColor DarkGray
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemLogs {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Logs do Sistema ---" -ForegroundColor Cyan
    Write-Host "Limpa os logs de eventos do sistema para liberar espa√ßo e melhorar o desempenho." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando logs do sistema..." -ForegroundColor Yellow
    
    # Verificar tamanho dos logs antes da limpeza
    $eventLogs = Get-WinEvent -ListLog * -ErrorAction SilentlyContinue | Where-Object { $_.RecordCount -gt 0 }
    $totalLogCount = ($eventLogs | Measure-Object).Count
    $total = ($eventLogs | Measure-Object -Property FileSize -Sum).Sum / 1MB
    
    Write-Host "Encontrados $totalLogCount logs de eventos ocupando aproximadamente $([math]::Round($total, 2)) MB." -ForegroundColor White
    
    # Limpar os logs principais
    Write-Host "Limpando logs principais do sistema..." -ForegroundColor Yellow
    
    $mainLogs = @("Application", "System", "Security")
    foreach ($log in $mainLogs) {
        try {
            $logSize = (Get-WinEvent -ListLog $log -ErrorAction SilentlyContinue).FileSize / 1MB
            $logRecords = (Get-WinEvent -ListLog $log -ErrorAction SilentlyContinue).RecordCount
            
            Write-Host "Log $log: $([math]::Round($logSize, 2)) MB com $logRecords registros" -ForegroundColor DarkGray
            wevtutil cl $log
            Write-Host "Log $log limpo com sucesso!" -ForegroundColor Green
        } catch {
            Write-Host "N√£o foi poss√≠vel limpar o log $log." -ForegroundColor Red
        }
    }
    
    # Perguntar se deseja limpar todos os outros logs
    $confirmAllLogs = Read-Host "Deseja limpar todos os outros logs do sistema? (s/n)"
    
    if ($confirmAllLogs -eq 's') {
        Write-Host "Limpando todos os logs do sistema... (isso pode levar algum tempo)" -ForegroundColor Yellow
        
        $otherLogs = $eventLogs | Where-Object { $_.LogName -notin $mainLogs }
        foreach ($log in $otherLogs) {
            try {
                wevtutil cl $log.LogName
            } catch {
                # Ignorar erros silenciosamente
            }
        }
        
        Write-Host "Todos os logs do sistema foram limpos!" -ForegroundColor Green
    } else {
        Write-Host "Apenas os logs principais foram limpos." -ForegroundColor Green
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanWindowsUpdateCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Atualiza√ß√µes do Windows ---" -ForegroundColor Yellow
    Write-Host "Limpa os arquivos tempor√°rios de atualiza√ß√µes do Windows para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando cache de atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    
    # Verificar tamanho da pasta SoftwareDistribution antes da limpeza
    $updateCachePath = "$env:SystemRoot\SoftwareDistribution\Download"
    $updateCacheFiles = Get-ChildItem -Path $updateCachePath -Recurse -ErrorAction SilentlyContinue
    $updateCacheSize = ($updateCacheFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "O cache de atualiza√ß√µes do Windows est√° ocupando aproximadamente $([math]::Round($updateCacheSize, 2)) MB." -ForegroundColor White
    
    # Parar o servi√ßo Windows Update
    Write-Host "Parando o servi√ßo Windows Update..." -ForegroundColor DarkGray
    Stop-Service -Name wuauserv -Force -ErrorAction SilentlyContinue
    
    # Limpar o cache de atualiza√ß√µes
    Write-Host "Limpando o cache de atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    
    # Iniciar o servi√ßo Windows Update novamente
    Write-Host "Iniciando o servi√ßo Windows Update..." -ForegroundColor DarkGray
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    
    Write-Host "Cache de atualiza√ß√µes do Windows limpo com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de atualiza√ß√µes:" -ForegroundColor Cyan
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray
    Write-Host "- Resolu√ß√£o de problemas com atualiza√ß√µes do Windows" -ForegroundColor DarkGray
    Write-Host "- Melhoria no desempenho do sistema" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanHibernationFile {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos de Hiberna√ß√£o ---" -ForegroundColor White
    Write-Host "Gerencia o arquivo de hiberna√ß√£o (hiberfil.sys) para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar status atual da hiberna√ß√£o
    Write-Host "Verificando status atual da hiberna√ß√£o..." -ForegroundColor Yellow
    $hibernationStatus = powercfg.exe /availablesleepstates | Select-String -Pattern "Hiberna√ß√£o"
    
    if ($hibernationStatus -match "Hiberna√ß√£o est√° desativada") {
        $currentStatus = "desativada"
    } else {
        $currentStatus = "ativada"
    }
    
    Write-Host "Status atual da hiberna√ß√£o: $currentStatus" -ForegroundColor White
    
    # Verificar tamanho do arquivo de hiberna√ß√£o (se existir)
    $systemDrive = $env:SystemDrive
    $hiberfilPath = "$systemDrive\hiberfil.sys"
    
    if (Test-Path -Path $hiberfilPath -ErrorAction SilentlyContinue) {
        try {
            $hiberfilSize = (Get-Item -Path $hiberfilPath -Force -ErrorAction SilentlyContinue).Length / 1GB
            Write-Host "Tamanho do arquivo de hiberna√ß√£o: $([math]::Round($hiberfilSize, 2)) GB" -ForegroundColor White
        } catch {
            Write-Host "N√£o foi poss√≠vel determinar o tamanho do arquivo de hiberna√ß√£o." -ForegroundColor DarkGray
        }
    } else {
        Write-Host "Arquivo de hiberna√ß√£o n√£o encontrado (j√° est√° desativado)." -ForegroundColor DarkGray
    }
    
    # Perguntar se deseja desativar ou ativar a hiberna√ß√£o
    if ($currentStatus -eq "ativada") {
        $confirmHibernation = Read-Host "Deseja desativar a hiberna√ß√£o para liberar espa√ßo em disco? (s/n)"
        
        if ($confirmHibernation -eq 's') {
            Write-Host "Desativando a hiberna√ß√£o..." -ForegroundColor Yellow
            powercfg.exe /hibernate off
            Write-Host "Hiberna√ß√£o desativada com sucesso! O arquivo hiberfil.sys foi removido." -ForegroundColor Green
        } else {
            Write-Host "Hiberna√ß√£o mantida ativada." -ForegroundColor Green
        }
    } else {
        $confirmHibernation = Read-Host "Deseja ativar a hiberna√ß√£o? (s/n)"
        
        if ($confirmHibernation -eq 's') {
            Write-Host "Ativando a hiberna√ß√£o..." -ForegroundColor Yellow
            powercfg.exe /hibernate on
            Write-Host "Hiberna√ß√£o ativada com sucesso! O arquivo hiberfil.sys foi criado." -ForegroundColor Green
            
            # Verificar novo tamanho do arquivo de hiberna√ß√£o
            if (Test-Path -Path $hiberfilPath -ErrorAction SilentlyContinue) {
                try {
                    $newHiberfilSize = (Get-Item -Path $hiberfilPath -Force -ErrorAction SilentlyContinue).Length / 1GB
                    Write-Host "Tamanho do novo arquivo de hiberna√ß√£o: $([math]::Round($newHiberfilSize, 2)) GB" -ForegroundColor White
                } catch {
                    Write-Host "N√£o foi poss√≠vel determinar o tamanho do novo arquivo de hiberna√ß√£o." -ForegroundColor DarkGray
                }
            }
        } else {
            Write-Host "Hiberna√ß√£o mantida desativada." -ForegroundColor Green
        }
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo foi afetado:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nInforma√ß√µes sobre a hiberna√ß√£o:" -ForegroundColor Cyan
    Write-Host "- O arquivo de hiberna√ß√£o (hiberfil.sys) geralmente ocupa espa√ßo equivalente a 75% da RAM instalada" -ForegroundColor DarkGray
    Write-Host "- Desativar a hiberna√ß√£o libera esse espa√ßo, mas voc√™ n√£o poder√° usar o modo de hiberna√ß√£o" -ForegroundColor DarkGray
    Write-Host "- A hiberna√ß√£o √© √∫til para laptops, pois salva o estado do sistema no disco antes de desligar" -ForegroundColor DarkGray
    Write-Host "- Para desktops, a hiberna√ß√£o geralmente √© menos necess√°ria" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanWinSxS {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Pasta WinSxS ---" -ForegroundColor Magenta
    Write-Host "Limpa componentes n√£o utilizados da pasta WinSxS para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "A pasta WinSxS (Windows Side-by-Side) armazena componentes do sistema e pode ocupar muito espa√ßo." -ForegroundColor White
    Write-Host "Esta limpeza √© segura e usa ferramentas oficiais do Windows para remover componentes n√£o utilizados." -ForegroundColor White
    Write-Host ""
    
    # Verificar tamanho da pasta WinSxS antes da limpeza
    Write-Host "Verificando tamanho da pasta WinSxS (isso pode levar algum tempo)..." -ForegroundColor Yellow
    
    try {
        $winSxSSize = (Get-ChildItem -Path "$env:SystemRoot\WinSxS" -Recurse -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum / 1GB
        Write-Host "Tamanho atual da pasta WinSxS: $([math]::Round($winSxSSize, 2)) GB" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel determinar o tamanho da pasta WinSxS." -ForegroundColor DarkGray
    }
    
    # Perguntar se deseja prosseguir com a limpeza
    $confirmCleanup = Read-Host "Deseja prosseguir com a limpeza da pasta WinSxS? (s/n)"
    
    if ($confirmCleanup -eq 's') {
        Write-Host "Executando limpeza de componentes n√£o utilizados (isso pode levar v√°rios minutos)..." -ForegroundColor Yellow
        
        # Executar limpeza de componentes
        Write-Host "Etapa 1: Limpeza de componentes..." -ForegroundColor DarkGray
        Dism.exe /Online /Cleanup-Image /StartComponentCleanup
        
        # Perguntar se deseja executar limpeza mais agressiva (com reset base)
        $confirmResetBase = Read-Host "Deseja executar uma limpeza mais profunda? (remove a capacidade de desinstalar atualiza√ß√µes) (s/n)"
        
        if ($confirmResetBase -eq 's') {
            Write-Host "Etapa 2: Executando limpeza profunda (isso pode levar muito tempo)..." -ForegroundColor DarkGray
            Dism.exe /Online /Cleanup-Image /StartComponentCleanup /ResetBase
            Write-Host "Limpeza profunda conclu√≠da!" -ForegroundColor Green
        }
        
        Write-Host "Limpeza da pasta WinSxS conclu√≠da com sucesso!" -ForegroundColor Green
        
        # Verificar tamanho da pasta WinSxS ap√≥s a limpeza
        try {
            $newWinSxSSize = (Get-ChildItem -Path "$env:SystemRoot\WinSxS" -Recurse -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum / 1GB
            $savedSpace = $winSxSSize - $newWinSxSSize
            
            Write-Host "Tamanho atual da pasta WinSxS: $([math]::Round($newWinSxSSize, 2)) GB" -ForegroundColor White
            Write-Host "Espa√ßo liberado: $([math]::Round($savedSpace, 2)) GB" -ForegroundColor Green
        } catch {
            Write-Host "N√£o foi poss√≠vel determinar o novo tamanho da pasta WinSxS." -ForegroundColor DarkGray
        }
    } else {
        Write-Host "Limpeza da pasta WinSxS cancelada." -ForegroundColor Yellow
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nInforma√ß√µes sobre a pasta WinSxS:" -ForegroundColor Cyan
    Write-Host "- A pasta WinSxS armazena componentes do sistema Windows e atualiza√ß√µes" -ForegroundColor DarkGray
    Write-Host "- N√£o √© recomendado excluir esta pasta manualmente" -ForegroundColor DarkGray
    Write-Host "- A limpeza realizada √© segura e usa ferramentas oficiais do Windows" -ForegroundColor DarkGray
    Write-Host "- Ap√≥s a limpeza profunda, n√£o ser√° poss√≠vel desinstalar algumas atualiza√ß√µes" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - REDE (Expandidas) ---
function Invoke-NetworkFlushDns {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Limpar Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-NetworkChangeDns {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Mudar Servidor DNS ---" -ForegroundColor Cyan
    Write-Host "Permite definir servidores DNS personalizados para suas conex√µes de rede." -ForegroundColor DarkGray
    Write-Host ""

    # Listar adaptadores de rede ativos
    Write-Host "Listando adaptadores de rede ativos..." -ForegroundColor Yellow
    $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" }
    
    if ($networkAdapters.Count -eq 0) {
        Write-Host "Nenhum adaptador de rede ativo encontrado." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    Write-Host "Adaptadores de rede ativos:" -ForegroundColor White
    $index = 1
    foreach ($adapter in $networkAdapters) {
        Write-Host "[$index] $($adapter.Name) - $($adapter.InterfaceDescription)" -ForegroundColor White
        $index++
    }
    Write-Host ""
    
    # Selecionar adaptador de rede
    $adapterChoice = Read-Host "Selecione o n√∫mero do adaptador que deseja configurar (ou 0 para voltar)"
    
    if ($adapterChoice -eq "0" -or $adapterChoice -eq "") {
        Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    $adapterIndex = [int]$adapterChoice - 1
    if ($adapterIndex -lt 0 -or $adapterIndex -ge $networkAdapters.Count) {
        Write-Host "Sele√ß√£o inv√°lida." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    $selectedAdapter = $networkAdapters[$adapterIndex]
    
    # Mostrar configura√ß√£o DNS atual
    Write-Host "Configura√ß√£o DNS atual para $($selectedAdapter.Name):" -ForegroundColor Yellow
    $currentDns = Get-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -AddressFamily IPv4 | Select-Object -ExpandProperty ServerAddresses
    
    if ($currentDns.Count -eq 0) {
        Write-Host "Nenhum servidor DNS configurado manualmente (usando DHCP)." -ForegroundColor DarkGray
    } else {
        foreach ($dns in $currentDns) {
            Write-Host $dns -ForegroundColor White
        }
    }
    Write-Host ""
    
    # Op√ß√µes de DNS
    Write-Host "Op√ß√µes de DNS:" -ForegroundColor Yellow
    Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
    Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
    Write-Host "[3] OpenDNS (208.67.222.222, 208.67.220.220)" -ForegroundColor White
    Write-Host "[4] Quad9 (9.9.9.9, 149.112.112.112)" -ForegroundColor White
    Write-Host "[5] AdGuard DNS (94.140.14.14, 94.140.15.15)" -ForegroundColor White
    Write-Host "[6] Inserir DNS personalizado" -ForegroundColor White
    Write-Host "[7] Usar DNS autom√°tico (DHCP)" -ForegroundColor White
    Write-Host "[0] Cancelar" -ForegroundColor White
    Write-Host ""
    
    $dnsChoice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($dnsChoice) {
        "1" {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            $dnsName = "Google DNS"
        }
        "2" {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            $dnsName = "Cloudflare DNS"
        }
        "3" {
            $primaryDns = "208.67.222.222"
            $secondaryDns = "208.67.220.220"
            $dnsName = "OpenDNS"
        }
        "4" {
            $primaryDns = "9.9.9.9"
            $secondaryDns = "149.112.112.112"
            $dnsName = "Quad9"
        }
        "5" {
            $primaryDns = "94.140.14.14"
            $secondaryDns = "94.140.15.15"
            $dnsName = "AdGuard DNS"
        }
        "6" {
            $primaryDns = Read-Host "Digite o endere√ßo do DNS prim√°rio"
            $secondaryDns = Read-Host "Digite o endere√ßo do DNS secund√°rio (ou deixe em branco)"
            $dnsName = "DNS Personalizado"
        }
        "7" {
            Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ResetServerAddresses
            Write-Host "Configura√ß√£o de DNS definida para autom√°tica (DHCP)." -ForegroundColor Green
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
        "0" {
            Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
        default {
            Write-Host "Op√ß√£o inv√°lida." -ForegroundColor Red
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
    }
    
    # Aplicar configura√ß√£o de DNS
    if ($secondaryDns -eq "") {
        Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ServerAddresses $primaryDns
    } else {
        Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ServerAddresses $primaryDns, $secondaryDns
    }
    
    Write-Host "Configura√ß√£o de DNS alterada para $dnsName." -ForegroundColor Green
    Write-Host "DNS Prim√°rio: $primaryDns" -ForegroundColor White
    if ($secondaryDns -ne "") {
        Write-Host "DNS Secund√°rio: $secondaryDns" -ForegroundColor White
    }
    
    # Limpar cache DNS ap√≥s a mudan√ßa
    Write-Host "Limpando cache DNS para aplicar as altera√ß√µes..." -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo." -ForegroundColor Green
    
    Write-Host "`nBenef√≠cios de usar servidores DNS alternativos:" -ForegroundColor Cyan
    Write-Host "- Maior velocidade de resolu√ß√£o de nomes" -ForegroundColor DarkGray
    Write-Host "- Melhor confiabilidade e disponibilidade" -ForegroundColor DarkGray
    Write-Host "- Alguns servidores oferecem prote√ß√£o adicional contra malware e phishing" -ForegroundColor DarkGray
    Write-Host "- Possibilidade de contornar bloqueios de conte√∫do baseados em DNS" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-NetworkReset {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Resetar Configura√ß√µes de Rede ---" -ForegroundColor White
    Write-Host "Reinicia os componentes de rede. Use como √∫ltimo recurso para solucionar problemas de conex√£o." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "!!! ATEN√á√ÉO: ESTE COMANDO VAI REINICIAR SUAS CONFIGURA√á√ïES DE REDE !!!" -ForegroundColor Red
    Write-Host "Sua conex√£o ser√° interrompida temporariamente e todas as configura√ß√µes de rede personalizadas ser√£o redefinidas." -ForegroundColor Yellow
    Write-Host "Isso inclui adaptadores de rede, configura√ß√µes de DNS, configura√ß√µes de proxy, etc." -ForegroundColor Yellow
    Write-Host ""
    
    Write-Host "Esta opera√ß√£o pode ajudar a resolver os seguintes problemas:" -ForegroundColor Cyan
    Write-Host "- Conex√µes de rede inst√°veis ou intermitentes" -ForegroundColor DarkGray
    Write-Host "- Problemas de DNS ou resolu√ß√£o de nomes" -ForegroundColor DarkGray
    Write-Host "- Problemas de conectividade ap√≥s instala√ß√£o de software ou atualiza√ß√µes" -ForegroundColor DarkGray
    Write-Host "- Erros de rede persistentes que n√£o s√£o resolvidos por outros m√©todos" -ForegroundColor DarkGray
    Write-Host ""
    
    $confirm = Read-Host "Tem certeza que deseja resetar as configura√ß√µes de rede? (digite 'sim' para confirmar)"
    
    if ($confirm -eq 'sim') {
        Write-Host "Iniciando reset de configura√ß√µes de rede..." -ForegroundColor Yellow
        
        # Etapa 1: Resetar pilha TCP/IP
        Write-Host "Etapa 1: Resetando pilha TCP/IP..." -ForegroundColor DarkGray
        netsh int ip reset
        
        # Etapa 2: Resetar cat√°logo Winsock
        Write-Host "Etapa 2: Resetando cat√°logo Winsock..." -ForegroundColor DarkGray
        netsh winsock reset
        
        # Etapa 3: Limpar cache DNS
        Write-Host "Etapa 3: Limpando cache DNS..." -ForegroundColor DarkGray
        ipconfig /flushdns
        
        # Etapa 4: Renovar configura√ß√µes DHCP
        Write-Host "Etapa 4: Renovando configura√ß√µes DHCP..." -ForegroundColor DarkGray
        ipconfig /release
        ipconfig /renew
        
        # Etapa 5: Reiniciar adaptadores de rede
        Write-Host "Etapa 5: Reiniciando adaptadores de rede..." -ForegroundColor DarkGray
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        
        Write-Host "Reset de configura√ß√µes de rede conclu√≠do!" -ForegroundColor Green
        Write-Host "Recomenda-se reiniciar o computador para aplicar todas as altera√ß√µes." -ForegroundColor Yellow
        
        $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (s/n)"
        if ($confirmRestart -eq 's') {
            Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
            Restart-Computer -Force
        } else {
            Write-Host "Rein√≠cio cancelado. Algumas altera√ß√µes podem n√£o ter efeito at√© que o computador seja reiniciado." -ForegroundColor Yellow
        }
    } else {
        Write-Host "Reset de configura√ß√µes de rede cancelado." -ForegroundColor Green
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-OptimizeTcpIp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Otimizar Configura√ß√µes TCP/IP ---" -ForegroundColor Green
    Write-Host "Ajusta configura√ß√µes avan√ßadas do TCP/IP para melhorar o desempenho da conex√£o." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o otimiza v√°rios par√¢metros TCP/IP para melhorar a velocidade e estabilidade da conex√£o." -ForegroundColor White
    Write-Host "As otimiza√ß√µes s√£o seguras e podem ser revertidas se necess√°rio." -ForegroundColor White
    Write-Host ""
    
    Write-Host "Configura√ß√µes atuais:" -ForegroundColor Yellow
    
    # Mostrar configura√ß√µes atuais
    Write-Host "Auto-Tuning Level:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Auto-Tuning Level"
    
    Write-Host "Congestion Provider:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Congestion Control Provider"
    
    Write-Host "ECN Capability:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "ECN Capability"
    
    Write-Host "Receive-Side Scaling (RSS):" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Receive-Side Scaling State"
    
    Write-Host ""
    $confirm = Read-Host "Deseja aplicar otimiza√ß√µes TCP/IP recomendadas? (s/n)"
    
    if ($confirm -eq 's') {
        Write-Host "Aplicando otimiza√ß√µes TCP/IP..." -ForegroundColor Yellow
        
        # Otimiza√ß√£o 1: Habilitar TCP Window Auto-Tuning
        Write-Host "Configurando TCP Auto-Tuning para 'normal'..." -ForegroundColor DarkGray
        netsh int tcp set global autotuninglevel=normal
        
        # Otimiza√ß√£o 2: Habilitar Receive-Side Scaling (RSS)
        Write-Host "Habilitando Receive-Side Scaling (RSS)..." -ForegroundColor DarkGray
        netsh int tcp set global rss=enabled
        
        # Otimiza√ß√£o 3: Configurar Congestion Provider para CTCP
        Write-Host "Configurando Congestion Provider para 'ctcp'..." -ForegroundColor DarkGray
        netsh int tcp set global congestionprovider=ctcp
        
        # Otimiza√ß√£o 4: Habilitar ECN Capability
        Write-Host "Habilitando ECN Capability..." -ForegroundColor DarkGray
        netsh int tcp set global ecncapability=enabled
        
        # Otimiza√ß√£o 5: Configurar NetDMA (se dispon√≠vel)
        Write-Host "Tentando configurar NetDMA..." -ForegroundColor DarkGray
        netsh int tcp set global netdma=enabled
        
        # Otimiza√ß√£o 6: Configurar tamanho de buffer TCP
        Write-Host "Configurando tamanho de buffer TCP..." -ForegroundColor DarkGray
        netsh int tcp set global chimney=enabled
        
        # Otimiza√ß√£o 7: Configurar QoS
        Write-Host "Configurando QoS..." -ForegroundColor DarkGray
        netsh int tcp set global timestamps=disabled
        
        Write-Host "Otimiza√ß√µes TCP/IP aplicadas com sucesso!" -ForegroundColor Green
        
        Write-Host "`nNovas configura√ß√µes:" -ForegroundColor Yellow
        
        # Mostrar novas configura√ß√µes
        Write-Host "Auto-Tuning Level:" -ForegroundColor DarkGray
        netsh int tcp show global | Select-String "Auto-Tuning Level"
        
        Write-Host "Congestion Provider:" -ForegroundColor DarkGray
        netsh int tcp show global | Select-String "Congestion Control Provider"
        
        Write-Host "ECN Capability:" -ForegroundColor DarkGray
        netsh int tcp show global | Select-String "ECN Capability"
        
        Write-Host "Receive-Side Scaling (RSS):" -ForegroundColor DarkGray
        netsh int tcp show global | Select-String "Receive-Side Scaling State"
        
        Write-Host "`nBenef√≠cios das otimiza√ß√µes TCP/IP:" -ForegroundColor Cyan
        Write-Host "- Melhor aproveitamento da largura de banda dispon√≠vel" -ForegroundColor DarkGray
        Write-Host "- Redu√ß√£o da lat√™ncia em conex√µes de internet" -ForegroundColor DarkGray
        Write-Host "- Melhor desempenho em downloads e uploads" -ForegroundColor DarkGray
        Write-Host "- Conex√µes mais est√°veis em redes congestionadas" -ForegroundColor DarkGray
        
        Write-Host "`nNota: Algumas altera√ß√µes podem requerer reinicializa√ß√£o para ter efeito completo." -ForegroundColor Yellow
        $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (s/n)"
        
        if ($confirmRestart -eq 's') {
            Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
            Restart-Computer -Force
        }
    } else {
        Write-Host "Otimiza√ß√µes TCP/IP canceladas." -ForegroundColor Yellow
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-CheckNetworkSpeed {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Verificar Velocidade da Conex√£o ---" -ForegroundColor Magenta
    Write-Host "Realiza testes para verificar a velocidade e qualidade da sua conex√£o com a internet." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o realiza testes b√°sicos para avaliar a velocidade e qualidade da sua conex√£o." -ForegroundColor White
    Write-Host "Nota: Para testes de velocidade mais precisos, recomendamos usar sites especializados como speedtest.net" -ForegroundColor White
    Write-Host ""
    
    # Teste 1: Verificar conectividade b√°sica
    Write-Host "Teste 1: Verificando conectividade b√°sica com a internet..." -ForegroundColor Yellow
    $pingGoogle = Test-Connection -ComputerName google.com -Count 4 -ErrorAction SilentlyContinue
    
    if ($pingGoogle) {
        $avgLatency = ($pingGoogle | Measure-Object -Property ResponseTime -Average).Average
        $maxLatency = ($pingGoogle | Measure-Object -Property ResponseTime -Maximum).Maximum
        $minLatency = ($pingGoogle | Measure-Object -Property ResponseTime -Minimum).Minimum
        
        Write-Host "Conectividade: OK" -ForegroundColor Green
        Write-Host "Lat√™ncia m√©dia: $avgLatency ms" -ForegroundColor $(if ($avgLatency -lt 50) { "Green" } elseif ($avgLatency -lt 100) { "Yellow" } else { "Red" })
        Write-Host "Lat√™ncia m√≠nima: $minLatency ms" -ForegroundColor Green
        Write-Host "Lat√™ncia m√°xima: $maxLatency ms" -ForegroundColor $(if ($maxLatency -lt 100) { "Green" } elseif ($maxLatency -lt 200) { "Yellow" } else { "Red" })
        
        # Avalia√ß√£o da qualidade da conex√£o
        if ($avgLatency -lt 30) {
            $qualidade = "Excelente"
            $cor = "Green"
        } elseif ($avgLatency -lt 60) {
            $qualidade = "Boa"
            $cor = "Green"
        } elseif ($avgLatency -lt 100) {
            $qualidade = "Razo√°vel"
            $cor = "Yellow"
        } else {
            $qualidade = "Ruim"
            $cor = "Red"
        }
        
        Write-Host "Qualidade da conex√£o: $qualidade" -ForegroundColor $cor
    } else {
        Write-Host "N√£o foi poss√≠vel conectar √† internet. Verifique sua conex√£o." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    Write-Host ""
    
    # Teste 2: Verificar resolu√ß√£o DNS
    Write-Host "Teste 2: Verificando velocidade de resolu√ß√£o DNS..." -ForegroundColor Yellow
    $domains = @("google.com", "microsoft.com", "amazon.com", "facebook.com", "youtube.com")
    $dnsResults = @()
    
    foreach ($domain in $domains) {
        $startTime = Get-Date
        try {
            $null = Resolve-DnsName -Name $domain -ErrorAction SilentlyContinue
            $endTime = Get-Date
            $timeSpan = New-TimeSpan -Start $startTime -End $endTime
            $dnsResults += [PSCustomObject]@{
                Domain = $domain
                Time = $timeSpan.TotalMilliseconds
                Status = "OK"
            }
        } catch {
            $dnsResults += [PSCustomObject]@{
                Domain = $domain
                Time = 0
                Status = "Falha"
            }
        }
    }
    
    $dnsResults | Format-Table -AutoSize
    
    $avgDnsTime = ($dnsResults | Where-Object { $_.Status -eq "OK" } | Measure-Object -Property Time -Average).Average
    Write-Host "Tempo m√©dio de resolu√ß√£o DNS: $([math]::Round($avgDnsTime, 2)) ms" -ForegroundColor $(if ($avgDnsTime -lt 50) { "Green" } elseif ($avgDnsTime -lt 100) { "Yellow" } else { "Red" })
    
    Write-Host ""
    
    # Teste 3: Verificar MTU
    Write-Host "Teste 3: Verificando MTU (Maximum Transmission Unit)..." -ForegroundColor Yellow
    
    $activeAdapter = Get-NetAdapter | Where-Object { $_.Status -eq "Up" } | Select-Object -First 1
    if ($activeAdapter) {
        $mtu = Get-NetIPInterface -InterfaceIndex $activeAdapter.ifIndex -AddressFamily IPv4 | Select-Object -ExpandProperty NlMtu
        Write-Host "MTU atual: $mtu bytes" -ForegroundColor White
        
        if ($mtu -eq 1500) {
            Write-Host "MTU est√° no valor padr√£o (1500), que √© ideal para a maioria das conex√µes." -ForegroundColor Green
        } elseif ($mtu -lt 1500) {
            Write-Host "MTU est√° abaixo do valor padr√£o. Isso pode afetar o desempenho em algumas situa√ß√µes." -ForegroundColor Yellow
        } else {
            Write-Host "MTU est√° acima do valor padr√£o. Isso pode causar fragmenta√ß√£o de pacotes em algumas redes." -ForegroundColor Yellow
        }
    } else {
        Write-Host "N√£o foi poss√≠vel determinar o MTU. Nenhum adaptador de rede ativo encontrado." -ForegroundColor Red
    }
    
    Write-Host ""
    
    # Teste 4: Verificar perda de pacotes
    Write-Host "Teste 4: Verificando perda de pacotes..." -ForegroundColor Yellow
    $packetLossTest = Test-Connection -ComputerName google.com -Count 50 -ErrorAction SilentlyContinue
    
    if ($packetLossTest) {
        $packetsSent = 50
        $packetsReceived = ($packetLossTest | Measure-Object).Count
        $packetsLost = $packetsSent - $packetsReceived
        $packetLossPercentage = ($packetsLost / $packetsSent) * 100
        
        Write-Host "Pacotes enviados: $packetsSent" -ForegroundColor White
        Write-Host "Pacotes recebidos: $packetsReceived" -ForegroundColor White
        Write-Host "Pacotes perdidos: $packetsLost" -ForegroundColor $(if ($packetsLost -eq 0) { "Green" } elseif ($packetsLost -lt 5) { "Yellow" } else { "Red" })
        Write-Host "Percentual de perda: $([math]::Round($packetLossPercentage, 2))%" -ForegroundColor $(if ($packetLossPercentage -eq 0) { "Green" } elseif ($packetLossPercentage -lt 10) { "Yellow" } else { "Red" })
        
        # Avalia√ß√£o da qualidade da conex√£o baseada na perda de pacotes
        if ($packetLossPercentage -eq 0) {
            Write-Host "Qualidade da conex√£o (perda de pacotes): Excelente" -ForegroundColor Green
        } elseif ($packetLossPercentage -lt 2) {
            Write-Host "Qualidade da conex√£o (perda de pacotes): Boa" -ForegroundColor Green
        } elseif ($packetLossPercentage -lt 5) {
            Write-Host "Qualidade da conex√£o (perda de pacotes): Razo√°vel" -ForegroundColor Yellow
        } else {
            Write-Host "Qualidade da conex√£o (perda de pacotes): Ruim" -ForegroundColor Red
        }
    } else {
        Write-Host "N√£o foi poss√≠vel realizar o teste de perda de pacotes." -ForegroundColor Red
    }
    
    Write-Host ""
    
    # Resumo e recomenda√ß√µes
    Write-Host "=== Resumo da An√°lise de Rede ===" -ForegroundColor Cyan
    
    # Recomenda√ß√µes baseadas nos resultados
    Write-Host "Recomenda√ß√µes:" -ForegroundColor Yellow
    
    if ($avgLatency -gt 100) {
        Write-Host "- Sua lat√™ncia est√° alta. Considere verificar outros dispositivos na rede ou contatar seu provedor." -ForegroundColor Yellow
    }
    
    if ($avgDnsTime -gt 100) {
        Write-Host "- A resolu√ß√£o DNS est√° lenta. Considere mudar para servidores DNS mais r√°pidos como Google (8.8.8.8) ou Cloudflare (1.1.1.1)." -ForegroundColor Yellow
    }
    
    if ($packetLossPercentage -gt 2) {
        Write-Host "- H√° perda significativa de pacotes. Verifique sua conex√£o f√≠sica ou contate seu provedor." -ForegroundColor Yellow
    }
    
    if ($mtu -ne 1500 -and $mtu -ne 0) {
        Write-Host "- Seu MTU n√£o est√° no valor padr√£o. Considere ajust√°-lo para 1500 para melhor desempenho." -ForegroundColor Yellow
    }
    
    if ($avgLatency -le 100 -and $avgDnsTime -le 100 -and $packetLossPercentage -le 2) {
        Write-Host "- Sua conex√£o parece estar em boas condi√ß√µes! N√£o h√° problemas significativos detectados." -ForegroundColor Green
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-ConfigureQoS {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Configurar QoS (Qualidade de Servi√ßo) ---" -ForegroundColor Gray
    Write-Host "Configura prioridades de tr√°fego de rede para melhorar o desempenho de aplica√ß√µes espec√≠ficas." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "O QoS (Quality of Service) permite priorizar certos tipos de tr√°fego de rede sobre outros." -ForegroundColor White
    Write-Host "Isso √© √∫til para garantir que aplica√ß√µes importantes como jogos, chamadas de v√≠deo ou streaming" -ForegroundColor White
    Write-Host "tenham prioridade sobre downloads ou atualiza√ß√µes em segundo plano." -ForegroundColor White
    Write-Host ""
    
    Write-Host "Op√ß√µes de configura√ß√£o de QoS:" -ForegroundColor Yellow
    Write-Host "[1] Configurar QoS para Jogos (prioriza tr√°fego de jogos)" -ForegroundColor White
    Write-Host "[2] Configurar QoS para Videoconfer√™ncia (prioriza Zoom, Teams, etc.)" -ForegroundColor White
    Write-Host "[3] Configurar QoS para Streaming (prioriza Netflix, YouTube, etc.)" -ForegroundColor White
    Write-Host "[4] Configurar QoS Personalizado" -ForegroundColor White
    Write-Host "[5] Desativar QoS" -ForegroundColor White
    Write-Host "[0] Voltar" -ForegroundColor White
    Write-Host ""
    
    $qosChoice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($qosChoice) {
        "1" {
            Write-Host "Configurando QoS para Jogos..." -ForegroundColor Yellow
            
            # Criar pol√≠tica de QoS para jogos
            Write-Host "Criando pol√≠tica de QoS para jogos..." -ForegroundColor DarkGray
            
            # Verificar se o servi√ßo QoS est√° em execu√ß√£o
            $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            if ($qosService -and $qosService.Status -ne "Running") {
                Write-Host "Iniciando servi√ßo QoS RSVP..." -ForegroundColor DarkGray
                Start-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            }
            
            # Configurar QoS para jogos usando netsh
            netsh advfirewall firewall add rule name="QoS-Games" dir=out action=allow protocol=UDP remoteport=3074,3478,3479,3480 enable=yes
            
            # Configurar prioridade para jogos
            if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS")) {
                New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Force | Out-Null
            }
            
            # Adicionar pol√≠tica para jogos
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Application Name" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Protocol" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Remote Port" -Value "3074,3478-3480" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "DSCP Value" -Value "46" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Throttle Rate" -Value "-1" -Type String
            
            Write-Host "QoS para Jogos configurado com sucesso!" -ForegroundColor Green
            Write-Host "Os jogos online agora ter√£o prioridade sobre outros tipos de tr√°fego." -ForegroundColor Green
        }
        "2" {
            Write-Host "Configurando QoS para Videoconfer√™ncia..." -ForegroundColor Yellow
            
            # Criar pol√≠tica de QoS para videoconfer√™ncia
            Write-Host "Criando pol√≠tica de QoS para videoconfer√™ncia..." -ForegroundColor DarkGray
            
            # Verificar se o servi√ßo QoS est√° em execu√ß√£o
            $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            if ($qosService -and $qosService.Status -ne "Running") {
                Write-Host "Iniciando servi√ßo QoS RSVP..." -ForegroundColor DarkGray
                Start-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            }
            
            # Configurar QoS para videoconfer√™ncia usando netsh
            netsh advfirewall firewall add rule name="QoS-VideoConference" dir=out action=allow protocol=UDP remoteport=3478-3479,8801-8810 enable=yes
            
            # Configurar prioridade para videoconfer√™ncia
            if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS")) {
                New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Force | Out-Null
            }
            
            # Adicionar pol√≠tica para Zoom
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Application Name" -Value "Zoom.exe" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Protocol" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Remote Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "DSCP Value" -Value "46" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Throttle Rate" -Value "-1" -Type String
            
            # Adicionar pol√≠tica para Teams
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Application Name" -Value "Teams.exe" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Protocol" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Remote Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "DSCP Value" -Value "46" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Throttle Rate" -Value "-1" -Type String
            
            Write-Host "QoS para Videoconfer√™ncia configurado com sucesso!" -ForegroundColor Green
            Write-Host "Aplicativos como Zoom e Teams agora ter√£o prioridade sobre outros tipos de tr√°fego." -ForegroundColor Green
        }
        "3" {
            Write-Host "Configurando QoS para Streaming..." -ForegroundColor Yellow
            
            # Criar pol√≠tica de QoS para streaming
            Write-Host "Criando pol√≠tica de QoS para streaming..." -ForegroundColor DarkGray
            
            # Verificar se o servi√ßo QoS est√° em execu√ß√£o
            $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            if ($qosService -and $qosService.Status -ne "Running") {
                Write-Host "Iniciando servi√ßo QoS RSVP..." -ForegroundColor DarkGray
                Start-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            }
            
            # Configurar QoS para streaming usando netsh
            netsh advfirewall firewall add rule name="QoS-Streaming" dir=out action=allow protocol=TCP remoteport=80,443 enable=yes
            
            # Configurar prioridade para streaming
            if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS")) {
                New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Force | Out-Null
            }
            
            # Adicionar pol√≠tica para navegadores (streaming)
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Application Name" -Value "*.exe" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Protocol" -Value "TCP" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Remote Port" -Value "80,443" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "DSCP Value" -Value "34" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Throttle Rate" -Value "-1" -Type String
            
            Write-Host "QoS para Streaming configurado com sucesso!" -ForegroundColor Green
            Write-Host "Servi√ßos de streaming como Netflix e YouTube agora ter√£o prioridade sobre outros tipos de tr√°fego." -ForegroundColor Green
        }
        "4" {
            Write-Host "Configurando QoS Personalizado..." -ForegroundColor Yellow
            
            # Solicitar informa√ß√µes para QoS personalizado
            $appName = Read-Host "Digite o nome do aplicativo (ex: chrome.exe, ou * para todos)"
            $protocol = Read-Host "Digite o protocolo (TCP, UDP, ou * para ambos)"
            $remotePorts = Read-Host "Digite as portas remotas (ex: 80,443, ou * para todas)"
            $priority = Read-Host "Digite o valor de prioridade DSCP (0-63, recomendado: 46 para alta prioridade)"
            
            # Verificar se o servi√ßo QoS est√° em execu√ß√£o
            $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            if ($qosService -and $qosService.Status -ne "Running") {
                Write-Host "Iniciando servi√ßo QoS RSVP..." -ForegroundColor DarkGray
                Start-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            }
            
            # Configurar QoS personalizado
            if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS")) {
                New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Force | Out-Null
            }
            
            # Adicionar pol√≠tica personalizada
            $policyName = "CustomQoS_" + (Get-Random)
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Application Name" -Value $appName -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Protocol" -Value $protocol -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Remote Port" -Value $remotePorts -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "DSCP Value" -Value $priority -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Throttle Rate" -Value "-1" -Type String
            
            Write-Host "QoS Personalizado configurado com sucesso!" -ForegroundColor Green
            Write-Host "A pol√≠tica de QoS personalizada foi criada com o nome: $policyName" -ForegroundColor Green
        }
        "5" {
            Write-Host "Desativando QoS..." -ForegroundColor Yellow
            
            # Remover pol√≠ticas de QoS
            if (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS") {
                Remove-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Recurse -Force
                Write-Host "Pol√≠ticas de QoS removidas." -ForegroundColor Green
            }
            
            # Remover regras de firewall relacionadas a QoS
            netsh advfirewall firewall delete rule name="QoS-Games"
            netsh advfirewall firewall delete rule name="QoS-VideoConference"
            netsh advfirewall firewall delete rule name="QoS-Streaming"
            
            # Parar servi√ßo QoS
            $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            if ($qosService) {
                Stop-Service -Name "QoS RSVP" -Force -ErrorAction SilentlyContinue
                Set-Service -Name "QoS RSVP" -Startup Disabled -ErrorAction SilentlyContinue
                Write-Host "Servi√ßo QoS RSVP parado e desabilitado." -ForegroundColor Green
            }
            
            Write-Host "QoS desativado com sucesso!" -ForegroundColor Green
        }
        "0" {
            Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
        }
        default {
            Write-Host "Op√ß√£o inv√°lida." -ForegroundColor Red
        }
    }
    
    if ($qosChoice -ne "0") {
        Write-Host "`nNota: Algumas altera√ß√µes de QoS podem requerer reinicializa√ß√£o para ter efeito completo." -ForegroundColor Yellow
        $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (s/n)"
        
        if ($confirmRestart -eq 's') {
            Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
            Restart-Computer -Force
        }
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-DisableIPv6 {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Desativar IPv6 ---" -ForegroundColor Yellow
    Write-Host "Desativa o protocolo IPv6 em adaptadores de rede para resolver problemas de conectividade." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "O IPv6 √© o protocolo de internet mais recente, mas em algumas redes pode causar problemas de conectividade." -ForegroundColor White
    Write-Host "Desativar o IPv6 pode resolver problemas em redes que n√£o o suportam adequadamente." -ForegroundColor White
    Write-Host "Nota: Desativar o IPv6 n√£o √© recomendado a menos que voc√™ esteja enfrentando problemas espec√≠ficos." -ForegroundColor Yellow
    Write-Host ""
    
    # Verificar status atual do IPv6
    Write-Host "Verificando status atual do IPv6..." -ForegroundColor Yellow
    
    $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" }
    
    if ($networkAdapters.Count -eq 0) {
        Write-Host "Nenhum adaptador de rede ativo encontrado." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    Write-Host "Status do IPv6 nos adaptadores de rede ativos:" -ForegroundColor White
    
    foreach ($adapter in $networkAdapters) {
        $ipv6Status = Get-NetAdapterBinding -InterfaceAlias $adapter.Name -ComponentID "ms_tcpip6"
        $status = if ($ipv6Status.Enabled) { "Ativado" } else { "Desativado" }
        $statusColor = if ($ipv6Status.Enabled) { "Green" } else { "Yellow" }
        
        Write-Host "$($adapter.Name): $status" -ForegroundColor $statusColor
    }
    
    Write-Host ""
    Write-Host "Op√ß√µes:" -ForegroundColor Yellow
    Write-Host "[1] Desativar IPv6 em todos os adaptadores" -ForegroundColor White
    Write-Host "[2] Ativar IPv6 em todos os adaptadores" -ForegroundColor White
    Write-Host "[3] Gerenciar IPv6 em adaptadores espec√≠ficos" -ForegroundColor White
    Write-Host "[0] Voltar" -ForegroundColor White
    Write-Host ""
    
    $ipv6Choice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($ipv6Choice) {
        "1" {
            Write-Host "Desativando IPv6 em todos os adaptadores de rede..." -ForegroundColor Yellow
            
            foreach ($adapter in $networkAdapters) {
                Disable-NetAdapterBinding -InterfaceAlias $adapter.Name -ComponentID "ms_tcpip6"
                Write-Host "IPv6 desativado em $($adapter.Name)" -ForegroundColor Green
            }
            
            # Desativar IPv6 globalmente no registro
            Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters" -Name "DisabledComponents" -Value 0xffffffff -Type DWord
            
            Write-Host "IPv6 desativado em todos os adaptadores de rede!" -ForegroundColor Green
            Write-Host "Nota: Algumas altera√ß√µes podem requerer reinicializa√ß√£o para ter efeito completo." -ForegroundColor Yellow
        }
        "2" {
            Write-Host "Ativando IPv6 em todos os adaptadores de rede..." -ForegroundColor Yellow
            
            foreach ($adapter in $networkAdapters) {
                Enable-NetAdapterBinding -InterfaceAlias $adapter.Name -ComponentID "ms_tcpip6"
                Write-Host "IPv6 ativado em $($adapter.Name)" -ForegroundColor Green
            }
            
            # Ativar IPv6 globalmente no registro
            Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters" -Name "DisabledComponents" -Value 0x0 -Type DWord
            
            Write-Host "IPv6 ativado em todos os adaptadores de rede!" -ForegroundColor Green
            Write-Host "Nota: Algumas altera√ß√µes podem requerer reinicializa√ß√£o para ter efeito completo." -ForegroundColor Yellow
        }
        "3" {
            Write-Host "Gerenciando IPv6 em adaptadores espec√≠ficos..." -ForegroundColor Yellow
            
            $index = 1
            $adapterList = @()
            
            foreach ($adapter in $networkAdapters) {
                $ipv6Status = Get-NetAdapterBinding -InterfaceAlias $adapter.Name -ComponentID "ms_tcpip6"
                $status = if ($ipv6Status.Enabled) { "Ativado" } else { "Desativado" }
                $statusColor = if ($ipv6Status.Enabled) { "Green" } else { "Yellow" }
                
                Write-Host "[$index] $($adapter.Name): $status" -ForegroundColor $statusColor
                $adapterList += $adapter
                $index++
            }
            
            Write-Host "[0] Voltar" -ForegroundColor White
            Write-Host ""
            
            $adapterChoice = Read-Host "Selecione o n√∫mero do adaptador que deseja gerenciar (ou 0 para voltar)"
            
            if ($adapterChoice -eq "0" -or $adapterChoice -eq "") {
                Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
                break
            }
            
            $adapterIndex = [int]$adapterChoice - 1
            if ($adapterIndex -lt 0 -or $adapterIndex -ge $adapterList.Count) {
                Write-Host "Sele√ß√£o inv√°lida." -ForegroundColor Red
                break
            }
            
            $selectedAdapter = $adapterList[$adapterIndex]
            $ipv6Status = Get-NetAdapterBinding -InterfaceAlias $selectedAdapter.Name -ComponentID "ms_tcpip6"
            
            if ($ipv6Status.Enabled) {
                Write-Host "Desativando IPv6 em $($selectedAdapter.Name)..." -ForegroundColor Yellow
                Disable-NetAdapterBinding -InterfaceAlias $selectedAdapter.Name -ComponentID "ms_tcpip6"
                Write-Host "IPv6 desativado em $($selectedAdapter.Name)" -ForegroundColor Green
            } else {
                Write-Host "Ativando IPv6 em $($selectedAdapter.Name)..." -ForegroundColor Yellow
                Enable-NetAdapterBinding -InterfaceAlias $selectedAdapter.Name -ComponentID "ms_tcpip6"
                Write-Host "IPv6 ativado em $($selectedAdapter.Name)" -ForegroundColor Green
            }
        }
        "0" {
            Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
        }
        default {
            Write-Host "Op√ß√£o inv√°lida." -ForegroundColor Red
        }
    }
    
    if ($ipv6Choice -eq "1" -or $ipv6Choice -eq "2") {
        Write-Host "`nNota: Algumas altera√ß√µes de IPv6 podem requerer reinicializa√ß√£o para ter efeito completo." -ForegroundColor Yellow
        $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (s/n)"
        
        if ($confirmRestart -eq 's') {
            Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
            Restart-Computer -Force
        }
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-OptimizeGamingLatency {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Otimizar Lat√™ncia de Rede para Jogos ---" -ForegroundColor Cyan
    Write-Host "Configura par√¢metros de rede para reduzir a lat√™ncia em jogos online." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o otimiza v√°rios par√¢metros de rede para reduzir a lat√™ncia em jogos online." -ForegroundColor White
    Write-Host "As otimiza√ß√µes s√£o seguras e podem ser revertidas se necess√°rio." -ForegroundColor White
    Write-Host ""
    
    # Verificar lat√™ncia atual
    Write-Host "Verificando lat√™ncia atual para servidores de jogos populares..." -ForegroundColor Yellow
    
    $gameServers = @(
        @{Name="Google (Stadia)"; Address="stadia.google.com"},
        @{Name="EA Games"; Address="ea.com"},
        @{Name="Steam"; Address="steamcommunity.com"},
        @{Name="Epic Games"; Address="epicgames.com"},
        @{Name="Xbox Live"; Address="xbox.com"}
    )
    
    $latencyResults = @()
    
    foreach ($server in $gameServers) {
        try {
            $pingResult = Test-Connection -ComputerName $server.Address -Count 4 -ErrorAction SilentlyContinue
            if ($pingResult) {
                $avgLatency = ($pingResult | Measure-Object -Property ResponseTime -Average).Average
                $latencyResults += [PSCustomObject]@{
                    Server = $server.Name
                    Latency = [math]::Round($avgLatency, 2)
                    Status = "OK"
                }
            } else {
                $latencyResults += [PSCustomObject]@{
                    Server = $server.Name
                    Latency = 0
                    Status = "Falha"
                }
            }
        } catch {
            $latencyResults += [PSCustomObject]@{
                Server = $server.Name
                Latency = 0
                Status = "Falha"
            }
        }
    }
    
    Write-Host "Lat√™ncia atual para servidores de jogos:" -ForegroundColor White
    $latencyResults | Format-Table -AutoSize
    
    $avgLatency = ($latencyResults | Where-Object { $_.Status -eq "OK" } | Measure-Object -Property Latency -Average).Average
    if ($avgLatency -gt 0) {
        Write-Host "Lat√™ncia m√©dia atual: $([math]::Round($avgLatency, 2)) ms" -ForegroundColor $(if ($avgLatency -lt 50) { "Green" } elseif ($avgLatency -lt 100) { "Yellow" } else { "Red" })
    } else {
        Write-Host "N√£o foi poss√≠vel determinar a lat√™ncia m√©dia atual." -ForegroundColor Red
    }
    
    Write-Host ""
    $confirm = Read-Host "Deseja aplicar otimiza√ß√µes de lat√™ncia para jogos? (s/n)"
    
    if ($confirm -eq 's') {
        Write-Host "Aplicando otimiza√ß√µes de lat√™ncia para jogos..." -ForegroundColor Yellow
        
        # Otimiza√ß√£o 1: Configurar QoS para jogos
        Write-Host "Configurando QoS para jogos..." -ForegroundColor DarkGray
        
        # Verificar se o servi√ßo QoS est√° em execu√ß√£o
        $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
        if ($qosService -and $qosService.Status -ne "Running") {
            Write-Host "Iniciando servi√ßo QoS RSVP..." -ForegroundColor DarkGray
            Start-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
        }
        
        # Configurar QoS para jogos usando netsh
        netsh advfirewall firewall add rule name="QoS-Games" dir=out action=allow protocol=UDP remoteport=3074,3478,3479,3480 enable=yes
        
        # Configurar prioridade para jogos
        if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS")) {
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Force | Out-Null
        }
        
        # Adicionar pol√≠tica para jogos
        New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Force | Out-Null
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Application Name" -Value "*" -Type String
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Version" -Value "1.0" -Type String
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Protocol" -Value "*" -Type String
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Local Port" -Value "*" -Type String
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Local IP" -Value "*" -Type String
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Remote Port" -Value "3074,3478-3480" -Type String
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Remote IP" -Value "*" -Type String
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "DSCP Value" -Value "46" -Type String
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Throttle Rate" -Value "-1" -Type String
        
        # Otimiza√ß√£o 2: Configurar TCP/IP para jogos
        Write-Host "Configurando TCP/IP para jogos..." -ForegroundColor DarkGray
        
        # Habilitar TCP Window Auto-Tuning
        netsh int tcp set global autotuninglevel=normal
        
        # Habilitar Receive-Side Scaling (RSS)
        netsh int tcp set global rss=enabled
        
        # Configurar Congestion Provider para CTCP
        netsh int tcp set global congestionprovider=ctcp
        
        # Habilitar ECN Capability
        netsh int tcp set global ecncapability=enabled
        
        # Otimiza√ß√£o 3: Configurar Nagle Algorithm (reduz lat√™ncia para pacotes pequenos)
        Write-Host "Configurando Nagle Algorithm..." -ForegroundColor DarkGray
        
        # Desabilitar Nagle Algorithm para jogos
        if (-not (Test-Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces")) {
            New-Item -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces" -Force | Out-Null
        }
        
        $networkInterfaces = Get-ChildItem "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces"
        foreach ($interface in $networkInterfaces) {
            Set-ItemProperty -Path $interface.PSPath -Name "TcpAckFrequency" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
            Set-ItemProperty -Path $interface.PSPath -Name "TCPNoDelay" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        }
        
        # Otimiza√ß√£o 4: Configurar prioridade de CPU para jogos
        Write-Host "Configurando prioridade de CPU para jogos..." -ForegroundColor DarkGray
        
        # Configurar prioridade para jogos
        if (-not (Test-Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games")) {
            New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Force | Out-Null
        }
        
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "GPU Priority" -Value 8 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Priority" -Value 6 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Scheduling Category" -Type String -Value "High" -Force -ErrorAction SilentlyContinue
        
        # Otimiza√ß√£o 5: Configurar Network Throttling Index
        Write-Host "Configurando Network Throttling Index..." -ForegroundColor DarkGray
        
        if (-not (Test-Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile")) {
            New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile" -Force | Out-Null
        }
        
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile" -Name "NetworkThrottlingIndex" -Value 0xffffffff -Type DWord -Force -ErrorAction SilentlyContinue
        
        Write-Host "Otimiza√ß√µes de lat√™ncia para jogos aplicadas com sucesso!" -ForegroundColor Green
        
        # Verificar lat√™ncia ap√≥s otimiza√ß√µes
        Write-Host "`nVerificando lat√™ncia ap√≥s otimiza√ß√µes..." -ForegroundColor Yellow
        
        $latencyResultsAfter = @()
        
        foreach ($server in $gameServers) {
            try {
                $pingResult = Test-Connection -ComputerName $server.Address -Count 4 -ErrorAction SilentlyContinue
                if ($pingResult) {
                    $avgLatency = ($pingResult | Measure-Object -Property ResponseTime -Average).Average
                    $latencyResultsAfter += [PSCustomObject]@{
                        Server = $server.Name
                        Latency = [math]::Round($avgLatency, 2)
                        Status = "OK"
                    }
                } else {
                    $latencyResultsAfter += [PSCustomObject]@{
                        Server = $server.Name
                        Latency = 0
                        Status = "Falha"
                    }
                }
            } catch {
                $latencyResultsAfter += [PSCustomObject]@{
                    Server = $server.Name
                    Latency = 0
                    Status = "Falha"
                }
            }
        }
        
        Write-Host "Lat√™ncia ap√≥s otimiza√ß√µes:" -ForegroundColor White
        $latencyResultsAfter | Format-Table -AutoSize
        
        $avgLatencyAfter = ($latencyResultsAfter | Where-Object { $_.Status -eq "OK" } | Measure-Object -Property Latency -Average).Average
        if ($avgLatencyAfter -gt 0) {
            Write-Host "Lat√™ncia m√©dia ap√≥s otimiza√ß√µes: $([math]::Round($avgLatencyAfter, 2)) ms" -ForegroundColor $(if ($avgLatencyAfter -lt 50) { "Green" } elseif ($avgLatencyAfter -lt 100) { "Yellow" } else { "Red" })
        } else {
            Write-Host "N√£o foi poss√≠vel determinar a lat√™ncia m√©dia ap√≥s otimiza√ß√µes." -ForegroundColor Red
        }
        
        Write-Host "`nBenef√≠cios das otimiza√ß√µes de lat√™ncia para jogos:" -ForegroundColor Cyan
        Write-Host "- Redu√ß√£o da lat√™ncia em jogos online" -ForegroundColor DarkGray
        Write-Host "- Melhor resposta em jogos competitivos" -ForegroundColor DarkGray
        Write-Host "- Redu√ß√£o de lag e stuttering" -ForegroundColor DarkGray
        Write-Host "- Melhor experi√™ncia geral em jogos online" -ForegroundColor DarkGray
        
        Write-Host "`nNota: Algumas altera√ß√µes podem requerer reinicializa√ß√£o para ter efeito completo." -ForegroundColor Yellow
        $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (s/n)"
        
        if ($confirmRestart -eq 's') {
            Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
            Restart-Computer -Force
        }
    } else {
        Write-Host "Otimiza√ß√µes de lat√™ncia para jogos canceladas." -ForegroundColor Yellow
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - DESEMPENHO (Expandidas) ---
function Invoke-OptimizeVisualEffects {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Desempenho: Ajustar Efeitos Visuais para Melhor Desempenho ---" -ForegroundColor Green
    Write-Host "Configura os efeitos visuais do Windows para priorizar o desempenho sobre a apar√™ncia." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o ajusta os efeitos visuais do Windows para priorizar o desempenho." -ForegroundColor White
    Write-Host "Desativar efeitos visuais pode melhorar significativamente o desempenho em sistemas mais antigos." -ForegroundColor White
    Write-Host ""
    
    # Verificar configura√ß√µes atuais
    Write-Host "Verificando configura√ß√µes atuais de efeitos visuais..." -ForegroundColor Yellow
    
    $visualFXPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects"
    $visualFXSetting = Get-ItemProperty -Path $visualFXPath -Name "VisualFXSetting" -ErrorAction SilentlyContinue
    
    if ($visualFXSetting) {
        switch ($visualFXSetting.VisualFXSetting) {
            0 { $currentSetting = "Deixar o Windows escolher (Autom√°tico)" }
            1 { $currentSetting = "Ajustar para melhor apar√™ncia" }
            2 { $currentSetting = "Ajustar para melhor desempenho" }
            3 { $currentSetting = "Personalizado" }
            default { $currentSetting = "Desconhecido" }
        }
        
        Write-Host "Configura√ß√£o atual: $currentSetting" -ForegroundColor White
    } else {
        Write-Host "N√£o foi poss√≠vel determinar a configura√ß√£o atual." -ForegroundColor DarkGray
    }
    
    Write-Host ""
    Write-Host "Op√ß√µes de configura√ß√£o:" -ForegroundColor Yellow
    Write-Host "[1] Ajustar para melhor desempenho (desativa todos os efeitos visuais)" -ForegroundColor White
    Write-Host "[2] Ajustar para melhor apar√™ncia (ativa todos os efeitos visuais)" -ForegroundColor White
    Write-Host "[3] Deixar o Windows escolher (configura√ß√£o autom√°tica)" -ForegroundColor White
    Write-Host "[4] Configura√ß√£o personalizada (escolher efeitos espec√≠ficos)" -ForegroundColor White
    Write-Host "[0] Voltar" -ForegroundColor White
    Write-Host ""
    
    $visualChoice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($visualChoice) {
        "1" {
            Write-Host "Ajustando para melhor desempenho..." -ForegroundColor Yellow
            
            # Configurar para melhor desempenho (desativar todos os efeitos visuais)
            Set-ItemProperty -Path $visualFXPath -Name "VisualFXSetting" -Value 2 -Type DWord -Force
            
            # Desativar efeitos visuais espec√≠ficos
            $desktopPath = "HKCU:\Control Panel\Desktop"
            $advancedPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced"
            $windowMetricsPath = "HKCU:\Control Panel\Desktop\WindowMetrics"
            
            # Desativar anima√ß√µes de janela
            Set-ItemProperty -Path $desktopPath -Name "UserPreferencesMask" -Value ([byte[]](0x90, 0x12, 0x01, 0x80)) -Type Binary -Force
            
            # Desativar anima√ß√µes de minimizar/maximizar
            Set-ItemProperty -Path $windowMetricsPath -Name "MinAnimate" -Value 0 -Type String -Force
            
            # Desativar efeitos de transpar√™ncia
            Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize" -Name "EnableTransparency" -Value 0 -Type DWord -Force
            
            # Desativar anima√ß√µes da barra de tarefas
            Set-ItemProperty -Path $advancedPath -Name "TaskbarAnimations" -Value 0 -Type DWord -Force
            
            # Desativar sele√ß√£o transparente
            Set-ItemProperty -Path $advancedPath -Name "ListviewAlphaSelect" -Value 0 -Type DWord -Force
            
            # Desativar sombras sob o ponteiro do mouse
            Set-ItemProperty -Path $advancedPath -Name "EnablePointerShadow" -Value 0 -Type DWord -Force
            
            # Desativar sombras sob janelas
            Set-ItemProperty -Path $advancedPath -Name "ListviewShadow" -Value 0 -Type DWord -Force
            
            Write-Host "Configura√ß√£o ajustada para melhor desempenho!" -ForegroundColor Green
            Write-Host "Todos os efeitos visuais foram desativados para maximizar o desempenho." -ForegroundColor Green
        }
        "2" {
            Write-Host "Ajustando para melhor apar√™ncia..." -ForegroundColor Yellow
            
            # Configurar para melhor apar√™ncia (ativar todos os efeitos visuais)
            Set-ItemProperty -Path $visualFXPath -Name "VisualFXSetting" -Value 1 -Type DWord -Force
            
            # Ativar efeitos visuais espec√≠ficos
            $desktopPath = "HKCU:\Control Panel\Desktop"
            $advancedPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced"
            $windowMetricsPath = "HKCU:\Control Panel\Desktop\WindowMetrics"
            
            # Ativar anima√ß√µes de janela
            Set-ItemProperty -Path $desktopPath -Name "UserPreferencesMask" -Value ([byte[]](0x9E, 0x3E, 0x07, 0x80)) -Type Binary -Force
            
            # Ativar anima√ß√µes de minimizar/maximizar
            Set-ItemProperty -Path $windowMetricsPath -Name "MinAnimate" -Value 1 -Type String -Force
            
            # Ativar efeitos de transpar√™ncia
            Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize" -Name "EnableTransparency" -Value 1 -Type DWord -Force
            
            # Ativar anima√ß√µes da barra de tarefas
            Set-ItemProperty -Path $advancedPath -Name "TaskbarAnimations" -Value 1 -Type DWord -Force
            
            # Ativar sele√ß√£o transparente
            Set-ItemProperty -Path $advancedPath -Name "ListviewAlphaSelect" -Value 1 -Type DWord -Force
            
            # Ativar sombras sob o ponteiro do mouse
            Set-ItemProperty -Path $advancedPath -Name "EnablePointerShadow" -Value 1 -Type DWord -Force
            
            # Ativar sombras sob janelas
            Set-ItemProperty -Path $advancedPath -Name "ListviewShadow" -Value 1 -Type DWord -Force
            
            Write-Host "Configura√ß√£o ajustada para melhor apar√™ncia!" -ForegroundColor Green
            Write-Host "Todos os efeitos visuais foram ativados para maximizar a apar√™ncia." -ForegroundColor Green
        }
        "3" {
            Write-Host "Configurando para deixar o Windows escolher..." -ForegroundColor Yellow
            
            # Configurar para deixar o Windows escolher (configura√ß√£o autom√°tica)
            Set-ItemProperty -Path $visualFXPath -Name "VisualFXSetting" -Value 0 -Type DWord -Force
            
            Write-Host "Configura√ß√£o ajustada para deixar o Windows escolher!" -ForegroundColor Green
            Write-Host "O Windows ir√° determinar automaticamente quais efeitos visuais usar com base no desempenho do sistema." -ForegroundColor Green
        }
        "4" {
            Write-Host "Configura√ß√£o personalizada de efeitos visuais..." -ForegroundColor Yellow
            
            # Configurar para personalizado
            Set-ItemProperty -Path $visualFXPath -Name "VisualFXSetting" -Value 3 -Type DWord -Force
            
            $desktopPath = "HKCU:\Control Panel\Desktop"
            $advancedPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced"
            $windowMetricsPath = "HKCU:\Control Panel\Desktop\WindowMetrics"
            
            # Listar efeitos visuais dispon√≠veis
            Write-Host ""
            Write-Host "Efeitos visuais dispon√≠veis:" -ForegroundColor Yellow
            Write-Host "[1] Anima√ß√µes de janela" -ForegroundColor White
            Write-Host "[2] Anima√ß√µes de minimizar/maximizar" -ForegroundColor White
            Write-Host "[3] Efeitos### Enhanced TORK Optimizer

I'll enhance the TORK optimizer with more comprehensive functionality across all features, starting with an expanded Simple Cleanup function and then improving all other options.

```powershell type="code"
# Define a preferencia de acao para erros (continua a execucao por padrao)
# Permite que o script tente rodar o m√°ximo poss√≠vel mesmo que alguns comandos encontrem problemas.
$ErrorActionPreference = 'SilentlyContinue' # N√£o exibe erros se um item n√£o puder ser processado, por exemplo.

# --- Funcao pra Centralizar Texto (Nosso Maestro de Alinhamento - s√≥ pra textos, n√£o pro bannerz√£o!) ---
# Deixa ela aqui, vai que a gente usa pra centralizar outra coisa, n√©?
function Centraliza($texto, $cor="White") {
    $largura = [console]::WindowWidth # Pega a largura da largura da janela agora
    # Calcula o espa√ßo pra botar o texto no meio. Pura matem√°tica da zoeira!
    $espacos = [Math]::Max(0, [Math]::Floor(($largura - $texto.Length) / 2))
    $linha = (" " * $espacos) + $texto # Cria a linha com os espa√ßos e o texto
    Write-Host $linha -ForegroundColor $cor # Manda pro console com a cor pedida
}

# --- Funcao que Desenha o Nosso Banner Irado do TORK! ---
# Esse √© o nosso outdoor digital no console! Ajustado pros espa√ßos que voc√™ mandou!
# Se as bordas ainda estiverem meio teimosas, √© o jeitinho do console mesmo, viu? üòâ
function Banner-TORK {
    # Nossas cores vibrantes para o banner!
    $CorBorda = "DarkCyan" # Mantido para a borda, combina com o ciano. Se quiser mudar, √© aqui!
    $CorLogo = "Green" # Cor vibrante
    $CorProjeto = "Cyan" # Cor vibrante
    $CorCopyright = "Gray" # Tom mais suave

    Write-Host "" # D√° um espacinho no topo, pra n√£o grudar
    Write-Host "                    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë          ‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë ‚ñà‚ñà‚ïî‚ïù                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ñà‚ñà‚ïó                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù                                          ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë           Bem-vindo ao TORK - Otimizador para Windows!                                ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë        Projeto de automacao, limpeza, manutencao e tweaks.                            ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë            (C) Partner77 - Todos os direitos reservados                               ‚ïë" -ForegroundColor $CorCopyright
    Write-Host "                    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor $CorBorda
    Write-Host "" # Espa√ßo embaixo
}

# --- Checagem de Permiss√µes de Administrador (O Guarda da Porta!) ---
# V√™ se a gente t√° rodando com poderes de admin, sen√£o n√£o d√° pra mexer no Windows direito.
function Test-Administrator {
    $currentUser = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())
    return $currentUser.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
}

if (-not (Test-Administrator)) {
    Write-Host "OPA! Calma l√°, patr√£o!" -ForegroundColor Red
    Write-Host "Pra usar o TORK e deixar o PC voando, preciso de super poderes de Administrador!" -ForegroundColor Yellow
    Write-Host "Fecha essa janela, clica com o bot√£o direito no arquivo do script e escolhe 'Executar como administrador'. A√≠ sim, tamo junto!" -ForegroundColor Yellow
    Read-Host "D√° um Enter quando terminar de ler, que a gente se v√™ na pr√≥xima..."
    Exit
}

Write-Host "Poderes de Administrador verificados! Bora nessa!" -ForegroundColor Green
Start-Sleep -Seconds 1

# --- Fun√ß√µes Utilit√°rias (Ferramentas que usamos em v√°rios lugares) ---
function Get-SystemInfo {
    $os = Get-CimInstance Win32_OperatingSystem
    $cs = Get-CimInstance Win32_ComputerSystem
    $proc = Get-CimInstance Win32_Processor
    $mem = Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property Capacity -Sum
    
    $info = @{
        "OSName" = $os.Caption
        "OSVersion" = $os.Version
        "OSBuild" = $os.BuildNumber
        "ComputerName" = $cs.Name
        "Manufacturer" = $cs.Manufacturer
        "Model" = $cs.Model
        "Processor" = $proc.Name
        "Memory" = [math]::Round($mem.Sum / 1GB, 2)
        "Architecture" = $os.OSArchitecture
        "InstallDate" = $os.InstallDate
        "LastBootTime" = $os.LastBootUpTime
    }
    
    return $info
}

function Show-SystemSummary {
    $sysInfo = Get-SystemInfo
    
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Computador: $($sysInfo.ComputerName)" -ForegroundColor White
    Write-Host "Fabricante: $($sysInfo.Manufacturer)" -ForegroundColor White
    Write-Host "Modelo: $($sysInfo.Model)" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "Instalado em: $($sysInfo.InstallDate)" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

function Get-DiskSpaceBefore {
    $drives = Get-PSDrive -PSProvider FileSystem
    $driveInfo = @{}
    
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        
        $driveInfo[$drive.Name] = @{
            "Free" = $freeSpace
            "Used" = $usedSpace
            "Total" = $totalSpace
        }
    }
    
    return $driveInfo
}

function Show-DiskSpaceComparison {
    param (
        $before
    )
    
    $after = Get-PSDrive -PSProvider FileSystem
    
    Write-Host "=== Compara√ß√£o de Espa√ßo em Disco ===" -ForegroundColor Cyan
    
    foreach ($drive in $after) {
        if ($before.ContainsKey($drive.Name)) {
            $freeSpaceAfter = [math]::Round($drive.Free / 1GB, 2)
            $freeSpaceBefore = $before[$drive.Name].Free
            $spaceRecovered = [math]::Round($freeSpaceAfter - $freeSpaceBefore, 2)
            
            Write-Host "Drive $($drive.Name):" -ForegroundColor White
            Write-Host "  Espa√ßo livre antes: $freeSpaceBefore GB" -ForegroundColor Gray
            Write-Host "  Espa√ßo livre agora: $freeSpaceAfter GB" -ForegroundColor Gray
            
            if ($spaceRecovered -gt 0) {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Green
            } else {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Yellow
            }
            Write-Host ""
        }
    }
    
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

# --- Fun√ß√µes dos Menus (Principal, Simplificado, Avan√ßado e Sub-menus) ---

# --- Menu Principal (A Bifurca√ß√£o do Destino! Simplificado vs Avan√ßado) ---
# √â aqui que o usu√°rio escolhe se quer ser um mago ou um cara pr√°tico!
function Show-MainMenu {
    do {
        Clear-Host # Limpa a tela pra organizar o menu
        Banner-TORK # Banner no topo, pra gente n√£o esquecer quem somos!
        Show-SystemSummary # Mostra um resumo do sistema

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "       MENU PRINCIPAL" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # As duas grandes estradas da otimiza√ß√£o! Cores variadas (repetindo)!
        Write-Host "[1] Otimiza√ß√£o Simplificada (Pra quem quer praticidade e resultado r√°pido!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o Avan√ßada (Pra quem curte mexer fundo e ter control total!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[3] Diagn√≥stico R√°pido do Sistema (Ver o que t√° rolando no PC)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[4] Sobre o TORK (Informa√ß√µes e cr√©ditos)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[0] Sair (Ah, que pena... Mas a porta t√° aberta!)" -ForegroundColor Red # Vermelho pra Sair - Ok

        Write-Host ""

        # Pergunta pro usu√°rio qual caminho ele escolhe, tipo Mestre Pok√©mon!
        $choice = Read-Host "Escolhe sua op√ß√£o, treinador!"

        # V√™ pra onde a gente vai com base na escolha
        switch ($choice) {
            "1" { Show-SimplifiedMenu } # Se escolheu 1, vai pro Menu Simplificado!
            "2" { Show-AdvancedMenu } # Se escolheu 2, vai pro Menu Avan√ßado!
            "3" { Invoke-QuickDiagnostic } # Nova fun√ß√£o de diagn√≥stico r√°pido
            "4" { Show-AboutTORK } # Nova fun√ß√£o de sobre
            "0" { Write-Host "Fechou! Valeu por usar o TORK! Volte sempre que seu PC pedir um g√°s! ;)" -ForegroundColor Green; Start-Sleep -Seconds 2; break } # Se escolheu 0, vaza (mas volta!)
            default {
                Write-Host "Eita! Op√ß√£o inv√°lida! Confere os n√∫meros e tenta de novo, bora l√°!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1 # D√° um tempinho pro usu√°rio ver a zoeira da mensagem
            }
        }
    } while ($choice -ne '0') # Repete o Menu Principal enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Simplificado (Aqui o TORK faz m√°gica r√°pida e segura!) ---
# Acessado pela op√ß√£o 1 do Menu Principal. Menos op√ß√µes, mais a√ß√£o direta!
function Show-SimplifiedMenu {
    do {
        Clear-Host # Limpa o palco pra esse menu!
        Banner-TORK # Nosso banner no topo, sempre presente!

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "   OTIMIZACAO SIMPLIFICADA" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes SIMPLIFICADAS - cada uma pode fazer um monte de coisa por baixo dos panos! Cores variadas (repetindo as prim√°rias/neon e adicionando outras)!
        Write-Host "[1] Limpeza Geral do Sistema (Tira o lixo que t√° pesando!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o de Mem√≥ria e Programas que Ligam com o Windows (Deixa tudo mais √°gil!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[3] Acelerar a Conex√£o com a Internet (Pra navegar sem gargalo!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[4] Deixar o Windows mais Leve Visualmente (Desativa uns efeitos pra ganhar desempenho!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Otimiza√ß√£o de Jogos (Configura√ß√µes pra melhorar FPS e desempenho)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[6] Manuten√ß√£o de Seguran√ßa (Verificar e corrigir problemas de seguran√ßa)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[7] RODAR TODAS as otimiza√ß√µes SIMPLIFICADAS! (Modo Turbo F√°cil!)" -ForegroundColor Red # Vermelho pra "Faz Tudo" - Destaque/Cuidado
        Write-Host "[0] Voltar ao Menu Principal (A gente te espera aqui!)" -ForegroundColor Gray # Cor neutra pra voltar

        Write-Host ""

        # Pergunta qual m√°gica simplificada o usu√°rio quer
        $choice = Read-Host "Escolhe sua m√°gica simplificada!"

        # V√™ qual m√°gica rodar
        switch ($choice) {
            "1" { Invoke-SimpleSystemCleanup } # Chama a fun√ß√£o de limpeza b√°sica
            "2" { Invoke-SimpleMemoryStartup } # Chama a fun√ß√£o pra mem√≥ria/inicializa√ß√£o
            "3" { Invoke-SimpleInternetOpt } # Chama a fun√ß√£o pra internet
            "4" { Invoke-SimpleVisualOpt } # Chama a fun√ß√£o pra visual
            "5" { Invoke-SimpleGamingOpt } # Nova fun√ß√£o para otimiza√ß√£o de jogos
            "6" { Invoke-SimpleSecurityMaintenance } # Nova fun√ß√£o para manuten√ß√£o de seguran√ßa
            "7" {
                # Rodar todas as simplificadas sequencialmente
                Write-Host "`nModo Turbo F√°cil ATIVADO! Rodando todas as otimiza√ß√µes SIMPLIFICADAS... segura pe√£o!`n" -ForegroundColor Yellow
                Invoke-SimpleSystemCleanup # Roda a 1
                Invoke-SimpleMemoryStartup # Roda a 2
                Invoke-SimpleInternetOpt # Roda a 3
                Invoke-SimpleVisualOpt # Roda a 4
                Invoke-SimpleGamingOpt # Roda a 5
                Invoke-SimpleSecurityMaintenance # Roda a 6
                Write-Host "`nShow! Todas as otimiza√ß√µes SIMPLIFICADAS foram executadas! PC t√° agradecendo! ;)`n" -ForegroundColor Green
                Read-Host "Aperta Enter pra voltar pro Menu Simplificado..." # Pausa no final do "Rodar Todas"
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-MainMenu
            default {
                Write-Host "Ops! Op√ß√£o inv√°lida no Menu Simplificado! Confere os n√∫meros e manda bala de novo!" -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Simplificado enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Avan√ßado (O Playground dos Magos do PC!) ---
# Acessado pela op√ß√£o 2 do Menu Principal. Aqui a gente mergulha fundo!
function Show-AdvancedMenu {
    do {
        Clear-Host # Limpa o palco pro menu avan√ßado!
        Banner-TORK # Nosso banner no topo, pra n√£o perder a pose!

        Write-Host "" # Espacinho maroto
        Write-Host "===============================" -ForegroundColor White
        Write-Host "      MENU AVANCADO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes do menu avan√ßado (as CATEGORIAS dos 200 poderes!) Cores variadas (repetindo)!
        Write-Host "[1] Limpeza e Manuten√ß√£o de Arquivos (Tirar a poeira digital!)" -ForegroundColor Cyan # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[2] Otimiza√ß√µes de Desempenho do Sistema (Deixar o motor roncando!)" -ForegroundColor Green # Cor variada
        Write-Host "[3] Configura√ß√µes e Otimiza√ß√µes de Rede (Pra internet voar baixo!)" -ForegroundColor Yellow # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[4] Gerenciamento e Otimiza√ß√£o de Servi√ßos do Windows (O que t√° rodando e n√£o precisa?!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Ferramentas de Diagn√≥stico e Verifica√ß√£o (Pra ver se t√° tudo nos conformes!)" -ForegroundColor Cyan # Cor repetida
        Write-Host "[6] Desabilitar/Gerenciar Recursos do Windows (Tirar o peso extra do sistema!)" -ForegroundColor Green # Cor repetida
        Write-Host "[7] Gerenciamento de Arquivos e Pastas Avan√ßado (Comandos ninja pra arquivos!)" -ForegroundColor Yellow # Cor repetida
        Write-Host "[8] Gerenciamento de Contas de Usu√°rio (Organizar a galera que usa o PC!)" -ForegroundColor White # Cor repetida
        Write-Host "[9] Otimiza√ß√£o para Jogos Avan√ßada (Tweaks pra gamers de verdade!)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Configura√ß√µes de Privacidade (Controle o que o Windows sabe sobre voc√™)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[11] Outras Configura√ß√µes e Tweaks Diversos (Aqueles ajustes secretos!)" -ForegroundColor Gray # Cor neutra/escura
        Write-Host "[0] Voltar ao Menu Principal (Pronto pra voltar pra estrada principal!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta pro mago qual categoria ele quer explorar
        $choice = Read-Host "Escolhe sua √°rea de magia, mago!"

        # V√™ pra onde a gente navega dentro do mundo avan√ßado
        switch ($choice) {
            "1" { Show-LimpezaManutencaoMenu } # CHAMA O SUB-MENU DE LIMPEZA
            "2" { Show-DesempenhoMenu } # Agora √© um sub-menu tamb√©m
            "3" { Show-ConfiguracoesRedeMenu } # CHAMA O SUB-MENU DE REDE
            "4" { Show-ServicosMenu } # Agora √© um sub-menu tamb√©m
            "5" { Show-DiagnosticoMenu } # Agora √© um sub-menu tamb√©m
            "6" { Show-RecursosMenu } # Agora √© um sub-menu tamb√©m
            "7" { Show-ArquivosPastasMenu } # Agora √© um sub-menu tamb√©m
            "8" { Show-UsuariosMenu } # Agora √© um sub-menu tamb√©m
            "9" { Show-JogosAvancadoMenu } # Novo sub-menu para jogos
            "10" { Show-PrivacidadeMenu } # Novo sub-menu para privacidade
            "11" { Show-OutrosMenu } # Agora √© um sub-menu tamb√©m
            "0" { break } # Sai do loop deste menu, voltando pro Menu Principal
            default {
                Write-Host "Humm, essa √°rea da magia ainda n√£o existe ou voc√™ digitou errado! Tenta de novo, mago!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Avan√ßado enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Limpeza e Manuten√ß√£o (Dentro do Avan√ßado!) ---
# Este menu lista as op√ß√µes ESPEC√çFICAS da categoria Limpeza no Menu Avan√ßado
function Show-LimpezaManutencaoMenu {
    do {
        Clear-Host # Limpa o palco pra este sub-menu!
        Banner-TORK # Banner no topo, sempre!

        Write-Host "" # Espacinho
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: LIMPEZA E MANUT." -ForegroundColor White # T√≠tulo menor pro sub-menu
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes ESPEC√çFICAS da categoria Limpeza. Cores variadas (repetindo cores)!
        Write-Host "[1] Limpar Arquivos Tempor√°rios do Usu√°rio (Tipo a pasta Temp!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[2] Limpar Arquivos Tempor√°rios do Sistema (Os tempor√°rios do Windows!)" -ForegroundColor Gray # Cor neutra (substitui DarkCyan)
        Write-Host "[3] Limpar Cache de DNS (Pra resolver nomes de site mais r√°pido!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[4] Esvaziar Lixeira (Adeus, arquivos deletados!)" -ForegroundColor Gray # Cor neutra (repetindo)
        Write-Host "[5] Limpar Cache de Miniaturas (Aqueles previews de imagem/v√≠deo!)" -ForegroundColor Green # Cor variada
        Write-Host "[6] Limpar Logs do Sistema (Arquivos de registro que acumulam)" -ForegroundColor Cyan # Nova op√ß√£o
        Write-Host "[7] Limpar Cache de Atualiza√ß√µes do Windows (Liberar espa√ßo de updates)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[8] Limpar Arquivos de Hiberna√ß√£o (Liberar o hiberfil.sys)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[9] Limpar Arquivos WinSxS (Pasta que ocupa muito espa√ßo)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Executar TODAS as limpezas acima (Faxina completa!)" -ForegroundColor Red # Nova op√ß√£o
        Write-Host "[0] Voltar ao Menu Avan√ßado (De volta pras categorias!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta qual limpeza espec√≠fica o mago quer fazer
        $choice = Read-Host "Escolhe a limpeza avan√ßada, mestre!"

        # V√™ qual fun√ß√£o de limpeza espec√≠fica chamar
        switch ($choice) {
            "1" { Invoke-CleanUserTemp } # Chama a fun√ß√£o pra Limpar Temp Usu√°rio
            "2" { Invoke-CleanSystemTemp } # Chama a fun√ß√£o pra Limpar Temp Sistema
            "3" { Invoke-CleanDnsCache } # Chama a fun√ß√£o pra Limpar Cache DNS
            "4" { Invoke-EmptyRecycleBin } # Chama a fun√ß√£o pra Esvaziar Lixeira
            "5" { Invoke-CleanThumbnailCache } # Chama a fun√ß√£o pra Limpar Cache de Miniaturas
            "6" { Invoke-CleanSystemLogs } # Nova fun√ß√£o para limpar logs do sistema
            "7" { Invoke-CleanWindowsUpdateCache } # Nova fun√ß√£o para limpar cache de updates
            "8" { Invoke-CleanHibernationFile } # Nova fun√ß√£o para limpar arquivo de hiberna√ß√£o
            "9" { Invoke-CleanWinSxS } # Nova fun√ß√£o para limpar pasta WinSxS
            "10" { 
                # Executa todas as limpezas em sequ√™ncia
                Write-Host "`nIniciando faxina completa do sistema! Isso pode demorar um pouco...`n" -ForegroundColor Yellow
                $diskSpaceBefore = Get-DiskSpaceBefore
                
                Invoke-CleanUserTemp
                Invoke-CleanSystemTemp
                Invoke-CleanDnsCache
                Invoke-EmptyRecycleBin
                Invoke-CleanThumbnailCache
                Invoke-CleanSystemLogs
                Invoke-CleanWindowsUpdateCache
                Invoke-CleanHibernationFile
                Invoke-CleanWinSxS
                
                Write-Host "`nFaxina completa finalizada! Veja quanto espa√ßo foi recuperado:`n" -ForegroundColor Green
                Show-DiskSpaceComparison -before $diskSpaceBefore
                Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-AdvancedMenu
            default {
                Write-Host "Essa tarefa de limpeza ainda n√£o t√° na lista! V√™ os n√∫meros e tenta de novo!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Sub-Menu Limpeza enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Desempenho (Dentro do Avan√ßado!) ---
function Show-DesempenhoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DESEMPENHO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Ajustar Efeitos Visuais para Melhor Desempenho" -ForegroundColor Green
        Write-Host "[2] Otimizar Disco do Sistema" -ForegroundColor Cyan
        Write-Host "[3] Limpar Arquivos Prefetch" -ForegroundColor Yellow
        Write-Host "[4] Definir Plano de Energia para Alto Desempenho" -ForegroundColor White
        Write-Host "[5] Otimizar Servi√ßo SuperFetch/SysMain" -ForegroundColor Magenta
        Write-Host "[6] Ajustar Tamanho da Mem√≥ria Virtual" -ForegroundColor Gray
        Write-Host "[7] Desativar Indexa√ß√£o de Arquivos" -ForegroundColor Green
        Write-Host "[8] Otimizar Inicializa√ß√£o do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de desempenho" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o de desempenho"

        switch ($choice) {
            "1" { Invoke-OptimizeVisualEffects }
            "2" { Invoke-OptimizeDisk }
            "3" { Invoke-CleanPrefetch }
            "4" { Invoke-SetHighPerformancePower }
            "5" { Invoke-OptimizeSuperFetch }
            "6" { Invoke-AdjustVirtualMemory }
            "7" { Invoke-DisableIndexing }
            "8" { Invoke-OptimizeStartup }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de desempenho...`n" -ForegroundColor Yellow
                Invoke-OptimizeVisualEffects
                Invoke-OptimizeDisk
                Invoke-CleanPrefetch
                Invoke-SetHighPerformancePower
                Invoke-OptimizeSuperFetch
                Invoke-AdjustVirtualMemory
                Invoke-DisableIndexing
                Invoke-OptimizeStartup
                Write-Host "`nTodas as otimiza√ß√µes de desempenho foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Configura√ß√µes de Rede (Dentro do Avan√ßado!) ---
function Show-ConfiguracoesRedeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: CONFIG. REDE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Limpar Cache de DNS" -ForegroundColor Yellow
        Write-Host "[2] Mudar Servidor DNS" -ForegroundColor Cyan
        Write-Host "[3] Resetar Configura√ß√µes de Rede" -ForegroundColor White
        Write-Host "[4] Otimizar Configura√ß√µes TCP/IP" -ForegroundColor Green
        Write-Host "[5] Verificar Velocidade da Conex√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar QoS (Qualidade de Servi√ßo)" -ForegroundColor Gray
        Write-Host "[7] Desativar IPv6 (Se n√£o estiver usando)" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Lat√™ncia de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de rede" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√£o de rede"

        switch ($choice) {
            "1" { Invoke-NetworkFlushDns }
            "2" { Invoke-NetworkChangeDns }
            "3" { Invoke-NetworkReset }
            "4" { Invoke-OptimizeTcpIp }
            "5" { Invoke-CheckNetworkSpeed }
            "6" { Invoke-ConfigureQoS }
            "7" { Invoke-DisableIPv6 }
            "8" { Invoke-OptimizeGamingLatency }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de rede...`n" -ForegroundColor Yellow
                Invoke-NetworkFlushDns
                Invoke-OptimizeTcpIp
                Invoke-CheckNetworkSpeed
                Invoke-ConfigureQoS
                Invoke-DisableIPv6
                Invoke-OptimizeGamingLatency
                Write-Host "`nTodas as otimiza√ß√µes de rede foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Rede..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Servi√ßos (Dentro do Avan√ßado!) ---
function Show-ServicosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: SERVICOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desabilitar Servi√ßo SuperFetch/SysMain" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Servi√ßo de Impress√£o" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Servi√ßo Windows Update" -ForegroundColor White
        Write-Host "[4] Listar Todos os Servi√ßos em Execu√ß√£o" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Otimizar Servi√ßos para Desempenho Geral" -ForegroundColor Gray
        Write-Host "[7] Restaurar Servi√ßos para Configura√ß√£o Padr√£o" -ForegroundColor Yellow
        Write-Host "[8] Desabilitar Servi√ßos Desnecess√°rios" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de servi√ßos"

        switch ($choice) {
            "1" { Invoke-ManageSuperFetch }
            "2" { Invoke-ManagePrintService }
            "3" { Invoke-ManageWindowsUpdate }
            "4" { Invoke-ListRunningServices }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-OptimizeServicesForPerformance }
            "7" { Invoke-RestoreDefaultServices }
            "8" { Invoke-DisableUnnecessaryServices }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Diagn√≥stico (Dentro do Avan√ßado!) ---
function Show-DiagnosticoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DIAGNOSTICO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Verificar Arquivos do Sistema (SFC)" -ForegroundColor Yellow
        Write-Host "[2] Reparar Imagem do Windows (DISM)" -ForegroundColor Cyan
        Write-Host "[3] Verificar Disco por Erros (CHKDSK)" -ForegroundColor White
        Write-Host "[4] Verificar Sa√∫de do Disco" -ForegroundColor Green
        Write-Host "[5] Verificar Drivers Desatualizados" -ForegroundColor Magenta
        Write-Host "[6] Verificar Problemas de Inicializa√ß√£o" -ForegroundColor Gray
        Write-Host "[7] Verificar Problemas de Mem√≥ria RAM" -ForegroundColor Yellow
        Write-Host "[8] Verificar Temperatura do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODOS os diagn√≥sticos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de diagn√≥stico"

        switch ($choice) {
            "1" { Invoke-SfcScan }
            "2" { Invoke-DismRepair }
            "3" { Invoke-ChkDsk }
            "4" { Invoke-CheckDiskHealth }
            "5" { Invoke-CheckDrivers }
            "6" { Invoke-CheckStartupIssues }
            "7" { Invoke-CheckMemory }
            "8" { Invoke-CheckTemperature }
            "9" {
                Write-Host "`nExecutando todos os diagn√≥sticos...`n" -ForegroundColor Yellow
                Invoke-SfcScan
                Invoke-DismRepair
                Invoke-CheckDiskHealth
                Invoke-CheckDrivers
                Invoke-CheckStartupIssues
                Invoke-CheckTemperature
                Write-Host "`nTodos os diagn√≥sticos foram conclu√≠dos!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Diagn√≥stico..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Recursos (Dentro do Avan√ßado!) ---
function Show-RecursosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: RECURSOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Gerenciar Hiberna√ß√£o" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Planos de Energia" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Recursos Opcionais do Windows" -ForegroundColor White
        Write-Host "[4] Gerenciar Mem√≥ria Virtual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Windows Defender" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Recursos de Telemetria" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Recursos de Inicializa√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Recursos de Seguran√ßa" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de recursos"

        switch ($choice) {
            "1" { Invoke-ManageHibernation }
            "2" { Invoke-ManagePowerPlans }
            "3" { Invoke-ManageOptionalFeatures }
            "4" { Invoke-ManageVirtualMemory }
            "5" { Invoke-ManageWindowsDefender }
            "6" { Invoke-ManageTelemetry }
            "7" { Invoke-ManageStartupResources }
            "8" { Invoke-ManageSecurityFeatures }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Arquivos e Pastas (Dentro do Avan√ßado!) ---
function Show-ArquivosPastasMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: ARQUIVOS E PASTAS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Encontrar Arquivos Grandes" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Arquivos" -ForegroundColor Cyan
        Write-Host "[3] Tomar Posse de Arquivos (TakeOwn)" -ForegroundColor White
        Write-Host "[4] Listar Conte√∫do de Pastas Espec√≠ficas" -ForegroundColor Green
        Write-Host "[5] Compactar Pastas para Economizar Espa√ßo" -ForegroundColor Magenta
        Write-Host "[6] Verificar Integridade de Arquivos" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Arquivos Ocultos e do Sistema" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Atributos de Arquivos" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de arquivos e pastas"

        switch ($choice) {
            "1" { Invoke-FindLargeFiles }
            "2" { Invoke-ManageFilePermissions }
            "3" { Invoke-TakeOwnership }
            "4" { Invoke-ListFolderContents }
            "5" { Invoke-CompressFolders }
            "6" { Invoke-VerifyFileIntegrity }
            "7" { Invoke-ManageHiddenSystemFiles }
            "8" { Invoke-ManageFileAttributes }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Usu√°rios (Dentro do Avan√ßado!) ---
function Show-UsuariosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: USUARIOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Listar Todos os Usu√°rios Locais" -ForegroundColor Yellow
        Write-Host "[2] Listar Todos os Grupos Locais" -ForegroundColor Cyan
        Write-Host "[3] Listar Membros de Grupos Espec√≠ficos" -ForegroundColor White
        Write-Host "[4] Mostrar Propriedades do Usu√°rio Atual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Contas de Usu√°rio" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Pol√≠ticas de Senha" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Permiss√µes de Usu√°rio" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar UAC (Controle de Conta de Usu√°rio)" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de usu√°rios"

        switch ($choice) {
            "1" { Invoke-ListLocalUsers }
            "2" { Invoke-ListLocalGroups }
            "3" { Invoke-ListGroupMembers }
            "4" { Invoke-ShowCurrentUserProperties }
            "5" { Invoke-ManageUserAccounts }
            "6" { Invoke-ManagePasswordPolicies }
            "7" { Invoke-ManageUserPermissions }
            "8" { Invoke-ManageUAC }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Jogos Avan√ßado (Dentro do Avan√ßado!) ---
function Show-JogosAvancadoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: JOGOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Otimizar Prioridade de CPU para Jogos" -ForegroundColor Yellow
        Write-Host "[2] Otimizar Configura√ß√µes de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[3] Otimizar Configura√ß√µes de GPU" -ForegroundColor White
        Write-Host "[4] Desativar Game DVR e Game Bar" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Configurar Modo de Jogo do Windows" -ForegroundColor Gray
        Write-Host "[7] Otimizar Configura√ß√µes de √Åudio para Jogos" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Configura√ß√µes de Input Lag" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes para jogos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o para jogos"

        switch ($choice) {
            "1" { Invoke-OptimizeCpuPriority }
            "2" { Invoke-OptimizeNetworkForGaming }
            "3" { Invoke-OptimizeGpuSettings }
            "4" { Invoke-DisableGameDvrBar }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-ConfigureGameMode }
            "7" { Invoke-OptimizeAudioForGaming }
            "8" { Invoke-OptimizeInputLag }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes para jogos...`n" -ForegroundColor Yellow
                Invoke-OptimizeCpuPriority
                Invoke-OptimizeNetworkForGaming
                Invoke-OptimizeGpuSettings
                Invoke-DisableGameDvrBar
                Invoke-OptimizeServicesForGaming
                Invoke-ConfigureGameMode
                Invoke-OptimizeAudioForGaming
                Invoke-OptimizeInputLag
                Write-Host "`nTodas as otimiza√ß√µes para jogos foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Jogos..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Privacidade (Dentro do Avan√ßado!) ---
function Show-PrivacidadeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: PRIVACIDADE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desativar Telemetria do Windows" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Aplicativos" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Hist√≥rico de Atividades" -ForegroundColor White
        Write-Host "[4] Gerenciar Diagn√≥stico e Feedback" -ForegroundColor Green
        Write-Host "[5] Gerenciar An√∫ncios Personalizados" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Localiza√ß√£o e Sensores" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Reconhecimento de Voz e Digita√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Sincroniza√ß√£o com a Microsoft" -ForegroundColor Cyan
        Write-Host "[9] Aplicar TODAS as configura√ß√µes de privacidade" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de privacidade"

        switch ($choice) {
            "1" { Invoke-DisableTelemetry }
            "2" { Invoke-ManageAppPermissions }
            "3" { Invoke-ManageActivityHistory }
            "4" { Invoke-ManageDiagnosticsFeedback }
            "5" { Invoke-ManagePersonalizedAds }
            "6" { Invoke-ManageLocationSensors }
            "7" { Invoke-ManageVoiceTyping }
            "8" { Invoke-ManageMicrosoftSync }
            "9" {
                Write-Host "`nAplicando todas as configura√ß√µes de privacidade...`n" -ForegroundColor Yellow
                Invoke-DisableTelemetry
                Invoke-ManageAppPermissions
                Invoke-ManageActivityHistory
                Invoke-ManageDiagnosticsFeedback
                Invoke-ManagePersonalizedAds
                Invoke-ManageLocationSensors
                Invoke-ManageVoiceTyping
                Invoke-ManageMicrosoftSync
                Write-Host "`nTodas as configura√ß√µes de privacidade foram aplicadas!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Privacidade..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Outros (Dentro do Avan√ßado!) ---
function Show-OutrosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: OUTROS TWEAKS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Mostrar Informa√ß√µes Detalhadas do Sistema" -ForegroundColor Yellow
        Write-Host "[2] Mostrar Configura√ß√£o Completa de Rede" -ForegroundColor Cyan
        Write-Host "[3] Reiniciar Explorer.exe" -ForegroundColor White
        Write-Host "[4] Limpar Cache de Atualiza√ß√µes do Windows" -ForegroundColor Green
        Write-Host "[5] Gerenciar Programas de Inicializa√ß√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar Op√ß√µes de Energia Avan√ßadas" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Configura√ß√µes de Armazenamento" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Configura√ß√µes de Notifica√ß√µes" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√µes diversas"

        switch ($choice) {
            "1" { Invoke-ShowDetailedSystemInfo }
            "2" { Invoke-ShowDetailedNetworkConfig }
            "3" { Invoke-RestartExplorer }
            "4" { Invoke-CleanWindowsUpdateCache }
            "5" { Invoke-ManageStartupPrograms }
            "6" { Invoke-ConfigureAdvancedPowerOptions }
            "7" { Invoke-ManageStorageSettings }
            "8" { Invoke-ManageNotificationSettings }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- Fun√ß√µes para as Secoes SIMPLIFICADAS (Expandidas) ---
function Invoke-SimpleSystemCleanup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza Geral do Sistema: Hora de varrer o lixo digital! ---" -ForegroundColor Green
    Write-Host "Essa op√ß√£o vai te ajudar a liberar espa√ßo e dar um f√¥lego pro PC tirando arquivos tempor√°rios, lixo da lixeira, etc. √â tipo faxina no computador!" -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Comando 1: Limpar Arquivos Tempor√°rios do Usu√°rio
    Write-Host "Bora come√ßar limpando os arquivos tempor√°rios do seu usu√°rio! Eles acumulam que √© uma beleza!" -ForegroundColor Yellow
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio limpos! Menos peso pro PC respirar! ;)" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Esvaziar a Lixeira
    Write-Host "Agora, vamos dar um fim definitivo naqueles arquivos na Lixeira. Eles s√≥ est√£o ocupando espa√ßo √† toa!" -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada! Espa√ßo recuperado com sucesso! R√°!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios do Windows
    Write-Host "Vamos limpar tamb√©m os tempor√°rios do pr√≥prio Windows. √Äs vezes, fica lixo escondido por l√°!" -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Limpar Cache de Navegadores Comuns
    Write-Host "Bora dar uma geral nos caches dos navegadores tamb√©m! Eles guardam um monte de coisa que pode pesar!" -ForegroundColor Yellow
    
    # Chrome
    Write-Host "Tentando limpar cache do Google Chrome..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Chrome limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Edge
    Write-Host "Tentando limpar cache do Microsoft Edge..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Edge limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Firefox
    Write-Host "Tentando limpar cache do Mozilla Firefox..." -ForegroundColor DarkGray
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\cache2\entries\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\startupCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\thumbnails\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Firefox limpo (pode n√£o ser completo, dependendo do perfil/uso)." -ForegroundColor DarkGray

    # Brave (se instalado)
    Write-Host "Tentando limpar cache do Brave Browser (se instalado)..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Brave limpo (se instalado e n√£o estiver rodando)." -ForegroundColor DarkGray

    Write-Host "Limpeza de caches de navegador conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Comando 5: Limpar Cache de Miniaturas
    Write-Host "Limpando cache de miniaturas do Windows (aquelas pr√©-visualiza√ß√µes de imagens e v√≠deos)..." -ForegroundColor Yellow
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Write-Host "Cache de miniaturas limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Limpar Arquivos de Log do Windows
    Write-Host "Limpando arquivos de log do Windows que podem ocupar espa√ßo..." -ForegroundColor Yellow
    wevtutil cl Application
    wevtutil cl System
    wevtutil cl Security
    Write-Host "Logs do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 7: Limpar Arquivos Tempor√°rios de Instala√ß√£o
    Write-Host "Limpando arquivos tempor√°rios de instala√ß√£o de programas..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Installer\$*\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios de instala√ß√£o limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 8: Limpar Arquivos de Atualiza√ß√£o do Windows
    Write-Host "Limpando arquivos de atualiza√ß√£o do Windows que podem ocupar bastante espa√ßo..." -ForegroundColor Yellow
    Stop-Service -Name wuauserv -ErrorAction SilentlyContinue
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    Write-Host "Arquivos de atualiza√ß√£o do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 9: Limpar Arquivos Prefetch
    Write-Host "Limpando arquivos prefetch para melhorar a inicializa√ß√£o..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Prefetch\*.pf" -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos prefetch limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 10: Executar Limpeza de Disco Integrada do Windows
    Write-Host "Executando a ferramenta de limpeza de disco integrada do Windows..." -ForegroundColor Yellow
    Start-Process -FilePath cleanmgr.exe -ArgumentList "/sagerun:1" -Wait -ErrorAction SilentlyContinue
    Write-Host "Limpeza de disco conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "Vamos ver quanto espa√ßo conseguimos recuperar com essa faxina:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nPronto! A faxina geral b√°sica foi feita! Seu PC agradece o espa√ßo extra! ;)" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu
    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleMemoryStartup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Mem√≥ria e Inicializa√ß√£o R√°pida: Deixa o PC ligando num piscar! ---" -ForegroundColor Yellow
    Write-Host "Aqui a gente d√° uma olhada na mem√≥ria RAM e nos programas que ligam junto com o Windows. Menos coisa ligando √† toa = PC mais r√°pido pra usar na hora!" -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Listar Programas de Inicializa√ß√£o
    Write-Host "Listando programas que iniciam com o Windows (pra voc√™ saber o que t√° rodando por baixo dos panos):" -ForegroundColor Yellow
    Get-CimInstance win32_startupcommand | Select-Object Name, command, Location | Format-Table -AutoSize
    Write-Host "Lista de programas de inicializa√ß√£o exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Servi√ßo SuperFetch/SysMain
    Write-Host "Otimizando o servi√ßo SuperFetch/SysMain para melhorar o desempenho..." -ForegroundColor Yellow
    $confirmSysMain = Read-Host "Deseja desativar o servi√ßo SysMain/SuperFetch? (s/n) - Recomendado para SSDs"
    if ($confirmSysMain -eq 's') {
        Set-Service -Name SysMain -StartupType Disabled -ErrorAction SilentlyContinue
        Stop-Service -Name SysMain -Force -ErrorAction SilentlyContinue
        Write-Host "Servi√ßo SysMain/SuperFetch desativado!" -ForegroundColor Green
    } else {
        Write-Host "Servi√ßo SysMain/SuperFetch mantido ativo." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios de Updates
    Write-Host "Limpando arquivos tempor√°rios de atualiza√ß√µes do Windows (podem ocupar bastante espa√ßo e afetar performance):" -ForegroundColor Yellow
    Dism /online /Cleanup-Image /StartComponentCleanup /ErrorAction SilentlyContinue
    Write-Host "Limpeza de componentes de atualiza√ß√£o iniciada (pode levar um tempo)." -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Mem√≥ria Virtual
    Write-Host "Otimizando configura√ß√µes de mem√≥ria virtual para melhor desempenho..." -ForegroundColor Yellow
    $totalRam = (Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property capacity -Sum).Sum / 1GB
    Write-Host "Seu sistema tem aproximadamente $totalRam GB de RAM." -ForegroundColor White
    
    $confirmPageFile = Read-Host "Deseja otimizar o arquivo de pagina√ß√£o (mem√≥ria virtual)? (s/n)"
    if ($confirmPageFile -eq 's') {
        # Calcula tamanho recomendado (1.5x a RAM para sistemas com menos de 8GB, 1x para sistemas com mais)
        $pageFileSize = if ($totalRam -lt 8) { [math]::Round($totalRam * 1.5) * 1024 } else { [math]::Round($totalRam) * 1024 }
        
        Write-Host "Configurando arquivo de pagina√ß√£o para tamanho fixo de $pageFileSize MB..." -ForegroundColor DarkGray
        $computerSystem = Get-WmiObject -Class Win32_ComputerSystem
        $computerSystem.AutomaticManagedPagefile = $false
        $computerSystem.Put() | Out-Null
        
        $pageFileSetting = Get-WmiObject -Class Win32_PageFileSetting
        if ($pageFileSetting) {
            $pageFileSetting.InitialSize = $pageFileSize
            $pageFileSetting.MaximumSize = $pageFileSize
            $pageFileSetting.Put() | Out-Null
        }
        Write-Host "Arquivo de pagina√ß√£o otimizado! (Requer reinicializa√ß√£o para aplicar totalmente)" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes de mem√≥ria virtual mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Listar os 10 Processos que mais usam mem√≥ria no momento
    Write-Host "Listando os 10 processos que mais consomem mem√≥ria agora:" -ForegroundColor Yellow
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host "Lista de processos exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Otimizar Inicializa√ß√£o do Windows
    Write-Host "Otimizando a inicializa√ß√£o do Windows..." -ForegroundColor Yellow
    # Desabilitar servi√ßos n√£o essenciais que podem atrasar a inicializa√ß√£o
    $startupServices = @(
        @{Name="DiagTrack"; DisplayName="Experi√™ncias do Usu√°rio Conectado e Telemetria"},
        @{Name="dmwappushservice"; DisplayName="Servi√ßo de Transfer√™ncia Inteligente em Segundo Plano (BITS)"},
        @{Name="MapsBroker"; DisplayName="Servi√ßo de Dados de Mapas"}
    )
    
    foreach ($service in $startupServices) {
        $confirmService = Read-Host "Deseja desativar o servi√ßo '$($service.DisplayName)' na inicializa√ß√£o? (s/n)"
        if ($confirmService -eq 's') {
            Set-Service -Name $service.Name -StartupType Disabled -ErrorAction SilentlyContinue
            Stop-Service -Name $service.Name -Force -ErrorAction SilentlyContinue
            Write-Host "Servi√ßo '$($service.DisplayName)' desativado!" -ForegroundColor Green
        } else {
            Write-Host "Servi√ßo '$($service.DisplayName)' mantido." -ForegroundColor Green
        }
    }
    Write-Host ""

    # Comando 7: Reiniciar o Computador (√ötil pra liberar mem√≥ria e aplicar mudan√ßas)
    Write-Host "Quer dar um 'refresh' geral no PC? Reiniciar pode ajudar!" -ForegroundColor Yellow
    $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (digite 'sim' para confirmar)"
    if ($confirmRestart -eq 'sim') {
        Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
        Restart-Computer -Force
    } else {
        Write-Host "Rein√≠cio cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o de mem√≥ria e inicializa√ß√£o!" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu (a n√£o ser que o PC tenha reiniciado)
    if ($confirmRestart -ne 'sim') {
        Write-Host ""
        Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
    }
}

function Invoke-SimpleInternetOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Acelerar a Conex√£o com a Internet (Simplificado): Diz adeus pro 'carregando...'! ---" -ForegroundColor Cyan
    Write-Host "Vamos fazer uns ajustes r√°pidos na sua conex√£o pra tentar deixar ela mais esperta." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Limpar Cache de DNS
    Write-Host "Limpando o cache de endere√ßos de internet (DNS) pra resolver nomes mais r√°pido!" -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Configura√ß√µes TCP/IP
    Write-Host "Otimizando configura√ß√µes TCP/IP para melhorar a velocidade de conex√£o..." -ForegroundColor Yellow
    
    # Habilitar TCP Window Auto-Tuning
    netsh int tcp set global autotuninglevel=normal
    Write-Host "TCP Auto-Tuning configurado para 'normal'." -ForegroundColor DarkGray
    
    # Otimizar par√¢metros de recebimento de pacotes
    netsh int tcp set global rss=enabled
    Write-Host "Receive-Side Scaling (RSS) habilitado." -ForegroundColor DarkGray
    
    # Otimizar congestion provider
    netsh int tcp set global congestionprovider=ctcp
    Write-Host "Congestion Provider configurado para 'ctcp'." -ForegroundColor DarkGray
    
    # Otimizar ECN capability
    netsh int tcp set global ecncapability=enabled
    Write-Host "ECN Capability habilitado." -ForegroundColor DarkGray
    
    Write-Host "Configura√ß√µes TCP/IP otimizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Reiniciar Adaptadores de Rede
    Write-Host "Dando um 'reset' r√°pido nas suas conex√µes de rede. Pode resolver uns pepinos!" -ForegroundColor Yellow
    $confirmResetAdapter = Read-Host "Isso vai desconectar brevemente sua internet. Continuar? (s/n)"
    if ($confirmResetAdapter -eq 's') {
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        Write-Host "Adaptadores de rede reiniciados." -ForegroundColor Green
    } else {
        Write-Host "Reset de adaptadores cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 4: Configurar DNS R√°pido
    Write-Host "Configurar DNS mais r√°pido pode melhorar sua navega√ß√£o!" -ForegroundColor Yellow
    $confirmDns = Read-Host "Deseja configurar DNS mais r√°pidos (Google ou Cloudflare)? (s/n)"
    if ($confirmDns -eq 's') {
        Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
        Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
        $dnsChoice = Read-Host "Escolha uma op√ß√£o (1 ou 2)"
        
        $primaryDns = ""
        $secondaryDns = ""
        
        if ($dnsChoice -eq '1') {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            Write-Host "Google DNS selecionado." -ForegroundColor DarkGray
        } elseif ($dnsChoice -eq '2') {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            Write-Host "Cloudflare DNS selecionado." -ForegroundColor DarkGray
        } else {
            Write-Host "Op√ß√£o inv√°lida. DNS n√£o alterado." -ForegroundColor Red
        }
        
        if ($primaryDns -ne "") {
            $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" -and ($_.InterfaceDescription -match "Ethernet" -or $_.InterfaceDescription -match "Wi-Fi" -or $_.InterfaceDescription -match "Wireless") }
            
            foreach ($adapter in $networkAdapters) {
                Write-Host "Configurando DNS para adaptador: $($adapter.Name)" -ForegroundColor DarkGray
                Set-DnsClientServerAddress -InterfaceIndex $adapter.ifIndex -ServerAddresses ($primaryDns, $secondaryDns)
            }
            
            Write-Host "DNS configurado! Sua navega√ß√£o deve ficar mais r√°pida agora." -ForegroundColor Green
        }
    } else {
        Write-Host "Configura√ß√£o de DNS mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Mostrar Status B√°sico da Conex√£o
    Write-Host "Mostrando um resumo b√°sico da sua configura√ß√£o de rede atual:" -ForegroundColor Yellow
    ipconfig /all | Select-String -Pattern "IPv4", "DNS", "Gateway", "DHCP", "Subnet", "Physical Address"
    Write-Host "Status b√°sico da rede exibido." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Testar a conex√£o com a internet
    Write-Host "Testando a conex√£o com a internet (ping para google.com)..." -ForegroundColor Yellow
    Test-Connection -Count 4 google.com -ErrorAction SilentlyContinue
    Write-Host "Teste de conex√£o finalizado." -ForegroundColor Green
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o b√°sica de internet!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleVisualOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Deixar o Windows mais Leve Visualmente (Simplificado): Desempenho antes da beleza! ---" -ForegroundColor White
    Write-Host "Ajustes r√°pidos pra desativar efeitos visuais que podem pesar, liberando recursos pro que importa." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ajustar Efeitos Visuais
    Write-Host "Voc√™ quer desativar ou ativar as anima√ß√µes e efeitos visuais do Windows?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Efeitos Visuais (Pra ganhar desempenho)" -ForegroundColor Green
    Write-Host "[2] Configurar para Melhor Apar√™ncia (Mais bonito, mas mais pesado)" -ForegroundColor White
    Write-Host "[3] Deixar o Windows Escolher (Configura√ß√£o padr√£o)" -ForegroundColor Cyan
    $choiceVisual = Read-Host "Escolha [1], [2] ou [3]"

    if ($choiceVisual -eq '1') {
        Write-Host "Desativando efeitos visuais para melhor desempenho..." -ForegroundColor Yellow
        # Valor 2 = Ajustar para melhor desempenho (desativa a maioria dos efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 2 -Type DWord -Force -ErrorAction SilentlyContinue
        
        # Desativar anima√ß√µes individuais
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop' -Name 'UserPreferencesMask' -Value ([byte[]](0x90, 0x12, 0x01, 0x80)) -Type Binary -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop\WindowMetrics' -Name 'MinAnimate' -Value 0 -Type String -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'ListviewAlphaSelect' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'TaskbarAnimations' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        
        Write-Host "Efeitos visuais desativados para melhor desempenho!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '2') {
        Write-Host "Configurando para melhor apar√™ncia (todos os efeitos visuais ativados)..." -ForegroundColor Yellow
        # Valor 1 = Ajustar para melhor apar√™ncia (ativa todos os efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Efeitos visuais configurados para melhor apar√™ncia!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '3') {
        Write-Host "Deixando o Windows escolher automaticamente (configura√ß√£o padr√£o)..." -ForegroundColor Yellow
        # Valor 0 = Deixar o Windows escolher
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Configura√ß√£o visual definida para padr√£o do Windows!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa nos efeitos visuais foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 2: Ativar/Desativar Efeitos de Transpar√™ncia
    Write-Host "E os efeitos de transpar√™ncia do Windows (tipo na barra de tarefas)?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Transpar√™ncia (Mais leve)" -ForegroundColor Green
    Write-Host "[2] Ativar Transpar√™ncia (Mais 'bonito')" -ForegroundColor White
    $choiceTransp = Read-Host "Escolha [1] ou [2]"

    if ($choiceTransp -eq '1') {
        Write-Host "Desativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 0 = Desativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia desativada!" -ForegroundColor Green
    } elseif ($choiceTransp -eq '2') {
        Write-Host "Ativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 1 = Ativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia ativada!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa na transpar√™ncia foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 3: Configurar Tema Claro/Escuro
    Write-Host "Voc√™ prefere tema claro ou escuro? O tema escuro pode ser mais confort√°vel para os olhos." -ForegroundColor Yellow
    Write-Host "[1] Tema Escuro (Dark Mode)" -ForegroundColor DarkGray
    Write-Host "[2] Tema Claro (Light Mode)" -ForegroundColor White
    $choiceTheme = Read-Host "Escolha [1] ou [2]"

    if ($choiceTheme -eq '1') {
        Write-Host "Configurando tema escuro..." -ForegroundColor Yellow
        # Valor 0 = Tema Escuro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema escuro configurado!" -ForegroundColor Green
    } elseif ($choiceTheme -eq '2') {
        Write-Host "Configurando tema claro..." -ForegroundColor Yellow
        # Valor 1 = Tema Claro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema claro configurado!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa no tema foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Configurar Resolu√ß√£o de Tela
    Write-Host "Deseja ajustar a resolu√ß√£o da tela? Resolu√ß√µes menores podem melhorar o desempenho em PCs mais antigos." -ForegroundColor Yellow
    $confirmResolution = Read-Host "Deseja ver e ajustar a resolu√ß√£o da tela? (s/n)"
    
    if ($confirmResolution -eq 's') {
        # Mostrar resolu√ß√£o atual
        $currentResolution = Get-WmiObject -Class Win32_VideoController | Select-Object -ExpandProperty VideoModeDescription
        Write-Host "Resolu√ß√£o atual: $currentResolution" -ForegroundColor White
        
        # Abrir configura√ß√µes de exibi√ß√£o do Windows
        Write-Host "Abrindo configura√ß√µes de exibi√ß√£o do Windows..." -ForegroundColor DarkGray
        Start-Process "ms-settings:display"
        Write-Host "Ajuste a resolu√ß√£o conforme necess√°rio na janela de configura√ß√µes que foi aberta." -ForegroundColor Green
        
        $waitForSettings = Read-Host "Pressione Enter quando terminar de ajustar as configura√ß√µes de exibi√ß√£o"
    } else {
        Write-Host "Configura√ß√£o de resolu√ß√£o mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizados os ajustes visuais b√°sicos!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleGamingOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Jogos (Simplificado): Mais FPS, menos lag! ---" -ForegroundColor Magenta
    Write-Host "Vamos fazer alguns ajustes para melhorar o desempenho dos seus jogos sem complica√ß√µes." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ativar Modo de Jogo do Windows
    Write-Host "Ativando o Modo de Jogo do Windows para priorizar recursos para jogos..." -ForegroundColor Yellow
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AllowAutoGameMode" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AutoGameModeEnabled" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Write-Host "Modo de Jogo do Windows ativado!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Desativar Game DVR e Game Bar
    Write-Host "O Game DVR e Game Bar podem reduzir o desempenho em jogos. Deseja desativ√°-los?" -ForegroundColor Yellow
    $confirmGameDVR = Read-Host "Desativar Game DVR e Game Bar? (s/n)"
    
    if ($confirmGameDVR -eq 's') {
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "UseNexusForGameBarEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\System\GameConfigStore" -Name "GameDVR_Enabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR" -Name "AppCaptureEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Write-Host "Game DVR e Game Bar desativados!" -ForegroundColor Green
    } else {
        Write-Host "Game DVR e Game Bar mantidos ativos." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Otimizar Plano de Energia para Jogos
    Write-Host "Configurando plano de energia para alto desempenho (ideal para jogos)..." -ForegroundColor Yellow
    powercfg.exe /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c
    Write-Host "Plano de energia configurado para alto desempenho!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Configura√ß√µes de Mouse
    Write-Host "Otimizando configura√ß√µes de mouse para jogos (precis√£o do ponteiro)..." -ForegroundColor Yellow
    $confirmMouseFix = Read-Host "Desativar a acelera√ß√£o do mouse para melhor precis√£o em jogos? (s/n)"
    
    if ($confirmMouseFix -eq 's') {
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseSpeed" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold1" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold2" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Write-Host "Acelera√ß√£o do mouse desativada para melhor precis√£o em jogos!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do mouse mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Otimizar Prioridade de CPU para Jogos
    Write-Host "Configurando prioridade de CPU para jogos..." -ForegroundColor Yellow
    Write-Host "Esta configura√ß√£o ajusta o sistema para dar mais prioridade aos jogos." -ForegroundColor DarkGray
    
    # Criar chave de registro para prioridade de jogos
    if (-not (Test-Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games")) {
        New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Force | Out-Null
    }
    
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "GPU Priority" -Type DWord -Value 8 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Priority" -Type DWord -Value 6 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Scheduling Category" -Type String -Value "High" -Force -ErrorAction SilentlyContinue
    
    Write-Host "Prioridade de CPU para jogos otimizada!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Verificar Driver de Placa de V√≠deo
    Write-Host "Verificando informa√ß√µes da placa de v√≠deo..." -ForegroundColor Yellow
    $gpuInfo = Get-WmiObject -Class Win32_VideoController | Select-Object Name, DriverVersion, CurrentHorizontalResolution, CurrentVerticalResolution
    
    foreach ($gpu in $gpuInfo) {
        Write-Host "Placa de v√≠deo: $($gpu.Name)" -ForegroundColor White
        Write-Host "Vers√£o do driver: $($gpu.DriverVersion)" -ForegroundColor White
        Write-Host "Resolu√ß√£o atual: $($gpu.CurrentHorizontalResolution) x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
      x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
    
    Write-Host "Recomenda√ß√£o: Mantenha seus drivers de v√≠deo atualizados para melhor desempenho em jogos!" -ForegroundColor Green
    Write-Host "Voc√™ pode baixar os drivers mais recentes nos sites oficiais da NVIDIA, AMD ou Intel." -ForegroundColor DarkGray
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nOtimiza√ß√µes para jogos conclu√≠das! Seus jogos devem rodar mais suaves agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleSecurityMaintenance {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Manuten√ß√£o de Seguran√ßa (Simplificado): Mantenha seu PC protegido! ---" -ForegroundColor DarkYellow
    Write-Host "Vamos verificar e melhorar a seguran√ßa do seu sistema com alguns ajustes simples." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Verificar Status do Windows Defender
    Write-Host "Verificando status do Windows Defender..." -ForegroundColor Yellow
    $defenderStatus = Get-MpComputerStatus
    
    Write-Host "Status do Windows Defender:" -ForegroundColor White
    Write-Host "Antiv√≠rus habilitado: $($defenderStatus.AntivirusEnabled)" -ForegroundColor $(if ($defenderStatus.AntivirusEnabled) { "Green" } else { "Red" })
    Write-Host "Prote√ß√£o em tempo real: $($defenderStatus.RealTimeProtectionEnabled)" -ForegroundColor $(if ($defenderStatus.RealTimeProtectionEnabled) { "Green" } else { "Red" })
    Write-Host "Defini√ß√µes de antiv√≠rus: $($defenderStatus.AntivirusSignatureVersion)" -ForegroundColor White
    Write-Host "√öltima atualiza√ß√£o: $($defenderStatus.AntivirusSignatureLastUpdated)" -ForegroundColor White
    Write-Host ""

    # Comando 2: Atualizar Defini√ß√µes do Windows Defender
    Write-Host "Atualizando defini√ß√µes do Windows Defender..." -ForegroundColor Yellow
    Update-MpSignature -ErrorAction SilentlyContinue
    Write-Host "Defini√ß√µes do Windows Defender atualizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Verificar Atualiza√ß√µes do Windows
    Write-Host "Verificando status das atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
            Write-Host "Recomenda√ß√£o: Execute o Windows Update para manter seu sistema seguro." -ForegroundColor Green
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Verificar Configura√ß√µes de Firewall
    Write-Host "Verificando status do Firewall do Windows..." -ForegroundColor Yellow
    $firewallStatus = Get-NetFirewallProfile
    
    foreach ($profile in $firewallStatus) {
        Write-Host "Perfil: $($profile.Name)" -ForegroundColor White
        Write-Host "Status: $($profile.Enabled)" -ForegroundColor $(if ($profile.Enabled) { "Green" } else { "Red" })
        Write-Host ""
    }
    
    $confirmFirewall = Read-Host "Deseja habilitar o Firewall em todos os perfis? (s/n)"
    if ($confirmFirewall -eq 's') {
        Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True
        Write-Host "Firewall habilitado em todos os perfis!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do Firewall mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Verificar Configura√ß√µes de UAC
    Write-Host "Verificando configura√ß√µes do Controle de Conta de Usu√°rio (UAC)..." -ForegroundColor Yellow
    $uacLevel = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -ErrorAction SilentlyContinue
    
    if ($uacLevel) {
        switch ($uacLevel.ConsentPromptBehaviorAdmin) {
            0 { $uacStatus = "Desativado (N√£o recomendado)" }
            1 { $uacStatus = "Baixo (N√£o recomendado)" }
            2 { $uacStatus = "M√©dio" }
            5 { $uacStatus = "Alto (Recomendado)" }
            default { $uacStatus = "Personalizado" }
        }
        
        Write-Host "N√≠vel atual do UAC: $uacStatus" -ForegroundColor $(if ($uacLevel.ConsentPromptBehaviorAdmin -ge 2) { "Green" } else { "Red" })
        
        $confirmUAC = Read-Host "Deseja configurar o UAC para o n√≠vel recomendado? (s/n)"
        if ($confirmUAC -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -Value 5 -Type DWord -Force -ErrorAction SilentlyContinue
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "PromptOnSecureDesktop" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
            Write-Host "UAC configurado para o n√≠vel recomendado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do UAC mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do UAC." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 6: Verificar Configura√ß√µes de SmartScreen
    Write-Host "Verificando configura√ß√µes do Windows SmartScreen..." -ForegroundColor Yellow
    $smartScreen = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -ErrorAction SilentlyContinue
    
    if ($smartScreen) {
        Write-Host "Status do SmartScreen: $($smartScreen.SmartScreenEnabled)" -ForegroundColor $(if ($smartScreen.SmartScreenEnabled -eq "RequireAdmin" -or $smartScreen.SmartScreenEnabled -eq "Warn") { "Green" } else { "Red" })
        
        $confirmSmartScreen = Read-Host "Deseja habilitar o SmartScreen para maior seguran√ßa? (s/n)"
        if ($confirmSmartScreen -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -Value "RequireAdmin" -Type String -Force -ErrorAction SilentlyContinue
            Write-Host "SmartScreen habilitado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do SmartScreen mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do SmartScreen." -ForegroundColor Red
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nManuten√ß√£o de seguran√ßa conclu√≠da! Seu sistema est√° mais protegido agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

# --- Fun√ß√µes para o Diagn√≥stico R√°pido e Sobre ---
function Invoke-QuickDiagnostic {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Diagn√≥stico R√°pido do Sistema ---" -ForegroundColor Yellow
    Write-Host "Vamos fazer uma verifica√ß√£o r√°pida do estado atual do seu PC." -ForegroundColor Gray
    Write-Host ""

    # Informa√ß√µes do Sistema
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    $sysInfo = Get-SystemInfo
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host ""

    # Uso de CPU
    Write-Host "=== Uso de CPU ===" -ForegroundColor Cyan
    $cpuLoad = (Get-WmiObject Win32_Processor).LoadPercentage
    Write-Host "Uso atual de CPU: $cpuLoad%" -ForegroundColor $(if ($cpuLoad -lt 70) { "Green" } elseif ($cpuLoad -lt 90) { "Yellow" } else { "Red" })
    Write-Host ""

    # Uso de Mem√≥ria
    Write-Host "=== Uso de Mem√≥ria ===" -ForegroundColor Cyan
    $os = Get-WmiObject Win32_OperatingSystem
    $totalMemory = [math]::Round($os.TotalVisibleMemorySize / 1MB, 2)
    $freeMemory = [math]::Round($os.FreePhysicalMemory / 1MB, 2)
    $usedMemory = [math]::Round($totalMemory - $freeMemory, 2)
    $memoryPercentage = [math]::Round(($usedMemory / $totalMemory) * 100, 2)
    
    Write-Host "Mem√≥ria Total: $totalMemory GB" -ForegroundColor White
    Write-Host "Mem√≥ria Usada: $usedMemory GB ($memoryPercentage%)" -ForegroundColor $(if ($memoryPercentage -lt 70) { "Green" } elseif ($memoryPercentage -lt 90) { "Yellow" } else { "Red" })
    Write-Host "Mem√≥ria Livre: $freeMemory GB" -ForegroundColor White
    Write-Host ""

    # Espa√ßo em Disco
    Write-Host "=== Espa√ßo em Disco ===" -ForegroundColor Cyan
    $drives = Get-PSDrive -PSProvider FileSystem
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        $percentFree = [math]::Round(($freeSpace / $totalSpace) * 100, 2)
        
        Write-Host "Drive $($drive.Name):" -ForegroundColor White
        Write-Host "  Total: $totalSpace GB" -ForegroundColor White
        Write-Host "  Usado: $usedSpace GB" -ForegroundColor White
        Write-Host "  Livre: $freeSpace GB ($percentFree%)" -ForegroundColor $(if ($percentFree -gt 20) { "Green" } elseif ($percentFree -gt 10) { "Yellow" } else { "Red" })
    }
    Write-Host ""

    # Processos que mais consomem recursos
    Write-Host "=== Top 5 Processos (CPU) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object CPU -Descending | Select-Object -First 5 ProcessName, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}}, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host ""

    Write-Host "=== Top 5 Processos (Mem√≥ria) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 5 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}}, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}} | Format-Table -AutoSize
    Write-Host ""

    # Status de Servi√ßos Cr√≠ticos
    Write-Host "=== Status de Servi√ßos Cr√≠ticos ===" -ForegroundColor Cyan
    $criticalServices = @("wuauserv", "WinDefend", "MpsSvc", "wscsvc")
    foreach ($service in $criticalServices) {
        $serviceStatus = Get-Service -Name $service -ErrorAction SilentlyContinue
        if ($serviceStatus) {
            Write-Host "$($serviceStatus.DisplayName): $($serviceStatus.Status)" -ForegroundColor $(if ($serviceStatus.Status -eq "Running") { "Green" } else { "Red" })
        }
    }
    Write-Host ""

    # Verificar Atualiza√ß√µes Pendentes
    Write-Host "=== Atualiza√ß√µes do Windows ===" -ForegroundColor Cyan
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Recomenda√ß√µes
    Write-Host "=== Recomenda√ß√µes ===" -ForegroundColor Cyan
    
    # Recomenda√ß√£o de Mem√≥ria
    if ($memoryPercentage -gt 80) {
        Write-Host "- Seu uso de mem√≥ria est√° alto. Considere fechar alguns programas ou usar a op√ß√£o 'Otimiza√ß√£o de Mem√≥ria'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Disco
    $lowDiskSpace = $false
    foreach ($drive in $drives) {
        $percentFree = [math]::Round(($drive.Free / ($drive.Free + $drive.Used)) * 100, 2)
        if ($percentFree -lt 15) {
            $lowDiskSpace = $true
            break
        }
    }
    
    if ($lowDiskSpace) {
        Write-Host "- Espa√ßo em disco baixo detectado. Considere usar a op√ß√£o 'Limpeza Geral do Sistema'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Atualiza√ß√µes
    if ($pendingUpdates -gt 0) {
        Write-Host "- Existem atualiza√ß√µes pendentes. Recomendamos atualizar seu sistema para maior seguran√ßa." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Inicializa√ß√£o
    $bootTime = $sysInfo.LastBootTime
    $uptime = (Get-Date) - $bootTime
    if ($uptime.Days -gt 7) {
        Write-Host "- Seu sistema est√° ligado h√° $($uptime.Days) dias. Considere reiniciar para aplicar atualiza√ß√µes e limpar a mem√≥ria." -ForegroundColor Yellow
    }
    
    Write-Host ""

    # Mensagem de conclus√£o
    Write-Host "`nDiagn√≥stico r√°pido conclu√≠do! Use as informa√ß√µes acima para decidir quais otimiza√ß√µes fazer." -ForegroundColor Green

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

function Show-AboutTORK {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Sobre o TORK ---" -ForegroundColor White
    Write-Host ""
    
    Write-Host "TORK - Otimizador para Windows" -ForegroundColor Cyan
    Write-Host "Vers√£o: 2.0" -ForegroundColor White
    Write-Host "Desenvolvido por: Partner77" -ForegroundColor White
    Write-Host ""
    
    Write-Host "=== Descri√ß√£o ===" -ForegroundColor Yellow
    Write-Host "O TORK √© uma ferramenta abrangente de otimiza√ß√£o para Windows, projetada para" -ForegroundColor Gray
    Write-Host "melhorar o desempenho do seu sistema atrav√©s de limpeza, ajustes e otimiza√ß√µes." -ForegroundColor Gray
    Write-Host "Ele oferece op√ß√µes simplificadas para usu√°rios comuns e op√ß√µes avan√ßadas para" -ForegroundColor Gray
    Write-Host "usu√°rios experientes que desejam um controle mais detalhado sobre o sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Recursos ===" -ForegroundColor Yellow
    Write-Host "- Limpeza completa do sistema" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√£o de mem√≥ria e inicializa√ß√£o" -ForegroundColor Gray
    Write-Host "- Ajustes de rede para melhor conectividade" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√µes visuais para melhor desempenho" -ForegroundColor Gray
    Write-Host "- Configura√ß√µes espec√≠ficas para jogos" -ForegroundColor Gray
    Write-Host "- Manuten√ß√£o de seguran√ßa" -ForegroundColor Gray
    Write-Host "- Diagn√≥stico r√°pido do sistema" -ForegroundColor Gray
    Write-Host "- Mais de 100 ajustes e otimiza√ß√µes avan√ßadas" -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Aviso Legal ===" -ForegroundColor Yellow
    Write-Host "Este software √© fornecido 'como est√°', sem garantias de qualquer tipo." -ForegroundColor Gray
    Write-Host "O autor n√£o se responsabiliza por quaisquer danos ou problemas causados pelo uso" -ForegroundColor Gray
    Write-Host "deste software. Use por sua conta e risco. Recomendamos sempre fazer backup" -ForegroundColor Gray
    Write-Host "dos seus dados importantes antes de realizar otimiza√ß√µes no sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Agradecimentos ===" -ForegroundColor Yellow
    Write-Host "Obrigado por escolher o TORK para otimizar seu sistema Windows!" -ForegroundColor Gray
    Write-Host "Esperamos que esta ferramenta ajude a melhorar o desempenho do seu PC." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "¬© 2023-2024 Partner77 - Todos os direitos reservados" -ForegroundColor Cyan
    Write-Host ""
    
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - LIMPEZA (Expandidas) ---
function Invoke-CleanUserTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Usu√°rio ---" -ForegroundColor Cyan
    Write-Host "Remove arquivos da pasta tempor√°ria do seu usu√°rio (`$env:TEMP`)." -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:TEMP..." -ForegroundColor Yellow
    $tempFiles = Get-ChildItem -Path $env:TEMP -Recurse -ErrorAction SilentlyContinue
    $tempFilesCount = ($tempFiles | Measure-Object).Count
    $tempFilesSize = ($tempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $tempFilesCount arquivos tempor√°rios ocupando aproximadamente $([math]::Round($tempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Sistema ---" -ForegroundColor Gray
    Write-Host "Remove arquivos da pasta tempor√°ria do Windows (`$env:SystemRoot\Temp`)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:SystemRoot\Temp..." -ForegroundColor Yellow
    $systemTempFiles = Get-ChildItem -Path "$env:SystemRoot\Temp" -Recurse -ErrorAction SilentlyContinue
    $systemTempFilesCount = ($systemTempFiles | Measure-Object).Count
    $systemTempFilesSize = ($systemTempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $systemTempFilesCount arquivos tempor√°rios do sistema ocupando aproximadamente $([math]::Round($systemTempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do sistema removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanDnsCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-EmptyRecycleBin {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Esvaziar Lixeira ---" -ForegroundColor Gray
    Write-Host "Esvazia a lixeira do usu√°rio logado." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar tamanho da lixeira antes de esvaziar
    Write-Host "Verificando tamanho da lixeira..." -ForegroundColor Yellow
    
    try {
        $shell = New-Object -ComObject Shell.Application
        $recycleBin = $shell.Namespace(0xA)
        $recycleBinItems = $recycleBin.Items()
        $recycleBinItemCount = $recycleBinItems.Count
        
        Write-Host "A lixeira cont√©m $recycleBinItemCount itens." -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o conte√∫do da lixeira." -ForegroundColor DarkGray
    }
    
    # Esvaziar a lixeira
    Write-Host "Executando: Esvaziando a lixeira..." -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanThumbnailCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Miniaturas ---" -ForegroundColor Green
    Write-Host "Remove o cache de miniaturas de arquivos (imagens, v√≠deos, etc.)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Limpando cache de miniaturas..." -ForegroundColor Yellow
    
    # Verificar tamanho do cache de miniaturas antes da limpeza
    $thumbnailPath = "$env:LOCALAPPDATA\Microsoft\Windows\Explorer"
    $thumbnailFiles = Get-ChildItem -Path $thumbnailPath -Filter "thumbcache_*.db" -ErrorAction SilentlyContinue
    $thumbnailFilesCount = ($thumbnailFiles | Measure-Object).Count
    $thumbnailFilesSize = ($thumbnailFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $thumbnailFilesCount arquivos de cache de miniaturas ocupando aproximadamente $([math]::Round($thumbnailFilesSize, 2)) MB." -ForegroundColor White
    
    # Limpar o cache de miniaturas
    Stop-Process -Name explorer -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Start-Process explorer
    
    Write-Host "Cache de miniaturas limpo com sucesso!" -ForegroundColor Green
    Write-Host "O Windows Explorer foi reiniciado para aplicar as altera√ß√µes." -ForegroundColor DarkGray
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de miniaturas:" -ForegroundColor Cyan
    Write-Host "- Navega√ß√£o mais r√°pida em pastas com muitas imagens ou v√≠deos" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de miniaturas corrompidas ou desatualizadas" -ForegroundColor DarkGray
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemLogs {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Logs do Sistema ---" -ForegroundColor Cyan
    Write-Host "Limpa os logs de eventos do sistema para liberar espa√ßo e melhorar o desempenho." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando logs do sistema..." -ForegroundColor Yellow
    
    # Verificar tamanho dos logs antes da limpeza
    $eventLogs = Get-WinEvent -ListLog * -ErrorAction SilentlyContinue | Where-Object { $_.RecordCount -gt 0 }
    $totalLogCount = ($eventLogs | Measure-Object).Count
    $total### Enhanced TORK Optimizer

I'll enhance the TORK optimizer with more comprehensive functionality across all features, starting with an expanded Simple Cleanup function and then improving all other options.

```powershell type="code"
# Define a preferencia de acao para erros (continua a execucao por padrao)
# Permite que o script tente rodar o m√°ximo poss√≠vel mesmo que alguns comandos encontrem problemas.
$ErrorActionPreference = 'SilentlyContinue' # N√£o exibe erros se um item n√£o puder ser processado, por exemplo.

# --- Funcao pra Centralizar Texto (Nosso Maestro de Alinhamento - s√≥ pra textos, n√£o pro bannerz√£o!) ---
# Deixa ela aqui, vai que a gente usa pra centralizar outra coisa, n√©?
function Centraliza($texto, $cor="White") {
    $largura = [console]::WindowWidth # Pega a largura da largura da janela agora
    # Calcula o espa√ßo pra botar o texto no meio. Pura matem√°tica da zoeira!
    $espacos = [Math]::Max(0, [Math]::Floor(($largura - $texto.Length) / 2))
    $linha = (" " * $espacos) + $texto # Cria a linha com os espa√ßos e o texto
    Write-Host $linha -ForegroundColor $cor # Manda pro console com a cor pedida
}

# --- Funcao que Desenha o Nosso Banner Irado do TORK! ---
# Esse √© o nosso outdoor digital no console! Ajustado pros espa√ßos que voc√™ mandou!
# Se as bordas ainda estiverem meio teimosas, √© o jeitinho do console mesmo, viu? üòâ
function Banner-TORK {
    # Nossas cores vibrantes para o banner!
    $CorBorda = "DarkCyan" # Mantido para a borda, combina com o ciano. Se quiser mudar, √© aqui!
    $CorLogo = "Green" # Cor vibrante
    $CorProjeto = "Cyan" # Cor vibrante
    $CorCopyright = "Gray" # Tom mais suave

    Write-Host "" # D√° um espacinho no topo, pra n√£o grudar
    Write-Host "                    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë          ‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë ‚ñà‚ñà‚ïî‚ïù                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ñà‚ñà‚ïó                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù                                          ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë           Bem-vindo ao TORK - Otimizador para Windows!                                ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë        Projeto de automacao, limpeza, manutencao e tweaks.                            ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë            (C) Partner77 - Todos os direitos reservados                               ‚ïë" -ForegroundColor $CorCopyright
    Write-Host "                    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor $CorBorda
    Write-Host "" # Espa√ßo embaixo
}

# --- Checagem de Permiss√µes de Administrador (O Guarda da Porta!) ---
# V√™ se a gente t√° rodando com poderes de admin, sen√£o n√£o d√° pra mexer no Windows direito.
function Test-Administrator {
    $currentUser = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())
    return $currentUser.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
}

if (-not (Test-Administrator)) {
    Write-Host "OPA! Calma l√°, patr√£o!" -ForegroundColor Red
    Write-Host "Pra usar o TORK e deixar o PC voando, preciso de super poderes de Administrador!" -ForegroundColor Yellow
    Write-Host "Fecha essa janela, clica com o bot√£o direito no arquivo do script e escolhe 'Executar como administrador'. A√≠ sim, tamo junto!" -ForegroundColor Yellow
    Read-Host "D√° um Enter quando terminar de ler, que a gente se v√™ na pr√≥xima..."
    Exit
}

Write-Host "Poderes de Administrador verificados! Bora nessa!" -ForegroundColor Green
Start-Sleep -Seconds 1

# --- Fun√ß√µes Utilit√°rias (Ferramentas que usamos em v√°rios lugares) ---
function Get-SystemInfo {
    $os = Get-CimInstance Win32_OperatingSystem
    $cs = Get-CimInstance Win32_ComputerSystem
    $proc = Get-CimInstance Win32_Processor
    $mem = Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property Capacity -Sum
    
    $info = @{
        "OSName" = $os.Caption
        "OSVersion" = $os.Version
        "OSBuild" = $os.BuildNumber
        "ComputerName" = $cs.Name
        "Manufacturer" = $cs.Manufacturer
        "Model" = $cs.Model
        "Processor" = $proc.Name
        "Memory" = [math]::Round($mem.Sum / 1GB, 2)
        "Architecture" = $os.OSArchitecture
        "InstallDate" = $os.InstallDate
        "LastBootTime" = $os.LastBootUpTime
    }
    
    return $info
}

function Show-SystemSummary {
    $sysInfo = Get-SystemInfo
    
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Computador: $($sysInfo.ComputerName)" -ForegroundColor White
    Write-Host "Fabricante: $($sysInfo.Manufacturer)" -ForegroundColor White
    Write-Host "Modelo: $($sysInfo.Model)" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "Instalado em: $($sysInfo.InstallDate)" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

function Get-DiskSpaceBefore {
    $drives = Get-PSDrive -PSProvider FileSystem
    $driveInfo = @{}
    
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        
        $driveInfo[$drive.Name] = @{
            "Free" = $freeSpace
            "Used" = $usedSpace
            "Total" = $totalSpace
        }
    }
    
    return $driveInfo
}

function Show-DiskSpaceComparison {
    param (
        $before
    )
    
    $after = Get-PSDrive -PSProvider FileSystem
    
    Write-Host "=== Compara√ß√£o de Espa√ßo em Disco ===" -ForegroundColor Cyan
    
    foreach ($drive in $after) {
        if ($before.ContainsKey($drive.Name)) {
            $freeSpaceAfter = [math]::Round($drive.Free / 1GB, 2)
            $freeSpaceBefore = $before[$drive.Name].Free
            $spaceRecovered = [math]::Round($freeSpaceAfter - $freeSpaceBefore, 2)
            
            Write-Host "Drive $($drive.Name):" -ForegroundColor White
            Write-Host "  Espa√ßo livre antes: $freeSpaceBefore GB" -ForegroundColor Gray
            Write-Host "  Espa√ßo livre agora: $freeSpaceAfter GB" -ForegroundColor Gray
            
            if ($spaceRecovered -gt 0) {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Green
            } else {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Yellow
            }
            Write-Host ""
        }
    }
    
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

# --- Fun√ß√µes dos Menus (Principal, Simplificado, Avan√ßado e Sub-menus) ---

# --- Menu Principal (A Bifurca√ß√£o do Destino! Simplificado vs Avan√ßado) ---
# √â aqui que o usu√°rio escolhe se quer ser um mago ou um cara pr√°tico!
function Show-MainMenu {
    do {
        Clear-Host # Limpa a tela pra organizar o menu
        Banner-TORK # Banner no topo, pra gente n√£o esquecer quem somos!
        Show-SystemSummary # Mostra um resumo do sistema

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "       MENU PRINCIPAL" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # As duas grandes estradas da otimiza√ß√£o! Cores variadas (repetindo)!
        Write-Host "[1] Otimiza√ß√£o Simplificada (Pra quem quer praticidade e resultado r√°pido!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o Avan√ßada (Pra quem curte mexer fundo e ter control total!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[3] Diagn√≥stico R√°pido do Sistema (Ver o que t√° rolando no PC)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[4] Sobre o TORK (Informa√ß√µes e cr√©ditos)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[0] Sair (Ah, que pena... Mas a porta t√° aberta!)" -ForegroundColor Red # Vermelho pra Sair - Ok

        Write-Host ""

        # Pergunta pro usu√°rio qual caminho ele escolhe, tipo Mestre Pok√©mon!
        $choice = Read-Host "Escolhe sua op√ß√£o, treinador!"

        # V√™ pra onde a gente vai com base na escolha
        switch ($choice) {
            "1" { Show-SimplifiedMenu } # Se escolheu 1, vai pro Menu Simplificado!
            "2" { Show-AdvancedMenu } # Se escolheu 2, vai pro Menu Avan√ßado!
            "3" { Invoke-QuickDiagnostic } # Nova fun√ß√£o de diagn√≥stico r√°pido
            "4" { Show-AboutTORK } # Nova fun√ß√£o de sobre
            "0" { Write-Host "Fechou! Valeu por usar o TORK! Volte sempre que seu PC pedir um g√°s! ;)" -ForegroundColor Green; Start-Sleep -Seconds 2; break } # Se escolheu 0, vaza (mas volta!)
            default {
                Write-Host "Eita! Op√ß√£o inv√°lida! Confere os n√∫meros e tenta de novo, bora l√°!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1 # D√° um tempinho pro usu√°rio ver a zoeira da mensagem
            }
        }
    } while ($choice -ne '0') # Repete o Menu Principal enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Simplificado (Aqui o TORK faz m√°gica r√°pida e segura!) ---
# Acessado pela op√ß√£o 1 do Menu Principal. Menos op√ß√µes, mais a√ß√£o direta!
function Show-SimplifiedMenu {
    do {
        Clear-Host # Limpa o palco pra esse menu!
        Banner-TORK # Nosso banner no topo, sempre presente!

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "   OTIMIZACAO SIMPLIFICADA" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes SIMPLIFICADAS - cada uma pode fazer um monte de coisa por baixo dos panos! Cores variadas (repetindo as prim√°rias/neon e adicionando outras)!
        Write-Host "[1] Limpeza Geral do Sistema (Tira o lixo que t√° pesando!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o de Mem√≥ria e Programas que Ligam com o Windows (Deixa tudo mais √°gil!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[3] Acelerar a Conex√£o com a Internet (Pra navegar sem gargalo!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[4] Deixar o Windows mais Leve Visualmente (Desativa uns efeitos pra ganhar desempenho!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Otimiza√ß√£o de Jogos (Configura√ß√µes pra melhorar FPS e desempenho)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[6] Manuten√ß√£o de Seguran√ßa (Verificar e corrigir problemas de seguran√ßa)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[7] RODAR TODAS as otimiza√ß√µes SIMPLIFICADAS! (Modo Turbo F√°cil!)" -ForegroundColor Red # Vermelho pra "Faz Tudo" - Destaque/Cuidado
        Write-Host "[0] Voltar ao Menu Principal (A gente te espera aqui!)" -ForegroundColor Gray # Cor neutra pra voltar

        Write-Host ""

        # Pergunta qual m√°gica simplificada o usu√°rio quer
        $choice = Read-Host "Escolhe sua m√°gica simplificada!"

        # V√™ qual m√°gica rodar
        switch ($choice) {
            "1" { Invoke-SimpleSystemCleanup } # Chama a fun√ß√£o de limpeza b√°sica
            "2" { Invoke-SimpleMemoryStartup } # Chama a fun√ß√£o pra mem√≥ria/inicializa√ß√£o
            "3" { Invoke-SimpleInternetOpt } # Chama a fun√ß√£o pra internet
            "4" { Invoke-SimpleVisualOpt } # Chama a fun√ß√£o pra visual
            "5" { Invoke-SimpleGamingOpt } # Nova fun√ß√£o para otimiza√ß√£o de jogos
            "6" { Invoke-SimpleSecurityMaintenance } # Nova fun√ß√£o para manuten√ß√£o de seguran√ßa
            "7" {
                # Rodar todas as simplificadas sequencialmente
                Write-Host "`nModo Turbo F√°cil ATIVADO! Rodando todas as otimiza√ß√µes SIMPLIFICADAS... segura pe√£o!`n" -ForegroundColor Yellow
                Invoke-SimpleSystemCleanup # Roda a 1
                Invoke-SimpleMemoryStartup # Roda a 2
                Invoke-SimpleInternetOpt # Roda a 3
                Invoke-SimpleVisualOpt # Roda a 4
                Invoke-SimpleGamingOpt # Roda a 5
                Invoke-SimpleSecurityMaintenance # Roda a 6
                Write-Host "`nShow! Todas as otimiza√ß√µes SIMPLIFICADAS foram executadas! PC t√° agradecendo! ;)`n" -ForegroundColor Green
                Read-Host "Aperta Enter pra voltar pro Menu Simplificado..." # Pausa no final do "Rodar Todas"
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-MainMenu
            default {
                Write-Host "Ops! Op√ß√£o inv√°lida no Menu Simplificado! Confere os n√∫meros e manda bala de novo!" -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Simplificado enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Avan√ßado (O Playground dos Magos do PC!) ---
# Acessado pela op√ß√£o 2 do Menu Principal. Aqui a gente mergulha fundo!
function Show-AdvancedMenu {
    do {
        Clear-Host # Limpa o palco pro menu avan√ßado!
        Banner-TORK # Nosso banner no topo, pra n√£o perder a pose!

        Write-Host "" # Espacinho maroto
        Write-Host "===============================" -ForegroundColor White
        Write-Host "      MENU AVANCADO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes do menu avan√ßado (as CATEGORIAS dos 200 poderes!) Cores variadas (repetindo)!
        Write-Host "[1] Limpeza e Manuten√ß√£o de Arquivos (Tirar a poeira digital!)" -ForegroundColor Cyan # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[2] Otimiza√ß√µes de Desempenho do Sistema (Deixar o motor roncando!)" -ForegroundColor Green # Cor variada
        Write-Host "[3] Configura√ß√µes e Otimiza√ß√µes de Rede (Pra internet voar baixo!)" -ForegroundColor Yellow # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[4] Gerenciamento e Otimiza√ß√£o de Servi√ßos do Windows (O que t√° rodando e n√£o precisa?!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Ferramentas de Diagn√≥stico e Verifica√ß√£o (Pra ver se t√° tudo nos conformes!)" -ForegroundColor Cyan # Cor repetida
        Write-Host "[6] Desabilitar/Gerenciar Recursos do Windows (Tirar o peso extra do sistema!)" -ForegroundColor Green # Cor repetida
        Write-Host "[7] Gerenciamento de Arquivos e Pastas Avan√ßado (Comandos ninja pra arquivos!)" -ForegroundColor Yellow # Cor repetida
        Write-Host "[8] Gerenciamento de Contas de Usu√°rio (Organizar a galera que usa o PC!)" -ForegroundColor White # Cor repetida
        Write-Host "[9] Otimiza√ß√£o para Jogos Avan√ßada (Tweaks pra gamers de verdade!)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Configura√ß√µes de Privacidade (Controle o que o Windows sabe sobre voc√™)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[11] Outras Configura√ß√µes e Tweaks Diversos (Aqueles ajustes secretos!)" -ForegroundColor Gray # Cor neutra/escura
        Write-Host "[0] Voltar ao Menu Principal (Pronto pra voltar pra estrada principal!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta pro mago qual categoria ele quer explorar
        $choice = Read-Host "Escolhe sua √°rea de magia, mago!"

        # V√™ pra onde a gente navega dentro do mundo avan√ßado
        switch ($choice) {
            "1" { Show-LimpezaManutencaoMenu } # CHAMA O SUB-MENU DE LIMPEZA
            "2" { Show-DesempenhoMenu } # Agora √© um sub-menu tamb√©m
            "3" { Show-ConfiguracoesRedeMenu } # CHAMA O SUB-MENU DE REDE
            "4" { Show-ServicosMenu } # Agora √© um sub-menu tamb√©m
            "5" { Show-DiagnosticoMenu } # Agora √© um sub-menu tamb√©m
            "6" { Show-RecursosMenu } # Agora √© um sub-menu tamb√©m
            "7" { Show-ArquivosPastasMenu } # Agora √© um sub-menu tamb√©m
            "8" { Show-UsuariosMenu } # Agora √© um sub-menu tamb√©m
            "9" { Show-JogosAvancadoMenu } # Novo sub-menu para jogos
            "10" { Show-PrivacidadeMenu } # Novo sub-menu para privacidade
            "11" { Show-OutrosMenu } # Agora √© um sub-menu tamb√©m
            "0" { break } # Sai do loop deste menu, voltando pro Menu Principal
            default {
                Write-Host "Humm, essa √°rea da magia ainda n√£o existe ou voc√™ digitou errado! Tenta de novo, mago!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Avan√ßado enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Limpeza e Manuten√ß√£o (Dentro do Avan√ßado!) ---
# Este menu lista as op√ß√µes ESPEC√çFICAS da categoria Limpeza no Menu Avan√ßado
function Show-LimpezaManutencaoMenu {
    do {
        Clear-Host # Limpa o palco pra este sub-menu!
        Banner-TORK # Banner no topo, sempre!

        Write-Host "" # Espacinho
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: LIMPEZA E MANUT." -ForegroundColor White # T√≠tulo menor pro sub-menu
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes ESPEC√çFICAS da categoria Limpeza. Cores variadas (repetindo cores)!
        Write-Host "[1] Limpar Arquivos Tempor√°rios do Usu√°rio (Tipo a pasta Temp!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[2] Limpar Arquivos Tempor√°rios do Sistema (Os tempor√°rios do Windows!)" -ForegroundColor Gray # Cor neutra (substitui DarkCyan)
        Write-Host "[3] Limpar Cache de DNS (Pra resolver nomes de site mais r√°pido!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[4] Esvaziar Lixeira (Adeus, arquivos deletados!)" -ForegroundColor Gray # Cor neutra (repetindo)
        Write-Host "[5] Limpar Cache de Miniaturas (Aqueles previews de imagem/v√≠deo!)" -ForegroundColor Green # Cor variada
        Write-Host "[6] Limpar Logs do Sistema (Arquivos de registro que acumulam)" -ForegroundColor Cyan # Nova op√ß√£o
        Write-Host "[7] Limpar Cache de Atualiza√ß√µes do Windows (Liberar espa√ßo de updates)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[8] Limpar Arquivos de Hiberna√ß√£o (Liberar o hiberfil.sys)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[9] Limpar Arquivos WinSxS (Pasta que ocupa muito espa√ßo)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Executar TODAS as limpezas acima (Faxina completa!)" -ForegroundColor Red # Nova op√ß√£o
        Write-Host "[0] Voltar ao Menu Avan√ßado (De volta pras categorias!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta qual limpeza espec√≠fica o mago quer fazer
        $choice = Read-Host "Escolhe a limpeza avan√ßada, mestre!"

        # V√™ qual fun√ß√£o de limpeza espec√≠fica chamar
        switch ($choice) {
            "1" { Invoke-CleanUserTemp } # Chama a fun√ß√£o pra Limpar Temp Usu√°rio
            "2" { Invoke-CleanSystemTemp } # Chama a fun√ß√£o pra Limpar Temp Sistema
            "3" { Invoke-CleanDnsCache } # Chama a fun√ß√£o pra Limpar Cache DNS
            "4" { Invoke-EmptyRecycleBin } # Chama a fun√ß√£o pra Esvaziar Lixeira
            "5" { Invoke-CleanThumbnailCache } # Chama a fun√ß√£o pra Limpar Cache de Miniaturas
            "6" { Invoke-CleanSystemLogs } # Nova fun√ß√£o para limpar logs do sistema
            "7" { Invoke-CleanWindowsUpdateCache } # Nova fun√ß√£o para limpar cache de updates
            "8" { Invoke-CleanHibernationFile } # Nova fun√ß√£o para limpar arquivo de hiberna√ß√£o
            "9" { Invoke-CleanWinSxS } # Nova fun√ß√£o para limpar pasta WinSxS
            "10" { 
                # Executa todas as limpezas em sequ√™ncia
                Write-Host "`nIniciando faxina completa do sistema! Isso pode demorar um pouco...`n" -ForegroundColor Yellow
                $diskSpaceBefore = Get-DiskSpaceBefore
                
                Invoke-CleanUserTemp
                Invoke-CleanSystemTemp
                Invoke-CleanDnsCache
                Invoke-EmptyRecycleBin
                Invoke-CleanThumbnailCache
                Invoke-CleanSystemLogs
                Invoke-CleanWindowsUpdateCache
                Invoke-CleanHibernationFile
                Invoke-CleanWinSxS
                
                Write-Host "`nFaxina completa finalizada! Veja quanto espa√ßo foi recuperado:`n" -ForegroundColor Green
                Show-DiskSpaceComparison -before $diskSpaceBefore
                Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-AdvancedMenu
            default {
                Write-Host "Essa tarefa de limpeza ainda n√£o t√° na lista! V√™ os n√∫meros e tenta de novo!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Sub-Menu Limpeza enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Desempenho (Dentro do Avan√ßado!) ---
function Show-DesempenhoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DESEMPENHO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Ajustar Efeitos Visuais para Melhor Desempenho" -ForegroundColor Green
        Write-Host "[2] Otimizar Disco do Sistema" -ForegroundColor Cyan
        Write-Host "[3] Limpar Arquivos Prefetch" -ForegroundColor Yellow
        Write-Host "[4] Definir Plano de Energia para Alto Desempenho" -ForegroundColor White
        Write-Host "[5] Otimizar Servi√ßo SuperFetch/SysMain" -ForegroundColor Magenta
        Write-Host "[6] Ajustar Tamanho da Mem√≥ria Virtual" -ForegroundColor Gray
        Write-Host "[7] Desativar Indexa√ß√£o de Arquivos" -ForegroundColor Green
        Write-Host "[8] Otimizar Inicializa√ß√£o do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de desempenho" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o de desempenho"

        switch ($choice) {
            "1" { Invoke-OptimizeVisualEffects }
            "2" { Invoke-OptimizeDisk }
            "3" { Invoke-CleanPrefetch }
            "4" { Invoke-SetHighPerformancePower }
            "5" { Invoke-OptimizeSuperFetch }
            "6" { Invoke-AdjustVirtualMemory }
            "7" { Invoke-DisableIndexing }
            "8" { Invoke-OptimizeStartup }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de desempenho...`n" -ForegroundColor Yellow
                Invoke-OptimizeVisualEffects
                Invoke-OptimizeDisk
                Invoke-CleanPrefetch
                Invoke-SetHighPerformancePower
                Invoke-OptimizeSuperFetch
                Invoke-AdjustVirtualMemory
                Invoke-DisableIndexing
                Invoke-OptimizeStartup
                Write-Host "`nTodas as otimiza√ß√µes de desempenho foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Configura√ß√µes de Rede (Dentro do Avan√ßado!) ---
function Show-ConfiguracoesRedeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: CONFIG. REDE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Limpar Cache de DNS" -ForegroundColor Yellow
        Write-Host "[2] Mudar Servidor DNS" -ForegroundColor Cyan
        Write-Host "[3] Resetar Configura√ß√µes de Rede" -ForegroundColor White
        Write-Host "[4] Otimizar Configura√ß√µes TCP/IP" -ForegroundColor Green
        Write-Host "[5] Verificar Velocidade da Conex√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar QoS (Qualidade de Servi√ßo)" -ForegroundColor Gray
        Write-Host "[7] Desativar IPv6 (Se n√£o estiver usando)" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Lat√™ncia de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de rede" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√£o de rede"

        switch ($choice) {
            "1" { Invoke-NetworkFlushDns }
            "2" { Invoke-NetworkChangeDns }
            "3" { Invoke-NetworkReset }
            "4" { Invoke-OptimizeTcpIp }
            "5" { Invoke-CheckNetworkSpeed }
            "6" { Invoke-ConfigureQoS }
            "7" { Invoke-DisableIPv6 }
            "8" { Invoke-OptimizeGamingLatency }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de rede...`n" -ForegroundColor Yellow
                Invoke-NetworkFlushDns
                Invoke-OptimizeTcpIp
                Invoke-CheckNetworkSpeed
                Invoke-ConfigureQoS
                Invoke-DisableIPv6
                Invoke-OptimizeGamingLatency
                Write-Host "`nTodas as otimiza√ß√µes de rede foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Rede..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Servi√ßos (Dentro do Avan√ßado!) ---
function Show-ServicosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: SERVICOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desabilitar Servi√ßo SuperFetch/SysMain" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Servi√ßo de Impress√£o" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Servi√ßo Windows Update" -ForegroundColor White
        Write-Host "[4] Listar Todos os Servi√ßos em Execu√ß√£o" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Otimizar Servi√ßos para Desempenho Geral" -ForegroundColor Gray
        Write-Host "[7] Restaurar Servi√ßos para Configura√ß√£o Padr√£o" -ForegroundColor Yellow
        Write-Host "[8] Desabilitar Servi√ßos Desnecess√°rios" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de servi√ßos"

        switch ($choice) {
            "1" { Invoke-ManageSuperFetch }
            "2" { Invoke-ManagePrintService }
            "3" { Invoke-ManageWindowsUpdate }
            "4" { Invoke-ListRunningServices }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-OptimizeServicesForPerformance }
            "7" { Invoke-RestoreDefaultServices }
            "8" { Invoke-DisableUnnecessaryServices }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Diagn√≥stico (Dentro do Avan√ßado!) ---
function Show-DiagnosticoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DIAGNOSTICO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Verificar Arquivos do Sistema (SFC)" -ForegroundColor Yellow
        Write-Host "[2] Reparar Imagem do Windows (DISM)" -ForegroundColor Cyan
        Write-Host "[3] Verificar Disco por Erros (CHKDSK)" -ForegroundColor White
        Write-Host "[4] Verificar Sa√∫de do Disco" -ForegroundColor Green
        Write-Host "[5] Verificar Drivers Desatualizados" -ForegroundColor Magenta
        Write-Host "[6] Verificar Problemas de Inicializa√ß√£o" -ForegroundColor Gray
        Write-Host "[7] Verificar Problemas de Mem√≥ria RAM" -ForegroundColor Yellow
        Write-Host "[8] Verificar Temperatura do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODOS os diagn√≥sticos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de diagn√≥stico"

        switch ($choice) {
            "1" { Invoke-SfcScan }
            "2" { Invoke-DismRepair }
            "3" { Invoke-ChkDsk }
            "4" { Invoke-CheckDiskHealth }
            "5" { Invoke-CheckDrivers }
            "6" { Invoke-CheckStartupIssues }
            "7" { Invoke-CheckMemory }
            "8" { Invoke-CheckTemperature }
            "9" {
                Write-Host "`nExecutando todos os diagn√≥sticos...`n" -ForegroundColor Yellow
                Invoke-SfcScan
                Invoke-DismRepair
                Invoke-CheckDiskHealth
                Invoke-CheckDrivers
                Invoke-CheckStartupIssues
                Invoke-CheckTemperature
                Write-Host "`nTodos os diagn√≥sticos foram conclu√≠dos!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Diagn√≥stico..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Recursos (Dentro do Avan√ßado!) ---
function Show-RecursosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: RECURSOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Gerenciar Hiberna√ß√£o" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Planos de Energia" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Recursos Opcionais do Windows" -ForegroundColor White
        Write-Host "[4] Gerenciar Mem√≥ria Virtual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Windows Defender" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Recursos de Telemetria" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Recursos de Inicializa√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Recursos de Seguran√ßa" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de recursos"

        switch ($choice) {
            "1" { Invoke-ManageHibernation }
            "2" { Invoke-ManagePowerPlans }
            "3" { Invoke-ManageOptionalFeatures }
            "4" { Invoke-ManageVirtualMemory }
            "5" { Invoke-ManageWindowsDefender }
            "6" { Invoke-ManageTelemetry }
            "7" { Invoke-ManageStartupResources }
            "8" { Invoke-ManageSecurityFeatures }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Arquivos e Pastas (Dentro do Avan√ßado!) ---
function Show-ArquivosPastasMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: ARQUIVOS E PASTAS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Encontrar Arquivos Grandes" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Arquivos" -ForegroundColor Cyan
        Write-Host "[3] Tomar Posse de Arquivos (TakeOwn)" -ForegroundColor White
        Write-Host "[4] Listar Conte√∫do de Pastas Espec√≠ficas" -ForegroundColor Green
        Write-Host "[5] Compactar Pastas para Economizar Espa√ßo" -ForegroundColor Magenta
        Write-Host "[6] Verificar Integridade de Arquivos" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Arquivos Ocultos e do Sistema" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Atributos de Arquivos" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de arquivos e pastas"

        switch ($choice) {
            "1" { Invoke-FindLargeFiles }
            "2" { Invoke-ManageFilePermissions }
            "3" { Invoke-TakeOwnership }
            "4" { Invoke-ListFolderContents }
            "5" { Invoke-CompressFolders }
            "6" { Invoke-VerifyFileIntegrity }
            "7" { Invoke-ManageHiddenSystemFiles }
            "8" { Invoke-ManageFileAttributes }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Usu√°rios (Dentro do Avan√ßado!) ---
function Show-UsuariosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: USUARIOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Listar Todos os Usu√°rios Locais" -ForegroundColor Yellow
        Write-Host "[2] Listar Todos os Grupos Locais" -ForegroundColor Cyan
        Write-Host "[3] Listar Membros de Grupos Espec√≠ficos" -ForegroundColor White
        Write-Host "[4] Mostrar Propriedades do Usu√°rio Atual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Contas de Usu√°rio" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Pol√≠ticas de Senha" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Permiss√µes de Usu√°rio" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar UAC (Controle de Conta de Usu√°rio)" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de usu√°rios"

        switch ($choice) {
            "1" { Invoke-ListLocalUsers }
            "2" { Invoke-ListLocalGroups }
            "3" { Invoke-ListGroupMembers }
            "4" { Invoke-ShowCurrentUserProperties }
            "5" { Invoke-ManageUserAccounts }
            "6" { Invoke-ManagePasswordPolicies }
            "7" { Invoke-ManageUserPermissions }
            "8" { Invoke-ManageUAC }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Jogos Avan√ßado (Dentro do Avan√ßado!) ---
function Show-JogosAvancadoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: JOGOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Otimizar Prioridade de CPU para Jogos" -ForegroundColor Yellow
        Write-Host "[2] Otimizar Configura√ß√µes de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[3] Otimizar Configura√ß√µes de GPU" -ForegroundColor White
        Write-Host "[4] Desativar Game DVR e Game Bar" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Configurar Modo de Jogo do Windows" -ForegroundColor Gray
        Write-Host "[7] Otimizar Configura√ß√µes de √Åudio para Jogos" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Configura√ß√µes de Input Lag" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes para jogos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o para jogos"

        switch ($choice) {
            "1" { Invoke-OptimizeCpuPriority }
            "2" { Invoke-OptimizeNetworkForGaming }
            "3" { Invoke-OptimizeGpuSettings }
            "4" { Invoke-DisableGameDvrBar }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-ConfigureGameMode }
            "7" { Invoke-OptimizeAudioForGaming }
            "8" { Invoke-OptimizeInputLag }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes para jogos...`n" -ForegroundColor Yellow
                Invoke-OptimizeCpuPriority
                Invoke-OptimizeNetworkForGaming
                Invoke-OptimizeGpuSettings
                Invoke-DisableGameDvrBar
                Invoke-OptimizeServicesForGaming
                Invoke-ConfigureGameMode
                Invoke-OptimizeAudioForGaming
                Invoke-OptimizeInputLag
                Write-Host "`nTodas as otimiza√ß√µes para jogos foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Jogos..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Privacidade (Dentro do Avan√ßado!) ---
function Show-PrivacidadeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: PRIVACIDADE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desativar Telemetria do Windows" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Aplicativos" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Hist√≥rico de Atividades" -ForegroundColor White
        Write-Host "[4] Gerenciar Diagn√≥stico e Feedback" -ForegroundColor Green
        Write-Host "[5] Gerenciar An√∫ncios Personalizados" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Localiza√ß√£o e Sensores" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Reconhecimento de Voz e Digita√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Sincroniza√ß√£o com a Microsoft" -ForegroundColor Cyan
        Write-Host "[9] Aplicar TODAS as configura√ß√µes de privacidade" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de privacidade"

        switch ($choice) {
            "1" { Invoke-DisableTelemetry }
            "2" { Invoke-ManageAppPermissions }
            "3" { Invoke-ManageActivityHistory }
            "4" { Invoke-ManageDiagnosticsFeedback }
            "5" { Invoke-ManagePersonalizedAds }
            "6" { Invoke-ManageLocationSensors }
            "7" { Invoke-ManageVoiceTyping }
            "8" { Invoke-ManageMicrosoftSync }
            "9" {
                Write-Host "`nAplicando todas as configura√ß√µes de privacidade...`n" -ForegroundColor Yellow
                Invoke-DisableTelemetry
                Invoke-ManageAppPermissions
                Invoke-ManageActivityHistory
                Invoke-ManageDiagnosticsFeedback
                Invoke-ManagePersonalizedAds
                Invoke-ManageLocationSensors
                Invoke-ManageVoiceTyping
                Invoke-ManageMicrosoftSync
                Write-Host "`nTodas as configura√ß√µes de privacidade foram aplicadas!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Privacidade..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Outros (Dentro do Avan√ßado!) ---
function Show-OutrosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: OUTROS TWEAKS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Mostrar Informa√ß√µes Detalhadas do Sistema" -ForegroundColor Yellow
        Write-Host "[2] Mostrar Configura√ß√£o Completa de Rede" -ForegroundColor Cyan
        Write-Host "[3] Reiniciar Explorer.exe" -ForegroundColor White
        Write-Host "[4] Limpar Cache de Atualiza√ß√µes do Windows" -ForegroundColor Green
        Write-Host "[5] Gerenciar Programas de Inicializa√ß√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar Op√ß√µes de Energia Avan√ßadas" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Configura√ß√µes de Armazenamento" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Configura√ß√µes de Notifica√ß√µes" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√µes diversas"

        switch ($choice) {
            "1" { Invoke-ShowDetailedSystemInfo }
            "2" { Invoke-ShowDetailedNetworkConfig }
            "3" { Invoke-RestartExplorer }
            "4" { Invoke-CleanWindowsUpdateCache }
            "5" { Invoke-ManageStartupPrograms }
            "6" { Invoke-ConfigureAdvancedPowerOptions }
            "7" { Invoke-ManageStorageSettings }
            "8" { Invoke-ManageNotificationSettings }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- Fun√ß√µes para as Secoes SIMPLIFICADAS (Expandidas) ---
function Invoke-SimpleSystemCleanup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza Geral do Sistema: Hora de varrer o lixo digital! ---" -ForegroundColor Green
    Write-Host "Essa op√ß√£o vai te ajudar a liberar espa√ßo e dar um f√¥lego pro PC tirando arquivos tempor√°rios, lixo da lixeira, etc. √â tipo faxina no computador!" -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Comando 1: Limpar Arquivos Tempor√°rios do Usu√°rio
    Write-Host "Bora come√ßar limpando os arquivos tempor√°rios do seu usu√°rio! Eles acumulam que √© uma beleza!" -ForegroundColor Yellow
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio limpos! Menos peso pro PC respirar! ;)" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Esvaziar a Lixeira
    Write-Host "Agora, vamos dar um fim definitivo naqueles arquivos na Lixeira. Eles s√≥ est√£o ocupando espa√ßo √† toa!" -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada! Espa√ßo recuperado com sucesso! R√°!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios do Windows
    Write-Host "Vamos limpar tamb√©m os tempor√°rios do pr√≥prio Windows. √Äs vezes, fica lixo escondido por l√°!" -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Limpar Cache de Navegadores Comuns
    Write-Host "Bora dar uma geral nos caches dos navegadores tamb√©m! Eles guardam um monte de coisa que pode pesar!" -ForegroundColor Yellow
    
    # Chrome
    Write-Host "Tentando limpar cache do Google Chrome..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Chrome limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Edge
    Write-Host "Tentando limpar cache do Microsoft Edge..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Edge limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Firefox
    Write-Host "Tentando limpar cache do Mozilla Firefox..." -ForegroundColor DarkGray
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\cache2\entries\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\startupCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\thumbnails\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Firefox limpo (pode n√£o ser completo, dependendo do perfil/uso)." -ForegroundColor DarkGray

    # Brave (se instalado)
    Write-Host "Tentando limpar cache do Brave Browser (se instalado)..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Brave limpo (se instalado e n√£o estiver rodando)." -ForegroundColor DarkGray

    Write-Host "Limpeza de caches de navegador conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Comando 5: Limpar Cache de Miniaturas
    Write-Host "Limpando cache de miniaturas do Windows (aquelas pr√©-visualiza√ß√µes de imagens e v√≠deos)..." -ForegroundColor Yellow
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Write-Host "Cache de miniaturas limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Limpar Arquivos de Log do Windows
    Write-Host "Limpando arquivos de log do Windows que podem ocupar espa√ßo..." -ForegroundColor Yellow
    wevtutil cl Application
    wevtutil cl System
    wevtutil cl Security
    Write-Host "Logs do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 7: Limpar Arquivos Tempor√°rios de Instala√ß√£o
    Write-Host "Limpando arquivos tempor√°rios de instala√ß√£o de programas..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Installer\$*\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios de instala√ß√£o limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 8: Limpar Arquivos de Atualiza√ß√£o do Windows
    Write-Host "Limpando arquivos de atualiza√ß√£o do Windows que podem ocupar bastante espa√ßo..." -ForegroundColor Yellow
    Stop-Service -Name wuauserv -ErrorAction SilentlyContinue
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    Write-Host "Arquivos de atualiza√ß√£o do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 9: Limpar Arquivos Prefetch
    Write-Host "Limpando arquivos prefetch para melhorar a inicializa√ß√£o..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Prefetch\*.pf" -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos prefetch limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 10: Executar Limpeza de Disco Integrada do Windows
    Write-Host "Executando a ferramenta de limpeza de disco integrada do Windows..." -ForegroundColor Yellow
    Start-Process -FilePath cleanmgr.exe -ArgumentList "/sagerun:1" -Wait -ErrorAction SilentlyContinue
    Write-Host "Limpeza de disco conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "Vamos ver quanto espa√ßo conseguimos recuperar com essa faxina:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nPronto! A faxina geral b√°sica foi feita! Seu PC agradece o espa√ßo extra! ;)" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu
    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleMemoryStartup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Mem√≥ria e Inicializa√ß√£o R√°pida: Deixa o PC ligando num piscar! ---" -ForegroundColor Yellow
    Write-Host "Aqui a gente d√° uma olhada na mem√≥ria RAM e nos programas que ligam junto com o Windows. Menos coisa ligando √† toa = PC mais r√°pido pra usar na hora!" -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Listar Programas de Inicializa√ß√£o
    Write-Host "Listando programas que iniciam com o Windows (pra voc√™ saber o que t√° rodando por baixo dos panos):" -ForegroundColor Yellow
    Get-CimInstance win32_startupcommand | Select-Object Name, command, Location | Format-Table -AutoSize
    Write-Host "Lista de programas de inicializa√ß√£o exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Servi√ßo SuperFetch/SysMain
    Write-Host "Otimizando o servi√ßo SuperFetch/SysMain para melhorar o desempenho..." -ForegroundColor Yellow
    $confirmSysMain = Read-Host "Deseja desativar o servi√ßo SysMain/SuperFetch? (s/n) - Recomendado para SSDs"
    if ($confirmSysMain -eq 's') {
        Set-Service -Name SysMain -StartupType Disabled -ErrorAction SilentlyContinue
        Stop-Service -Name SysMain -Force -ErrorAction SilentlyContinue
        Write-Host "Servi√ßo SysMain/SuperFetch desativado!" -ForegroundColor Green
    } else {
        Write-Host "Servi√ßo SysMain/SuperFetch mantido ativo." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios de Updates
    Write-Host "Limpando arquivos tempor√°rios de atualiza√ß√µes do Windows (podem ocupar bastante espa√ßo e afetar performance):" -ForegroundColor Yellow
    Dism /online /Cleanup-Image /StartComponentCleanup /ErrorAction SilentlyContinue
    Write-Host "Limpeza de componentes de atualiza√ß√£o iniciada (pode levar um tempo)." -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Mem√≥ria Virtual
    Write-Host "Otimizando configura√ß√µes de mem√≥ria virtual para melhor desempenho..." -ForegroundColor Yellow
    $totalRam = (Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property capacity -Sum).Sum / 1GB
    Write-Host "Seu sistema tem aproximadamente $totalRam GB de RAM." -ForegroundColor White
    
    $confirmPageFile = Read-Host "Deseja otimizar o arquivo de pagina√ß√£o (mem√≥ria virtual)? (s/n)"
    if ($confirmPageFile -eq 's') {
        # Calcula tamanho recomendado (1.5x a RAM para sistemas com menos de 8GB, 1x para sistemas com mais)
        $pageFileSize = if ($totalRam -lt 8) { [math]::Round($totalRam * 1.5) * 1024 } else { [math]::Round($totalRam) * 1024 }
        
        Write-Host "Configurando arquivo de pagina√ß√£o para tamanho fixo de $pageFileSize MB..." -ForegroundColor DarkGray
        $computerSystem = Get-WmiObject -Class Win32_ComputerSystem
        $computerSystem.AutomaticManagedPagefile = $false
        $computerSystem.Put() | Out-Null
        
        $pageFileSetting = Get-WmiObject -Class Win32_PageFileSetting
        if ($pageFileSetting) {
            $pageFileSetting.InitialSize = $pageFileSize
            $pageFileSetting.MaximumSize = $pageFileSize
            $pageFileSetting.Put() | Out-Null
        }
        Write-Host "Arquivo de pagina√ß√£o otimizado! (Requer reinicializa√ß√£o para aplicar totalmente)" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes de mem√≥ria virtual mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Listar os 10 Processos que mais usam mem√≥ria no momento
    Write-Host "Listando os 10 processos que mais consomem mem√≥ria agora:" -ForegroundColor Yellow
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host "Lista de processos exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Otimizar Inicializa√ß√£o do Windows
    Write-Host "Otimizando a inicializa√ß√£o do Windows..." -ForegroundColor Yellow
    # Desabilitar servi√ßos n√£o essenciais que podem atrasar a inicializa√ß√£o
    $startupServices = @(
        @{Name="DiagTrack"; DisplayName="Experi√™ncias do Usu√°rio Conectado e Telemetria"},
        @{Name="dmwappushservice"; DisplayName="Servi√ßo de Transfer√™ncia Inteligente em Segundo Plano (BITS)"},
        @{Name="MapsBroker"; DisplayName="Servi√ßo de Dados de Mapas"}
    )
    
    foreach ($service in $startupServices) {
        $confirmService = Read-Host "Deseja desativar o servi√ßo '$($service.DisplayName)' na inicializa√ß√£o? (s/n)"
        if ($confirmService -eq 's') {
            Set-Service -Name $service.Name -StartupType Disabled -ErrorAction SilentlyContinue
            Stop-Service -Name $service.Name -Force -ErrorAction SilentlyContinue
            Write-Host "Servi√ßo '$($service.DisplayName)' desativado!" -ForegroundColor Green
        } else {
            Write-Host "Servi√ßo '$($service.DisplayName)' mantido." -ForegroundColor Green
        }
    }
    Write-Host ""

    # Comando 7: Reiniciar o Computador (√ötil pra liberar mem√≥ria e aplicar mudan√ßas)
    Write-Host "Quer dar um 'refresh' geral no PC? Reiniciar pode ajudar!" -ForegroundColor Yellow
    $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (digite 'sim' para confirmar)"
    if ($confirmRestart -eq 'sim') {
        Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
        Restart-Computer -Force
    } else {
        Write-Host "Rein√≠cio cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o de mem√≥ria e inicializa√ß√£o!" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu (a n√£o ser que o PC tenha reiniciado)
    if ($confirmRestart -ne 'sim') {
        Write-Host ""
        Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
    }
}

function Invoke-SimpleInternetOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Acelerar a Conex√£o com a Internet (Simplificado): Diz adeus pro 'carregando...'! ---" -ForegroundColor Cyan
    Write-Host "Vamos fazer uns ajustes r√°pidos na sua conex√£o pra tentar deixar ela mais esperta." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Limpar Cache de DNS
    Write-Host "Limpando o cache de endere√ßos de internet (DNS) pra resolver nomes mais r√°pido!" -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Configura√ß√µes TCP/IP
    Write-Host "Otimizando configura√ß√µes TCP/IP para melhorar a velocidade de conex√£o..." -ForegroundColor Yellow
    
    # Habilitar TCP Window Auto-Tuning
    netsh int tcp set global autotuninglevel=normal
    Write-Host "TCP Auto-Tuning configurado para 'normal'." -ForegroundColor DarkGray
    
    # Otimizar par√¢metros de recebimento de pacotes
    netsh int tcp set global rss=enabled
    Write-Host "Receive-Side Scaling (RSS) habilitado." -ForegroundColor DarkGray
    
    # Otimizar congestion provider
    netsh int tcp set global congestionprovider=ctcp
    Write-Host "Congestion Provider configurado para 'ctcp'." -ForegroundColor DarkGray
    
    # Otimizar ECN capability
    netsh int tcp set global ecncapability=enabled
    Write-Host "ECN Capability habilitado." -ForegroundColor DarkGray
    
    Write-Host "Configura√ß√µes TCP/IP otimizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Reiniciar Adaptadores de Rede
    Write-Host "Dando um 'reset' r√°pido nas suas conex√µes de rede. Pode resolver uns pepinos!" -ForegroundColor Yellow
    $confirmResetAdapter = Read-Host "Isso vai desconectar brevemente sua internet. Continuar? (s/n)"
    if ($confirmResetAdapter -eq 's') {
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        Write-Host "Adaptadores de rede reiniciados." -ForegroundColor Green
    } else {
        Write-Host "Reset de adaptadores cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 4: Configurar DNS R√°pido
    Write-Host "Configurar DNS mais r√°pido pode melhorar sua navega√ß√£o!" -ForegroundColor Yellow
    $confirmDns = Read-Host "Deseja configurar DNS mais r√°pidos (Google ou Cloudflare)? (s/n)"
    if ($confirmDns -eq 's') {
        Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
        Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
        $dnsChoice = Read-Host "Escolha uma op√ß√£o (1 ou 2)"
        
        $primaryDns = ""
        $secondaryDns = ""
        
        if ($dnsChoice -eq '1') {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            Write-Host "Google DNS selecionado." -ForegroundColor DarkGray
        } elseif ($dnsChoice -eq '2') {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            Write-Host "Cloudflare DNS selecionado." -ForegroundColor DarkGray
        } else {
            Write-Host "Op√ß√£o inv√°lida. DNS n√£o alterado." -ForegroundColor Red
        }
        
        if ($primaryDns -ne "") {
            $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" -and ($_.InterfaceDescription -match "Ethernet" -or $_.InterfaceDescription -match "Wi-Fi" -or $_.InterfaceDescription -match "Wireless") }
            
            foreach ($adapter in $networkAdapters) {
                Write-Host "Configurando DNS para adaptador: $($adapter.Name)" -ForegroundColor DarkGray
                Set-DnsClientServerAddress -InterfaceIndex $adapter.ifIndex -ServerAddresses ($primaryDns, $secondaryDns)
            }
            
            Write-Host "DNS configurado! Sua navega√ß√£o deve ficar mais r√°pida agora." -ForegroundColor Green
        }
    } else {
        Write-Host "Configura√ß√£o de DNS mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Mostrar Status B√°sico da Conex√£o
    Write-Host "Mostrando um resumo b√°sico da sua configura√ß√£o de rede atual:" -ForegroundColor Yellow
    ipconfig /all | Select-String -Pattern "IPv4", "DNS", "Gateway", "DHCP", "Subnet", "Physical Address"
    Write-Host "Status b√°sico da rede exibido." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Testar a conex√£o com a internet
    Write-Host "Testando a conex√£o com a internet (ping para google.com)..." -ForegroundColor Yellow
    Test-Connection -Count 4 google.com -ErrorAction SilentlyContinue
    Write-Host "Teste de conex√£o finalizado." -ForegroundColor Green
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o b√°sica de internet!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleVisualOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Deixar o Windows mais Leve Visualmente (Simplificado): Desempenho antes da beleza! ---" -ForegroundColor White
    Write-Host "Ajustes r√°pidos pra desativar efeitos visuais que podem pesar, liberando recursos pro que importa." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ajustar Efeitos Visuais
    Write-Host "Voc√™ quer desativar ou ativar as anima√ß√µes e efeitos visuais do Windows?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Efeitos Visuais (Pra ganhar desempenho)" -ForegroundColor Green
    Write-Host "[2] Configurar para Melhor Apar√™ncia (Mais bonito, mas mais pesado)" -ForegroundColor White
    Write-Host "[3] Deixar o Windows Escolher (Configura√ß√£o padr√£o)" -ForegroundColor Cyan
    $choiceVisual = Read-Host "Escolha [1], [2] ou [3]"

    if ($choiceVisual -eq '1') {
        Write-Host "Desativando efeitos visuais para melhor desempenho..." -ForegroundColor Yellow
        # Valor 2 = Ajustar para melhor desempenho (desativa a maioria dos efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 2 -Type DWord -Force -ErrorAction SilentlyContinue
        
        # Desativar anima√ß√µes individuais
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop' -Name 'UserPreferencesMask' -Value ([byte[]](0x90, 0x12, 0x01, 0x80)) -Type Binary -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop\WindowMetrics' -Name 'MinAnimate' -Value 0 -Type String -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'ListviewAlphaSelect' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'TaskbarAnimations' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        
        Write-Host "Efeitos visuais desativados para melhor desempenho!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '2') {
        Write-Host "Configurando para melhor apar√™ncia (todos os efeitos visuais ativados)..." -ForegroundColor Yellow
        # Valor 1 = Ajustar para melhor apar√™ncia (ativa todos os efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Efeitos visuais configurados para melhor apar√™ncia!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '3') {
        Write-Host "Deixando o Windows escolher automaticamente (configura√ß√£o padr√£o)..." -ForegroundColor Yellow
        # Valor 0 = Deixar o Windows escolher
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Configura√ß√£o visual definida para padr√£o do Windows!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa nos efeitos visuais foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 2: Ativar/Desativar Efeitos de Transpar√™ncia
    Write-Host "E os efeitos de transpar√™ncia do Windows (tipo na barra de tarefas)?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Transpar√™ncia (Mais leve)" -ForegroundColor Green
    Write-Host "[2] Ativar Transpar√™ncia (Mais 'bonito')" -ForegroundColor White
    $choiceTransp = Read-Host "Escolha [1] ou [2]"

    if ($choiceTransp -eq '1') {
        Write-Host "Desativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 0 = Desativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia desativada!" -ForegroundColor Green
    } elseif ($choiceTransp -eq '2') {
        Write-Host "Ativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 1 = Ativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia ativada!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa na transpar√™ncia foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 3: Configurar Tema Claro/Escuro
    Write-Host "Voc√™ prefere tema claro ou escuro? O tema escuro pode ser mais confort√°vel para os olhos." -ForegroundColor Yellow
    Write-Host "[1] Tema Escuro (Dark Mode)" -ForegroundColor DarkGray
    Write-Host "[2] Tema Claro (Light Mode)" -ForegroundColor White
    $choiceTheme = Read-Host "Escolha [1] ou [2]"

    if ($choiceTheme -eq '1') {
        Write-Host "Configurando tema escuro..." -ForegroundColor Yellow
        # Valor 0 = Tema Escuro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema escuro configurado!" -ForegroundColor Green
    } elseif ($choiceTheme -eq '2') {
        Write-Host "Configurando tema claro..." -ForegroundColor Yellow
        # Valor 1 = Tema Claro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema claro configurado!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa no tema foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Configurar Resolu√ß√£o de Tela
    Write-Host "Deseja ajustar a resolu√ß√£o da tela? Resolu√ß√µes menores podem melhorar o desempenho em PCs mais antigos." -ForegroundColor Yellow
    $confirmResolution = Read-Host "Deseja ver e ajustar a resolu√ß√£o da tela? (s/n)"
    
    if ($confirmResolution -eq 's') {
        # Mostrar resolu√ß√£o atual
        $currentResolution = Get-WmiObject -Class Win32_VideoController | Select-Object -ExpandProperty VideoModeDescription
        Write-Host "Resolu√ß√£o atual: $currentResolution" -ForegroundColor White
        
        # Abrir configura√ß√µes de exibi√ß√£o do Windows
        Write-Host "Abrindo configura√ß√µes de exibi√ß√£o do Windows..." -ForegroundColor DarkGray
        Start-Process "ms-settings:display"
        Write-Host "Ajuste a resolu√ß√£o conforme necess√°rio na janela de configura√ß√µes que foi aberta." -ForegroundColor Green
        
        $waitForSettings = Read-Host "Pressione Enter quando terminar de ajustar as configura√ß√µes de exibi√ß√£o"
    } else {
        Write-Host "Configura√ß√£o de resolu√ß√£o mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizados os ajustes visuais b√°sicos!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleGamingOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Jogos (Simplificado): Mais FPS, menos lag! ---" -ForegroundColor Magenta
    Write-Host "Vamos fazer alguns ajustes para melhorar o desempenho dos seus jogos sem complica√ß√µes." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ativar Modo de Jogo do Windows
    Write-Host "Ativando o Modo de Jogo do Windows para priorizar recursos para jogos..." -ForegroundColor Yellow
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AllowAutoGameMode" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AutoGameModeEnabled" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Write-Host "Modo de Jogo do Windows ativado!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Desativar Game DVR e Game Bar
    Write-Host "O Game DVR e Game Bar podem reduzir o desempenho em jogos. Deseja desativ√°-los?" -ForegroundColor Yellow
    $confirmGameDVR = Read-Host "Desativar Game DVR e Game Bar? (s/n)"
    
    if ($confirmGameDVR -eq 's') {
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "UseNexusForGameBarEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\System\GameConfigStore" -Name "GameDVR_Enabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR" -Name "AppCaptureEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Write-Host "Game DVR e Game Bar desativados!" -ForegroundColor Green
    } else {
        Write-Host "Game DVR e Game Bar mantidos ativos." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Otimizar Plano de Energia para Jogos
    Write-Host "Configurando plano de energia para alto desempenho (ideal para jogos)..." -ForegroundColor Yellow
    powercfg.exe /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c
    Write-Host "Plano de energia configurado para alto desempenho!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Configura√ß√µes de Mouse
    Write-Host "Otimizando configura√ß√µes de mouse para jogos (precis√£o do ponteiro)..." -ForegroundColor Yellow
    $confirmMouseFix = Read-Host "Desativar a acelera√ß√£o do mouse para melhor precis√£o em jogos? (s/n)"
    
    if ($confirmMouseFix -eq 's') {
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseSpeed" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold1" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold2" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Write-Host "Acelera√ß√£o do mouse desativada para melhor precis√£o em jogos!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do mouse mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Otimizar Prioridade de CPU para Jogos
    Write-Host "Configurando prioridade de CPU para jogos..." -ForegroundColor Yellow
    Write-Host "Esta configura√ß√£o ajusta o sistema para dar mais prioridade aos jogos." -ForegroundColor DarkGray
    
    # Criar chave de registro para prioridade de jogos
    if (-not (Test-Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games")) {
        New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Force | Out-Null
    }
    
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "GPU Priority" -Type DWord -Value 8 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Priority" -Type DWord -Value 6 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Scheduling Category" -Type String -Value "High" -Force -ErrorAction SilentlyContinue
    
    Write-Host "Prioridade de CPU para jogos otimizada!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Verificar Driver de Placa de V√≠deo
    Write-Host "Verificando informa√ß√µes da placa de v√≠deo..." -ForegroundColor Yellow
    $gpuInfo = Get-WmiObject -Class Win32_VideoController | Select-Object Name, DriverVersion, CurrentHorizontalResolution, CurrentVerticalResolution
    
    foreach ($gpu in $gpuInfo) {
        Write-Host "Placa de v√≠deo: $($gpu.Name)" -ForegroundColor White
        Write-Host "Vers√£o do driver: $($gpu.DriverVersion)" -ForegroundColor White
        Write-Host "Resolu√ß√£o atual: $($gpu.CurrentHorizontalResolution) x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
      x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
    
    Write-Host "Recomenda√ß√£o: Mantenha seus drivers de v√≠deo atualizados para melhor desempenho em jogos!" -ForegroundColor Green
    Write-Host "Voc√™ pode baixar os drivers mais recentes nos sites oficiais da NVIDIA, AMD ou Intel." -ForegroundColor DarkGray
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nOtimiza√ß√µes para jogos conclu√≠das! Seus jogos devem rodar mais suaves agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleSecurityMaintenance {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Manuten√ß√£o de Seguran√ßa (Simplificado): Mantenha seu PC protegido! ---" -ForegroundColor DarkYellow
    Write-Host "Vamos verificar e melhorar a seguran√ßa do seu sistema com alguns ajustes simples." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Verificar Status do Windows Defender
    Write-Host "Verificando status do Windows Defender..." -ForegroundColor Yellow
    $defenderStatus = Get-MpComputerStatus
    
    Write-Host "Status do Windows Defender:" -ForegroundColor White
    Write-Host "Antiv√≠rus habilitado: $($defenderStatus.AntivirusEnabled)" -ForegroundColor $(if ($defenderStatus.AntivirusEnabled) { "Green" } else { "Red" })
    Write-Host "Prote√ß√£o em tempo real: $($defenderStatus.RealTimeProtectionEnabled)" -ForegroundColor $(if ($defenderStatus.RealTimeProtectionEnabled) { "Green" } else { "Red" })
    Write-Host "Defini√ß√µes de antiv√≠rus: $($defenderStatus.AntivirusSignatureVersion)" -ForegroundColor White
    Write-Host "√öltima atualiza√ß√£o: $($defenderStatus.AntivirusSignatureLastUpdated)" -ForegroundColor White
    Write-Host ""

    # Comando 2: Atualizar Defini√ß√µes do Windows Defender
    Write-Host "Atualizando defini√ß√µes do Windows Defender..." -ForegroundColor Yellow
    Update-MpSignature -ErrorAction SilentlyContinue
    Write-Host "Defini√ß√µes do Windows Defender atualizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Verificar Atualiza√ß√µes do Windows
    Write-Host "Verificando status das atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
            Write-Host "Recomenda√ß√£o: Execute o Windows Update para manter seu sistema seguro." -ForegroundColor Green
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Verificar Configura√ß√µes de Firewall
    Write-Host "Verificando status do Firewall do Windows..." -ForegroundColor Yellow
    $firewallStatus = Get-NetFirewallProfile
    
    foreach ($profile in $firewallStatus) {
        Write-Host "Perfil: $($profile.Name)" -ForegroundColor White
        Write-Host "Status: $($profile.Enabled)" -ForegroundColor $(if ($profile.Enabled) { "Green" } else { "Red" })
        Write-Host ""
    }
    
    $confirmFirewall = Read-Host "Deseja habilitar o Firewall em todos os perfis? (s/n)"
    if ($confirmFirewall -eq 's') {
        Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True
        Write-Host "Firewall habilitado em todos os perfis!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do Firewall mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Verificar Configura√ß√µes de UAC
    Write-Host "Verificando configura√ß√µes do Controle de Conta de Usu√°rio (UAC)..." -ForegroundColor Yellow
    $uacLevel = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -ErrorAction SilentlyContinue
    
    if ($uacLevel) {
        switch ($uacLevel.ConsentPromptBehaviorAdmin) {
            0 { $uacStatus = "Desativado (N√£o recomendado)" }
            1 { $uacStatus = "Baixo (N√£o recomendado)" }
            2 { $uacStatus = "M√©dio" }
            5 { $uacStatus = "Alto (Recomendado)" }
            default { $uacStatus = "Personalizado" }
        }
        
        Write-Host "N√≠vel atual do UAC: $uacStatus" -ForegroundColor $(if ($uacLevel.ConsentPromptBehaviorAdmin -ge 2) { "Green" } else { "Red" })
        
        $confirmUAC = Read-Host "Deseja configurar o UAC para o n√≠vel recomendado? (s/n)"
        if ($confirmUAC -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -Value 5 -Type DWord -Force -ErrorAction SilentlyContinue
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "PromptOnSecureDesktop" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
            Write-Host "UAC configurado para o n√≠vel recomendado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do UAC mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do UAC." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 6: Verificar Configura√ß√µes de SmartScreen
    Write-Host "Verificando configura√ß√µes do Windows SmartScreen..." -ForegroundColor Yellow
    $smartScreen = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -ErrorAction SilentlyContinue
    
    if ($smartScreen) {
        Write-Host "Status do SmartScreen: $($smartScreen.SmartScreenEnabled)" -ForegroundColor $(if ($smartScreen.SmartScreenEnabled -eq "RequireAdmin" -or $smartScreen.SmartScreenEnabled -eq "Warn") { "Green" } else { "Red" })
        
        $confirmSmartScreen = Read-Host "Deseja habilitar o SmartScreen para maior seguran√ßa? (s/n)"
        if ($confirmSmartScreen -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -Value "RequireAdmin" -Type String -Force -ErrorAction SilentlyContinue
            Write-Host "SmartScreen habilitado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do SmartScreen mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do SmartScreen." -ForegroundColor Red
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nManuten√ß√£o de seguran√ßa conclu√≠da! Seu sistema est√° mais protegido agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

# --- Fun√ß√µes para o Diagn√≥stico R√°pido e Sobre ---
function Invoke-QuickDiagnostic {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Diagn√≥stico R√°pido do Sistema ---" -ForegroundColor Yellow
    Write-Host "Vamos fazer uma verifica√ß√£o r√°pida do estado atual do seu PC." -ForegroundColor Gray
    Write-Host ""

    # Informa√ß√µes do Sistema
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    $sysInfo = Get-SystemInfo
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host ""

    # Uso de CPU
    Write-Host "=== Uso de CPU ===" -ForegroundColor Cyan
    $cpuLoad = (Get-WmiObject Win32_Processor).LoadPercentage
    Write-Host "Uso atual de CPU: $cpuLoad%" -ForegroundColor $(if ($cpuLoad -lt 70) { "Green" } elseif ($cpuLoad -lt 90) { "Yellow" } else { "Red" })
    Write-Host ""

    # Uso de Mem√≥ria
    Write-Host "=== Uso de Mem√≥ria ===" -ForegroundColor Cyan
    $os = Get-WmiObject Win32_OperatingSystem
    $totalMemory = [math]::Round($os.TotalVisibleMemorySize / 1MB, 2)
    $freeMemory = [math]::Round($os.FreePhysicalMemory / 1MB, 2)
    $usedMemory = [math]::Round($totalMemory - $freeMemory, 2)
    $memoryPercentage = [math]::Round(($usedMemory / $totalMemory) * 100, 2)
    
    Write-Host "Mem√≥ria Total: $totalMemory GB" -ForegroundColor White
    Write-Host "Mem√≥ria Usada: $usedMemory GB ($memoryPercentage%)" -ForegroundColor $(if ($memoryPercentage -lt 70) { "Green" } elseif ($memoryPercentage -lt 90) { "Yellow" } else { "Red" })
    Write-Host "Mem√≥ria Livre: $freeMemory GB" -ForegroundColor White
    Write-Host ""

    # Espa√ßo em Disco
    Write-Host "=== Espa√ßo em Disco ===" -ForegroundColor Cyan
    $drives = Get-PSDrive -PSProvider FileSystem
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        $percentFree = [math]::Round(($freeSpace / $totalSpace) * 100, 2)
        
        Write-Host "Drive $($drive.Name):" -ForegroundColor White
        Write-Host "  Total: $totalSpace GB" -ForegroundColor White
        Write-Host "  Usado: $usedSpace GB" -ForegroundColor White
        Write-Host "  Livre: $freeSpace GB ($percentFree%)" -ForegroundColor $(if ($percentFree -gt 20) { "Green" } elseif ($percentFree -gt 10) { "Yellow" } else { "Red" })
    }
    Write-Host ""

    # Processos que mais consomem recursos
    Write-Host "=== Top 5 Processos (CPU) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object CPU -Descending | Select-Object -First 5 ProcessName, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}}, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host ""

    Write-Host "=== Top 5 Processos (Mem√≥ria) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 5 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}}, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}} | Format-Table -AutoSize
    Write-Host ""

    # Status de Servi√ßos Cr√≠ticos
    Write-Host "=== Status de Servi√ßos Cr√≠ticos ===" -ForegroundColor Cyan
    $criticalServices = @("wuauserv", "WinDefend", "MpsSvc", "wscsvc")
    foreach ($service in $criticalServices) {
        $serviceStatus = Get-Service -Name $service -ErrorAction SilentlyContinue
        if ($serviceStatus) {
            Write-Host "$($serviceStatus.DisplayName): $($serviceStatus.Status)" -ForegroundColor $(if ($serviceStatus.Status -eq "Running") { "Green" } else { "Red" })
        }
    }
    Write-Host ""

    # Verificar Atualiza√ß√µes Pendentes
    Write-Host "=== Atualiza√ß√µes do Windows ===" -ForegroundColor Cyan
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Recomenda√ß√µes
    Write-Host "=== Recomenda√ß√µes ===" -ForegroundColor Cyan
    
    # Recomenda√ß√£o de Mem√≥ria
    if ($memoryPercentage -gt 80) {
        Write-Host "- Seu uso de mem√≥ria est√° alto. Considere fechar alguns programas ou usar a op√ß√£o 'Otimiza√ß√£o de Mem√≥ria'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Disco
    $lowDiskSpace = $false
    foreach ($drive in $drives) {
        $percentFree = [math]::Round(($drive.Free / ($drive.Free + $drive.Used)) * 100, 2)
        if ($percentFree -lt 15) {
            $lowDiskSpace = $true
            break
        }
    }
    
    if ($lowDiskSpace) {
        Write-Host "- Espa√ßo em disco baixo detectado. Considere usar a op√ß√£o 'Limpeza Geral do Sistema'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Atualiza√ß√µes
    if ($pendingUpdates -gt 0) {
        Write-Host "- Existem atualiza√ß√µes pendentes. Recomendamos atualizar seu sistema para maior seguran√ßa." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Inicializa√ß√£o
    $bootTime = $sysInfo.LastBootTime
    $uptime = (Get-Date) - $bootTime
    if ($uptime.Days -gt 7) {
        Write-Host "- Seu sistema est√° ligado h√° $($uptime.Days) dias. Considere reiniciar para aplicar atualiza√ß√µes e limpar a mem√≥ria." -ForegroundColor Yellow
    }
    
    Write-Host ""

    # Mensagem de conclus√£o
    Write-Host "`nDiagn√≥stico r√°pido conclu√≠do! Use as informa√ß√µes acima para decidir quais otimiza√ß√µes fazer." -ForegroundColor Green

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

function Show-AboutTORK {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Sobre o TORK ---" -ForegroundColor White
    Write-Host ""
    
    Write-Host "TORK - Otimizador para Windows" -ForegroundColor Cyan
    Write-Host "Vers√£o: 2.0" -ForegroundColor White
    Write-Host "Desenvolvido por: Partner77" -ForegroundColor White
    Write-Host ""
    
    Write-Host "=== Descri√ß√£o ===" -ForegroundColor Yellow
    Write-Host "O TORK √© uma ferramenta abrangente de otimiza√ß√£o para Windows, projetada para" -ForegroundColor Gray
    Write-Host "melhorar o desempenho do seu sistema atrav√©s de limpeza, ajustes e otimiza√ß√µes." -ForegroundColor Gray
    Write-Host "Ele oferece op√ß√µes simplificadas para usu√°rios comuns e op√ß√µes avan√ßadas para" -ForegroundColor Gray
    Write-Host "usu√°rios experientes que desejam um controle mais detalhado sobre o sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Recursos ===" -ForegroundColor Yellow
    Write-Host "- Limpeza completa do sistema" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√£o de mem√≥ria e inicializa√ß√£o" -ForegroundColor Gray
    Write-Host "- Ajustes de rede para melhor conectividade" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√µes visuais para melhor desempenho" -ForegroundColor Gray
    Write-Host "- Configura√ß√µes espec√≠ficas para jogos" -ForegroundColor Gray
    Write-Host "- Manuten√ß√£o de seguran√ßa" -ForegroundColor Gray
    Write-Host "- Diagn√≥stico r√°pido do sistema" -ForegroundColor Gray
    Write-Host "- Mais de 100 ajustes e otimiza√ß√µes avan√ßadas" -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Aviso Legal ===" -ForegroundColor Yellow
    Write-Host "Este software √© fornecido 'como est√°', sem garantias de qualquer tipo." -ForegroundColor Gray
    Write-Host "O autor n√£o se responsabiliza por quaisquer danos ou problemas causados pelo uso" -ForegroundColor Gray
    Write-Host "deste software. Use por sua conta e risco. Recomendamos sempre fazer backup" -ForegroundColor Gray
    Write-Host "dos seus dados importantes antes de realizar otimiza√ß√µes no sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Agradecimentos ===" -ForegroundColor Yellow
    Write-Host "Obrigado por escolher o TORK para otimizar seu sistema Windows!" -ForegroundColor Gray
    Write-Host "Esperamos que esta ferramenta ajude a melhorar o desempenho do seu PC." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "¬© 2023-2024 Partner77 - Todos os direitos reservados" -ForegroundColor Cyan
    Write-Host ""
    
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - LIMPEZA (Expandidas) ---
function Invoke-CleanUserTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Usu√°rio ---" -ForegroundColor Cyan
    Write-Host "Remove arquivos da pasta tempor√°ria do seu usu√°rio (`$env:TEMP`)." -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:TEMP..." -ForegroundColor Yellow
    $tempFiles = Get-ChildItem -Path $env:TEMP -Recurse -ErrorAction SilentlyContinue
    $tempFilesCount = ($tempFiles | Measure-Object).Count
    $tempFilesSize = ($tempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $tempFilesCount arquivos tempor√°rios ocupando aproximadamente $([math]::Round($tempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Sistema ---" -ForegroundColor Gray
    Write-Host "Remove arquivos da pasta tempor√°ria do Windows (`$env:SystemRoot\Temp`)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:SystemRoot\Temp..." -ForegroundColor Yellow
    $systemTempFiles = Get-ChildItem -Path "$env:SystemRoot\Temp" -Recurse -ErrorAction SilentlyContinue
    $systemTempFilesCount = ($systemTempFiles | Measure-Object).Count
    $systemTempFilesSize = ($systemTempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $systemTempFilesCount arquivos tempor√°rios do sistema ocupando aproximadamente $([math]::Round($systemTempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do sistema removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanDnsCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-EmptyRecycleBin {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Esvaziar Lixeira ---" -ForegroundColor Gray
    Write-Host "Esvazia a lixeira do usu√°rio logado." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar tamanho da lixeira antes de esvaziar
    Write-Host "Verificando tamanho da lixeira..." -ForegroundColor Yellow
    
    try {
        $shell = New-Object -ComObject Shell.Application
        $recycleBin = $shell.Namespace(0xA)
        $recycleBinItems = $recycleBin.Items()
        $recycleBinItemCount = $recycleBinItems.Count
        
        Write-Host "A lixeira cont√©m $recycleBinItemCount itens." -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o conte√∫do da lixeira." -ForegroundColor DarkGray
    }
    
    # Esvaziar a lixeira
    Write-Host "Executando: Esvaziando a lixeira..." -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanThumbnailCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Miniaturas ---" -ForegroundColor Green
    Write-Host "Remove o cache de miniaturas de arquivos (imagens, v√≠deos, etc.)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Limpando cache de miniaturas..." -ForegroundColor Yellow
    
    # Verificar tamanho do cache de miniaturas antes da limpeza
    $thumbnailPath = "$env:LOCALAPPDATA\Microsoft\Windows\Explorer"
    $thumbnailFiles = Get-ChildItem -Path $thumbnailPath -Filter "thumbcache_*.db" -ErrorAction SilentlyContinue
    $thumbnailFilesCount = ($thumbnailFiles | Measure-Object).Count
    $thumbnailFilesSize = ($thumbnailFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $thumbnailFilesCount arquivos de cache de miniaturas ocupando aproximadamente $([math]::Round($thumbnailFilesSize, 2)) MB." -ForegroundColor White
    
    # Limpar o cache de miniaturas
    Stop-Process -Name explorer -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Start-Process explorer
    
    Write-Host "Cache de miniaturas limpo com sucesso!" -ForegroundColor Green
    Write-Host "O Windows Explorer foi reiniciado para aplicar as altera√ß√µes." -ForegroundColor DarkGray
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de miniaturas:" -ForegroundColor Cyan
    Write-Host "- Navega√ß√£o mais r√°pida em pastas com muitas imagens ou v√≠deos" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de miniaturas corrompidas ou desatualizadas" -ForegroundColor DarkGray
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemLogs {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Logs do Sistema ---" -ForegroundColor Cyan
    Write-Host "Limpa os logs de eventos do sistema para liberar espa√ßo e melhorar o desempenho." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando logs do sistema..." -ForegroundColor Yellow
    
    # Verificar tamanho dos logs antes da limpeza
    $eventLogs = Get-WinEvent -ListLog * -ErrorAction SilentlyContinue | Where-Object { $_.RecordCount -gt 0 }
    $totalLogCount = ($eventLogs | Measure-Object).Count
    $total = ($eventLogs | Measure-Object -Property FileSize -Sum).Sum / 1MB
    
    Write-Host "Encontrados $totalLogCount logs de eventos ocupando aproximadamente $([math]::Round($total, 2)) MB." -ForegroundColor White
    
    # Limpar os logs principais
    Write-Host "Limpando logs principais do sistema..." -ForegroundColor Yellow
    
    $mainLogs = @("Application", "System", "Security")
    foreach ($log in $mainLogs) {
        try {
            $logSize = (Get-WinEvent -ListLog $log -ErrorAction SilentlyContinue).FileSize / 1MB
            $logRecords = (Get-WinEvent -ListLog $log -ErrorAction SilentlyContinue).RecordCount
            
            Write-Host "Log $log: $([math]::Round($logSize, 2)) MB com $logRecords registros" -ForegroundColor DarkGray
            wevtutil cl $log
            Write-Host "Log $log limpo com sucesso!" -ForegroundColor Green
        } catch {
            Write-Host "N√£o foi poss√≠vel limpar o log $log." -ForegroundColor Red
        }
    }
    
    # Perguntar se deseja limpar todos os outros logs
    $confirmAllLogs = Read-Host "Deseja limpar todos os outros logs do sistema? (s/n)"
    
    if ($confirmAllLogs -eq 's') {
        Write-Host "Limpando todos os logs do sistema... (isso pode levar algum tempo)" -ForegroundColor Yellow
        
        $otherLogs = $eventLogs | Where-Object { $_.LogName -notin $mainLogs }
        foreach ($log in $otherLogs) {
            try {
                wevtutil cl $log.LogName
            } catch {
                # Ignorar erros silenciosamente
            }
        }
        
        Write-Host "Todos os logs do sistema foram limpos!" -ForegroundColor Green
    } else {
        Write-Host "Apenas os logs principais foram limpos." -ForegroundColor Green
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanWindowsUpdateCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Atualiza√ß√µes do Windows ---" -ForegroundColor Yellow
    Write-Host "Limpa os arquivos tempor√°rios de atualiza√ß√µes do Windows para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando cache de atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    
    # Verificar tamanho da pasta SoftwareDistribution antes da limpeza
    $updateCachePath = "$env:SystemRoot\SoftwareDistribution\Download"
    $updateCacheFiles = Get-ChildItem -Path $updateCachePath -Recurse -ErrorAction SilentlyContinue
    $updateCacheSize = ($updateCacheFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "O cache de atualiza√ß√µes do Windows est√° ocupando aproximadamente $([math]::Round($updateCacheSize, 2)) MB." -ForegroundColor White
    
    # Parar o servi√ßo Windows Update
    Write-Host "Parando o servi√ßo Windows Update..." -ForegroundColor DarkGray
    Stop-Service -Name wuauserv -Force -ErrorAction SilentlyContinue
    
    # Limpar o cache de atualiza√ß√µes
    Write-Host "Limpando o cache de atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    
    # Iniciar o servi√ßo Windows Update novamente
    Write-Host "Iniciando o servi√ßo Windows Update..." -ForegroundColor DarkGray
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    
    Write-Host "Cache de atualiza√ß√µes do Windows limpo com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de atualiza√ß√µes:" -ForegroundColor Cyan
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray
    Write-Host "- Resolu√ß√£o de problemas com atualiza√ß√µes do Windows" -ForegroundColor DarkGray
    Write-Host "- Melhoria no desempenho do sistema" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanHibernationFile {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos de Hiberna√ß√£o ---" -ForegroundColor White
    Write-Host "Gerencia o arquivo de hiberna√ß√£o (hiberfil.sys) para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar status atual da hiberna√ß√£o
    Write-Host "Verificando status atual da hiberna√ß√£o..." -ForegroundColor Yellow
    $hibernationStatus = powercfg.exe /availablesleepstates | Select-String -Pattern "Hiberna√ß√£o"
    
    if ($hibernationStatus -match "Hiberna√ß√£o est√° desativada") {
        $currentStatus = "desativada"
    } else {
        $currentStatus = "ativada"
    }
    
    Write-Host "Status atual da hiberna√ß√£o: $currentStatus" -ForegroundColor White
    
    # Verificar tamanho do arquivo de hiberna√ß√£o (se existir)
    $systemDrive = $env:SystemDrive
    $hiberfilPath = "$systemDrive\hiberfil.sys"
    
    if (Test-Path -Path $hiberfilPath -ErrorAction SilentlyContinue) {
        try {
            $hiberfilSize = (Get-Item -Path $hiberfilPath -Force -ErrorAction SilentlyContinue).Length / 1GB
            Write-Host "Tamanho do arquivo de hiberna√ß√£o: $([math]::Round($hiberfilSize, 2)) GB" -ForegroundColor White
        } catch {
            Write-Host "N√£o foi poss√≠vel determinar o tamanho do arquivo de hiberna√ß√£o." -ForegroundColor DarkGray
        }
    } else {
        Write-Host "Arquivo de hiberna√ß√£o n√£o encontrado (j√° est√° desativado)." -ForegroundColor DarkGray
    }
    
    # Perguntar se deseja desativar ou ativar a hiberna√ß√£o
    if ($currentStatus -eq "ativada") {
        $confirmHibernation = Read-Host "Deseja desativar a hiberna√ß√£o para liberar espa√ßo em disco? (s/n)"
        
        if ($confirmHibernation -eq 's') {
            Write-Host "Desativando a hiberna√ß√£o..." -ForegroundColor Yellow
            powercfg.exe /hibernate off
            Write-Host "Hiberna√ß√£o desativada com sucesso! O arquivo hiberfil.sys foi removido." -ForegroundColor Green
        } else {
            Write-Host "Hiberna√ß√£o mantida ativada." -ForegroundColor Green
        }
    } else {
        $confirmHibernation = Read-Host "Deseja ativar a hiberna√ß√£o? (s/n)"
        
        if ($confirmHibernation -eq 's') {
            Write-Host "Ativando a hiberna√ß√£o..." -ForegroundColor Yellow
            powercfg.exe /hibernate on
            Write-Host "Hiberna√ß√£o ativada com sucesso! O arquivo hiberfil.sys foi criado." -ForegroundColor Green
            
            # Verificar novo tamanho do arquivo de hiberna√ß√£o
            if (Test-Path -Path $hiberfilPath -ErrorAction SilentlyContinue) {
                try {
                    $newHiberfilSize = (Get-Item -Path $hiberfilPath -Force -ErrorAction SilentlyContinue).Length / 1GB
                    Write-Host "Tamanho do novo arquivo de hiberna√ß√£o: $([math]::Round($newHiberfilSize, 2)) GB" -ForegroundColor White
                } catch {
                    Write-Host "N√£o foi poss√≠vel determinar o tamanho do novo arquivo de hiberna√ß√£o." -ForegroundColor DarkGray
                }
            }
        } else {
            Write-Host "Hiberna√ß√£o mantida desativada." -ForegroundColor Green
        }
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo foi afetado:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nInforma√ß√µes sobre a hiberna√ß√£o:" -ForegroundColor Cyan
    Write-Host "- O arquivo de hiberna√ß√£o (hiberfil.sys) geralmente ocupa espa√ßo equivalente a 75% da RAM instalada" -ForegroundColor DarkGray
    Write-Host "- Desativar a hiberna√ß√£o libera esse espa√ßo, mas voc√™ n√£o poder√° usar o modo de hiberna√ß√£o" -ForegroundColor DarkGray
    Write-Host "- A hiberna√ß√£o √© √∫til para laptops, pois salva o estado do sistema no disco antes de desligar" -ForegroundColor DarkGray
    Write-Host "- Para desktops, a hiberna√ß√£o geralmente √© menos necess√°ria" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanWinSxS {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Pasta WinSxS ---" -ForegroundColor Magenta
    Write-Host "Limpa componentes n√£o utilizados da pasta WinSxS para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "A pasta WinSxS (Windows Side-by-Side) armazena componentes do sistema e pode ocupar muito espa√ßo." -ForegroundColor White
    Write-Host "Esta limpeza √© segura e usa ferramentas oficiais do Windows para remover componentes n√£o utilizados." -ForegroundColor White
    Write-Host ""
    
    # Verificar tamanho da pasta WinSxS antes da limpeza
    Write-Host "Verificando tamanho da pasta WinSxS (isso pode levar algum tempo)..." -ForegroundColor Yellow
    
    try {
        $winSxSSize = (Get-ChildItem -Path "$env:SystemRoot\WinSxS" -Recurse -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum / 1GB
        Write-Host "Tamanho atual da pasta WinSxS: $([math]::Round($winSxSSize, 2)) GB" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel determinar o tamanho da pasta WinSxS." -ForegroundColor DarkGray
    }
    
    # Perguntar se deseja prosseguir com a limpeza
    $confirmCleanup = Read-Host "Deseja prosseguir com a limpeza da pasta WinSxS? (s/n)"
    
    if ($confirmCleanup -eq 's') {
        Write-Host "Executando limpeza de componentes n√£o utilizados (isso pode levar v√°rios minutos)..." -ForegroundColor Yellow
        
        # Executar limpeza de componentes
        Write-Host "Etapa 1: Limpeza de componentes..." -ForegroundColor DarkGray
        Dism.exe /Online /Cleanup-Image /StartComponentCleanup
        
        # Perguntar se deseja executar limpeza mais agressiva (com reset base)
        $confirmResetBase = Read-Host "Deseja executar uma limpeza mais profunda? (remove a capacidade de desinstalar atualiza√ß√µes) (s/n)"
        
        if ($confirmResetBase -eq 's') {
            Write-Host "Etapa 2: Executando limpeza profunda (isso pode levar muito tempo)..." -ForegroundColor DarkGray
            Dism.exe /Online /Cleanup-Image /StartComponentCleanup /ResetBase
            Write-Host "Limpeza profunda conclu√≠da!" -ForegroundColor Green
        }
        
        Write-Host "Limpeza da pasta WinSxS conclu√≠da com sucesso!" -ForegroundColor Green
        
        # Verificar tamanho da pasta WinSxS ap√≥s a limpeza
        try {
            $newWinSxSSize = (Get-ChildItem -Path "$env:SystemRoot\WinSxS" -Recurse -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum / 1GB
            $savedSpace = $winSxSSize - $newWinSxSSize
            
            Write-Host "Tamanho atual da pasta WinSxS: $([math]::Round($newWinSxSSize, 2)) GB" -ForegroundColor White
            Write-Host "Espa√ßo liberado: $([math]::Round($savedSpace, 2)) GB" -ForegroundColor Green
        } catch {
            Write-Host "N√£o foi poss√≠vel determinar o novo tamanho da pasta WinSxS." -ForegroundColor DarkGray
        }
    } else {
        Write-Host "Limpeza da pasta WinSxS cancelada." -ForegroundColor Yellow
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nInforma√ß√µes sobre a pasta WinSxS:" -ForegroundColor Cyan
    Write-Host "- A pasta WinSxS armazena componentes do sistema Windows e atualiza√ß√µes" -ForegroundColor DarkGray
    Write-Host "- N√£o √© recomendado excluir esta pasta manualmente" -ForegroundColor DarkGray
    Write-Host "- A limpeza realizada √© segura e usa ferramentas oficiais do Windows" -ForegroundColor DarkGray
    Write-Host "- Ap√≥s a limpeza profunda, n√£o ser√° poss√≠vel desinstalar algumas atualiza√ß√µes" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - REDE (Expandidas) ---
function Invoke-NetworkFlushDns {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Limpar Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-NetworkChangeDns {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Mudar Servidor DNS ---" -ForegroundColor Cyan
    Write-Host "Permite definir servidores DNS personalizados para suas conex√µes de rede." -ForegroundColor DarkGray
    Write-Host ""

    # Listar adaptadores de rede ativos
    Write-Host "Listando adaptadores de rede ativos..." -ForegroundColor Yellow
    $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" }
    
    if ($networkAdapters.Count -eq 0) {
        Write-Host "Nenhum adaptador de rede ativo encontrado." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    Write-Host "Adaptadores de rede ativos:" -ForegroundColor White
    $index = 1
    foreach ($adapter in $networkAdapters) {
        Write-Host "[$index] $($adapter.Name) - $($adapter.InterfaceDescription)" -ForegroundColor White
        $index++
    }
    Write-Host ""
    
    # Selecionar adaptador de rede
    $adapterChoice = Read-Host "Selecione o n√∫mero do adaptador que deseja configurar (ou 0 para voltar)"
    
    if ($adapterChoice -eq "0" -or $adapterChoice -eq "") {
        Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    $adapterIndex = [int]$adapterChoice - 1
    if ($adapterIndex -lt 0 -or $adapterIndex -ge $networkAdapters.Count) {
        Write-Host "Sele√ß√£o inv√°lida." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    $selectedAdapter = $networkAdapters[$adapterIndex]
    
    # Mostrar configura√ß√£o DNS atual
    Write-Host "Configura√ß√£o DNS atual para $($selectedAdapter.Name):" -ForegroundColor Yellow
    $currentDns = Get-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -AddressFamily IPv4 | Select-Object -ExpandProperty ServerAddresses
    
    if ($currentDns.Count -eq 0) {
        Write-Host "Nenhum servidor DNS configurado manualmente (usando DHCP)." -ForegroundColor DarkGray
    } else {
        foreach ($dns in $currentDns) {
            Write-Host $dns -ForegroundColor White
        }
    }
    Write-Host ""
    
    # Op√ß√µes de DNS
    Write-Host "Op√ß√µes de DNS:" -ForegroundColor Yellow
    Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
    Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
    Write-Host "[3] OpenDNS (208.67.222.222, 208.67.220.220)" -ForegroundColor White
    Write-Host "[4] Quad9 (9.9.9.9, 149.112.112.112)" -ForegroundColor White
    Write-Host "[5] AdGuard DNS (94.140.14.14, 94.140.15.15)" -ForegroundColor White
    Write-Host "[6] Inserir DNS personalizado" -ForegroundColor White
    Write-Host "[7] Usar DNS autom√°tico (DHCP)" -ForegroundColor White
    Write-Host "[0] Cancelar" -ForegroundColor White
    Write-Host ""
    
    $dnsChoice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($dnsChoice) {
        "1" {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            $dnsName = "Google DNS"
        }
        "2" {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            $dnsName = "Cloudflare DNS"
        }
        "3" {
            $primaryDns = "208.67.222.222"
            $secondaryDns = "208.67.220.220"
            $dnsName = "OpenDNS"
        }
        "4" {
            $primaryDns = "9.9.9.9"
            $secondaryDns = "149.112.112.112"
            $dnsName = "Quad9"
        }
        "5" {
            $primaryDns = "94.140.14.14"
            $secondaryDns = "94.140.15.15"
            $dnsName = "AdGuard DNS"
        }
        "6" {
            $primaryDns = Read-Host "Digite o endere√ßo do DNS prim√°rio"
            $secondaryDns = Read-Host "Digite o endere√ßo do DNS secund√°rio (ou deixe em branco)"
            $dnsName = "DNS Personalizado"
        }
        "7" {
            Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ResetServerAddresses
            Write-Host "Configura√ß√£o de DNS definida para autom√°tica (DHCP)." -ForegroundColor Green
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
        "0" {
            Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
        default {
            Write-Host "Op√ß√£o inv√°lida." -ForegroundColor Red
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
    }
    
    # Aplicar configura√ß√£o de DNS
    if ($secondaryDns -eq "") {
        Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ServerAddresses $primaryDns
    } else {
        Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ServerAddresses $primaryDns, $secondaryDns
    }
    
    Write-Host "Configura√ß√£o de DNS alterada para $dnsName." -ForegroundColor Green
    Write-Host "DNS Prim√°rio: $primaryDns" -ForegroundColor White
    if ($secondaryDns -ne "") {
        Write-Host "DNS Secund√°rio: $secondaryDns" -ForegroundColor White
    }
    
    # Limpar cache DNS ap√≥s a mudan√ßa
    Write-Host "Limpando cache DNS para aplicar as altera√ß√µes..." -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo." -ForegroundColor Green
    
    Write-Host "`nBenef√≠cios de usar servidores DNS alternativos:" -ForegroundColor Cyan
    Write-Host "- Maior velocidade de resolu√ß√£o de nomes" -ForegroundColor DarkGray
    Write-Host "- Melhor confiabilidade e disponibilidade" -ForegroundColor DarkGray
    Write-Host "- Alguns servidores oferecem prote√ß√£o adicional contra malware e phishing" -ForegroundColor DarkGray
    Write-Host "- Possibilidade de contornar bloqueios de conte√∫do baseados em DNS" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-NetworkReset {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Resetar Configura√ß√µes de Rede ---" -ForegroundColor White
    Write-Host "Reinicia os componentes de rede. Use como √∫ltimo recurso para solucionar problemas de conex√£o." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "!!! ATEN√á√ÉO: ESTE COMANDO VAI REINICIAR SUAS CONFIGURA√á√ïES DE REDE !!!" -ForegroundColor Red
    Write-Host "Sua conex√£o ser√° interrompida temporariamente e todas as configura√ß√µes de rede personalizadas ser√£o redefinidas." -ForegroundColor Yellow
    Write-Host "Isso inclui adaptadores de rede, configura√ß√µes de DNS, configura√ß√µes de proxy, etc." -ForegroundColor Yellow
    Write-Host ""
    
    Write-Host "Esta opera√ß√£o pode ajudar a resolver os seguintes problemas:" -ForegroundColor Cyan
    Write-Host "- Conex√µes de rede inst√°veis ou intermitentes" -ForegroundColor DarkGray
    Write-Host "- Problemas de DNS ou resolu√ß√£o de nomes" -ForegroundColor DarkGray
    Write-Host "- Problemas de conectividade ap√≥s instala√ß√£o de software ou atualiza√ß√µes" -ForegroundColor DarkGray
    Write-Host "- Erros de rede persistentes que n√£o s√£o resolvidos por outros m√©todos" -ForegroundColor DarkGray
    Write-Host ""
    
    $confirm = Read-Host "Tem certeza que deseja resetar as configura√ß√µes de rede? (digite 'sim' para confirmar)"
    
    if ($confirm -eq 'sim') {
        Write-Host "Iniciando reset de configura√ß√µes de rede..." -ForegroundColor Yellow
        
        # Etapa 1: Resetar pilha TCP/IP
        Write-Host "Etapa 1: Resetando pilha TCP/IP..." -ForegroundColor DarkGray
        netsh int ip reset
        
        # Etapa 2: Resetar cat√°logo Winsock
        Write-Host "Etapa 2: Resetando cat√°logo Winsock..." -ForegroundColor DarkGray
        netsh winsock reset
        
        # Etapa 3: Limpar cache DNS
        Write-Host "Etapa 3: Limpando cache DNS..." -ForegroundColor DarkGray
        ipconfig /flushdns
        
        # Etapa 4: Renovar configura√ß√µes DHCP
        Write-Host "Etapa 4: Renovando configura√ß√µes DHCP..." -ForegroundColor DarkGray
        ipconfig /release
        ipconfig /renew
        
        # Etapa 5: Reiniciar adaptadores de rede
        Write-Host "Etapa 5: Reiniciando adaptadores de rede..." -ForegroundColor DarkGray
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        
        Write-Host "Reset de configura√ß√µes de rede conclu√≠do!" -ForegroundColor Green
        Write-Host "Recomenda-se reiniciar o computador para aplicar todas as altera√ß√µes." -ForegroundColor Yellow
        
        $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (s/n)"
        if ($confirmRestart -eq 's') {
            Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
            Restart-Computer -Force
        } else {
            Write-Host "Rein√≠cio cancelado. Algumas altera√ß√µes podem n√£o ter efeito at√© que o computador seja reiniciado." -ForegroundColor Yellow
        }
    } else {
        Write-Host "Reset de configura√ß√µes de rede cancelado." -ForegroundColor Green
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-OptimizeTcpIp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Otimizar Configura√ß√µes TCP/IP ---" -ForegroundColor Green
    Write-Host "Ajusta configura√ß√µes avan√ßadas do TCP/IP para melhorar o desempenho da conex√£o." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o otimiza v√°rios par√¢metros TCP/IP para melhorar a velocidade e estabilidade da conex√£o." -ForegroundColor White
    Write-Host "As otimiza√ß√µes s√£o seguras e podem ser revertidas se necess√°rio." -ForegroundColor White
    Write-Host ""
    
    Write-Host "Configura√ß√µes atuais:" -ForegroundColor Yellow
    
    # Mostrar configura√ß√µes atuais
    Write-Host "Auto-Tuning Level:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Auto-Tuning Level"
    
    Write-Host "Congestion Provider:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Congestion Control Provider"
    
    Write-Host "ECN Capability:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "ECN Capability"
    
    Write-Host "Receive-Side Scaling (RSS):" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Receive-Side Scaling State"
    
    Write-Host ""
    $confirm = Read-Host "Deseja aplicar otimiza√ß√µes TCP/IP recomendadas? (s/n)"
    
    if ($confirm -eq 's') {
        Write-Host "Aplicando otimiza√ß√µes TCP/IP..." -ForegroundColor Yellow
        
        # Otimiza√ß√£o 1: Habilitar TCP Window Auto-Tuning
        Write-Host "Configurando TCP Auto-Tuning para 'normal'..." -ForegroundColor DarkGray
        netsh int tcp set global### Enhanced TORK Optimizer

I'll enhance the TORK optimizer with more comprehensive functionality across all features, starting with an expanded Simple Cleanup function and then improving all other options.

```powershell type="code"
# Define a preferencia de acao para erros (continua a execucao por padrao)
# Permite que o script tente rodar o m√°ximo poss√≠vel mesmo que alguns comandos encontrem problemas.
$ErrorActionPreference = 'SilentlyContinue' # N√£o exibe erros se um item n√£o puder ser processado, por exemplo.

# --- Funcao pra Centralizar Texto (Nosso Maestro de Alinhamento - s√≥ pra textos, n√£o pro bannerz√£o!) ---
# Deixa ela aqui, vai que a gente usa pra centralizar outra coisa, n√©?
function Centraliza($texto, $cor="White") {
    $largura = [console]::WindowWidth # Pega a largura da largura da janela agora
    # Calcula o espa√ßo pra botar o texto no meio. Pura matem√°tica da zoeira!
    $espacos = [Math]::Max(0, [Math]::Floor(($largura - $texto.Length) / 2))
    $linha = (" " * $espacos) + $texto # Cria a linha com os espa√ßos e o texto
    Write-Host $linha -ForegroundColor $cor # Manda pro console com a cor pedida
}

# --- Funcao que Desenha o Nosso Banner Irado do TORK! ---
# Esse √© o nosso outdoor digital no console! Ajustado pros espa√ßos que voc√™ mandou!
# Se as bordas ainda estiverem meio teimosas, √© o jeitinho do console mesmo, viu? üòâ
function Banner-TORK {
    # Nossas cores vibrantes para o banner!
    $CorBorda = "DarkCyan" # Mantido para a borda, combina com o ciano. Se quiser mudar, √© aqui!
    $CorLogo = "Green" # Cor vibrante
    $CorProjeto = "Cyan" # Cor vibrante
    $CorCopyright = "Gray" # Tom mais suave

    Write-Host "" # D√° um espacinho no topo, pra n√£o grudar
    Write-Host "                    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë          ‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë ‚ñà‚ñà‚ïî‚ïù                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ñà‚ñà‚ïó                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù                                          ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë           Bem-vindo ao TORK - Otimizador para Windows!                                ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë        Projeto de automacao, limpeza, manutencao e tweaks.                            ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë            (C) Partner77 - Todos os direitos reservados                               ‚ïë" -ForegroundColor $CorCopyright
    Write-Host "                    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor $CorBorda
    Write-Host "" # Espa√ßo embaixo
}

# --- Checagem de Permiss√µes de Administrador (O Guarda da Porta!) ---
# V√™ se a gente t√° rodando com poderes de admin, sen√£o n√£o d√° pra mexer no Windows direito.
function Test-Administrator {
    $currentUser = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())
    return $currentUser.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
}

if (-not (Test-Administrator)) {
    Write-Host "OPA! Calma l√°, patr√£o!" -ForegroundColor Red
    Write-Host "Pra usar o TORK e deixar o PC voando, preciso de super poderes de Administrador!" -ForegroundColor Yellow
    Write-Host "Fecha essa janela, clica com o bot√£o direito no arquivo do script e escolhe 'Executar como administrador'. A√≠ sim, tamo junto!" -ForegroundColor Yellow
    Read-Host "D√° um Enter quando terminar de ler, que a gente se v√™ na pr√≥xima..."
    Exit
}

Write-Host "Poderes de Administrador verificados! Bora nessa!" -ForegroundColor Green
Start-Sleep -Seconds 1

# --- Fun√ß√µes Utilit√°rias (Ferramentas que usamos em v√°rios lugares) ---
function Get-SystemInfo {
    $os = Get-CimInstance Win32_OperatingSystem
    $cs = Get-CimInstance Win32_ComputerSystem
    $proc = Get-CimInstance Win32_Processor
    $mem = Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property Capacity -Sum
    
    $info = @{
        "OSName" = $os.Caption
        "OSVersion" = $os.Version
        "OSBuild" = $os.BuildNumber
        "ComputerName" = $cs.Name
        "Manufacturer" = $cs.Manufacturer
        "Model" = $cs.Model
        "Processor" = $proc.Name
        "Memory" = [math]::Round($mem.Sum / 1GB, 2)
        "Architecture" = $os.OSArchitecture
        "InstallDate" = $os.InstallDate
        "LastBootTime" = $os.LastBootUpTime
    }
    
    return $info
}

function Show-SystemSummary {
    $sysInfo = Get-SystemInfo
    
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Computador: $($sysInfo.ComputerName)" -ForegroundColor White
    Write-Host "Fabricante: $($sysInfo.Manufacturer)" -ForegroundColor White
    Write-Host "Modelo: $($sysInfo.Model)" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "Instalado em: $($sysInfo.InstallDate)" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

function Get-DiskSpaceBefore {
    $drives = Get-PSDrive -PSProvider FileSystem
    $driveInfo = @{}
    
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        
        $driveInfo[$drive.Name] = @{
            "Free" = $freeSpace
            "Used" = $usedSpace
            "Total" = $totalSpace
        }
    }
    
    return $driveInfo
}

function Show-DiskSpaceComparison {
    param (
        $before
    )
    
    $after = Get-PSDrive -PSProvider FileSystem
    
    Write-Host "=== Compara√ß√£o de Espa√ßo em Disco ===" -ForegroundColor Cyan
    
    foreach ($drive in $after) {
        if ($before.ContainsKey($drive.Name)) {
            $freeSpaceAfter = [math]::Round($drive.Free / 1GB, 2)
            $freeSpaceBefore = $before[$drive.Name].Free
            $spaceRecovered = [math]::Round($freeSpaceAfter - $freeSpaceBefore, 2)
            
            Write-Host "Drive $($drive.Name):" -ForegroundColor White
            Write-Host "  Espa√ßo livre antes: $freeSpaceBefore GB" -ForegroundColor Gray
            Write-Host "  Espa√ßo livre agora: $freeSpaceAfter GB" -ForegroundColor Gray
            
            if ($spaceRecovered -gt 0) {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Green
            } else {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Yellow
            }
            Write-Host ""
        }
    }
    
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

# --- Fun√ß√µes dos Menus (Principal, Simplificado, Avan√ßado e Sub-menus) ---

# --- Menu Principal (A Bifurca√ß√£o do Destino! Simplificado vs Avan√ßado) ---
# √â aqui que o usu√°rio escolhe se quer ser um mago ou um cara pr√°tico!
function Show-MainMenu {
    do {
        Clear-Host # Limpa a tela pra organizar o menu
        Banner-TORK # Banner no topo, pra gente n√£o esquecer quem somos!
        Show-SystemSummary # Mostra um resumo do sistema

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "       MENU PRINCIPAL" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # As duas grandes estradas da otimiza√ß√£o! Cores variadas (repetindo)!
        Write-Host "[1] Otimiza√ß√£o Simplificada (Pra quem quer praticidade e resultado r√°pido!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o Avan√ßada (Pra quem curte mexer fundo e ter control total!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[3] Diagn√≥stico R√°pido do Sistema (Ver o que t√° rolando no PC)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[4] Sobre o TORK (Informa√ß√µes e cr√©ditos)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[0] Sair (Ah, que pena... Mas a porta t√° aberta!)" -ForegroundColor Red # Vermelho pra Sair - Ok

        Write-Host ""

        # Pergunta pro usu√°rio qual caminho ele escolhe, tipo Mestre Pok√©mon!
        $choice = Read-Host "Escolhe sua op√ß√£o, treinador!"

        # V√™ pra onde a gente vai com base na escolha
        switch ($choice) {
            "1" { Show-SimplifiedMenu } # Se escolheu 1, vai pro Menu Simplificado!
            "2" { Show-AdvancedMenu } # Se escolheu 2, vai pro Menu Avan√ßado!
            "3" { Invoke-QuickDiagnostic } # Nova fun√ß√£o de diagn√≥stico r√°pido
            "4" { Show-AboutTORK } # Nova fun√ß√£o de sobre
            "0" { Write-Host "Fechou! Valeu por usar o TORK! Volte sempre que seu PC pedir um g√°s! ;)" -ForegroundColor Green; Start-Sleep -Seconds 2; break } # Se escolheu 0, vaza (mas volta!)
            default {
                Write-Host "Eita! Op√ß√£o inv√°lida! Confere os n√∫meros e tenta de novo, bora l√°!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1 # D√° um tempinho pro usu√°rio ver a zoeira da mensagem
            }
        }
    } while ($choice -ne '0') # Repete o Menu Principal enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Simplificado (Aqui o TORK faz m√°gica r√°pida e segura!) ---
# Acessado pela op√ß√£o 1 do Menu Principal. Menos op√ß√µes, mais a√ß√£o direta!
function Show-SimplifiedMenu {
    do {
        Clear-Host # Limpa o palco pra esse menu!
        Banner-TORK # Nosso banner no topo, sempre presente!

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "   OTIMIZACAO SIMPLIFICADA" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes SIMPLIFICADAS - cada uma pode fazer um monte de coisa por baixo dos panos! Cores variadas (repetindo as prim√°rias/neon e adicionando outras)!
        Write-Host "[1] Limpeza Geral do Sistema (Tira o lixo que t√° pesando!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o de Mem√≥ria e Programas que Ligam com o Windows (Deixa tudo mais √°gil!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[3] Acelerar a Conex√£o com a Internet (Pra navegar sem gargalo!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[4] Deixar o Windows mais Leve Visualmente (Desativa uns efeitos pra ganhar desempenho!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Otimiza√ß√£o de Jogos (Configura√ß√µes pra melhorar FPS e desempenho)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[6] Manuten√ß√£o de Seguran√ßa (Verificar e corrigir problemas de seguran√ßa)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[7] RODAR TODAS as otimiza√ß√µes SIMPLIFICADAS! (Modo Turbo F√°cil!)" -ForegroundColor Red # Vermelho pra "Faz Tudo" - Destaque/Cuidado
        Write-Host "[0] Voltar ao Menu Principal (A gente te espera aqui!)" -ForegroundColor Gray # Cor neutra pra voltar

        Write-Host ""

        # Pergunta qual m√°gica simplificada o usu√°rio quer
        $choice = Read-Host "Escolhe sua m√°gica simplificada!"

        # V√™ qual m√°gica rodar
        switch ($choice) {
            "1" { Invoke-SimpleSystemCleanup } # Chama a fun√ß√£o de limpeza b√°sica
            "2" { Invoke-SimpleMemoryStartup } # Chama a fun√ß√£o pra mem√≥ria/inicializa√ß√£o
            "3" { Invoke-SimpleInternetOpt } # Chama a fun√ß√£o pra internet
            "4" { Invoke-SimpleVisualOpt } # Chama a fun√ß√£o pra visual
            "5" { Invoke-SimpleGamingOpt } # Nova fun√ß√£o para otimiza√ß√£o de jogos
            "6" { Invoke-SimpleSecurityMaintenance } # Nova fun√ß√£o para manuten√ß√£o de seguran√ßa
            "7" {
                # Rodar todas as simplificadas sequencialmente
                Write-Host "`nModo Turbo F√°cil ATIVADO! Rodando todas as otimiza√ß√µes SIMPLIFICADAS... segura pe√£o!`n" -ForegroundColor Yellow
                Invoke-SimpleSystemCleanup # Roda a 1
                Invoke-SimpleMemoryStartup # Roda a 2
                Invoke-SimpleInternetOpt # Roda a 3
                Invoke-SimpleVisualOpt # Roda a 4
                Invoke-SimpleGamingOpt # Roda a 5
                Invoke-SimpleSecurityMaintenance # Roda a 6
                Write-Host "`nShow! Todas as otimiza√ß√µes SIMPLIFICADAS foram executadas! PC t√° agradecendo! ;)`n" -ForegroundColor Green
                Read-Host "Aperta Enter pra voltar pro Menu Simplificado..." # Pausa no final do "Rodar Todas"
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-MainMenu
            default {
                Write-Host "Ops! Op√ß√£o inv√°lida no Menu Simplificado! Confere os n√∫meros e manda bala de novo!" -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Simplificado enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Avan√ßado (O Playground dos Magos do PC!) ---
# Acessado pela op√ß√£o 2 do Menu Principal. Aqui a gente mergulha fundo!
function Show-AdvancedMenu {
    do {
        Clear-Host # Limpa o palco pro menu avan√ßado!
        Banner-TORK # Nosso banner no topo, pra n√£o perder a pose!

        Write-Host "" # Espacinho maroto
        Write-Host "===============================" -ForegroundColor White
        Write-Host "      MENU AVANCADO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes do menu avan√ßado (as CATEGORIAS dos 200 poderes!) Cores variadas (repetindo)!
        Write-Host "[1] Limpeza e Manuten√ß√£o de Arquivos (Tirar a poeira digital!)" -ForegroundColor Cyan # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[2] Otimiza√ß√µes de Desempenho do Sistema (Deixar o motor roncando!)" -ForegroundColor Green # Cor variada
        Write-Host "[3] Configura√ß√µes e Otimiza√ß√µes de Rede (Pra internet voar baixo!)" -ForegroundColor Yellow # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[4] Gerenciamento e Otimiza√ß√£o de Servi√ßos do Windows (O que t√° rodando e n√£o precisa?!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Ferramentas de Diagn√≥stico e Verifica√ß√£o (Pra ver se t√° tudo nos conformes!)" -ForegroundColor Cyan # Cor repetida
        Write-Host "[6] Desabilitar/Gerenciar Recursos do Windows (Tirar o peso extra do sistema!)" -ForegroundColor Green # Cor repetida
        Write-Host "[7] Gerenciamento de Arquivos e Pastas Avan√ßado (Comandos ninja pra arquivos!)" -ForegroundColor Yellow # Cor repetida
        Write-Host "[8] Gerenciamento de Contas de Usu√°rio (Organizar a galera que usa o PC!)" -ForegroundColor White # Cor repetida
        Write-Host "[9] Otimiza√ß√£o para Jogos Avan√ßada (Tweaks pra gamers de verdade!)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Configura√ß√µes de Privacidade (Controle o que o Windows sabe sobre voc√™)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[11] Outras Configura√ß√µes e Tweaks Diversos (Aqueles ajustes secretos!)" -ForegroundColor Gray # Cor neutra/escura
        Write-Host "[0] Voltar ao Menu Principal (Pronto pra voltar pra estrada principal!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta pro mago qual categoria ele quer explorar
        $choice = Read-Host "Escolhe sua √°rea de magia, mago!"

        # V√™ pra onde a gente navega dentro do mundo avan√ßado
        switch ($choice) {
            "1" { Show-LimpezaManutencaoMenu } # CHAMA O SUB-MENU DE LIMPEZA
            "2" { Show-DesempenhoMenu } # Agora √© um sub-menu tamb√©m
            "3" { Show-ConfiguracoesRedeMenu } # CHAMA O SUB-MENU DE REDE
            "4" { Show-ServicosMenu } # Agora √© um sub-menu tamb√©m
            "5" { Show-DiagnosticoMenu } # Agora √© um sub-menu tamb√©m
            "6" { Show-RecursosMenu } # Agora √© um sub-menu tamb√©m
            "7" { Show-ArquivosPastasMenu } # Agora √© um sub-menu tamb√©m
            "8" { Show-UsuariosMenu } # Agora √© um sub-menu tamb√©m
            "9" { Show-JogosAvancadoMenu } # Novo sub-menu para jogos
            "10" { Show-PrivacidadeMenu } # Novo sub-menu para privacidade
            "11" { Show-OutrosMenu } # Agora √© um sub-menu tamb√©m
            "0" { break } # Sai do loop deste menu, voltando pro Menu Principal
            default {
                Write-Host "Humm, essa √°rea da magia ainda n√£o existe ou voc√™ digitou errado! Tenta de novo, mago!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Avan√ßado enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Limpeza e Manuten√ß√£o (Dentro do Avan√ßado!) ---
# Este menu lista as op√ß√µes ESPEC√çFICAS da categoria Limpeza no Menu Avan√ßado
function Show-LimpezaManutencaoMenu {
    do {
        Clear-Host # Limpa o palco pra este sub-menu!
        Banner-TORK # Banner no topo, sempre!

        Write-Host "" # Espacinho
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: LIMPEZA E MANUT." -ForegroundColor White # T√≠tulo menor pro sub-menu
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes ESPEC√çFICAS da categoria Limpeza. Cores variadas (repetindo cores)!
        Write-Host "[1] Limpar Arquivos Tempor√°rios do Usu√°rio (Tipo a pasta Temp!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[2] Limpar Arquivos Tempor√°rios do Sistema (Os tempor√°rios do Windows!)" -ForegroundColor Gray # Cor neutra (substitui DarkCyan)
        Write-Host "[3] Limpar Cache de DNS (Pra resolver nomes de site mais r√°pido!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[4] Esvaziar Lixeira (Adeus, arquivos deletados!)" -ForegroundColor Gray # Cor neutra (repetindo)
        Write-Host "[5] Limpar Cache de Miniaturas (Aqueles previews de imagem/v√≠deo!)" -ForegroundColor Green # Cor variada
        Write-Host "[6] Limpar Logs do Sistema (Arquivos de registro que acumulam)" -ForegroundColor Cyan # Nova op√ß√£o
        Write-Host "[7] Limpar Cache de Atualiza√ß√µes do Windows (Liberar espa√ßo de updates)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[8] Limpar Arquivos de Hiberna√ß√£o (Liberar o hiberfil.sys)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[9] Limpar Arquivos WinSxS (Pasta que ocupa muito espa√ßo)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Executar TODAS as limpezas acima (Faxina completa!)" -ForegroundColor Red # Nova op√ß√£o
        Write-Host "[0] Voltar ao Menu Avan√ßado (De volta pras categorias!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta qual limpeza espec√≠fica o mago quer fazer
        $choice = Read-Host "Escolhe a limpeza avan√ßada, mestre!"

        # V√™ qual fun√ß√£o de limpeza espec√≠fica chamar
        switch ($choice) {
            "1" { Invoke-CleanUserTemp } # Chama a fun√ß√£o pra Limpar Temp Usu√°rio
            "2" { Invoke-CleanSystemTemp } # Chama a fun√ß√£o pra Limpar Temp Sistema
            "3" { Invoke-CleanDnsCache } # Chama a fun√ß√£o pra Limpar Cache DNS
            "4" { Invoke-EmptyRecycleBin } # Chama a fun√ß√£o pra Esvaziar Lixeira
            "5" { Invoke-CleanThumbnailCache } # Chama a fun√ß√£o pra Limpar Cache de Miniaturas
            "6" { Invoke-CleanSystemLogs } # Nova fun√ß√£o para limpar logs do sistema
            "7" { Invoke-CleanWindowsUpdateCache } # Nova fun√ß√£o para limpar cache de updates
            "8" { Invoke-CleanHibernationFile } # Nova fun√ß√£o para limpar arquivo de hiberna√ß√£o
            "9" { Invoke-CleanWinSxS } # Nova fun√ß√£o para limpar pasta WinSxS
            "10" { 
                # Executa todas as limpezas em sequ√™ncia
                Write-Host "`nIniciando faxina completa do sistema! Isso pode demorar um pouco...`n" -ForegroundColor Yellow
                $diskSpaceBefore = Get-DiskSpaceBefore
                
                Invoke-CleanUserTemp
                Invoke-CleanSystemTemp
                Invoke-CleanDnsCache
                Invoke-EmptyRecycleBin
                Invoke-CleanThumbnailCache
                Invoke-CleanSystemLogs
                Invoke-CleanWindowsUpdateCache
                Invoke-CleanHibernationFile
                Invoke-CleanWinSxS
                
                Write-Host "`nFaxina completa finalizada! Veja quanto espa√ßo foi recuperado:`n" -ForegroundColor Green
                Show-DiskSpaceComparison -before $diskSpaceBefore
                Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-AdvancedMenu
            default {
                Write-Host "Essa tarefa de limpeza ainda n√£o t√° na lista! V√™ os n√∫meros e tenta de novo!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Sub-Menu Limpeza enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Desempenho (Dentro do Avan√ßado!) ---
function Show-DesempenhoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DESEMPENHO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Ajustar Efeitos Visuais para Melhor Desempenho" -ForegroundColor Green
        Write-Host "[2] Otimizar Disco do Sistema" -ForegroundColor Cyan
        Write-Host "[3] Limpar Arquivos Prefetch" -ForegroundColor Yellow
        Write-Host "[4] Definir Plano de Energia para Alto Desempenho" -ForegroundColor White
        Write-Host "[5] Otimizar Servi√ßo SuperFetch/SysMain" -ForegroundColor Magenta
        Write-Host "[6] Ajustar Tamanho da Mem√≥ria Virtual" -ForegroundColor Gray
        Write-Host "[7] Desativar Indexa√ß√£o de Arquivos" -ForegroundColor Green
        Write-Host "[8] Otimizar Inicializa√ß√£o do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de desempenho" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o de desempenho"

        switch ($choice) {
            "1" { Invoke-OptimizeVisualEffects }
            "2" { Invoke-OptimizeDisk }
            "3" { Invoke-CleanPrefetch }
            "4" { Invoke-SetHighPerformancePower }
            "5" { Invoke-OptimizeSuperFetch }
            "6" { Invoke-AdjustVirtualMemory }
            "7" { Invoke-DisableIndexing }
            "8" { Invoke-OptimizeStartup }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de desempenho...`n" -ForegroundColor Yellow
                Invoke-OptimizeVisualEffects
                Invoke-OptimizeDisk
                Invoke-CleanPrefetch
                Invoke-SetHighPerformancePower
                Invoke-OptimizeSuperFetch
                Invoke-AdjustVirtualMemory
                Invoke-DisableIndexing
                Invoke-OptimizeStartup
                Write-Host "`nTodas as otimiza√ß√µes de desempenho foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Configura√ß√µes de Rede (Dentro do Avan√ßado!) ---
function Show-ConfiguracoesRedeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: CONFIG. REDE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Limpar Cache de DNS" -ForegroundColor Yellow
        Write-Host "[2] Mudar Servidor DNS" -ForegroundColor Cyan
        Write-Host "[3] Resetar Configura√ß√µes de Rede" -ForegroundColor White
        Write-Host "[4] Otimizar Configura√ß√µes TCP/IP" -ForegroundColor Green
        Write-Host "[5] Verificar Velocidade da Conex√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar QoS (Qualidade de Servi√ßo)" -ForegroundColor Gray
        Write-Host "[7] Desativar IPv6 (Se n√£o estiver usando)" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Lat√™ncia de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de rede" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√£o de rede"

        switch ($choice) {
            "1" { Invoke-NetworkFlushDns }
            "2" { Invoke-NetworkChangeDns }
            "3" { Invoke-NetworkReset }
            "4" { Invoke-OptimizeTcpIp }
            "5" { Invoke-CheckNetworkSpeed }
            "6" { Invoke-ConfigureQoS }
            "7" { Invoke-DisableIPv6 }
            "8" { Invoke-OptimizeGamingLatency }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de rede...`n" -ForegroundColor Yellow
                Invoke-NetworkFlushDns
                Invoke-OptimizeTcpIp
                Invoke-CheckNetworkSpeed
                Invoke-ConfigureQoS
                Invoke-DisableIPv6
                Invoke-OptimizeGamingLatency
                Write-Host "`nTodas as otimiza√ß√µes de rede foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Rede..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Servi√ßos (Dentro do Avan√ßado!) ---
function Show-ServicosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: SERVICOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desabilitar Servi√ßo SuperFetch/SysMain" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Servi√ßo de Impress√£o" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Servi√ßo Windows Update" -ForegroundColor White
        Write-Host "[4] Listar Todos os Servi√ßos em Execu√ß√£o" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Otimizar Servi√ßos para Desempenho Geral" -ForegroundColor Gray
        Write-Host "[7] Restaurar Servi√ßos para Configura√ß√£o Padr√£o" -ForegroundColor Yellow
        Write-Host "[8] Desabilitar Servi√ßos Desnecess√°rios" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de servi√ßos"

        switch ($choice) {
            "1" { Invoke-ManageSuperFetch }
            "2" { Invoke-ManagePrintService }
            "3" { Invoke-ManageWindowsUpdate }
            "4" { Invoke-ListRunningServices }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-OptimizeServicesForPerformance }
            "7" { Invoke-RestoreDefaultServices }
            "8" { Invoke-DisableUnnecessaryServices }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Diagn√≥stico (Dentro do Avan√ßado!) ---
function Show-DiagnosticoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DIAGNOSTICO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Verificar Arquivos do Sistema (SFC)" -ForegroundColor Yellow
        Write-Host "[2] Reparar Imagem do Windows (DISM)" -ForegroundColor Cyan
        Write-Host "[3] Verificar Disco por Erros (CHKDSK)" -ForegroundColor White
        Write-Host "[4] Verificar Sa√∫de do Disco" -ForegroundColor Green
        Write-Host "[5] Verificar Drivers Desatualizados" -ForegroundColor Magenta
        Write-Host "[6] Verificar Problemas de Inicializa√ß√£o" -ForegroundColor Gray
        Write-Host "[7] Verificar Problemas de Mem√≥ria RAM" -ForegroundColor Yellow
        Write-Host "[8] Verificar Temperatura do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODOS os diagn√≥sticos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de diagn√≥stico"

        switch ($choice) {
            "1" { Invoke-SfcScan }
            "2" { Invoke-DismRepair }
            "3" { Invoke-ChkDsk }
            "4" { Invoke-CheckDiskHealth }
            "5" { Invoke-CheckDrivers }
            "6" { Invoke-CheckStartupIssues }
            "7" { Invoke-CheckMemory }
            "8" { Invoke-CheckTemperature }
            "9" {
                Write-Host "`nExecutando todos os diagn√≥sticos...`n" -ForegroundColor Yellow
                Invoke-SfcScan
                Invoke-DismRepair
                Invoke-CheckDiskHealth
                Invoke-CheckDrivers
                Invoke-CheckStartupIssues
                Invoke-CheckTemperature
                Write-Host "`nTodos os diagn√≥sticos foram conclu√≠dos!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Diagn√≥stico..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Recursos (Dentro do Avan√ßado!) ---
function Show-RecursosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: RECURSOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Gerenciar Hiberna√ß√£o" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Planos de Energia" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Recursos Opcionais do Windows" -ForegroundColor White
        Write-Host "[4] Gerenciar Mem√≥ria Virtual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Windows Defender" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Recursos de Telemetria" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Recursos de Inicializa√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Recursos de Seguran√ßa" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de recursos"

        switch ($choice) {
            "1" { Invoke-ManageHibernation }
            "2" { Invoke-ManagePowerPlans }
            "3" { Invoke-ManageOptionalFeatures }
            "4" { Invoke-ManageVirtualMemory }
            "5" { Invoke-ManageWindowsDefender }
            "6" { Invoke-ManageTelemetry }
            "7" { Invoke-ManageStartupResources }
            "8" { Invoke-ManageSecurityFeatures }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Arquivos e Pastas (Dentro do Avan√ßado!) ---
function Show-ArquivosPastasMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: ARQUIVOS E PASTAS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Encontrar Arquivos Grandes" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Arquivos" -ForegroundColor Cyan
        Write-Host "[3] Tomar Posse de Arquivos (TakeOwn)" -ForegroundColor White
        Write-Host "[4] Listar Conte√∫do de Pastas Espec√≠ficas" -ForegroundColor Green
        Write-Host "[5] Compactar Pastas para Economizar Espa√ßo" -ForegroundColor Magenta
        Write-Host "[6] Verificar Integridade de Arquivos" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Arquivos Ocultos e do Sistema" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Atributos de Arquivos" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de arquivos e pastas"

        switch ($choice) {
            "1" { Invoke-FindLargeFiles }
            "2" { Invoke-ManageFilePermissions }
            "3" { Invoke-TakeOwnership }
            "4" { Invoke-ListFolderContents }
            "5" { Invoke-CompressFolders }
            "6" { Invoke-VerifyFileIntegrity }
            "7" { Invoke-ManageHiddenSystemFiles }
            "8" { Invoke-ManageFileAttributes }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Usu√°rios (Dentro do Avan√ßado!) ---
function Show-UsuariosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: USUARIOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Listar Todos os Usu√°rios Locais" -ForegroundColor Yellow
        Write-Host "[2] Listar Todos os Grupos Locais" -ForegroundColor Cyan
        Write-Host "[3] Listar Membros de Grupos Espec√≠ficos" -ForegroundColor White
        Write-Host "[4] Mostrar Propriedades do Usu√°rio Atual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Contas de Usu√°rio" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Pol√≠ticas de Senha" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Permiss√µes de Usu√°rio" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar UAC (Controle de Conta de Usu√°rio)" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de usu√°rios"

        switch ($choice) {
            "1" { Invoke-ListLocalUsers }
            "2" { Invoke-ListLocalGroups }
            "3" { Invoke-ListGroupMembers }
            "4" { Invoke-ShowCurrentUserProperties }
            "5" { Invoke-ManageUserAccounts }
            "6" { Invoke-ManagePasswordPolicies }
            "7" { Invoke-ManageUserPermissions }
            "8" { Invoke-ManageUAC }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Jogos Avan√ßado (Dentro do Avan√ßado!) ---
function Show-JogosAvancadoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: JOGOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Otimizar Prioridade de CPU para Jogos" -ForegroundColor Yellow
        Write-Host "[2] Otimizar Configura√ß√µes de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[3] Otimizar Configura√ß√µes de GPU" -ForegroundColor White
        Write-Host "[4] Desativar Game DVR e Game Bar" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Configurar Modo de Jogo do Windows" -ForegroundColor Gray
        Write-Host "[7] Otimizar Configura√ß√µes de √Åudio para Jogos" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Configura√ß√µes de Input Lag" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes para jogos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o para jogos"

        switch ($choice) {
            "1" { Invoke-OptimizeCpuPriority }
            "2" { Invoke-OptimizeNetworkForGaming }
            "3" { Invoke-OptimizeGpuSettings }
            "4" { Invoke-DisableGameDvrBar }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-ConfigureGameMode }
            "7" { Invoke-OptimizeAudioForGaming }
            "8" { Invoke-OptimizeInputLag }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes para jogos...`n" -ForegroundColor Yellow
                Invoke-OptimizeCpuPriority
                Invoke-OptimizeNetworkForGaming
                Invoke-OptimizeGpuSettings
                Invoke-DisableGameDvrBar
                Invoke-OptimizeServicesForGaming
                Invoke-ConfigureGameMode
                Invoke-OptimizeAudioForGaming
                Invoke-OptimizeInputLag
                Write-Host "`nTodas as otimiza√ß√µes para jogos foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Jogos..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Privacidade (Dentro do Avan√ßado!) ---
function Show-PrivacidadeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: PRIVACIDADE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desativar Telemetria do Windows" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Aplicativos" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Hist√≥rico de Atividades" -ForegroundColor White
        Write-Host "[4] Gerenciar Diagn√≥stico e Feedback" -ForegroundColor Green
        Write-Host "[5] Gerenciar An√∫ncios Personalizados" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Localiza√ß√£o e Sensores" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Reconhecimento de Voz e Digita√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Sincroniza√ß√£o com a Microsoft" -ForegroundColor Cyan
        Write-Host "[9] Aplicar TODAS as configura√ß√µes de privacidade" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de privacidade"

        switch ($choice) {
            "1" { Invoke-DisableTelemetry }
            "2" { Invoke-ManageAppPermissions }
            "3" { Invoke-ManageActivityHistory }
            "4" { Invoke-ManageDiagnosticsFeedback }
            "5" { Invoke-ManagePersonalizedAds }
            "6" { Invoke-ManageLocationSensors }
            "7" { Invoke-ManageVoiceTyping }
            "8" { Invoke-ManageMicrosoftSync }
            "9" {
                Write-Host "`nAplicando todas as configura√ß√µes de privacidade...`n" -ForegroundColor Yellow
                Invoke-DisableTelemetry
                Invoke-ManageAppPermissions
                Invoke-ManageActivityHistory
                Invoke-ManageDiagnosticsFeedback
                Invoke-ManagePersonalizedAds
                Invoke-ManageLocationSensors
                Invoke-ManageVoiceTyping
                Invoke-ManageMicrosoftSync
                Write-Host "`nTodas as configura√ß√µes de privacidade foram aplicadas!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Privacidade..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Outros (Dentro do Avan√ßado!) ---
function Show-OutrosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: OUTROS TWEAKS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Mostrar Informa√ß√µes Detalhadas do Sistema" -ForegroundColor Yellow
        Write-Host "[2] Mostrar Configura√ß√£o Completa de Rede" -ForegroundColor Cyan
        Write-Host "[3] Reiniciar Explorer.exe" -ForegroundColor White
        Write-Host "[4] Limpar Cache de Atualiza√ß√µes do Windows" -ForegroundColor Green
        Write-Host "[5] Gerenciar Programas de Inicializa√ß√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar Op√ß√µes de Energia Avan√ßadas" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Configura√ß√µes de Armazenamento" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Configura√ß√µes de Notifica√ß√µes" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√µes diversas"

        switch ($choice) {
            "1" { Invoke-ShowDetailedSystemInfo }
            "2" { Invoke-ShowDetailedNetworkConfig }
            "3" { Invoke-RestartExplorer }
            "4" { Invoke-CleanWindowsUpdateCache }
            "5" { Invoke-ManageStartupPrograms }
            "6" { Invoke-ConfigureAdvancedPowerOptions }
            "7" { Invoke-ManageStorageSettings }
            "8" { Invoke-ManageNotificationSettings }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- Fun√ß√µes para as Secoes SIMPLIFICADAS (Expandidas) ---
function Invoke-SimpleSystemCleanup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza Geral do Sistema: Hora de varrer o lixo digital! ---" -ForegroundColor Green
    Write-Host "Essa op√ß√£o vai te ajudar a liberar espa√ßo e dar um f√¥lego pro PC tirando arquivos tempor√°rios, lixo da lixeira, etc. √â tipo faxina no computador!" -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Comando 1: Limpar Arquivos Tempor√°rios do Usu√°rio
    Write-Host "Bora come√ßar limpando os arquivos tempor√°rios do seu usu√°rio! Eles acumulam que √© uma beleza!" -ForegroundColor Yellow
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio limpos! Menos peso pro PC respirar! ;)" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Esvaziar a Lixeira
    Write-Host "Agora, vamos dar um fim definitivo naqueles arquivos na Lixeira. Eles s√≥ est√£o ocupando espa√ßo √† toa!" -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada! Espa√ßo recuperado com sucesso! R√°!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios do Windows
    Write-Host "Vamos limpar tamb√©m os tempor√°rios do pr√≥prio Windows. √Äs vezes, fica lixo escondido por l√°!" -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Limpar Cache de Navegadores Comuns
    Write-Host "Bora dar uma geral nos caches dos navegadores tamb√©m! Eles guardam um monte de coisa que pode pesar!" -ForegroundColor Yellow
    
    # Chrome
    Write-Host "Tentando limpar cache do Google Chrome..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Chrome limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Edge
    Write-Host "Tentando limpar cache do Microsoft Edge..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Edge limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Firefox
    Write-Host "Tentando limpar cache do Mozilla Firefox..." -ForegroundColor DarkGray
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\cache2\entries\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\startupCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\thumbnails\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Firefox limpo (pode n√£o ser completo, dependendo do perfil/uso)." -ForegroundColor DarkGray

    # Brave (se instalado)
    Write-Host "Tentando limpar cache do Brave Browser (se instalado)..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Brave limpo (se instalado e n√£o estiver rodando)." -ForegroundColor DarkGray

    Write-Host "Limpeza de caches de navegador conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Comando 5: Limpar Cache de Miniaturas
    Write-Host "Limpando cache de miniaturas do Windows (aquelas pr√©-visualiza√ß√µes de imagens e v√≠deos)..." -ForegroundColor Yellow
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Write-Host "Cache de miniaturas limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Limpar Arquivos de Log do Windows
    Write-Host "Limpando arquivos de log do Windows que podem ocupar espa√ßo..." -ForegroundColor Yellow
    wevtutil cl Application
    wevtutil cl System
    wevtutil cl Security
    Write-Host "Logs do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 7: Limpar Arquivos Tempor√°rios de Instala√ß√£o
    Write-Host "Limpando arquivos tempor√°rios de instala√ß√£o de programas..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Installer\$*\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios de instala√ß√£o limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 8: Limpar Arquivos de Atualiza√ß√£o do Windows
    Write-Host "Limpando arquivos de atualiza√ß√£o do Windows que podem ocupar bastante espa√ßo..." -ForegroundColor Yellow
    Stop-Service -Name wuauserv -ErrorAction SilentlyContinue
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    Write-Host "Arquivos de atualiza√ß√£o do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 9: Limpar Arquivos Prefetch
    Write-Host "Limpando arquivos prefetch para melhorar a inicializa√ß√£o..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Prefetch\*.pf" -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos prefetch limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 10: Executar Limpeza de Disco Integrada do Windows
    Write-Host "Executando a ferramenta de limpeza de disco integrada do Windows..." -ForegroundColor Yellow
    Start-Process -FilePath cleanmgr.exe -ArgumentList "/sagerun:1" -Wait -ErrorAction SilentlyContinue
    Write-Host "Limpeza de disco conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "Vamos ver quanto espa√ßo conseguimos recuperar com essa faxina:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nPronto! A faxina geral b√°sica foi feita! Seu PC agradece o espa√ßo extra! ;)" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu
    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleMemoryStartup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Mem√≥ria e Inicializa√ß√£o R√°pida: Deixa o PC ligando num piscar! ---" -ForegroundColor Yellow
    Write-Host "Aqui a gente d√° uma olhada na mem√≥ria RAM e nos programas que ligam junto com o Windows. Menos coisa ligando √† toa = PC mais r√°pido pra usar na hora!" -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Listar Programas de Inicializa√ß√£o
    Write-Host "Listando programas que iniciam com o Windows (pra voc√™ saber o que t√° rodando por baixo dos panos):" -ForegroundColor Yellow
    Get-CimInstance win32_startupcommand | Select-Object Name, command, Location | Format-Table -AutoSize
    Write-Host "Lista de programas de inicializa√ß√£o exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Servi√ßo SuperFetch/SysMain
    Write-Host "Otimizando o servi√ßo SuperFetch/SysMain para melhorar o desempenho..." -ForegroundColor Yellow
    $confirmSysMain = Read-Host "Deseja desativar o servi√ßo SysMain/SuperFetch? (s/n) - Recomendado para SSDs"
    if ($confirmSysMain -eq 's') {
        Set-Service -Name SysMain -StartupType Disabled -ErrorAction SilentlyContinue
        Stop-Service -Name SysMain -Force -ErrorAction SilentlyContinue
        Write-Host "Servi√ßo SysMain/SuperFetch desativado!" -ForegroundColor Green
    } else {
        Write-Host "Servi√ßo SysMain/SuperFetch mantido ativo." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios de Updates
    Write-Host "Limpando arquivos tempor√°rios de atualiza√ß√µes do Windows (podem ocupar bastante espa√ßo e afetar performance):" -ForegroundColor Yellow
    Dism /online /Cleanup-Image /StartComponentCleanup /ErrorAction SilentlyContinue
    Write-Host "Limpeza de componentes de atualiza√ß√£o iniciada (pode levar um tempo)." -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Mem√≥ria Virtual
    Write-Host "Otimizando configura√ß√µes de mem√≥ria virtual para melhor desempenho..." -ForegroundColor Yellow
    $totalRam = (Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property capacity -Sum).Sum / 1GB
    Write-Host "Seu sistema tem aproximadamente $totalRam GB de RAM." -ForegroundColor White
    
    $confirmPageFile = Read-Host "Deseja otimizar o arquivo de pagina√ß√£o (mem√≥ria virtual)? (s/n)"
    if ($confirmPageFile -eq 's') {
        # Calcula tamanho recomendado (1.5x a RAM para sistemas com menos de 8GB, 1x para sistemas com mais)
        $pageFileSize = if ($totalRam -lt 8) { [math]::Round($totalRam * 1.5) * 1024 } else { [math]::Round($totalRam) * 1024 }
        
        Write-Host "Configurando arquivo de pagina√ß√£o para tamanho fixo de $pageFileSize MB..." -ForegroundColor DarkGray
        $computerSystem = Get-WmiObject -Class Win32_ComputerSystem
        $computerSystem.AutomaticManagedPagefile = $false
        $computerSystem.Put() | Out-Null
        
        $pageFileSetting = Get-WmiObject -Class Win32_PageFileSetting
        if ($pageFileSetting) {
            $pageFileSetting.InitialSize = $pageFileSize
            $pageFileSetting.MaximumSize = $pageFileSize
            $pageFileSetting.Put() | Out-Null
        }
        Write-Host "Arquivo de pagina√ß√£o otimizado! (Requer reinicializa√ß√£o para aplicar totalmente)" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes de mem√≥ria virtual mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Listar os 10 Processos que mais usam mem√≥ria no momento
    Write-Host "Listando os 10 processos que mais consomem mem√≥ria agora:" -ForegroundColor Yellow
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host "Lista de processos exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Otimizar Inicializa√ß√£o do Windows
    Write-Host "Otimizando a inicializa√ß√£o do Windows..." -ForegroundColor Yellow
    # Desabilitar servi√ßos n√£o essenciais que podem atrasar a inicializa√ß√£o
    $startupServices = @(
        @{Name="DiagTrack"; DisplayName="Experi√™ncias do Usu√°rio Conectado e Telemetria"},
        @{Name="dmwappushservice"; DisplayName="Servi√ßo de Transfer√™ncia Inteligente em Segundo Plano (BITS)"},
        @{Name="MapsBroker"; DisplayName="Servi√ßo de Dados de Mapas"}
    )
    
    foreach ($service in $startupServices) {
        $confirmService = Read-Host "Deseja desativar o servi√ßo '$($service.DisplayName)' na inicializa√ß√£o? (s/n)"
        if ($confirmService -eq 's') {
            Set-Service -Name $service.Name -StartupType Disabled -ErrorAction SilentlyContinue
            Stop-Service -Name $service.Name -Force -ErrorAction SilentlyContinue
            Write-Host "Servi√ßo '$($service.DisplayName)' desativado!" -ForegroundColor Green
        } else {
            Write-Host "Servi√ßo '$($service.DisplayName)' mantido." -ForegroundColor Green
        }
    }
    Write-Host ""

    # Comando 7: Reiniciar o Computador (√ötil pra liberar mem√≥ria e aplicar mudan√ßas)
    Write-Host "Quer dar um 'refresh' geral no PC? Reiniciar pode ajudar!" -ForegroundColor Yellow
    $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (digite 'sim' para confirmar)"
    if ($confirmRestart -eq 'sim') {
        Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
        Restart-Computer -Force
    } else {
        Write-Host "Rein√≠cio cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o de mem√≥ria e inicializa√ß√£o!" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu (a n√£o ser que o PC tenha reiniciado)
    if ($confirmRestart -ne 'sim') {
        Write-Host ""
        Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
    }
}

function Invoke-SimpleInternetOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Acelerar a Conex√£o com a Internet (Simplificado): Diz adeus pro 'carregando...'! ---" -ForegroundColor Cyan
    Write-Host "Vamos fazer uns ajustes r√°pidos na sua conex√£o pra tentar deixar ela mais esperta." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Limpar Cache de DNS
    Write-Host "Limpando o cache de endere√ßos de internet (DNS) pra resolver nomes mais r√°pido!" -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Configura√ß√µes TCP/IP
    Write-Host "Otimizando configura√ß√µes TCP/IP para melhorar a velocidade de conex√£o..." -ForegroundColor Yellow
    
    # Habilitar TCP Window Auto-Tuning
    netsh int tcp set global autotuninglevel=normal
    Write-Host "TCP Auto-Tuning configurado para 'normal'." -ForegroundColor DarkGray
    
    # Otimizar par√¢metros de recebimento de pacotes
    netsh int tcp set global rss=enabled
    Write-Host "Receive-Side Scaling (RSS) habilitado." -ForegroundColor DarkGray
    
    # Otimizar congestion provider
    netsh int tcp set global congestionprovider=ctcp
    Write-Host "Congestion Provider configurado para 'ctcp'." -ForegroundColor DarkGray
    
    # Otimizar ECN capability
    netsh int tcp set global ecncapability=enabled
    Write-Host "ECN Capability habilitado." -ForegroundColor DarkGray
    
    Write-Host "Configura√ß√µes TCP/IP otimizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Reiniciar Adaptadores de Rede
    Write-Host "Dando um 'reset' r√°pido nas suas conex√µes de rede. Pode resolver uns pepinos!" -ForegroundColor Yellow
    $confirmResetAdapter = Read-Host "Isso vai desconectar brevemente sua internet. Continuar? (s/n)"
    if ($confirmResetAdapter -eq 's') {
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        Write-Host "Adaptadores de rede reiniciados." -ForegroundColor Green
    } else {
        Write-Host "Reset de adaptadores cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 4: Configurar DNS R√°pido
    Write-Host "Configurar DNS mais r√°pido pode melhorar sua navega√ß√£o!" -ForegroundColor Yellow
    $confirmDns = Read-Host "Deseja configurar DNS mais r√°pidos (Google ou Cloudflare)? (s/n)"
    if ($confirmDns -eq 's') {
        Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
        Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
        $dnsChoice = Read-Host "Escolha uma op√ß√£o (1 ou 2)"
        
        $primaryDns = ""
        $secondaryDns = ""
        
        if ($dnsChoice -eq '1') {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            Write-Host "Google DNS selecionado." -ForegroundColor DarkGray
        } elseif ($dnsChoice -eq '2') {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            Write-Host "Cloudflare DNS selecionado." -ForegroundColor DarkGray
        } else {
            Write-Host "Op√ß√£o inv√°lida. DNS n√£o alterado." -ForegroundColor Red
        }
        
        if ($primaryDns -ne "") {
            $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" -and ($_.InterfaceDescription -match "Ethernet" -or $_.InterfaceDescription -match "Wi-Fi" -or $_.InterfaceDescription -match "Wireless") }
            
            foreach ($adapter in $networkAdapters) {
                Write-Host "Configurando DNS para adaptador: $($adapter.Name)" -ForegroundColor DarkGray
                Set-DnsClientServerAddress -InterfaceIndex $adapter.ifIndex -ServerAddresses ($primaryDns, $secondaryDns)
            }
            
            Write-Host "DNS configurado! Sua navega√ß√£o deve ficar mais r√°pida agora." -ForegroundColor Green
        }
    } else {
        Write-Host "Configura√ß√£o de DNS mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Mostrar Status B√°sico da Conex√£o
    Write-Host "Mostrando um resumo b√°sico da sua configura√ß√£o de rede atual:" -ForegroundColor Yellow
    ipconfig /all | Select-String -Pattern "IPv4", "DNS", "Gateway", "DHCP", "Subnet", "Physical Address"
    Write-Host "Status b√°sico da rede exibido." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Testar a conex√£o com a internet
    Write-Host "Testando a conex√£o com a internet (ping para google.com)..." -ForegroundColor Yellow
    Test-Connection -Count 4 google.com -ErrorAction SilentlyContinue
    Write-Host "Teste de conex√£o finalizado." -ForegroundColor Green
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o b√°sica de internet!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleVisualOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Deixar o Windows mais Leve Visualmente (Simplificado): Desempenho antes da beleza! ---" -ForegroundColor White
    Write-Host "Ajustes r√°pidos pra desativar efeitos visuais que podem pesar, liberando recursos pro que importa." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ajustar Efeitos Visuais
    Write-Host "Voc√™ quer desativar ou ativar as anima√ß√µes e efeitos visuais do Windows?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Efeitos Visuais (Pra ganhar desempenho)" -ForegroundColor Green
    Write-Host "[2] Configurar para Melhor Apar√™ncia (Mais bonito, mas mais pesado)" -ForegroundColor White
    Write-Host "[3] Deixar o Windows Escolher (Configura√ß√£o padr√£o)" -ForegroundColor Cyan
    $choiceVisual = Read-Host "Escolha [1], [2] ou [3]"

    if ($choiceVisual -eq '1') {
        Write-Host "Desativando efeitos visuais para melhor desempenho..." -ForegroundColor Yellow
        # Valor 2 = Ajustar para melhor desempenho (desativa a maioria dos efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 2 -Type DWord -Force -ErrorAction SilentlyContinue
        
        # Desativar anima√ß√µes individuais
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop' -Name 'UserPreferencesMask' -Value ([byte[]](0x90, 0x12, 0x01, 0x80)) -Type Binary -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop\WindowMetrics' -Name 'MinAnimate' -Value 0 -Type String -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'ListviewAlphaSelect' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'TaskbarAnimations' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        
        Write-Host "Efeitos visuais desativados para melhor desempenho!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '2') {
        Write-Host "Configurando para melhor apar√™ncia (todos os efeitos visuais ativados)..." -ForegroundColor Yellow
        # Valor 1 = Ajustar para melhor apar√™ncia (ativa todos os efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Efeitos visuais configurados para melhor apar√™ncia!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '3') {
        Write-Host "Deixando o Windows escolher automaticamente (configura√ß√£o padr√£o)..." -ForegroundColor Yellow
        # Valor 0 = Deixar o Windows escolher
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Configura√ß√£o visual definida para padr√£o do Windows!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa nos efeitos visuais foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 2: Ativar/Desativar Efeitos de Transpar√™ncia
    Write-Host "E os efeitos de transpar√™ncia do Windows (tipo na barra de tarefas)?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Transpar√™ncia (Mais leve)" -ForegroundColor Green
    Write-Host "[2] Ativar Transpar√™ncia (Mais 'bonito')" -ForegroundColor White
    $choiceTransp = Read-Host "Escolha [1] ou [2]"

    if ($choiceTransp -eq '1') {
        Write-Host "Desativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 0 = Desativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia desativada!" -ForegroundColor Green
    } elseif ($choiceTransp -eq '2') {
        Write-Host "Ativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 1 = Ativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia ativada!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa na transpar√™ncia foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 3: Configurar Tema Claro/Escuro
    Write-Host "Voc√™ prefere tema claro ou escuro? O tema escuro pode ser mais confort√°vel para os olhos." -ForegroundColor Yellow
    Write-Host "[1] Tema Escuro (Dark Mode)" -ForegroundColor DarkGray
    Write-Host "[2] Tema Claro (Light Mode)" -ForegroundColor White
    $choiceTheme = Read-Host "Escolha [1] ou [2]"

    if ($choiceTheme -eq '1') {
        Write-Host "Configurando tema escuro..." -ForegroundColor Yellow
        # Valor 0 = Tema Escuro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema escuro configurado!" -ForegroundColor Green
    } elseif ($choiceTheme -eq '2') {
        Write-Host "Configurando tema claro..." -ForegroundColor Yellow
        # Valor 1 = Tema Claro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema claro configurado!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa no tema foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Configurar Resolu√ß√£o de Tela
    Write-Host "Deseja ajustar a resolu√ß√£o da tela? Resolu√ß√µes menores podem melhorar o desempenho em PCs mais antigos." -ForegroundColor Yellow
    $confirmResolution = Read-Host "Deseja ver e ajustar a resolu√ß√£o da tela? (s/n)"
    
    if ($confirmResolution -eq 's') {
        # Mostrar resolu√ß√£o atual
        $currentResolution = Get-WmiObject -Class Win32_VideoController | Select-Object -ExpandProperty VideoModeDescription
        Write-Host "Resolu√ß√£o atual: $currentResolution" -ForegroundColor White
        
        # Abrir configura√ß√µes de exibi√ß√£o do Windows
        Write-Host "Abrindo configura√ß√µes de exibi√ß√£o do Windows..." -ForegroundColor DarkGray
        Start-Process "ms-settings:display"
        Write-Host "Ajuste a resolu√ß√£o conforme necess√°rio na janela de configura√ß√µes que foi aberta." -ForegroundColor Green
        
        $waitForSettings = Read-Host "Pressione Enter quando terminar de ajustar as configura√ß√µes de exibi√ß√£o"
    } else {
        Write-Host "Configura√ß√£o de resolu√ß√£o mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizados os ajustes visuais b√°sicos!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleGamingOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Jogos (Simplificado): Mais FPS, menos lag! ---" -ForegroundColor Magenta
    Write-Host "Vamos fazer alguns ajustes para melhorar o desempenho dos seus jogos sem complica√ß√µes." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ativar Modo de Jogo do Windows
    Write-Host "Ativando o Modo de Jogo do Windows para priorizar recursos para jogos..." -ForegroundColor Yellow
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AllowAutoGameMode" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AutoGameModeEnabled" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Write-Host "Modo de Jogo do Windows ativado!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Desativar Game DVR e Game Bar
    Write-Host "O Game DVR e Game Bar podem reduzir o desempenho em jogos. Deseja desativ√°-los?" -ForegroundColor Yellow
    $confirmGameDVR = Read-Host "Desativar Game DVR e Game Bar? (s/n)"
    
    if ($confirmGameDVR -eq 's') {
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "UseNexusForGameBarEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\System\GameConfigStore" -Name "GameDVR_Enabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR" -Name "AppCaptureEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Write-Host "Game DVR e Game Bar desativados!" -ForegroundColor Green
    } else {
        Write-Host "Game DVR e Game Bar mantidos ativos." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Otimizar Plano de Energia para Jogos
    Write-Host "Configurando plano de energia para alto desempenho (ideal para jogos)..." -ForegroundColor Yellow
    powercfg.exe /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c
    Write-Host "Plano de energia configurado para alto desempenho!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Configura√ß√µes de Mouse
    Write-Host "Otimizando configura√ß√µes de mouse para jogos (precis√£o do ponteiro)..." -ForegroundColor Yellow
    $confirmMouseFix = Read-Host "Desativar a acelera√ß√£o do mouse para melhor precis√£o em jogos? (s/n)"
    
    if ($confirmMouseFix -eq 's') {
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseSpeed" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold1" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold2" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Write-Host "Acelera√ß√£o do mouse desativada para melhor precis√£o em jogos!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do mouse mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Otimizar Prioridade de CPU para Jogos
    Write-Host "Configurando prioridade de CPU para jogos..." -ForegroundColor Yellow
    Write-Host "Esta configura√ß√£o ajusta o sistema para dar mais prioridade aos jogos." -ForegroundColor DarkGray
    
    # Criar chave de registro para prioridade de jogos
    if (-not (Test-Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games")) {
        New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Force | Out-Null
    }
    
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "GPU Priority" -Type DWord -Value 8 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Priority" -Type DWord -Value 6 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Scheduling Category" -Type String -Value "High" -Force -ErrorAction SilentlyContinue
    
    Write-Host "Prioridade de CPU para jogos otimizada!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Verificar Driver de Placa de V√≠deo
    Write-Host "Verificando informa√ß√µes da placa de v√≠deo..." -ForegroundColor Yellow
    $gpuInfo = Get-WmiObject -Class Win32_VideoController | Select-Object Name, DriverVersion, CurrentHorizontalResolution, CurrentVerticalResolution
    
    foreach ($gpu in $gpuInfo) {
        Write-Host "Placa de v√≠deo: $($gpu.Name)" -ForegroundColor White
        Write-Host "Vers√£o do driver: $($gpu.DriverVersion)" -ForegroundColor White
        Write-Host "Resolu√ß√£o atual: $($gpu.CurrentHorizontalResolution) x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
      x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
    
    Write-Host "Recomenda√ß√£o: Mantenha seus drivers de v√≠deo atualizados para melhor desempenho em jogos!" -ForegroundColor Green
    Write-Host "Voc√™ pode baixar os drivers mais recentes nos sites oficiais da NVIDIA, AMD ou Intel." -ForegroundColor DarkGray
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nOtimiza√ß√µes para jogos conclu√≠das! Seus jogos devem rodar mais suaves agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleSecurityMaintenance {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Manuten√ß√£o de Seguran√ßa (Simplificado): Mantenha seu PC protegido! ---" -ForegroundColor DarkYellow
    Write-Host "Vamos verificar e melhorar a seguran√ßa do seu sistema com alguns ajustes simples." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Verificar Status do Windows Defender
    Write-Host "Verificando status do Windows Defender..." -ForegroundColor Yellow
    $defenderStatus = Get-MpComputerStatus
    
    Write-Host "Status do Windows Defender:" -ForegroundColor White
    Write-Host "Antiv√≠rus habilitado: $($defenderStatus.AntivirusEnabled)" -ForegroundColor $(if ($defenderStatus.AntivirusEnabled) { "Green" } else { "Red" })
    Write-Host "Prote√ß√£o em tempo real: $($defenderStatus.RealTimeProtectionEnabled)" -ForegroundColor $(if ($defenderStatus.RealTimeProtectionEnabled) { "Green" } else { "Red" })
    Write-Host "Defini√ß√µes de antiv√≠rus: $($defenderStatus.AntivirusSignatureVersion)" -ForegroundColor White
    Write-Host "√öltima atualiza√ß√£o: $($defenderStatus.AntivirusSignatureLastUpdated)" -ForegroundColor White
    Write-Host ""

    # Comando 2: Atualizar Defini√ß√µes do Windows Defender
    Write-Host "Atualizando defini√ß√µes do Windows Defender..." -ForegroundColor Yellow
    Update-MpSignature -ErrorAction SilentlyContinue
    Write-Host "Defini√ß√µes do Windows Defender atualizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Verificar Atualiza√ß√µes do Windows
    Write-Host "Verificando status das atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
            Write-Host "Recomenda√ß√£o: Execute o Windows Update para manter seu sistema seguro." -ForegroundColor Green
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Verificar Configura√ß√µes de Firewall
    Write-Host "Verificando status do Firewall do Windows..." -ForegroundColor Yellow
    $firewallStatus = Get-NetFirewallProfile
    
    foreach ($profile in $firewallStatus) {
        Write-Host "Perfil: $($profile.Name)" -ForegroundColor White
        Write-Host "Status: $($profile.Enabled)" -ForegroundColor $(if ($profile.Enabled) { "Green" } else { "Red" })
        Write-Host ""
    }
    
    $confirmFirewall = Read-Host "Deseja habilitar o Firewall em todos os perfis? (s/n)"
    if ($confirmFirewall -eq 's') {
        Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True
        Write-Host "Firewall habilitado em todos os perfis!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do Firewall mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Verificar Configura√ß√µes de UAC
    Write-Host "Verificando configura√ß√µes do Controle de Conta de Usu√°rio (UAC)..." -ForegroundColor Yellow
    $uacLevel = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -ErrorAction SilentlyContinue
    
    if ($uacLevel) {
        switch ($uacLevel.ConsentPromptBehaviorAdmin) {
            0 { $uacStatus = "Desativado (N√£o recomendado)" }
            1 { $uacStatus = "Baixo (N√£o recomendado)" }
            2 { $uacStatus = "M√©dio" }
            5 { $uacStatus = "Alto (Recomendado)" }
            default { $uacStatus = "Personalizado" }
        }
        
        Write-Host "N√≠vel atual do UAC: $uacStatus" -ForegroundColor $(if ($uacLevel.ConsentPromptBehaviorAdmin -ge 2) { "Green" } else { "Red" })
        
        $confirmUAC = Read-Host "Deseja configurar o UAC para o n√≠vel recomendado? (s/n)"
        if ($confirmUAC -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -Value 5 -Type DWord -Force -ErrorAction SilentlyContinue
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "PromptOnSecureDesktop" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
            Write-Host "UAC configurado para o n√≠vel recomendado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do UAC mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do UAC." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 6: Verificar Configura√ß√µes de SmartScreen
    Write-Host "Verificando configura√ß√µes do Windows SmartScreen..." -ForegroundColor Yellow
    $smartScreen = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -ErrorAction SilentlyContinue
    
    if ($smartScreen) {
        Write-Host "Status do SmartScreen: $($smartScreen.SmartScreenEnabled)" -ForegroundColor $(if ($smartScreen.SmartScreenEnabled -eq "RequireAdmin" -or $smartScreen.SmartScreenEnabled -eq "Warn") { "Green" } else { "Red" })
        
        $confirmSmartScreen = Read-Host "Deseja habilitar o SmartScreen para maior seguran√ßa? (s/n)"
        if ($confirmSmartScreen -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -Value "RequireAdmin" -Type String -Force -ErrorAction SilentlyContinue
            Write-Host "SmartScreen habilitado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do SmartScreen mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do SmartScreen." -ForegroundColor Red
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nManuten√ß√£o de seguran√ßa conclu√≠da! Seu sistema est√° mais protegido agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

# --- Fun√ß√µes para o Diagn√≥stico R√°pido e Sobre ---
function Invoke-QuickDiagnostic {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Diagn√≥stico R√°pido do Sistema ---" -ForegroundColor Yellow
    Write-Host "Vamos fazer uma verifica√ß√£o r√°pida do estado atual do seu PC." -ForegroundColor Gray
    Write-Host ""

    # Informa√ß√µes do Sistema
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    $sysInfo = Get-SystemInfo
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host ""

    # Uso de CPU
    Write-Host "=== Uso de CPU ===" -ForegroundColor Cyan
    $cpuLoad = (Get-WmiObject Win32_Processor).LoadPercentage
    Write-Host "Uso atual de CPU: $cpuLoad%" -ForegroundColor $(if ($cpuLoad -lt 70) { "Green" } elseif ($cpuLoad -lt 90) { "Yellow" } else { "Red" })
    Write-Host ""

    # Uso de Mem√≥ria
    Write-Host "=== Uso de Mem√≥ria ===" -ForegroundColor Cyan
    $os = Get-WmiObject Win32_OperatingSystem
    $totalMemory = [math]::Round($os.TotalVisibleMemorySize / 1MB, 2)
    $freeMemory = [math]::Round($os.FreePhysicalMemory / 1MB, 2)
    $usedMemory = [math]::Round($totalMemory - $freeMemory, 2)
    $memoryPercentage = [math]::Round(($usedMemory / $totalMemory) * 100, 2)
    
    Write-Host "Mem√≥ria Total: $totalMemory GB" -ForegroundColor White
    Write-Host "Mem√≥ria Usada: $usedMemory GB ($memoryPercentage%)" -ForegroundColor $(if ($memoryPercentage -lt 70) { "Green" } elseif ($memoryPercentage -lt 90) { "Yellow" } else { "Red" })
    Write-Host "Mem√≥ria Livre: $freeMemory GB" -ForegroundColor White
    Write-Host ""

    # Espa√ßo em Disco
    Write-Host "=== Espa√ßo em Disco ===" -ForegroundColor Cyan
    $drives = Get-PSDrive -PSProvider FileSystem
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        $percentFree = [math]::Round(($freeSpace / $totalSpace) * 100, 2)
        
        Write-Host "Drive $($drive.Name):" -ForegroundColor White
        Write-Host "  Total: $totalSpace GB" -ForegroundColor White
        Write-Host "  Usado: $usedSpace GB" -ForegroundColor White
        Write-Host "  Livre: $freeSpace GB ($percentFree%)" -ForegroundColor $(if ($percentFree -gt 20) { "Green" } elseif ($percentFree -gt 10) { "Yellow" } else { "Red" })
    }
    Write-Host ""

    # Processos que mais consomem recursos
    Write-Host "=== Top 5 Processos (CPU) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object CPU -Descending | Select-Object -First 5 ProcessName, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}}, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host ""

    Write-Host "=== Top 5 Processos (Mem√≥ria) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 5 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}}, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}} | Format-Table -AutoSize
    Write-Host ""

    # Status de Servi√ßos Cr√≠ticos
    Write-Host "=== Status de Servi√ßos Cr√≠ticos ===" -ForegroundColor Cyan
    $criticalServices = @("wuauserv", "WinDefend", "MpsSvc", "wscsvc")
    foreach ($service in $criticalServices) {
        $serviceStatus = Get-Service -Name $service -ErrorAction SilentlyContinue
        if ($serviceStatus) {
            Write-Host "$($serviceStatus.DisplayName): $($serviceStatus.Status)" -ForegroundColor $(if ($serviceStatus.Status -eq "Running") { "Green" } else { "Red" })
        }
    }
    Write-Host ""

    # Verificar Atualiza√ß√µes Pendentes
    Write-Host "=== Atualiza√ß√µes do Windows ===" -ForegroundColor Cyan
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Recomenda√ß√µes
    Write-Host "=== Recomenda√ß√µes ===" -ForegroundColor Cyan
    
    # Recomenda√ß√£o de Mem√≥ria
    if ($memoryPercentage -gt 80) {
        Write-Host "- Seu uso de mem√≥ria est√° alto. Considere fechar alguns programas ou usar a op√ß√£o 'Otimiza√ß√£o de Mem√≥ria'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Disco
    $lowDiskSpace = $false
    foreach ($drive in $drives) {
        $percentFree = [math]::Round(($drive.Free / ($drive.Free + $drive.Used)) * 100, 2)
        if ($percentFree -lt 15) {
            $lowDiskSpace = $true
            break
        }
    }
    
    if ($lowDiskSpace) {
        Write-Host "- Espa√ßo em disco baixo detectado. Considere usar a op√ß√£o 'Limpeza Geral do Sistema'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Atualiza√ß√µes
    if ($pendingUpdates -gt 0) {
        Write-Host "- Existem atualiza√ß√µes pendentes. Recomendamos atualizar seu sistema para maior seguran√ßa." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Inicializa√ß√£o
    $bootTime = $sysInfo.LastBootTime
    $uptime = (Get-Date) - $bootTime
    if ($uptime.Days -gt 7) {
        Write-Host "- Seu sistema est√° ligado h√° $($uptime.Days) dias. Considere reiniciar para aplicar atualiza√ß√µes e limpar a mem√≥ria." -ForegroundColor Yellow
    }
    
    Write-Host ""

    # Mensagem de conclus√£o
    Write-Host "`nDiagn√≥stico r√°pido conclu√≠do! Use as informa√ß√µes acima para decidir quais otimiza√ß√µes fazer." -ForegroundColor Green

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

function Show-AboutTORK {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Sobre o TORK ---" -ForegroundColor White
    Write-Host ""
    
    Write-Host "TORK - Otimizador para Windows" -ForegroundColor Cyan
    Write-Host "Vers√£o: 2.0" -ForegroundColor White
    Write-Host "Desenvolvido por: Partner77" -ForegroundColor White
    Write-Host ""
    
    Write-Host "=== Descri√ß√£o ===" -ForegroundColor Yellow
    Write-Host "O TORK √© uma ferramenta abrangente de otimiza√ß√£o para Windows, projetada para" -ForegroundColor Gray
    Write-Host "melhorar o desempenho do seu sistema atrav√©s de limpeza, ajustes e otimiza√ß√µes." -ForegroundColor Gray
    Write-Host "Ele oferece op√ß√µes simplificadas para usu√°rios comuns e op√ß√µes avan√ßadas para" -ForegroundColor Gray
    Write-Host "usu√°rios experientes que desejam um controle mais detalhado sobre o sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Recursos ===" -ForegroundColor Yellow
    Write-Host "- Limpeza completa do sistema" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√£o de mem√≥ria e inicializa√ß√£o" -ForegroundColor Gray
    Write-Host "- Ajustes de rede para melhor conectividade" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√µes visuais para melhor desempenho" -ForegroundColor Gray
    Write-Host "- Configura√ß√µes espec√≠ficas para jogos" -ForegroundColor Gray
    Write-Host "- Manuten√ß√£o de seguran√ßa" -ForegroundColor Gray
    Write-Host "- Diagn√≥stico r√°pido do sistema" -ForegroundColor Gray
    Write-Host "- Mais de 100 ajustes e otimiza√ß√µes avan√ßadas" -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Aviso Legal ===" -ForegroundColor Yellow
    Write-Host "Este software √© fornecido 'como est√°', sem garantias de qualquer tipo." -ForegroundColor Gray
    Write-Host "O autor n√£o se responsabiliza por quaisquer danos ou problemas causados pelo uso" -ForegroundColor Gray
    Write-Host "deste software. Use por sua conta e risco. Recomendamos sempre fazer backup" -ForegroundColor Gray
    Write-Host "dos seus dados importantes antes de realizar otimiza√ß√µes no sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Agradecimentos ===" -ForegroundColor Yellow
    Write-Host "Obrigado por escolher o TORK para otimizar seu sistema Windows!" -ForegroundColor Gray
    Write-Host "Esperamos que esta ferramenta ajude a melhorar o desempenho do seu PC." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "¬© 2023-2024 Partner77 - Todos os direitos reservados" -ForegroundColor Cyan
    Write-Host ""
    
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - LIMPEZA (Expandidas) ---
function Invoke-CleanUserTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Usu√°rio ---" -ForegroundColor Cyan
    Write-Host "Remove arquivos da pasta tempor√°ria do seu usu√°rio (`$env:TEMP`)." -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:TEMP..." -ForegroundColor Yellow
    $tempFiles = Get-ChildItem -Path $env:TEMP -Recurse -ErrorAction SilentlyContinue
    $tempFilesCount = ($tempFiles | Measure-Object).Count
    $tempFilesSize = ($tempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $tempFilesCount arquivos tempor√°rios ocupando aproximadamente $([math]::Round($tempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Sistema ---" -ForegroundColor Gray
    Write-Host "Remove arquivos da pasta tempor√°ria do Windows (`$env:SystemRoot\Temp`)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:SystemRoot\Temp..." -ForegroundColor Yellow
    $systemTempFiles = Get-ChildItem -Path "$env:SystemRoot\Temp" -Recurse -ErrorAction SilentlyContinue
    $systemTempFilesCount = ($systemTempFiles | Measure-Object).Count
    $systemTempFilesSize = ($systemTempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $systemTempFilesCount arquivos tempor√°rios do sistema ocupando aproximadamente $([math]::Round($systemTempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do sistema removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanDnsCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-EmptyRecycleBin {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Esvaziar Lixeira ---" -ForegroundColor Gray
    Write-Host "Esvazia a lixeira do usu√°rio logado." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar tamanho da lixeira antes de esvaziar
    Write-Host "Verificando tamanho da lixeira..." -ForegroundColor Yellow
    
    try {
        $shell = New-Object -ComObject Shell.Application
        $recycleBin = $shell.Namespace(0xA)
        $recycleBinItems = $recycleBin.Items()
        $recycleBinItemCount = $recycleBinItems.Count
        
        Write-Host "A lixeira cont√©m $recycleBinItemCount itens." -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o conte√∫do da lixeira." -ForegroundColor DarkGray
    }
    
    # Esvaziar a lixeira
    Write-Host "Executando: Esvaziando a lixeira..." -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanThumbnailCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Miniaturas ---" -ForegroundColor Green
    Write-Host "Remove o cache de miniaturas de arquivos (imagens, v√≠deos, etc.)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Limpando cache de miniaturas..." -ForegroundColor Yellow
    
    # Verificar tamanho do cache de miniaturas antes da limpeza
    $thumbnailPath = "$env:LOCALAPPDATA\Microsoft\Windows\Explorer"
    $thumbnailFiles = Get-ChildItem -Path $thumbnailPath -Filter "thumbcache_*.db" -ErrorAction SilentlyContinue
    $thumbnailFilesCount = ($thumbnailFiles | Measure-Object).Count
    $thumbnailFilesSize = ($thumbnailFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $thumbnailFilesCount arquivos de cache de miniaturas ocupando aproximadamente $([math]::Round($thumbnailFilesSize, 2)) MB." -ForegroundColor White
    
    # Limpar o cache de miniaturas
    Stop-Process -Name explorer -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Start-Process explorer
    
    Write-Host "Cache de miniaturas limpo com sucesso!" -ForegroundColor Green
    Write-Host "O Windows Explorer foi reiniciado para aplicar as altera√ß√µes." -ForegroundColor DarkGray
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de miniaturas:" -ForegroundColor Cyan
    Write-Host "- Navega√ß√£o mais r√°pida em pastas com muitas imagens ou v√≠deos" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de miniaturas corrompidas ou desatualizadas" -ForegroundColor DarkGray
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemLogs {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Logs do Sistema ---" -ForegroundColor Cyan
    Write-Host "Limpa os logs de eventos do sistema para liberar espa√ßo e melhorar o desempenho." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando logs do sistema..." -ForegroundColor Yellow
    
    # Verificar tamanho dos logs antes da limpeza
    $eventLogs = Get-WinEvent -ListLog * -ErrorAction SilentlyContinue | Where-Object { $_.RecordCount -gt 0 }
    $totalLogCount = ($eventLogs | Measure-Object).Count
    $total### Enhanced TORK Optimizer

I'll enhance the TORK optimizer with more comprehensive functionality across all features, starting with an expanded Simple Cleanup function and then improving all other options.

```powershell type="code"
# Define a preferencia de acao para erros (continua a execucao por padrao)
# Permite que o script tente rodar o m√°ximo poss√≠vel mesmo que alguns comandos encontrem problemas.
$ErrorActionPreference = 'SilentlyContinue' # N√£o exibe erros se um item n√£o puder ser processado, por exemplo.

# --- Funcao pra Centralizar Texto (Nosso Maestro de Alinhamento - s√≥ pra textos, n√£o pro bannerz√£o!) ---
# Deixa ela aqui, vai que a gente usa pra centralizar outra coisa, n√©?
function Centraliza($texto, $cor="White") {
    $largura = [console]::WindowWidth # Pega a largura da largura da janela agora
    # Calcula o espa√ßo pra botar o texto no meio. Pura matem√°tica da zoeira!
    $espacos = [Math]::Max(0, [Math]::Floor(($largura - $texto.Length) / 2))
    $linha = (" " * $espacos) + $texto # Cria a linha com os espa√ßos e o texto
    Write-Host $linha -ForegroundColor $cor # Manda pro console com a cor pedida
}

# --- Funcao que Desenha o Nosso Banner Irado do TORK! ---
# Esse √© o nosso outdoor digital no console! Ajustado pros espa√ßos que voc√™ mandou!
# Se as bordas ainda estiverem meio teimosas, √© o jeitinho do console mesmo, viu? üòâ
function Banner-TORK {
    # Nossas cores vibrantes para o banner!
    $CorBorda = "DarkCyan" # Mantido para a borda, combina com o ciano. Se quiser mudar, √© aqui!
    $CorLogo = "Green" # Cor vibrante
    $CorProjeto = "Cyan" # Cor vibrante
    $CorCopyright = "Gray" # Tom mais suave

    Write-Host "" # D√° um espacinho no topo, pra n√£o grudar
    Write-Host "                    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë          ‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë ‚ñà‚ñà‚ïî‚ïù                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ñà‚ñà‚ïó                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù                                          ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë           Bem-vindo ao TORK - Otimizador para Windows!                                ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë        Projeto de automacao, limpeza, manutencao e tweaks.                            ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë            (C) Partner77 - Todos os direitos reservados                               ‚ïë" -ForegroundColor $CorCopyright
    Write-Host "                    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor $CorBorda
    Write-Host "" # Espa√ßo embaixo
}

# --- Checagem de Permiss√µes de Administrador (O Guarda da Porta!) ---
# V√™ se a gente t√° rodando com poderes de admin, sen√£o n√£o d√° pra mexer no Windows direito.
function Test-Administrator {
    $currentUser = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())
    return $currentUser.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
}

if (-not (Test-Administrator)) {
    Write-Host "OPA! Calma l√°, patr√£o!" -ForegroundColor Red
    Write-Host "Pra usar o TORK e deixar o PC voando, preciso de super poderes de Administrador!" -ForegroundColor Yellow
    Write-Host "Fecha essa janela, clica com o bot√£o direito no arquivo do script e escolhe 'Executar como administrador'. A√≠ sim, tamo junto!" -ForegroundColor Yellow
    Read-Host "D√° um Enter quando terminar de ler, que a gente se v√™ na pr√≥xima..."
    Exit
}

Write-Host "Poderes de Administrador verificados! Bora nessa!" -ForegroundColor Green
Start-Sleep -Seconds 1

# --- Fun√ß√µes Utilit√°rias (Ferramentas que usamos em v√°rios lugares) ---
function Get-SystemInfo {
    $os = Get-CimInstance Win32_OperatingSystem
    $cs = Get-CimInstance Win32_ComputerSystem
    $proc = Get-CimInstance Win32_Processor
    $mem = Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property Capacity -Sum
    
    $info = @{
        "OSName" = $os.Caption
        "OSVersion" = $os.Version
        "OSBuild" = $os.BuildNumber
        "ComputerName" = $cs.Name
        "Manufacturer" = $cs.Manufacturer
        "Model" = $cs.Model
        "Processor" = $proc.Name
        "Memory" = [math]::Round($mem.Sum / 1GB, 2)
        "Architecture" = $os.OSArchitecture
        "InstallDate" = $os.InstallDate
        "LastBootTime" = $os.LastBootUpTime
    }
    
    return $info
}

function Show-SystemSummary {
    $sysInfo = Get-SystemInfo
    
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Computador: $($sysInfo.ComputerName)" -ForegroundColor White
    Write-Host "Fabricante: $($sysInfo.Manufacturer)" -ForegroundColor White
    Write-Host "Modelo: $($sysInfo.Model)" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "Instalado em: $($sysInfo.InstallDate)" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

function Get-DiskSpaceBefore {
    $drives = Get-PSDrive -PSProvider FileSystem
    $driveInfo = @{}
    
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        
        $driveInfo[$drive.Name] = @{
            "Free" = $freeSpace
            "Used" = $usedSpace
            "Total" = $totalSpace
        }
    }
    
    return $driveInfo
}

function Show-DiskSpaceComparison {
    param (
        $before
    )
    
    $after = Get-PSDrive -PSProvider FileSystem
    
    Write-Host "=== Compara√ß√£o de Espa√ßo em Disco ===" -ForegroundColor Cyan
    
    foreach ($drive in $after) {
        if ($before.ContainsKey($drive.Name)) {
            $freeSpaceAfter = [math]::Round($drive.Free / 1GB, 2)
            $freeSpaceBefore = $before[$drive.Name].Free
            $spaceRecovered = [math]::Round($freeSpaceAfter - $freeSpaceBefore, 2)
            
            Write-Host "Drive $($drive.Name):" -ForegroundColor White
            Write-Host "  Espa√ßo livre antes: $freeSpaceBefore GB" -ForegroundColor Gray
            Write-Host "  Espa√ßo livre agora: $freeSpaceAfter GB" -ForegroundColor Gray
            
            if ($spaceRecovered -gt 0) {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Green
            } else {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Yellow
            }
            Write-Host ""
        }
    }
    
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

# --- Fun√ß√µes dos Menus (Principal, Simplificado, Avan√ßado e Sub-menus) ---

# --- Menu Principal (A Bifurca√ß√£o do Destino! Simplificado vs Avan√ßado) ---
# √â aqui que o usu√°rio escolhe se quer ser um mago ou um cara pr√°tico!
function Show-MainMenu {
    do {
        Clear-Host # Limpa a tela pra organizar o menu
        Banner-TORK # Banner no topo, pra gente n√£o esquecer quem somos!
        Show-SystemSummary # Mostra um resumo do sistema

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "       MENU PRINCIPAL" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # As duas grandes estradas da otimiza√ß√£o! Cores variadas (repetindo)!
        Write-Host "[1] Otimiza√ß√£o Simplificada (Pra quem quer praticidade e resultado r√°pido!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o Avan√ßada (Pra quem curte mexer fundo e ter control total!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[3] Diagn√≥stico R√°pido do Sistema (Ver o que t√° rolando no PC)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[4] Sobre o TORK (Informa√ß√µes e cr√©ditos)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[0] Sair (Ah, que pena... Mas a porta t√° aberta!)" -ForegroundColor Red # Vermelho pra Sair - Ok

        Write-Host ""

        # Pergunta pro usu√°rio qual caminho ele escolhe, tipo Mestre Pok√©mon!
        $choice = Read-Host "Escolhe sua op√ß√£o, treinador!"

        # V√™ pra onde a gente vai com base na escolha
        switch ($choice) {
            "1" { Show-SimplifiedMenu } # Se escolheu 1, vai pro Menu Simplificado!
            "2" { Show-AdvancedMenu } # Se escolheu 2, vai pro Menu Avan√ßado!
            "3" { Invoke-QuickDiagnostic } # Nova fun√ß√£o de diagn√≥stico r√°pido
            "4" { Show-AboutTORK } # Nova fun√ß√£o de sobre
            "0" { Write-Host "Fechou! Valeu por usar o TORK! Volte sempre que seu PC pedir um g√°s! ;)" -ForegroundColor Green; Start-Sleep -Seconds 2; break } # Se escolheu 0, vaza (mas volta!)
            default {
                Write-Host "Eita! Op√ß√£o inv√°lida! Confere os n√∫meros e tenta de novo, bora l√°!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1 # D√° um tempinho pro usu√°rio ver a zoeira da mensagem
            }
        }
    } while ($choice -ne '0') # Repete o Menu Principal enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Simplificado (Aqui o TORK faz m√°gica r√°pida e segura!) ---
# Acessado pela op√ß√£o 1 do Menu Principal. Menos op√ß√µes, mais a√ß√£o direta!
function Show-SimplifiedMenu {
    do {
        Clear-Host # Limpa o palco pra esse menu!
        Banner-TORK # Nosso banner no topo, sempre presente!

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "   OTIMIZACAO SIMPLIFICADA" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes SIMPLIFICADAS - cada uma pode fazer um monte de coisa por baixo dos panos! Cores variadas (repetindo as prim√°rias/neon e adicionando outras)!
        Write-Host "[1] Limpeza Geral do Sistema (Tira o lixo que t√° pesando!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o de Mem√≥ria e Programas que Ligam com o Windows (Deixa tudo mais √°gil!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[3] Acelerar a Conex√£o com a Internet (Pra navegar sem gargalo!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[4] Deixar o Windows mais Leve Visualmente (Desativa uns efeitos pra ganhar desempenho!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Otimiza√ß√£o de Jogos (Configura√ß√µes pra melhorar FPS e desempenho)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[6] Manuten√ß√£o de Seguran√ßa (Verificar e corrigir problemas de seguran√ßa)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[7] RODAR TODAS as otimiza√ß√µes SIMPLIFICADAS! (Modo Turbo F√°cil!)" -ForegroundColor Red # Vermelho pra "Faz Tudo" - Destaque/Cuidado
        Write-Host "[0] Voltar ao Menu Principal (A gente te espera aqui!)" -ForegroundColor Gray # Cor neutra pra voltar

        Write-Host ""

        # Pergunta qual m√°gica simplificada o usu√°rio quer
        $choice = Read-Host "Escolhe sua m√°gica simplificada!"

        # V√™ qual m√°gica rodar
        switch ($choice) {
            "1" { Invoke-SimpleSystemCleanup } # Chama a fun√ß√£o de limpeza b√°sica
            "2" { Invoke-SimpleMemoryStartup } # Chama a fun√ß√£o pra mem√≥ria/inicializa√ß√£o
            "3" { Invoke-SimpleInternetOpt } # Chama a fun√ß√£o pra internet
            "4" { Invoke-SimpleVisualOpt } # Chama a fun√ß√£o pra visual
            "5" { Invoke-SimpleGamingOpt } # Nova fun√ß√£o para otimiza√ß√£o de jogos
            "6" { Invoke-SimpleSecurityMaintenance } # Nova fun√ß√£o para manuten√ß√£o de seguran√ßa
            "7" {
                # Rodar todas as simplificadas sequencialmente
                Write-Host "`nModo Turbo F√°cil ATIVADO! Rodando todas as otimiza√ß√µes SIMPLIFICADAS... segura pe√£o!`n" -ForegroundColor Yellow
                Invoke-SimpleSystemCleanup # Roda a 1
                Invoke-SimpleMemoryStartup # Roda a 2
                Invoke-SimpleInternetOpt # Roda a 3
                Invoke-SimpleVisualOpt # Roda a 4
                Invoke-SimpleGamingOpt # Roda a 5
                Invoke-SimpleSecurityMaintenance # Roda a 6
                Write-Host "`nShow! Todas as otimiza√ß√µes SIMPLIFICADAS foram executadas! PC t√° agradecendo! ;)`n" -ForegroundColor Green
                Read-Host "Aperta Enter pra voltar pro Menu Simplificado..." # Pausa no final do "Rodar Todas"
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-MainMenu
            default {
                Write-Host "Ops! Op√ß√£o inv√°lida no Menu Simplificado! Confere os n√∫meros e manda bala de novo!" -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Simplificado enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Avan√ßado (O Playground dos Magos do PC!) ---
# Acessado pela op√ß√£o 2 do Menu Principal. Aqui a gente mergulha fundo!
function Show-AdvancedMenu {
    do {
        Clear-Host # Limpa o palco pro menu avan√ßado!
        Banner-TORK # Nosso banner no topo, pra n√£o perder a pose!

        Write-Host "" # Espacinho maroto
        Write-Host "===============================" -ForegroundColor White
        Write-Host "      MENU AVANCADO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes do menu avan√ßado (as CATEGORIAS dos 200 poderes!) Cores variadas (repetindo)!
        Write-Host "[1] Limpeza e Manuten√ß√£o de Arquivos (Tirar a poeira digital!)" -ForegroundColor Cyan # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[2] Otimiza√ß√µes de Desempenho do Sistema (Deixar o motor roncando!)" -ForegroundColor Green # Cor variada
        Write-Host "[3] Configura√ß√µes e Otimiza√ß√µes de Rede (Pra internet voar baixo!)" -ForegroundColor Yellow # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[4] Gerenciamento e Otimiza√ß√£o de Servi√ßos do Windows (O que t√° rodando e n√£o precisa?!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Ferramentas de Diagn√≥stico e Verifica√ß√£o (Pra ver se t√° tudo nos conformes!)" -ForegroundColor Cyan # Cor repetida
        Write-Host "[6] Desabilitar/Gerenciar Recursos do Windows (Tirar o peso extra do sistema!)" -ForegroundColor Green # Cor repetida
        Write-Host "[7] Gerenciamento de Arquivos e Pastas Avan√ßado (Comandos ninja pra arquivos!)" -ForegroundColor Yellow # Cor repetida
        Write-Host "[8] Gerenciamento de Contas de Usu√°rio (Organizar a galera que usa o PC!)" -ForegroundColor White # Cor repetida
        Write-Host "[9] Otimiza√ß√£o para Jogos Avan√ßada (Tweaks pra gamers de verdade!)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Configura√ß√µes de Privacidade (Controle o que o Windows sabe sobre voc√™)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[11] Outras Configura√ß√µes e Tweaks Diversos (Aqueles ajustes secretos!)" -ForegroundColor Gray # Cor neutra/escura
        Write-Host "[0] Voltar ao Menu Principal (Pronto pra voltar pra estrada principal!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta pro mago qual categoria ele quer explorar
        $choice = Read-Host "Escolhe sua √°rea de magia, mago!"

        # V√™ pra onde a gente navega dentro do mundo avan√ßado
        switch ($choice) {
            "1" { Show-LimpezaManutencaoMenu } # CHAMA O SUB-MENU DE LIMPEZA
            "2" { Show-DesempenhoMenu } # Agora √© um sub-menu tamb√©m
            "3" { Show-ConfiguracoesRedeMenu } # CHAMA O SUB-MENU DE REDE
            "4" { Show-ServicosMenu } # Agora √© um sub-menu tamb√©m
            "5" { Show-DiagnosticoMenu } # Agora √© um sub-menu tamb√©m
            "6" { Show-RecursosMenu } # Agora √© um sub-menu tamb√©m
            "7" { Show-ArquivosPastasMenu } # Agora √© um sub-menu tamb√©m
            "8" { Show-UsuariosMenu } # Agora √© um sub-menu tamb√©m
            "9" { Show-JogosAvancadoMenu } # Novo sub-menu para jogos
            "10" { Show-PrivacidadeMenu } # Novo sub-menu para privacidade
            "11" { Show-OutrosMenu } # Agora √© um sub-menu tamb√©m
            "0" { break } # Sai do loop deste menu, voltando pro Menu Principal
            default {
                Write-Host "Humm, essa √°rea da magia ainda n√£o existe ou voc√™ digitou errado! Tenta de novo, mago!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Avan√ßado enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Limpeza e Manuten√ß√£o (Dentro do Avan√ßado!) ---
# Este menu lista as op√ß√µes ESPEC√çFICAS da categoria Limpeza no Menu Avan√ßado
function Show-LimpezaManutencaoMenu {
    do {
        Clear-Host # Limpa o palco pra este sub-menu!
        Banner-TORK # Banner no topo, sempre!

        Write-Host "" # Espacinho
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: LIMPEZA E MANUT." -ForegroundColor White # T√≠tulo menor pro sub-menu
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes ESPEC√çFICAS da categoria Limpeza. Cores variadas (repetindo cores)!
        Write-Host "[1] Limpar Arquivos Tempor√°rios do Usu√°rio (Tipo a pasta Temp!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[2] Limpar Arquivos Tempor√°rios do Sistema (Os tempor√°rios do Windows!)" -ForegroundColor Gray # Cor neutra (substitui DarkCyan)
        Write-Host "[3] Limpar Cache de DNS (Pra resolver nomes de site mais r√°pido!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[4] Esvaziar Lixeira (Adeus, arquivos deletados!)" -ForegroundColor Gray # Cor neutra (repetindo)
        Write-Host "[5] Limpar Cache de Miniaturas (Aqueles previews de imagem/v√≠deo!)" -ForegroundColor Green # Cor variada
        Write-Host "[6] Limpar Logs do Sistema (Arquivos de registro que acumulam)" -ForegroundColor Cyan # Nova op√ß√£o
        Write-Host "[7] Limpar Cache de Atualiza√ß√µes do Windows (Liberar espa√ßo de updates)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[8] Limpar Arquivos de Hiberna√ß√£o (Liberar o hiberfil.sys)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[9] Limpar Arquivos WinSxS (Pasta que ocupa muito espa√ßo)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Executar TODAS as limpezas acima (Faxina completa!)" -ForegroundColor Red # Nova op√ß√£o
        Write-Host "[0] Voltar ao Menu Avan√ßado (De volta pras categorias!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta qual limpeza espec√≠fica o mago quer fazer
        $choice = Read-Host "Escolhe a limpeza avan√ßada, mestre!"

        # V√™ qual fun√ß√£o de limpeza espec√≠fica chamar
        switch ($choice) {
            "1" { Invoke-CleanUserTemp } # Chama a fun√ß√£o pra Limpar Temp Usu√°rio
            "2" { Invoke-CleanSystemTemp } # Chama a fun√ß√£o pra Limpar Temp Sistema
            "3" { Invoke-CleanDnsCache } # Chama a fun√ß√£o pra Limpar Cache DNS
            "4" { Invoke-EmptyRecycleBin } # Chama a fun√ß√£o pra Esvaziar Lixeira
            "5" { Invoke-CleanThumbnailCache } # Chama a fun√ß√£o pra Limpar Cache de Miniaturas
            "6" { Invoke-CleanSystemLogs } # Nova fun√ß√£o para limpar logs do sistema
            "7" { Invoke-CleanWindowsUpdateCache } # Nova fun√ß√£o para limpar cache de updates
            "8" { Invoke-CleanHibernationFile } # Nova fun√ß√£o para limpar arquivo de hiberna√ß√£o
            "9" { Invoke-CleanWinSxS } # Nova fun√ß√£o para limpar pasta WinSxS
            "10" { 
                # Executa todas as limpezas em sequ√™ncia
                Write-Host "`nIniciando faxina completa do sistema! Isso pode demorar um pouco...`n" -ForegroundColor Yellow
                $diskSpaceBefore = Get-DiskSpaceBefore
                
                Invoke-CleanUserTemp
                Invoke-CleanSystemTemp
                Invoke-CleanDnsCache
                Invoke-EmptyRecycleBin
                Invoke-CleanThumbnailCache
                Invoke-CleanSystemLogs
                Invoke-CleanWindowsUpdateCache
                Invoke-CleanHibernationFile
                Invoke-CleanWinSxS
                
                Write-Host "`nFaxina completa finalizada! Veja quanto espa√ßo foi recuperado:`n" -ForegroundColor Green
                Show-DiskSpaceComparison -before $diskSpaceBefore
                Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-AdvancedMenu
            default {
                Write-Host "Essa tarefa de limpeza ainda n√£o t√° na lista! V√™ os n√∫meros e tenta de novo!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Sub-Menu Limpeza enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Desempenho (Dentro do Avan√ßado!) ---
function Show-DesempenhoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DESEMPENHO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Ajustar Efeitos Visuais para Melhor Desempenho" -ForegroundColor Green
        Write-Host "[2] Otimizar Disco do Sistema" -ForegroundColor Cyan
        Write-Host "[3] Limpar Arquivos Prefetch" -ForegroundColor Yellow
        Write-Host "[4] Definir Plano de Energia para Alto Desempenho" -ForegroundColor White
        Write-Host "[5] Otimizar Servi√ßo SuperFetch/SysMain" -ForegroundColor Magenta
        Write-Host "[6] Ajustar Tamanho da Mem√≥ria Virtual" -ForegroundColor Gray
        Write-Host "[7] Desativar Indexa√ß√£o de Arquivos" -ForegroundColor Green
        Write-Host "[8] Otimizar Inicializa√ß√£o do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de desempenho" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o de desempenho"

        switch ($choice) {
            "1" { Invoke-OptimizeVisualEffects }
            "2" { Invoke-OptimizeDisk }
            "3" { Invoke-CleanPrefetch }
            "4" { Invoke-SetHighPerformancePower }
            "5" { Invoke-OptimizeSuperFetch }
            "6" { Invoke-AdjustVirtualMemory }
            "7" { Invoke-DisableIndexing }
            "8" { Invoke-OptimizeStartup }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de desempenho...`n" -ForegroundColor Yellow
                Invoke-OptimizeVisualEffects
                Invoke-OptimizeDisk
                Invoke-CleanPrefetch
                Invoke-SetHighPerformancePower
                Invoke-OptimizeSuperFetch
                Invoke-AdjustVirtualMemory
                Invoke-DisableIndexing
                Invoke-OptimizeStartup
                Write-Host "`nTodas as otimiza√ß√µes de desempenho foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Configura√ß√µes de Rede (Dentro do Avan√ßado!) ---
function Show-ConfiguracoesRedeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: CONFIG. REDE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Limpar Cache de DNS" -ForegroundColor Yellow
        Write-Host "[2] Mudar Servidor DNS" -ForegroundColor Cyan
        Write-Host "[3] Resetar Configura√ß√µes de Rede" -ForegroundColor White
        Write-Host "[4] Otimizar Configura√ß√µes TCP/IP" -ForegroundColor Green
        Write-Host "[5] Verificar Velocidade da Conex√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar QoS (Qualidade de Servi√ßo)" -ForegroundColor Gray
        Write-Host "[7] Desativar IPv6 (Se n√£o estiver usando)" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Lat√™ncia de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de rede" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√£o de rede"

        switch ($choice) {
            "1" { Invoke-NetworkFlushDns }
            "2" { Invoke-NetworkChangeDns }
            "3" { Invoke-NetworkReset }
            "4" { Invoke-OptimizeTcpIp }
            "5" { Invoke-CheckNetworkSpeed }
            "6" { Invoke-ConfigureQoS }
            "7" { Invoke-DisableIPv6 }
            "8" { Invoke-OptimizeGamingLatency }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de rede...`n" -ForegroundColor Yellow
                Invoke-NetworkFlushDns
                Invoke-OptimizeTcpIp
                Invoke-CheckNetworkSpeed
                Invoke-ConfigureQoS
                Invoke-DisableIPv6
                Invoke-OptimizeGamingLatency
                Write-Host "`nTodas as otimiza√ß√µes de rede foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Rede..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Servi√ßos (Dentro do Avan√ßado!) ---
function Show-ServicosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: SERVICOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desabilitar Servi√ßo SuperFetch/SysMain" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Servi√ßo de Impress√£o" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Servi√ßo Windows Update" -ForegroundColor White
        Write-Host "[4] Listar Todos os Servi√ßos em Execu√ß√£o" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Otimizar Servi√ßos para Desempenho Geral" -ForegroundColor Gray
        Write-Host "[7] Restaurar Servi√ßos para Configura√ß√£o Padr√£o" -ForegroundColor Yellow
        Write-Host "[8] Desabilitar Servi√ßos Desnecess√°rios" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de servi√ßos"

        switch ($choice) {
            "1" { Invoke-ManageSuperFetch }
            "2" { Invoke-ManagePrintService }
            "3" { Invoke-ManageWindowsUpdate }
            "4" { Invoke-ListRunningServices }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-OptimizeServicesForPerformance }
            "7" { Invoke-RestoreDefaultServices }
            "8" { Invoke-DisableUnnecessaryServices }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Diagn√≥stico (Dentro do Avan√ßado!) ---
function Show-DiagnosticoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DIAGNOSTICO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Verificar Arquivos do Sistema (SFC)" -ForegroundColor Yellow
        Write-Host "[2] Reparar Imagem do Windows (DISM)" -ForegroundColor Cyan
        Write-Host "[3] Verificar Disco por Erros (CHKDSK)" -ForegroundColor White
        Write-Host "[4] Verificar Sa√∫de do Disco" -ForegroundColor Green
        Write-Host "[5] Verificar Drivers Desatualizados" -ForegroundColor Magenta
        Write-Host "[6] Verificar Problemas de Inicializa√ß√£o" -ForegroundColor Gray
        Write-Host "[7] Verificar Problemas de Mem√≥ria RAM" -ForegroundColor Yellow
        Write-Host "[8] Verificar Temperatura do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODOS os diagn√≥sticos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de diagn√≥stico"

        switch ($choice) {
            "1" { Invoke-SfcScan }
            "2" { Invoke-DismRepair }
            "3" { Invoke-ChkDsk }
            "4" { Invoke-CheckDiskHealth }
            "5" { Invoke-CheckDrivers }
            "6" { Invoke-CheckStartupIssues }
            "7" { Invoke-CheckMemory }
            "8" { Invoke-CheckTemperature }
            "9" {
                Write-Host "`nExecutando todos os diagn√≥sticos...`n" -ForegroundColor Yellow
                Invoke-SfcScan
                Invoke-DismRepair
                Invoke-CheckDiskHealth
                Invoke-CheckDrivers
                Invoke-CheckStartupIssues
                Invoke-CheckTemperature
                Write-Host "`nTodos os diagn√≥sticos foram conclu√≠dos!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Diagn√≥stico..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Recursos (Dentro do Avan√ßado!) ---
function Show-RecursosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: RECURSOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Gerenciar Hiberna√ß√£o" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Planos de Energia" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Recursos Opcionais do Windows" -ForegroundColor White
        Write-Host "[4] Gerenciar Mem√≥ria Virtual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Windows Defender" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Recursos de Telemetria" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Recursos de Inicializa√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Recursos de Seguran√ßa" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de recursos"

        switch ($choice) {
            "1" { Invoke-ManageHibernation }
            "2" { Invoke-ManagePowerPlans }
            "3" { Invoke-ManageOptionalFeatures }
            "4" { Invoke-ManageVirtualMemory }
            "5" { Invoke-ManageWindowsDefender }
            "6" { Invoke-ManageTelemetry }
            "7" { Invoke-ManageStartupResources }
            "8" { Invoke-ManageSecurityFeatures }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Arquivos e Pastas (Dentro do Avan√ßado!) ---
function Show-ArquivosPastasMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: ARQUIVOS E PASTAS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Encontrar Arquivos Grandes" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Arquivos" -ForegroundColor Cyan
        Write-Host "[3] Tomar Posse de Arquivos (TakeOwn)" -ForegroundColor White
        Write-Host "[4] Listar Conte√∫do de Pastas Espec√≠ficas" -ForegroundColor Green
        Write-Host "[5] Compactar Pastas para Economizar Espa√ßo" -ForegroundColor Magenta
        Write-Host "[6] Verificar Integridade de Arquivos" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Arquivos Ocultos e do Sistema" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Atributos de Arquivos" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de arquivos e pastas"

        switch ($choice) {
            "1" { Invoke-FindLargeFiles }
            "2" { Invoke-ManageFilePermissions }
            "3" { Invoke-TakeOwnership }
            "4" { Invoke-ListFolderContents }
            "5" { Invoke-CompressFolders }
            "6" { Invoke-VerifyFileIntegrity }
            "7" { Invoke-ManageHiddenSystemFiles }
            "8" { Invoke-ManageFileAttributes }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Usu√°rios (Dentro do Avan√ßado!) ---
function Show-UsuariosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: USUARIOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Listar Todos os Usu√°rios Locais" -ForegroundColor Yellow
        Write-Host "[2] Listar Todos os Grupos Locais" -ForegroundColor Cyan
        Write-Host "[3] Listar Membros de Grupos Espec√≠ficos" -ForegroundColor White
        Write-Host "[4] Mostrar Propriedades do Usu√°rio Atual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Contas de Usu√°rio" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Pol√≠ticas de Senha" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Permiss√µes de Usu√°rio" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar UAC (Controle de Conta de Usu√°rio)" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de usu√°rios"

        switch ($choice) {
            "1" { Invoke-ListLocalUsers }
            "2" { Invoke-ListLocalGroups }
            "3" { Invoke-ListGroupMembers }
            "4" { Invoke-ShowCurrentUserProperties }
            "5" { Invoke-ManageUserAccounts }
            "6" { Invoke-ManagePasswordPolicies }
            "7" { Invoke-ManageUserPermissions }
            "8" { Invoke-ManageUAC }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Jogos Avan√ßado (Dentro do Avan√ßado!) ---
function Show-JogosAvancadoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: JOGOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Otimizar Prioridade de CPU para Jogos" -ForegroundColor Yellow
        Write-Host "[2] Otimizar Configura√ß√µes de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[3] Otimizar Configura√ß√µes de GPU" -ForegroundColor White
        Write-Host "[4] Desativar Game DVR e Game Bar" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Configurar Modo de Jogo do Windows" -ForegroundColor Gray
        Write-Host "[7] Otimizar Configura√ß√µes de √Åudio para Jogos" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Configura√ß√µes de Input Lag" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes para jogos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o para jogos"

        switch ($choice) {
            "1" { Invoke-OptimizeCpuPriority }
            "2" { Invoke-OptimizeNetworkForGaming }
            "3" { Invoke-OptimizeGpuSettings }
            "4" { Invoke-DisableGameDvrBar }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-ConfigureGameMode }
            "7" { Invoke-OptimizeAudioForGaming }
            "8" { Invoke-OptimizeInputLag }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes para jogos...`n" -ForegroundColor Yellow
                Invoke-OptimizeCpuPriority
                Invoke-OptimizeNetworkForGaming
                Invoke-OptimizeGpuSettings
                Invoke-DisableGameDvrBar
                Invoke-OptimizeServicesForGaming
                Invoke-ConfigureGameMode
                Invoke-OptimizeAudioForGaming
                Invoke-OptimizeInputLag
                Write-Host "`nTodas as otimiza√ß√µes para jogos foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Jogos..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Privacidade (Dentro do Avan√ßado!) ---
function Show-PrivacidadeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: PRIVACIDADE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desativar Telemetria do Windows" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Aplicativos" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Hist√≥rico de Atividades" -ForegroundColor White
        Write-Host "[4] Gerenciar Diagn√≥stico e Feedback" -ForegroundColor Green
        Write-Host "[5] Gerenciar An√∫ncios Personalizados" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Localiza√ß√£o e Sensores" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Reconhecimento de Voz e Digita√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Sincroniza√ß√£o com a Microsoft" -ForegroundColor Cyan
        Write-Host "[9] Aplicar TODAS as configura√ß√µes de privacidade" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de privacidade"

        switch ($choice) {
            "1" { Invoke-DisableTelemetry }
            "2" { Invoke-ManageAppPermissions }
            "3" { Invoke-ManageActivityHistory }
            "4" { Invoke-ManageDiagnosticsFeedback }
            "5" { Invoke-ManagePersonalizedAds }
            "6" { Invoke-ManageLocationSensors }
            "7" { Invoke-ManageVoiceTyping }
            "8" { Invoke-ManageMicrosoftSync }
            "9" {
                Write-Host "`nAplicando todas as configura√ß√µes de privacidade...`n" -ForegroundColor Yellow
                Invoke-DisableTelemetry
                Invoke-ManageAppPermissions
                Invoke-ManageActivityHistory
                Invoke-ManageDiagnosticsFeedback
                Invoke-ManagePersonalizedAds
                Invoke-ManageLocationSensors
                Invoke-ManageVoiceTyping
                Invoke-ManageMicrosoftSync
                Write-Host "`nTodas as configura√ß√µes de privacidade foram aplicadas!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Privacidade..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Outros (Dentro do Avan√ßado!) ---
function Show-OutrosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: OUTROS TWEAKS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Mostrar Informa√ß√µes Detalhadas do Sistema" -ForegroundColor Yellow
        Write-Host "[2] Mostrar Configura√ß√£o Completa de Rede" -ForegroundColor Cyan
        Write-Host "[3] Reiniciar Explorer.exe" -ForegroundColor White
        Write-Host "[4] Limpar Cache de Atualiza√ß√µes do Windows" -ForegroundColor Green
        Write-Host "[5] Gerenciar Programas de Inicializa√ß√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar Op√ß√µes de Energia Avan√ßadas" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Configura√ß√µes de Armazenamento" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Configura√ß√µes de Notifica√ß√µes" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√µes diversas"

        switch ($choice) {
            "1" { Invoke-ShowDetailedSystemInfo }
            "2" { Invoke-ShowDetailedNetworkConfig }
            "3" { Invoke-RestartExplorer }
            "4" { Invoke-CleanWindowsUpdateCache }
            "5" { Invoke-ManageStartupPrograms }
            "6" { Invoke-ConfigureAdvancedPowerOptions }
            "7" { Invoke-ManageStorageSettings }
            "8" { Invoke-ManageNotificationSettings }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- Fun√ß√µes para as Secoes SIMPLIFICADAS (Expandidas) ---
function Invoke-SimpleSystemCleanup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza Geral do Sistema: Hora de varrer o lixo digital! ---" -ForegroundColor Green
    Write-Host "Essa op√ß√£o vai te ajudar a liberar espa√ßo e dar um f√¥lego pro PC tirando arquivos tempor√°rios, lixo da lixeira, etc. √â tipo faxina no computador!" -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Comando 1: Limpar Arquivos Tempor√°rios do Usu√°rio
    Write-Host "Bora come√ßar limpando os arquivos tempor√°rios do seu usu√°rio! Eles acumulam que √© uma beleza!" -ForegroundColor Yellow
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio limpos! Menos peso pro PC respirar! ;)" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Esvaziar a Lixeira
    Write-Host "Agora, vamos dar um fim definitivo naqueles arquivos na Lixeira. Eles s√≥ est√£o ocupando espa√ßo √† toa!" -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada! Espa√ßo recuperado com sucesso! R√°!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios do Windows
    Write-Host "Vamos limpar tamb√©m os tempor√°rios do pr√≥prio Windows. √Äs vezes, fica lixo escondido por l√°!" -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Limpar Cache de Navegadores Comuns
    Write-Host "Bora dar uma geral nos caches dos navegadores tamb√©m! Eles guardam um monte de coisa que pode pesar!" -ForegroundColor Yellow
    
    # Chrome
    Write-Host "Tentando limpar cache do Google Chrome..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Chrome limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Edge
    Write-Host "Tentando limpar cache do Microsoft Edge..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Edge limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Firefox
    Write-Host "Tentando limpar cache do Mozilla Firefox..." -ForegroundColor DarkGray
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\cache2\entries\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\startupCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\thumbnails\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Firefox limpo (pode n√£o ser completo, dependendo do perfil/uso)." -ForegroundColor DarkGray

    # Brave (se instalado)
    Write-Host "Tentando limpar cache do Brave Browser (se instalado)..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Brave limpo (se instalado e n√£o estiver rodando)." -ForegroundColor DarkGray

    Write-Host "Limpeza de caches de navegador conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Comando 5: Limpar Cache de Miniaturas
    Write-Host "Limpando cache de miniaturas do Windows (aquelas pr√©-visualiza√ß√µes de imagens e v√≠deos)..." -ForegroundColor Yellow
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Write-Host "Cache de miniaturas limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Limpar Arquivos de Log do Windows
    Write-Host "Limpando arquivos de log do Windows que podem ocupar espa√ßo..." -ForegroundColor Yellow
    wevtutil cl Application
    wevtutil cl System
    wevtutil cl Security
    Write-Host "Logs do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 7: Limpar Arquivos Tempor√°rios de Instala√ß√£o
    Write-Host "Limpando arquivos tempor√°rios de instala√ß√£o de programas..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Installer\$*\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios de instala√ß√£o limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 8: Limpar Arquivos de Atualiza√ß√£o do Windows
    Write-Host "Limpando arquivos de atualiza√ß√£o do Windows que podem ocupar bastante espa√ßo..." -ForegroundColor Yellow
    Stop-Service -Name wuauserv -ErrorAction SilentlyContinue
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    Write-Host "Arquivos de atualiza√ß√£o do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 9: Limpar Arquivos Prefetch
    Write-Host "Limpando arquivos prefetch para melhorar a inicializa√ß√£o..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Prefetch\*.pf" -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos prefetch limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 10: Executar Limpeza de Disco Integrada do Windows
    Write-Host "Executando a ferramenta de limpeza de disco integrada do Windows..." -ForegroundColor Yellow
    Start-Process -FilePath cleanmgr.exe -ArgumentList "/sagerun:1" -Wait -ErrorAction SilentlyContinue
    Write-Host "Limpeza de disco conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "Vamos ver quanto espa√ßo conseguimos recuperar com essa faxina:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nPronto! A faxina geral b√°sica foi feita! Seu PC agradece o espa√ßo extra! ;)" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu
    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleMemoryStartup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Mem√≥ria e Inicializa√ß√£o R√°pida: Deixa o PC ligando num piscar! ---" -ForegroundColor Yellow
    Write-Host "Aqui a gente d√° uma olhada na mem√≥ria RAM e nos programas que ligam junto com o Windows. Menos coisa ligando √† toa = PC mais r√°pido pra usar na hora!" -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Listar Programas de Inicializa√ß√£o
    Write-Host "Listando programas que iniciam com o Windows (pra voc√™ saber o que t√° rodando por baixo dos panos):" -ForegroundColor Yellow
    Get-CimInstance win32_startupcommand | Select-Object Name, command, Location | Format-Table -AutoSize
    Write-Host "Lista de programas de inicializa√ß√£o exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Servi√ßo SuperFetch/SysMain
    Write-Host "Otimizando o servi√ßo SuperFetch/SysMain para melhorar o desempenho..." -ForegroundColor Yellow
    $confirmSysMain = Read-Host "Deseja desativar o servi√ßo SysMain/SuperFetch? (s/n) - Recomendado para SSDs"
    if ($confirmSysMain -eq 's') {
        Set-Service -Name SysMain -StartupType Disabled -ErrorAction SilentlyContinue
        Stop-Service -Name SysMain -Force -ErrorAction SilentlyContinue
        Write-Host "Servi√ßo SysMain/SuperFetch desativado!" -ForegroundColor Green
    } else {
        Write-Host "Servi√ßo SysMain/SuperFetch mantido ativo." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios de Updates
    Write-Host "Limpando arquivos tempor√°rios de atualiza√ß√µes do Windows (podem ocupar bastante espa√ßo e afetar performance):" -ForegroundColor Yellow
    Dism /online /Cleanup-Image /StartComponentCleanup /ErrorAction SilentlyContinue
    Write-Host "Limpeza de componentes de atualiza√ß√£o iniciada (pode levar um tempo)." -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Mem√≥ria Virtual
    Write-Host "Otimizando configura√ß√µes de mem√≥ria virtual para melhor desempenho..." -ForegroundColor Yellow
    $totalRam = (Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property capacity -Sum).Sum / 1GB
    Write-Host "Seu sistema tem aproximadamente $totalRam GB de RAM." -ForegroundColor White
    
    $confirmPageFile = Read-Host "Deseja otimizar o arquivo de pagina√ß√£o (mem√≥ria virtual)? (s/n)"
    if ($confirmPageFile -eq 's') {
        # Calcula tamanho recomendado (1.5x a RAM para sistemas com menos de 8GB, 1x para sistemas com mais)
        $pageFileSize = if ($totalRam -lt 8) { [math]::Round($totalRam * 1.5) * 1024 } else { [math]::Round($totalRam) * 1024 }
        
        Write-Host "Configurando arquivo de pagina√ß√£o para tamanho fixo de $pageFileSize MB..." -ForegroundColor DarkGray
        $computerSystem = Get-WmiObject -Class Win32_ComputerSystem
        $computerSystem.AutomaticManagedPagefile = $false
        $computerSystem.Put() | Out-Null
        
        $pageFileSetting = Get-WmiObject -Class Win32_PageFileSetting
        if ($pageFileSetting) {
            $pageFileSetting.InitialSize = $pageFileSize
            $pageFileSetting.MaximumSize = $pageFileSize
            $pageFileSetting.Put() | Out-Null
        }
        Write-Host "Arquivo de pagina√ß√£o otimizado! (Requer reinicializa√ß√£o para aplicar totalmente)" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes de mem√≥ria virtual mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Listar os 10 Processos que mais usam mem√≥ria no momento
    Write-Host "Listando os 10 processos que mais consomem mem√≥ria agora:" -ForegroundColor Yellow
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host "Lista de processos exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Otimizar Inicializa√ß√£o do Windows
    Write-Host "Otimizando a inicializa√ß√£o do Windows..." -ForegroundColor Yellow
    # Desabilitar servi√ßos n√£o essenciais que podem atrasar a inicializa√ß√£o
    $startupServices = @(
        @{Name="DiagTrack"; DisplayName="Experi√™ncias do Usu√°rio Conectado e Telemetria"},
        @{Name="dmwappushservice"; DisplayName="Servi√ßo de Transfer√™ncia Inteligente em Segundo Plano (BITS)"},
        @{Name="MapsBroker"; DisplayName="Servi√ßo de Dados de Mapas"}
    )
    
    foreach ($service in $startupServices) {
        $confirmService = Read-Host "Deseja desativar o servi√ßo '$($service.DisplayName)' na inicializa√ß√£o? (s/n)"
        if ($confirmService -eq 's') {
            Set-Service -Name $service.Name -StartupType Disabled -ErrorAction SilentlyContinue
            Stop-Service -Name $service.Name -Force -ErrorAction SilentlyContinue
            Write-Host "Servi√ßo '$($service.DisplayName)' desativado!" -ForegroundColor Green
        } else {
            Write-Host "Servi√ßo '$($service.DisplayName)' mantido." -ForegroundColor Green
        }
    }
    Write-Host ""

    # Comando 7: Reiniciar o Computador (√ötil pra liberar mem√≥ria e aplicar mudan√ßas)
    Write-Host "Quer dar um 'refresh' geral no PC? Reiniciar pode ajudar!" -ForegroundColor Yellow
    $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (digite 'sim' para confirmar)"
    if ($confirmRestart -eq 'sim') {
        Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
        Restart-Computer -Force
    } else {
        Write-Host "Rein√≠cio cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o de mem√≥ria e inicializa√ß√£o!" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu (a n√£o ser que o PC tenha reiniciado)
    if ($confirmRestart -ne 'sim') {
        Write-Host ""
        Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
    }
}

function Invoke-SimpleInternetOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Acelerar a Conex√£o com a Internet (Simplificado): Diz adeus pro 'carregando...'! ---" -ForegroundColor Cyan
    Write-Host "Vamos fazer uns ajustes r√°pidos na sua conex√£o pra tentar deixar ela mais esperta." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Limpar Cache de DNS
    Write-Host "Limpando o cache de endere√ßos de internet (DNS) pra resolver nomes mais r√°pido!" -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Configura√ß√µes TCP/IP
    Write-Host "Otimizando configura√ß√µes TCP/IP para melhorar a velocidade de conex√£o..." -ForegroundColor Yellow
    
    # Habilitar TCP Window Auto-Tuning
    netsh int tcp set global autotuninglevel=normal
    Write-Host "TCP Auto-Tuning configurado para 'normal'." -ForegroundColor DarkGray
    
    # Otimizar par√¢metros de recebimento de pacotes
    netsh int tcp set global rss=enabled
    Write-Host "Receive-Side Scaling (RSS) habilitado." -ForegroundColor DarkGray
    
    # Otimizar congestion provider
    netsh int tcp set global congestionprovider=ctcp
    Write-Host "Congestion Provider configurado para 'ctcp'." -ForegroundColor DarkGray
    
    # Otimizar ECN capability
    netsh int tcp set global ecncapability=enabled
    Write-Host "ECN Capability habilitado." -ForegroundColor DarkGray
    
    Write-Host "Configura√ß√µes TCP/IP otimizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Reiniciar Adaptadores de Rede
    Write-Host "Dando um 'reset' r√°pido nas suas conex√µes de rede. Pode resolver uns pepinos!" -ForegroundColor Yellow
    $confirmResetAdapter = Read-Host "Isso vai desconectar brevemente sua internet. Continuar? (s/n)"
    if ($confirmResetAdapter -eq 's') {
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        Write-Host "Adaptadores de rede reiniciados." -ForegroundColor Green
    } else {
        Write-Host "Reset de adaptadores cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 4: Configurar DNS R√°pido
    Write-Host "Configurar DNS mais r√°pido pode melhorar sua navega√ß√£o!" -ForegroundColor Yellow
    $confirmDns = Read-Host "Deseja configurar DNS mais r√°pidos (Google ou Cloudflare)? (s/n)"
    if ($confirmDns -eq 's') {
        Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
        Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
        $dnsChoice = Read-Host "Escolha uma op√ß√£o (1 ou 2)"
        
        $primaryDns = ""
        $secondaryDns = ""
        
        if ($dnsChoice -eq '1') {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            Write-Host "Google DNS selecionado." -ForegroundColor DarkGray
        } elseif ($dnsChoice -eq '2') {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            Write-Host "Cloudflare DNS selecionado." -ForegroundColor DarkGray
        } else {
            Write-Host "Op√ß√£o inv√°lida. DNS n√£o alterado." -ForegroundColor Red
        }
        
        if ($primaryDns -ne "") {
            $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" -and ($_.InterfaceDescription -match "Ethernet" -or $_.InterfaceDescription -match "Wi-Fi" -or $_.InterfaceDescription -match "Wireless") }
            
            foreach ($adapter in $networkAdapters) {
                Write-Host "Configurando DNS para adaptador: $($adapter.Name)" -ForegroundColor DarkGray
                Set-DnsClientServerAddress -InterfaceIndex $adapter.ifIndex -ServerAddresses ($primaryDns, $secondaryDns)
            }
            
            Write-Host "DNS configurado! Sua navega√ß√£o deve ficar mais r√°pida agora." -ForegroundColor Green
        }
    } else {
        Write-Host "Configura√ß√£o de DNS mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Mostrar Status B√°sico da Conex√£o
    Write-Host "Mostrando um resumo b√°sico da sua configura√ß√£o de rede atual:" -ForegroundColor Yellow
    ipconfig /all | Select-String -Pattern "IPv4", "DNS", "Gateway", "DHCP", "Subnet", "Physical Address"
    Write-Host "Status b√°sico da rede exibido." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Testar a conex√£o com a internet
    Write-Host "Testando a conex√£o com a internet (ping para google.com)..." -ForegroundColor Yellow
    Test-Connection -Count 4 google.com -ErrorAction SilentlyContinue
    Write-Host "Teste de conex√£o finalizado." -ForegroundColor Green
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o b√°sica de internet!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleVisualOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Deixar o Windows mais Leve Visualmente (Simplificado): Desempenho antes da beleza! ---" -ForegroundColor White
    Write-Host "Ajustes r√°pidos pra desativar efeitos visuais que podem pesar, liberando recursos pro que importa." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ajustar Efeitos Visuais
    Write-Host "Voc√™ quer desativar ou ativar as anima√ß√µes e efeitos visuais do Windows?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Efeitos Visuais (Pra ganhar desempenho)" -ForegroundColor Green
    Write-Host "[2] Configurar para Melhor Apar√™ncia (Mais bonito, mas mais pesado)" -ForegroundColor White
    Write-Host "[3] Deixar o Windows Escolher (Configura√ß√£o padr√£o)" -ForegroundColor Cyan
    $choiceVisual = Read-Host "Escolha [1], [2] ou [3]"

    if ($choiceVisual -eq '1') {
        Write-Host "Desativando efeitos visuais para melhor desempenho..." -ForegroundColor Yellow
        # Valor 2 = Ajustar para melhor desempenho (desativa a maioria dos efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 2 -Type DWord -Force -ErrorAction SilentlyContinue
        
        # Desativar anima√ß√µes individuais
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop' -Name 'UserPreferencesMask' -Value ([byte[]](0x90, 0x12, 0x01, 0x80)) -Type Binary -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop\WindowMetrics' -Name 'MinAnimate' -Value 0 -Type String -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'ListviewAlphaSelect' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'TaskbarAnimations' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        
        Write-Host "Efeitos visuais desativados para melhor desempenho!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '2') {
        Write-Host "Configurando para melhor apar√™ncia (todos os efeitos visuais ativados)..." -ForegroundColor Yellow
        # Valor 1 = Ajustar para melhor apar√™ncia (ativa todos os efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Efeitos visuais configurados para melhor apar√™ncia!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '3') {
        Write-Host "Deixando o Windows escolher automaticamente (configura√ß√£o padr√£o)..." -ForegroundColor Yellow
        # Valor 0 = Deixar o Windows escolher
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Configura√ß√£o visual definida para padr√£o do Windows!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa nos efeitos visuais foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 2: Ativar/Desativar Efeitos de Transpar√™ncia
    Write-Host "E os efeitos de transpar√™ncia do Windows (tipo na barra de tarefas)?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Transpar√™ncia (Mais leve)" -ForegroundColor Green
    Write-Host "[2] Ativar Transpar√™ncia (Mais 'bonito')" -ForegroundColor White
    $choiceTransp = Read-Host "Escolha [1] ou [2]"

    if ($choiceTransp -eq '1') {
        Write-Host "Desativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 0 = Desativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia desativada!" -ForegroundColor Green
    } elseif ($choiceTransp -eq '2') {
        Write-Host "Ativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 1 = Ativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia ativada!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa na transpar√™ncia foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 3: Configurar Tema Claro/Escuro
    Write-Host "Voc√™ prefere tema claro ou escuro? O tema escuro pode ser mais confort√°vel para os olhos." -ForegroundColor Yellow
    Write-Host "[1] Tema Escuro (Dark Mode)" -ForegroundColor DarkGray
    Write-Host "[2] Tema Claro (Light Mode)" -ForegroundColor White
    $choiceTheme = Read-Host "Escolha [1] ou [2]"

    if ($choiceTheme -eq '1') {
        Write-Host "Configurando tema escuro..." -ForegroundColor Yellow
        # Valor 0 = Tema Escuro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema escuro configurado!" -ForegroundColor Green
    } elseif ($choiceTheme -eq '2') {
        Write-Host "Configurando tema claro..." -ForegroundColor Yellow
        # Valor 1 = Tema Claro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema claro configurado!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa no tema foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Configurar Resolu√ß√£o de Tela
    Write-Host "Deseja ajustar a resolu√ß√£o da tela? Resolu√ß√µes menores podem melhorar o desempenho em PCs mais antigos." -ForegroundColor Yellow
    $confirmResolution = Read-Host "Deseja ver e ajustar a resolu√ß√£o da tela? (s/n)"
    
    if ($confirmResolution -eq 's') {
        # Mostrar resolu√ß√£o atual
        $currentResolution = Get-WmiObject -Class Win32_VideoController | Select-Object -ExpandProperty VideoModeDescription
        Write-Host "Resolu√ß√£o atual: $currentResolution" -ForegroundColor White
        
        # Abrir configura√ß√µes de exibi√ß√£o do Windows
        Write-Host "Abrindo configura√ß√µes de exibi√ß√£o do Windows..." -ForegroundColor DarkGray
        Start-Process "ms-settings:display"
        Write-Host "Ajuste a resolu√ß√£o conforme necess√°rio na janela de configura√ß√µes que foi aberta." -ForegroundColor Green
        
        $waitForSettings = Read-Host "Pressione Enter quando terminar de ajustar as configura√ß√µes de exibi√ß√£o"
    } else {
        Write-Host "Configura√ß√£o de resolu√ß√£o mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizados os ajustes visuais b√°sicos!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleGamingOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Jogos (Simplificado): Mais FPS, menos lag! ---" -ForegroundColor Magenta
    Write-Host "Vamos fazer alguns ajustes para melhorar o desempenho dos seus jogos sem complica√ß√µes." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ativar Modo de Jogo do Windows
    Write-Host "Ativando o Modo de Jogo do Windows para priorizar recursos para jogos..." -ForegroundColor Yellow
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AllowAutoGameMode" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AutoGameModeEnabled" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Write-Host "Modo de Jogo do Windows ativado!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Desativar Game DVR e Game Bar
    Write-Host "O Game DVR e Game Bar podem reduzir o desempenho em jogos. Deseja desativ√°-los?" -ForegroundColor Yellow
    $confirmGameDVR = Read-Host "Desativar Game DVR e Game Bar? (s/n)"
    
    if ($confirmGameDVR -eq 's') {
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "UseNexusForGameBarEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\System\GameConfigStore" -Name "GameDVR_Enabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR" -Name "AppCaptureEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Write-Host "Game DVR e Game Bar desativados!" -ForegroundColor Green
    } else {
        Write-Host "Game DVR e Game Bar mantidos ativos." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Otimizar Plano de Energia para Jogos
    Write-Host "Configurando plano de energia para alto desempenho (ideal para jogos)..." -ForegroundColor Yellow
    powercfg.exe /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c
    Write-Host "Plano de energia configurado para alto desempenho!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Configura√ß√µes de Mouse
    Write-Host "Otimizando configura√ß√µes de mouse para jogos (precis√£o do ponteiro)..." -ForegroundColor Yellow
    $confirmMouseFix = Read-Host "Desativar a acelera√ß√£o do mouse para melhor precis√£o em jogos? (s/n)"
    
    if ($confirmMouseFix -eq 's') {
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseSpeed" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold1" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold2" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Write-Host "Acelera√ß√£o do mouse desativada para melhor precis√£o em jogos!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do mouse mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Otimizar Prioridade de CPU para Jogos
    Write-Host "Configurando prioridade de CPU para jogos..." -ForegroundColor Yellow
    Write-Host "Esta configura√ß√£o ajusta o sistema para dar mais prioridade aos jogos." -ForegroundColor DarkGray
    
    # Criar chave de registro para prioridade de jogos
    if (-not (Test-Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games")) {
        New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Force | Out-Null
    }
    
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "GPU Priority" -Type DWord -Value 8 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Priority" -Type DWord -Value 6 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Scheduling Category" -Type String -Value "High" -Force -ErrorAction SilentlyContinue
    
    Write-Host "Prioridade de CPU para jogos otimizada!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Verificar Driver de Placa de V√≠deo
    Write-Host "Verificando informa√ß√µes da placa de v√≠deo..." -ForegroundColor Yellow
    $gpuInfo = Get-WmiObject -Class Win32_VideoController | Select-Object Name, DriverVersion, CurrentHorizontalResolution, CurrentVerticalResolution
    
    foreach ($gpu in $gpuInfo) {
        Write-Host "Placa de v√≠deo: $($gpu.Name)" -ForegroundColor White
        Write-Host "Vers√£o do driver: $($gpu.DriverVersion)" -ForegroundColor White
        Write-Host "Resolu√ß√£o atual: $($gpu.CurrentHorizontalResolution) x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
      x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
    
    Write-Host "Recomenda√ß√£o: Mantenha seus drivers de v√≠deo atualizados para melhor desempenho em jogos!" -ForegroundColor Green
    Write-Host "Voc√™ pode baixar os drivers mais recentes nos sites oficiais da NVIDIA, AMD ou Intel." -ForegroundColor DarkGray
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nOtimiza√ß√µes para jogos conclu√≠das! Seus jogos devem rodar mais suaves agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleSecurityMaintenance {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Manuten√ß√£o de Seguran√ßa (Simplificado): Mantenha seu PC protegido! ---" -ForegroundColor DarkYellow
    Write-Host "Vamos verificar e melhorar a seguran√ßa do seu sistema com alguns ajustes simples." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Verificar Status do Windows Defender
    Write-Host "Verificando status do Windows Defender..." -ForegroundColor Yellow
    $defenderStatus = Get-MpComputerStatus
    
    Write-Host "Status do Windows Defender:" -ForegroundColor White
    Write-Host "Antiv√≠rus habilitado: $($defenderStatus.AntivirusEnabled)" -ForegroundColor $(if ($defenderStatus.AntivirusEnabled) { "Green" } else { "Red" })
    Write-Host "Prote√ß√£o em tempo real: $($defenderStatus.RealTimeProtectionEnabled)" -ForegroundColor $(if ($defenderStatus.RealTimeProtectionEnabled) { "Green" } else { "Red" })
    Write-Host "Defini√ß√µes de antiv√≠rus: $($defenderStatus.AntivirusSignatureVersion)" -ForegroundColor White
    Write-Host "√öltima atualiza√ß√£o: $($defenderStatus.AntivirusSignatureLastUpdated)" -ForegroundColor White
    Write-Host ""

    # Comando 2: Atualizar Defini√ß√µes do Windows Defender
    Write-Host "Atualizando defini√ß√µes do Windows Defender..." -ForegroundColor Yellow
    Update-MpSignature -ErrorAction SilentlyContinue
    Write-Host "Defini√ß√µes do Windows Defender atualizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Verificar Atualiza√ß√µes do Windows
    Write-Host "Verificando status das atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
            Write-Host "Recomenda√ß√£o: Execute o Windows Update para manter seu sistema seguro." -ForegroundColor Green
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Verificar Configura√ß√µes de Firewall
    Write-Host "Verificando status do Firewall do Windows..." -ForegroundColor Yellow
    $firewallStatus = Get-NetFirewallProfile
    
    foreach ($profile in $firewallStatus) {
        Write-Host "Perfil: $($profile.Name)" -ForegroundColor White
        Write-Host "Status: $($profile.Enabled)" -ForegroundColor $(if ($profile.Enabled) { "Green" } else { "Red" })
        Write-Host ""
    }
    
    $confirmFirewall = Read-Host "Deseja habilitar o Firewall em todos os perfis? (s/n)"
    if ($confirmFirewall -eq 's') {
        Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True
        Write-Host "Firewall habilitado em todos os perfis!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do Firewall mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Verificar Configura√ß√µes de UAC
    Write-Host "Verificando configura√ß√µes do Controle de Conta de Usu√°rio (UAC)..." -ForegroundColor Yellow
    $uacLevel = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -ErrorAction SilentlyContinue
    
    if ($uacLevel) {
        switch ($uacLevel.ConsentPromptBehaviorAdmin) {
            0 { $uacStatus = "Desativado (N√£o recomendado)" }
            1 { $uacStatus = "Baixo (N√£o recomendado)" }
            2 { $uacStatus = "M√©dio" }
            5 { $uacStatus = "Alto (Recomendado)" }
            default { $uacStatus = "Personalizado" }
        }
        
        Write-Host "N√≠vel atual do UAC: $uacStatus" -ForegroundColor $(if ($uacLevel.ConsentPromptBehaviorAdmin -ge 2) { "Green" } else { "Red" })
        
        $confirmUAC = Read-Host "Deseja configurar o UAC para o n√≠vel recomendado? (s/n)"
        if ($confirmUAC -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -Value 5 -Type DWord -Force -ErrorAction SilentlyContinue
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "PromptOnSecureDesktop" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
            Write-Host "UAC configurado para o n√≠vel recomendado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do UAC mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do UAC." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 6: Verificar Configura√ß√µes de SmartScreen
    Write-Host "Verificando configura√ß√µes do Windows SmartScreen..." -ForegroundColor Yellow
    $smartScreen = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -ErrorAction SilentlyContinue
    
    if ($smartScreen) {
        Write-Host "Status do SmartScreen: $($smartScreen.SmartScreenEnabled)" -ForegroundColor $(if ($smartScreen.SmartScreenEnabled -eq "RequireAdmin" -or $smartScreen.SmartScreenEnabled -eq "Warn") { "Green" } else { "Red" })
        
        $confirmSmartScreen = Read-Host "Deseja habilitar o SmartScreen para maior seguran√ßa? (s/n)"
        if ($confirmSmartScreen -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -Value "RequireAdmin" -Type String -Force -ErrorAction SilentlyContinue
            Write-Host "SmartScreen habilitado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do SmartScreen mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do SmartScreen." -ForegroundColor Red
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nManuten√ß√£o de seguran√ßa conclu√≠da! Seu sistema est√° mais protegido agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

# --- Fun√ß√µes para o Diagn√≥stico R√°pido e Sobre ---
function Invoke-QuickDiagnostic {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Diagn√≥stico R√°pido do Sistema ---" -ForegroundColor Yellow
    Write-Host "Vamos fazer uma verifica√ß√£o r√°pida do estado atual do seu PC." -ForegroundColor Gray
    Write-Host ""

    # Informa√ß√µes do Sistema
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    $sysInfo = Get-SystemInfo
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host ""

    # Uso de CPU
    Write-Host "=== Uso de CPU ===" -ForegroundColor Cyan
    $cpuLoad = (Get-WmiObject Win32_Processor).LoadPercentage
    Write-Host "Uso atual de CPU: $cpuLoad%" -ForegroundColor $(if ($cpuLoad -lt 70) { "Green" } elseif ($cpuLoad -lt 90) { "Yellow" } else { "Red" })
    Write-Host ""

    # Uso de Mem√≥ria
    Write-Host "=== Uso de Mem√≥ria ===" -ForegroundColor Cyan
    $os = Get-WmiObject Win32_OperatingSystem
    $totalMemory = [math]::Round($os.TotalVisibleMemorySize / 1MB, 2)
    $freeMemory = [math]::Round($os.FreePhysicalMemory / 1MB, 2)
    $usedMemory = [math]::Round($totalMemory - $freeMemory, 2)
    $memoryPercentage = [math]::Round(($usedMemory / $totalMemory) * 100, 2)
    
    Write-Host "Mem√≥ria Total: $totalMemory GB" -ForegroundColor White
    Write-Host "Mem√≥ria Usada: $usedMemory GB ($memoryPercentage%)" -ForegroundColor $(if ($memoryPercentage -lt 70) { "Green" } elseif ($memoryPercentage -lt 90) { "Yellow" } else { "Red" })
    Write-Host "Mem√≥ria Livre: $freeMemory GB" -ForegroundColor White
    Write-Host ""

    # Espa√ßo em Disco
    Write-Host "=== Espa√ßo em Disco ===" -ForegroundColor Cyan
    $drives = Get-PSDrive -PSProvider FileSystem
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        $percentFree = [math]::Round(($freeSpace / $totalSpace) * 100, 2)
        
        Write-Host "Drive $($drive.Name):" -ForegroundColor White
        Write-Host "  Total: $totalSpace GB" -ForegroundColor White
        Write-Host "  Usado: $usedSpace GB" -ForegroundColor White
        Write-Host "  Livre: $freeSpace GB ($percentFree%)" -ForegroundColor $(if ($percentFree -gt 20) { "Green" } elseif ($percentFree -gt 10) { "Yellow" } else { "Red" })
    }
    Write-Host ""

    # Processos que mais consomem recursos
    Write-Host "=== Top 5 Processos (CPU) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object CPU -Descending | Select-Object -First 5 ProcessName, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}}, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host ""

    Write-Host "=== Top 5 Processos (Mem√≥ria) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 5 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}}, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}} | Format-Table -AutoSize
    Write-Host ""

    # Status de Servi√ßos Cr√≠ticos
    Write-Host "=== Status de Servi√ßos Cr√≠ticos ===" -ForegroundColor Cyan
    $criticalServices = @("wuauserv", "WinDefend", "MpsSvc", "wscsvc")
    foreach ($service in $criticalServices) {
        $serviceStatus = Get-Service -Name $service -ErrorAction SilentlyContinue
        if ($serviceStatus) {
            Write-Host "$($serviceStatus.DisplayName): $($serviceStatus.Status)" -ForegroundColor $(if ($serviceStatus.Status -eq "Running") { "Green" } else { "Red" })
        }
    }
    Write-Host ""

    # Verificar Atualiza√ß√µes Pendentes
    Write-Host "=== Atualiza√ß√µes do Windows ===" -ForegroundColor Cyan
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Recomenda√ß√µes
    Write-Host "=== Recomenda√ß√µes ===" -ForegroundColor Cyan
    
    # Recomenda√ß√£o de Mem√≥ria
    if ($memoryPercentage -gt 80) {
        Write-Host "- Seu uso de mem√≥ria est√° alto. Considere fechar alguns programas ou usar a op√ß√£o 'Otimiza√ß√£o de Mem√≥ria'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Disco
    $lowDiskSpace = $false
    foreach ($drive in $drives) {
        $percentFree = [math]::Round(($drive.Free / ($drive.Free + $drive.Used)) * 100, 2)
        if ($percentFree -lt 15) {
            $lowDiskSpace = $true
            break
        }
    }
    
    if ($lowDiskSpace) {
        Write-Host "- Espa√ßo em disco baixo detectado. Considere usar a op√ß√£o 'Limpeza Geral do Sistema'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Atualiza√ß√µes
    if ($pendingUpdates -gt 0) {
        Write-Host "- Existem atualiza√ß√µes pendentes. Recomendamos atualizar seu sistema para maior seguran√ßa." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Inicializa√ß√£o
    $bootTime = $sysInfo.LastBootTime
    $uptime = (Get-Date) - $bootTime
    if ($uptime.Days -gt 7) {
        Write-Host "- Seu sistema est√° ligado h√° $($uptime.Days) dias. Considere reiniciar para aplicar atualiza√ß√µes e limpar a mem√≥ria." -ForegroundColor Yellow
    }
    
    Write-Host ""

    # Mensagem de conclus√£o
    Write-Host "`nDiagn√≥stico r√°pido conclu√≠do! Use as informa√ß√µes acima para decidir quais otimiza√ß√µes fazer." -ForegroundColor Green

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

function Show-AboutTORK {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Sobre o TORK ---" -ForegroundColor White
    Write-Host ""
    
    Write-Host "TORK - Otimizador para Windows" -ForegroundColor Cyan
    Write-Host "Vers√£o: 2.0" -ForegroundColor White
    Write-Host "Desenvolvido por: Partner77" -ForegroundColor White
    Write-Host ""
    
    Write-Host "=== Descri√ß√£o ===" -ForegroundColor Yellow
    Write-Host "O TORK √© uma ferramenta abrangente de otimiza√ß√£o para Windows, projetada para" -ForegroundColor Gray
    Write-Host "melhorar o desempenho do seu sistema atrav√©s de limpeza, ajustes e otimiza√ß√µes." -ForegroundColor Gray
    Write-Host "Ele oferece op√ß√µes simplificadas para usu√°rios comuns e op√ß√µes avan√ßadas para" -ForegroundColor Gray
    Write-Host "usu√°rios experientes que desejam um controle mais detalhado sobre o sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Recursos ===" -ForegroundColor Yellow
    Write-Host "- Limpeza completa do sistema" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√£o de mem√≥ria e inicializa√ß√£o" -ForegroundColor Gray
    Write-Host "- Ajustes de rede para melhor conectividade" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√µes visuais para melhor desempenho" -ForegroundColor Gray
    Write-Host "- Configura√ß√µes espec√≠ficas para jogos" -ForegroundColor Gray
    Write-Host "- Manuten√ß√£o de seguran√ßa" -ForegroundColor Gray
    Write-Host "- Diagn√≥stico r√°pido do sistema" -ForegroundColor Gray
    Write-Host "- Mais de 100 ajustes e otimiza√ß√µes avan√ßadas" -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Aviso Legal ===" -ForegroundColor Yellow
    Write-Host "Este software √© fornecido 'como est√°', sem garantias de qualquer tipo." -ForegroundColor Gray
    Write-Host "O autor n√£o se responsabiliza por quaisquer danos ou problemas causados pelo uso" -ForegroundColor Gray
    Write-Host "deste software. Use por sua conta e risco. Recomendamos sempre fazer backup" -ForegroundColor Gray
    Write-Host "dos seus dados importantes antes de realizar otimiza√ß√µes no sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Agradecimentos ===" -ForegroundColor Yellow
    Write-Host "Obrigado por escolher o TORK para otimizar seu sistema Windows!" -ForegroundColor Gray
    Write-Host "Esperamos que esta ferramenta ajude a melhorar o desempenho do seu PC." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "¬© 2023-2024 Partner77 - Todos os direitos reservados" -ForegroundColor Cyan
    Write-Host ""
    
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - LIMPEZA (Expandidas) ---
function Invoke-CleanUserTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Usu√°rio ---" -ForegroundColor Cyan
    Write-Host "Remove arquivos da pasta tempor√°ria do seu usu√°rio (`$env:TEMP`)." -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:TEMP..." -ForegroundColor Yellow
    $tempFiles = Get-ChildItem -Path $env:TEMP -Recurse -ErrorAction SilentlyContinue
    $tempFilesCount = ($tempFiles | Measure-Object).Count
    $tempFilesSize = ($tempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $tempFilesCount arquivos tempor√°rios ocupando aproximadamente $([math]::Round($tempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Sistema ---" -ForegroundColor Gray
    Write-Host "Remove arquivos da pasta tempor√°ria do Windows (`$env:SystemRoot\Temp`)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:SystemRoot\Temp..." -ForegroundColor Yellow
    $systemTempFiles = Get-ChildItem -Path "$env:SystemRoot\Temp" -Recurse -ErrorAction SilentlyContinue
    $systemTempFilesCount = ($systemTempFiles | Measure-Object).Count
    $systemTempFilesSize = ($systemTempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $systemTempFilesCount arquivos tempor√°rios do sistema ocupando aproximadamente $([math]::Round($systemTempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do sistema removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanDnsCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-EmptyRecycleBin {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Esvaziar Lixeira ---" -ForegroundColor Gray
    Write-Host "Esvazia a lixeira do usu√°rio logado." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar tamanho da lixeira antes de esvaziar
    Write-Host "Verificando tamanho da lixeira..." -ForegroundColor Yellow
    
    try {
        $shell = New-Object -ComObject Shell.Application
        $recycleBin = $shell.Namespace(0xA)
        $recycleBinItems = $recycleBin.Items()
        $recycleBinItemCount = $recycleBinItems.Count
        
        Write-Host "A lixeira cont√©m $recycleBinItemCount itens." -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o conte√∫do da lixeira." -ForegroundColor DarkGray
    }
    
    # Esvaziar a lixeira
    Write-Host "Executando: Esvaziando a lixeira..." -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanThumbnailCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Miniaturas ---" -ForegroundColor Green
    Write-Host "Remove o cache de miniaturas de arquivos (imagens, v√≠deos, etc.)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Limpando cache de miniaturas..." -ForegroundColor Yellow
    
    # Verificar tamanho do cache de miniaturas antes da limpeza
    $thumbnailPath = "$env:LOCALAPPDATA\Microsoft\Windows\Explorer"
    $thumbnailFiles = Get-ChildItem -Path $thumbnailPath -Filter "thumbcache_*.db" -ErrorAction SilentlyContinue
    $thumbnailFilesCount = ($thumbnailFiles | Measure-Object).Count
    $thumbnailFilesSize = ($thumbnailFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $thumbnailFilesCount arquivos de cache de miniaturas ocupando aproximadamente $([math]::Round($thumbnailFilesSize, 2)) MB." -ForegroundColor White
    
    # Limpar o cache de miniaturas
    Stop-Process -Name explorer -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Start-Process explorer
    
    Write-Host "Cache de miniaturas limpo com sucesso!" -ForegroundColor Green
    Write-Host "O Windows Explorer foi reiniciado para aplicar as altera√ß√µes." -ForegroundColor DarkGray
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de miniaturas:" -ForegroundColor Cyan
    Write-Host "- Navega√ß√£o mais r√°pida em pastas com muitas imagens ou v√≠deos" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de miniaturas corrompidas ou desatualizadas" -ForegroundColor DarkGray
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemLogs {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Logs do Sistema ---" -ForegroundColor Cyan
    Write-Host "Limpa os logs de eventos do sistema para liberar espa√ßo e melhorar o desempenho." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando logs do sistema..." -ForegroundColor Yellow
    
    # Verificar tamanho dos logs antes da limpeza
    $eventLogs = Get-WinEvent -ListLog * -ErrorAction SilentlyContinue | Where-Object { $_.RecordCount -gt 0 }
    $totalLogCount = ($eventLogs | Measure-Object).Count
    $total = ($eventLogs | Measure-Object -Property FileSize -Sum).Sum / 1MB
    
    Write-Host "Encontrados $totalLogCount logs de eventos ocupando aproximadamente $([math]::Round($total, 2)) MB." -ForegroundColor White
    
    # Limpar os logs principais
    Write-Host "Limpando logs principais do sistema..." -ForegroundColor Yellow
    
    $mainLogs = @("Application", "System", "Security")
    foreach ($log in $mainLogs) {
        try {
            $logSize = (Get-WinEvent -ListLog $log -ErrorAction SilentlyContinue).FileSize / 1MB
            $logRecords = (Get-WinEvent -ListLog $log -ErrorAction SilentlyContinue).RecordCount
            
            Write-Host "Log $log: $([math]::Round($logSize, 2)) MB com $logRecords registros" -ForegroundColor DarkGray
            wevtutil cl $log
            Write-Host "Log $log limpo com sucesso!" -ForegroundColor Green
        } catch {
            Write-Host "N√£o foi poss√≠vel limpar o log $log." -ForegroundColor Red
        }
    }
    
    # Perguntar se deseja limpar todos os outros logs
    $confirmAllLogs = Read-Host "Deseja limpar todos os outros logs do sistema? (s/n)"
    
    if ($confirmAllLogs -eq 's') {
        Write-Host "Limpando todos os logs do sistema... (isso pode levar algum tempo)" -ForegroundColor Yellow
        
        $otherLogs = $eventLogs | Where-Object { $_.LogName -notin $mainLogs }
        foreach ($log in $otherLogs) {
            try {
                wevtutil cl $log.LogName
            } catch {
                # Ignorar erros silenciosamente
            }
        }
        
        Write-Host "Todos os logs do sistema foram limpos!" -ForegroundColor Green
    } else {
        Write-Host "Apenas os logs principais foram limpos." -ForegroundColor Green
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanWindowsUpdateCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Atualiza√ß√µes do Windows ---" -ForegroundColor Yellow
    Write-Host "Limpa os arquivos tempor√°rios de atualiza√ß√µes do Windows para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando cache de atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    
    # Verificar tamanho da pasta SoftwareDistribution antes da limpeza
    $updateCachePath = "$env:SystemRoot\SoftwareDistribution\Download"
    $updateCacheFiles = Get-ChildItem -Path $updateCachePath -Recurse -ErrorAction SilentlyContinue
    $updateCacheSize = ($updateCacheFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "O cache de atualiza√ß√µes do Windows est√° ocupando aproximadamente $([math]::Round($updateCacheSize, 2)) MB." -ForegroundColor White
    
    # Parar o servi√ßo Windows Update
    Write-Host "Parando o servi√ßo Windows Update..." -ForegroundColor DarkGray
    Stop-Service -Name wuauserv -Force -ErrorAction SilentlyContinue
    
    # Limpar o cache de atualiza√ß√µes
    Write-Host "Limpando o cache de atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    
    # Iniciar o servi√ßo Windows Update novamente
    Write-Host "Iniciando o servi√ßo Windows Update..." -ForegroundColor DarkGray
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    
    Write-Host "Cache de atualiza√ß√µes do Windows limpo com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de atualiza√ß√µes:" -ForegroundColor Cyan
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray
    Write-Host "- Resolu√ß√£o de problemas com atualiza√ß√µes do Windows" -ForegroundColor DarkGray
    Write-Host "- Melhoria no desempenho do sistema" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanHibernationFile {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos de Hiberna√ß√£o ---" -ForegroundColor White
    Write-Host "Gerencia o arquivo de hiberna√ß√£o (hiberfil.sys) para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar status atual da hiberna√ß√£o
    Write-Host "Verificando status atual da hiberna√ß√£o..." -ForegroundColor Yellow
    $hibernationStatus = powercfg.exe /availablesleepstates | Select-String -Pattern "Hiberna√ß√£o"
    
    if ($hibernationStatus -match "Hiberna√ß√£o est√° desativada") {
        $currentStatus = "desativada"
    } else {
        $currentStatus = "ativada"
    }
    
    Write-Host "Status atual da hiberna√ß√£o: $currentStatus" -ForegroundColor White
    
    # Verificar tamanho do arquivo de hiberna√ß√£o (se existir)
    $systemDrive = $env:SystemDrive
    $hiberfilPath = "$systemDrive\hiberfil.sys"
    
    if (Test-Path -Path $hiberfilPath -ErrorAction SilentlyContinue) {
        try {
            $hiberfilSize = (Get-Item -Path $hiberfilPath -Force -ErrorAction SilentlyContinue).Length / 1GB
            Write-Host "Tamanho do arquivo de hiberna√ß√£o: $([math]::Round($hiberfilSize, 2)) GB" -ForegroundColor White
        } catch {
            Write-Host "N√£o foi poss√≠vel determinar o tamanho do arquivo de hiberna√ß√£o." -ForegroundColor DarkGray
        }
    } else {
        Write-Host "Arquivo de hiberna√ß√£o n√£o encontrado (j√° est√° desativado)." -ForegroundColor DarkGray
    }
    
    # Perguntar se deseja desativar ou ativar a hiberna√ß√£o
    if ($currentStatus -eq "ativada") {
        $confirmHibernation = Read-Host "Deseja desativar a hiberna√ß√£o para liberar espa√ßo em disco? (s/n)"
        
        if ($confirmHibernation -eq 's') {
            Write-Host "Desativando a hiberna√ß√£o..." -ForegroundColor Yellow
            powercfg.exe /hibernate off
            Write-Host "Hiberna√ß√£o desativada com sucesso! O arquivo hiberfil.sys foi removido." -ForegroundColor Green
        } else {
            Write-Host "Hiberna√ß√£o mantida ativada." -ForegroundColor Green
        }
    } else {
        $confirmHibernation = Read-Host "Deseja ativar a hiberna√ß√£o? (s/n)"
        
        if ($confirmHibernation -eq 's') {
            Write-Host "Ativando a hiberna√ß√£o..." -ForegroundColor Yellow
            powercfg.exe /hibernate on
            Write-Host "Hiberna√ß√£o ativada com sucesso! O arquivo hiberfil.sys foi criado." -ForegroundColor Green
            
            # Verificar novo tamanho do arquivo de hiberna√ß√£o
            if (Test-Path -Path $hiberfilPath -ErrorAction SilentlyContinue) {
                try {
                    $newHiberfilSize = (Get-Item -Path $hiberfilPath -Force -ErrorAction SilentlyContinue).Length / 1GB
                    Write-Host "Tamanho do novo arquivo de hiberna√ß√£o: $([math]::Round($newHiberfilSize, 2)) GB" -ForegroundColor White
                } catch {
                    Write-Host "N√£o foi poss√≠vel determinar o tamanho do novo arquivo de hiberna√ß√£o." -ForegroundColor DarkGray
                }
            }
        } else {
            Write-Host "Hiberna√ß√£o mantida desativada." -ForegroundColor Green
        }
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo foi afetado:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nInforma√ß√µes sobre a hiberna√ß√£o:" -ForegroundColor Cyan
    Write-Host "- O arquivo de hiberna√ß√£o (hiberfil.sys) geralmente ocupa espa√ßo equivalente a 75% da RAM instalada" -ForegroundColor DarkGray
    Write-Host "- Desativar a hiberna√ß√£o libera esse espa√ßo, mas voc√™ n√£o poder√° usar o modo de hiberna√ß√£o" -ForegroundColor DarkGray
    Write-Host "- A hiberna√ß√£o √© √∫til para laptops, pois salva o estado do sistema no disco antes de desligar" -ForegroundColor DarkGray
    Write-Host "- Para desktops, a hiberna√ß√£o geralmente √© menos necess√°ria" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanWinSxS {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Pasta WinSxS ---" -ForegroundColor Magenta
    Write-Host "Limpa componentes n√£o utilizados da pasta WinSxS para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "A pasta WinSxS (Windows Side-by-Side) armazena componentes do sistema e pode ocupar muito espa√ßo." -ForegroundColor White
    Write-Host "Esta limpeza √© segura e usa ferramentas oficiais do Windows para remover componentes n√£o utilizados." -ForegroundColor White
    Write-Host ""
    
    # Verificar tamanho da pasta WinSxS antes da limpeza
    Write-Host "Verificando tamanho da pasta WinSxS (isso pode levar algum tempo)..." -ForegroundColor Yellow
    
    try {
        $winSxSSize = (Get-ChildItem -Path "$env:SystemRoot\WinSxS" -Recurse -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum / 1GB
        Write-Host "Tamanho atual da pasta WinSxS: $([math]::Round($winSxSSize, 2)) GB" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel determinar o tamanho da pasta WinSxS." -ForegroundColor DarkGray
    }
    
    # Perguntar se deseja prosseguir com a limpeza
    $confirmCleanup = Read-Host "Deseja prosseguir com a limpeza da pasta WinSxS? (s/n)"
    
    if ($confirmCleanup -eq 's') {
        Write-Host "Executando limpeza de componentes n√£o utilizados (isso pode levar v√°rios minutos)..." -ForegroundColor Yellow
        
        # Executar limpeza de componentes
        Write-Host "Etapa 1: Limpeza de componentes..." -ForegroundColor DarkGray
        Dism.exe /Online /Cleanup-Image /StartComponentCleanup
        
        # Perguntar se deseja executar limpeza mais agressiva (com reset base)
        $confirmResetBase = Read-Host "Deseja executar uma limpeza mais profunda? (remove a capacidade de desinstalar atualiza√ß√µes) (s/n)"
        
        if ($confirmResetBase -eq 's') {
            Write-Host "Etapa 2: Executando limpeza profunda (isso pode levar muito tempo)..." -ForegroundColor DarkGray
            Dism.exe /Online /Cleanup-Image /StartComponentCleanup /ResetBase
            Write-Host "Limpeza profunda conclu√≠da!" -ForegroundColor Green
        }
        
        Write-Host "Limpeza da pasta WinSxS conclu√≠da com sucesso!" -ForegroundColor Green
        
        # Verificar tamanho da pasta WinSxS ap√≥s a limpeza
        try {
            $newWinSxSSize = (Get-ChildItem -Path "$env:SystemRoot\WinSxS" -Recurse -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum / 1GB
            $savedSpace = $winSxSSize - $newWinSxSSize
            
            Write-Host "Tamanho atual da pasta WinSxS: $([math]::Round($newWinSxSSize, 2)) GB" -ForegroundColor White
            Write-Host "Espa√ßo liberado: $([math]::Round($savedSpace, 2)) GB" -ForegroundColor Green
        } catch {
            Write-Host "N√£o foi poss√≠vel determinar o novo tamanho da pasta WinSxS." -ForegroundColor DarkGray
        }
    } else {
        Write-Host "Limpeza da pasta WinSxS cancelada." -ForegroundColor Yellow
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nInforma√ß√µes sobre a pasta WinSxS:" -ForegroundColor Cyan
    Write-Host "- A pasta WinSxS armazena componentes do sistema Windows e atualiza√ß√µes" -ForegroundColor DarkGray
    Write-Host "- N√£o √© recomendado excluir esta pasta manualmente" -ForegroundColor DarkGray
    Write-Host "- A limpeza realizada √© segura e usa ferramentas oficiais do Windows" -ForegroundColor DarkGray
    Write-Host "- Ap√≥s a limpeza profunda, n√£o ser√° poss√≠vel desinstalar algumas atualiza√ß√µes" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - REDE (Expandidas) ---
function Invoke-NetworkFlushDns {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Limpar Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-NetworkChangeDns {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Mudar Servidor DNS ---" -ForegroundColor Cyan
    Write-Host "Permite definir servidores DNS personalizados para suas conex√µes de rede." -ForegroundColor DarkGray
    Write-Host ""

    # Listar adaptadores de rede ativos
    Write-Host "Listando adaptadores de rede ativos..." -ForegroundColor Yellow
    $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" }
    
    if ($networkAdapters.Count -eq 0) {
        Write-Host "Nenhum adaptador de rede ativo encontrado." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    Write-Host "Adaptadores de rede ativos:" -ForegroundColor White
    $index = 1
    foreach ($adapter in $networkAdapters) {
        Write-Host "[$index] $($adapter.Name) - $($adapter.InterfaceDescription)" -ForegroundColor White
        $index++
    }
    Write-Host ""
    
    # Selecionar adaptador de rede
    $adapterChoice = Read-Host "Selecione o n√∫mero do adaptador que deseja configurar (ou 0 para voltar)"
    
    if ($adapterChoice -eq "0" -or $adapterChoice -eq "") {
        Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    $adapterIndex = [int]$adapterChoice - 1
    if ($adapterIndex -lt 0 -or $adapterIndex -ge $networkAdapters.Count) {
        Write-Host "Sele√ß√£o inv√°lida." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    $selectedAdapter = $networkAdapters[$adapterIndex]
    
    # Mostrar configura√ß√£o DNS atual
    Write-Host "Configura√ß√£o DNS atual para $($selectedAdapter.Name):" -ForegroundColor Yellow
    $currentDns = Get-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -AddressFamily IPv4 | Select-Object -ExpandProperty ServerAddresses
    
    if ($currentDns.Count -eq 0) {
        Write-Host "Nenhum servidor DNS configurado manualmente (usando DHCP)." -ForegroundColor DarkGray
    } else {
        foreach ($dns in $currentDns) {
            Write-Host $dns -ForegroundColor White
        }
    }
    Write-Host ""
    
    # Op√ß√µes de DNS
    Write-Host "Op√ß√µes de DNS:" -ForegroundColor Yellow
    Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
    Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
    Write-Host "[3] OpenDNS (208.67.222.222, 208.67.220.220)" -ForegroundColor White
    Write-Host "[4] Quad9 (9.9.9.9, 149.112.112.112)" -ForegroundColor White
    Write-Host "[5] AdGuard DNS (94.140.14.14, 94.140.15.15)" -ForegroundColor White
    Write-Host "[6] Inserir DNS personalizado" -ForegroundColor White
    Write-Host "[7] Usar DNS autom√°tico (DHCP)" -ForegroundColor White
    Write-Host "[0] Cancelar" -ForegroundColor White
    Write-Host ""
    
    $dnsChoice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($dnsChoice) {
        "1" {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            $dnsName = "Google DNS"
        }
        "2" {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            $dnsName = "Cloudflare DNS"
        }
        "3" {
            $primaryDns = "208.67.222.222"
            $secondaryDns = "208.67.220.220"
            $dnsName = "OpenDNS"
        }
        "4" {
            $primaryDns = "9.9.9.9"
            $secondaryDns = "149.112.112.112"
            $dnsName = "Quad9"
        }
        "5" {
            $primaryDns = "94.140.14.14"
            $secondaryDns = "94.140.15.15"
            $dnsName = "AdGuard DNS"
        }
        "6" {
            $primaryDns = Read-Host "Digite o endere√ßo do DNS prim√°rio"
            $secondaryDns = Read-Host "Digite o endere√ßo do DNS secund√°rio (ou deixe em branco)"
            $dnsName = "DNS Personalizado"
        }
        "7" {
            Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ResetServerAddresses
            Write-Host "Configura√ß√£o de DNS definida para autom√°tica (DHCP)." -ForegroundColor Green
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
        "0" {
            Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
        default {
            Write-Host "Op√ß√£o inv√°lida." -ForegroundColor Red
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
    }
    
    # Aplicar configura√ß√£o de DNS
    if ($secondaryDns -eq "") {
        Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ServerAddresses $primaryDns
    } else {
        Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ServerAddresses $primaryDns, $secondaryDns
    }
    
    Write-Host "Configura√ß√£o de DNS alterada para $dnsName." -ForegroundColor Green
    Write-Host "DNS Prim√°rio: $primaryDns" -ForegroundColor White
    if ($secondaryDns -ne "") {
        Write-Host "DNS Secund√°rio: $secondaryDns" -ForegroundColor White
    }
    
    # Limpar cache DNS ap√≥s a mudan√ßa
    Write-Host "Limpando cache DNS para aplicar as altera√ß√µes..." -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo." -ForegroundColor Green
    
    Write-Host "`nBenef√≠cios de usar servidores DNS alternativos:" -ForegroundColor Cyan
    Write-Host "- Maior velocidade de resolu√ß√£o de nomes" -ForegroundColor DarkGray
    Write-Host "- Melhor confiabilidade e disponibilidade" -ForegroundColor DarkGray
    Write-Host "- Alguns servidores oferecem prote√ß√£o adicional contra malware e phishing" -ForegroundColor DarkGray
    Write-Host "- Possibilidade de contornar bloqueios de conte√∫do baseados em DNS" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-NetworkReset {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Resetar Configura√ß√µes de Rede ---" -ForegroundColor White
    Write-Host "Reinicia os componentes de rede. Use como √∫ltimo recurso para solucionar problemas de conex√£o." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "!!! ATEN√á√ÉO: ESTE COMANDO VAI REINICIAR SUAS CONFIGURA√á√ïES DE REDE !!!" -ForegroundColor Red
    Write-Host "Sua conex√£o ser√° interrompida temporariamente e todas as configura√ß√µes de rede personalizadas ser√£o redefinidas." -ForegroundColor Yellow
    Write-Host "Isso inclui adaptadores de rede, configura√ß√µes de DNS, configura√ß√µes de proxy, etc." -ForegroundColor Yellow
    Write-Host ""
    
    Write-Host "Esta opera√ß√£o pode ajudar a resolver os seguintes problemas:" -ForegroundColor Cyan
    Write-Host "- Conex√µes de rede inst√°veis ou intermitentes" -ForegroundColor DarkGray
    Write-Host "- Problemas de DNS ou resolu√ß√£o de nomes" -ForegroundColor DarkGray
    Write-Host "- Problemas de conectividade ap√≥s instala√ß√£o de software ou atualiza√ß√µes" -ForegroundColor DarkGray
    Write-Host "- Erros de rede persistentes que n√£o s√£o resolvidos por outros m√©todos" -ForegroundColor DarkGray
    Write-Host ""
    
    $confirm = Read-Host "Tem certeza que deseja resetar as configura√ß√µes de rede? (digite 'sim' para confirmar)"
    
    if ($confirm -eq 'sim') {
        Write-Host "Iniciando reset de configura√ß√µes de rede..." -ForegroundColor Yellow
        
        # Etapa 1: Resetar pilha TCP/IP
        Write-Host "Etapa 1: Resetando pilha TCP/IP..." -ForegroundColor DarkGray
        netsh int ip reset
        
        # Etapa 2: Resetar cat√°logo Winsock
        Write-Host "Etapa 2: Resetando cat√°logo Winsock..." -ForegroundColor DarkGray
        netsh winsock reset
        
        # Etapa 3: Limpar cache DNS
        Write-Host "Etapa 3: Limpando cache DNS..." -ForegroundColor DarkGray
        ipconfig /flushdns
        
        # Etapa 4: Renovar configura√ß√µes DHCP
        Write-Host "Etapa 4: Renovando configura√ß√µes DHCP..." -ForegroundColor DarkGray
        ipconfig /release
        ipconfig /renew
        
        # Etapa 5: Reiniciar adaptadores de rede
        Write-Host "Etapa 5: Reiniciando adaptadores de rede..." -ForegroundColor DarkGray
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        
        Write-Host "Reset de configura√ß√µes de rede conclu√≠do!" -ForegroundColor Green
        Write-Host "Recomenda-se reiniciar o computador para aplicar todas as altera√ß√µes." -ForegroundColor Yellow
        
        $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (s/n)"
        if ($confirmRestart -eq 's') {
            Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
            Restart-Computer -Force
        } else {
            Write-Host "Rein√≠cio cancelado. Algumas altera√ß√µes podem n√£o ter efeito at√© que o computador seja reiniciado." -ForegroundColor Yellow
        }
    } else {
        Write-Host "Reset de configura√ß√µes de rede cancelado." -ForegroundColor Green
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-OptimizeTcpIp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Otimizar Configura√ß√µes TCP/IP ---" -ForegroundColor Green
    Write-Host "Ajusta configura√ß√µes avan√ßadas do TCP/IP para melhorar o desempenho da conex√£o." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o otimiza v√°rios par√¢metros TCP/IP para melhorar a velocidade e estabilidade da conex√£o." -ForegroundColor White
    Write-Host "As otimiza√ß√µes s√£o seguras e podem ser revertidas se necess√°rio." -ForegroundColor White
    Write-Host ""
    
    Write-Host "Configura√ß√µes atuais:" -ForegroundColor Yellow
    
    # Mostrar configura√ß√µes atuais
    Write-Host "Auto-Tuning Level:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Auto-Tuning Level"
    
    Write-Host "Congestion Provider:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Congestion Control Provider"
    
    Write-Host "ECN Capability:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "ECN Capability"
    
    Write-Host "Receive-Side Scaling (RSS):" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Receive-Side Scaling State"
    
    Write-Host ""
    $confirm = Read-Host "Deseja aplicar otimiza√ß√µes TCP/IP recomendadas? (s/n)"
    
    if ($confirm -eq 's') {
        Write-Host "Aplicando otimiza√ß√µes TCP/IP..." -ForegroundColor Yellow
        
        # Otimiza√ß√£o 1: Habilitar TCP Window Auto-Tuning
        Write-Host "Configurando TCP Auto-Tuning para 'normal'..." -ForegroundColor DarkGray
        netsh int tcp set global autotuninglevel=normal
        
        # Otimiza√ß√£o 2: Habilitar Receive-Side Scaling (RSS)
        Write-Host "Habilitando Receive-Side Scaling (RSS)..." -ForegroundColor DarkGray
        netsh int tcp set global rss=enabled
        
        # Otimiza√ß√£o 3: Configurar Congestion Provider para CTCP
        Write-Host "Configurando Congestion Provider para 'ctcp'..." -ForegroundColor DarkGray
        netsh int tcp set global congestionprovider=ctcp
        
        # Otimiza√ß√£o 4: Habilitar ECN Capability
        Write-Host "Habilitando ECN Capability..." -ForegroundColor DarkGray
        netsh int tcp set global ecncapability=enabled
        
        # Otimiza√ß√£o 5: Configurar NetDMA (se dispon√≠vel)
        Write-Host "Tentando configurar NetDMA..." -ForegroundColor DarkGray
        netsh int tcp set global netdma=enabled
        
        # Otimiza√ß√£o 6: Configurar tamanho de buffer TCP
        Write-Host "Configurando tamanho de buffer TCP..." -ForegroundColor DarkGray
        netsh int tcp set global chimney=enabled
        
        # Otimiza√ß√£o 7: Configurar QoS
        Write-Host "Configurando QoS..." -ForegroundColor DarkGray
        netsh int tcp set global timestamps=disabled
        
        Write-Host "Otimiza√ß√µes TCP/IP aplicadas com sucesso!" -ForegroundColor Green
        
        Write-Host "`nNovas configura√ß√µes:" -ForegroundColor Yellow
        
        # Mostrar novas configura√ß√µes
        Write-Host "Auto-Tuning Level:" -ForegroundColor DarkGray
        netsh int tcp show global | Select-String "Auto-Tuning Level"
        
        Write-Host "Congestion Provider:" -ForegroundColor DarkGray
        netsh int tcp show global | Select-String "Congestion Control Provider"
        
        Write-Host "ECN Capability:" -ForegroundColor DarkGray
        netsh int tcp show global | Select-String "ECN Capability"
        
        Write-Host "Receive-Side Scaling (RSS):" -ForegroundColor DarkGray
        netsh int tcp show global | Select-String "Receive-Side Scaling State"
        
        Write-Host "`nBenef√≠cios das otimiza√ß√µes TCP/IP:" -ForegroundColor Cyan
        Write-Host "- Melhor aproveitamento da largura de banda dispon√≠vel" -ForegroundColor DarkGray
        Write-Host "- Redu√ß√£o da lat√™ncia em conex√µes de internet" -ForegroundColor DarkGray
        Write-Host "- Melhor desempenho em downloads e uploads" -ForegroundColor DarkGray
        Write-Host "- Conex√µes mais est√°veis em redes congestionadas" -ForegroundColor DarkGray
        
        Write-Host "`nNota: Algumas altera√ß√µes podem requerer reinicializa√ß√£o para ter efeito completo." -ForegroundColor Yellow
        $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (s/n)"
        
        if ($confirmRestart -eq 's') {
            Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
            Restart-Computer -Force
        }
    } else {
        Write-Host "Otimiza√ß√µes TCP/IP canceladas." -ForegroundColor Yellow
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-CheckNetworkSpeed {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Verificar Velocidade da Conex√£o ---" -ForegroundColor Magenta
    Write-Host "Realiza testes para verificar a velocidade e qualidade da sua conex√£o com a internet." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o realiza testes b√°sicos para avaliar a velocidade e qualidade da sua conex√£o." -ForegroundColor White
    Write-Host "Nota: Para testes de velocidade mais precisos, recomendamos usar sites especializados como speedtest.net" -ForegroundColor White
    Write-Host ""
    
    # Teste 1: Verificar conectividade b√°sica
    Write-Host "Teste 1: Verificando conectividade b√°sica com a internet..." -ForegroundColor Yellow
    $pingGoogle = Test-Connection -ComputerName google.com -Count 4 -ErrorAction SilentlyContinue
    
    if ($pingGoogle) {
        $avgLatency = ($pingGoogle | Measure-Object -Property ResponseTime -Average).Average
        $maxLatency = ($pingGoogle | Measure-Object -Property ResponseTime -Maximum).Maximum
        $minLatency = ($pingGoogle | Measure-Object -Property ResponseTime -Minimum).Minimum
        
        Write-Host "Conectividade: OK" -ForegroundColor Green
        Write-Host "Lat√™ncia m√©dia: $avgLatency ms" -ForegroundColor $(if ($avgLatency -lt 50) { "Green" } elseif ($avgLatency -lt 100) { "Yellow" } else { "Red" })
        Write-Host "Lat√™ncia m√≠nima: $minLatency ms" -ForegroundColor Green
        Write-Host "Lat√™ncia m√°xima: $maxLatency ms" -ForegroundColor $(if ($maxLatency -lt 100) { "Green" } elseif ($maxLatency -lt 200) { "Yellow" } else { "Red" })
        
        # Avalia√ß√£o da qualidade da conex√£o
        if ($avgLatency -lt 30) {
            $qualidade = "Excelente"
            $cor = "Green"
        } elseif ($avgLatency -lt 60) {
            $qualidade = "Boa"
            $cor = "Green"
        } elseif ($avgLatency -lt 100) {
            $qualidade = "Razo√°vel"
            $cor = "Yellow"
        } else {
            $qualidade = "Ruim"
            $cor = "Red"
        }
        
        Write-Host "Qualidade da conex√£o: $qualidade" -ForegroundColor $cor
    } else {
        Write-Host "N√£o foi poss√≠vel conectar √† internet. Verifique sua conex√£o." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    Write-Host ""
    
    # Teste 2: Verificar resolu√ß√£o DNS
    Write-Host "Teste 2: Verificando velocidade de resolu√ß√£o DNS..." -ForegroundColor Yellow
    $domains = @("google.com", "microsoft.com", "amazon.com", "facebook.com", "youtube.com")
    $dnsResults = @()
    
    foreach ($domain in $domains) {
        $startTime = Get-Date
        try {
            $null = Resolve-DnsName -Name $domain -ErrorAction SilentlyContinue
            $endTime = Get-Date
            $timeSpan = New-TimeSpan -Start $startTime -End $endTime
            $dnsResults += [PSCustomObject]@{
                Domain = $domain
                Time = $timeSpan.TotalMilliseconds
                Status = "OK"
            }
        } catch {
            $dnsResults += [PSCustomObject]@{
                Domain = $domain
                Time = 0
                Status = "Falha"
            }
        }
    }
    
    $dnsResults | Format-Table -AutoSize
    
    $avgDnsTime = ($dnsResults | Where-Object { $_.Status -eq "OK" } | Measure-Object -Property Time -Average).Average
    Write-Host "Tempo m√©dio de resolu√ß√£o DNS: $([math]::Round($avgDnsTime, 2)) ms" -ForegroundColor $(if ($avgDnsTime -lt 50) { "Green" } elseif ($avgDnsTime -lt 100) { "Yellow" } else { "Red" })
    
    Write-Host ""
    
    # Teste 3: Verificar MTU
    Write-Host "Teste 3: Verificando MTU (Maximum Transmission Unit)..." -ForegroundColor Yellow
    
    $activeAdapter = Get-NetAdapter | Where-Object { $_.Status -eq "Up" } | Select-Object -First 1
    if ($activeAdapter) {
        $mtu = Get-NetIPInterface -InterfaceIndex $activeAdapter.ifIndex -AddressFamily IPv4 | Select-Object -ExpandProperty NlMtu
        Write-Host "MTU atual: $mtu bytes" -ForegroundColor White
        
        if ($mtu -eq 1500) {
            Write-Host "MTU est√° no valor padr√£o (1500), que √© ideal para a maioria das conex√µes." -ForegroundColor Green
        } elseif ($mtu -lt 1500) {
            Write-Host "MTU est√° abaixo do valor padr√£o. Isso pode afetar o desempenho em algumas situa√ß√µes." -ForegroundColor Yellow
        } else {
            Write-Host "MTU est√° acima do valor padr√£o. Isso pode causar fragmenta√ß√£o de pacotes em algumas redes." -ForegroundColor Yellow
        }
    } else {
        Write-Host "N√£o foi poss√≠vel determinar o MTU. Nenhum adaptador de rede ativo encontrado." -ForegroundColor Red
    }
    
    Write-Host ""
    
    # Teste 4: Verificar perda de pacotes
    Write-Host "Teste 4: Verificando perda de pacotes..." -ForegroundColor Yellow
    $packetLossTest = Test-Connection -ComputerName google.com -Count 50 -ErrorAction SilentlyContinue
    
    if ($packetLossTest) {
        $packetsSent = 50
        $packetsReceived = ($packetLossTest | Measure-Object).Count
        $packetsLost = $packetsSent - $packetsReceived
        $packetLossPercentage = ($packetsLost / $packetsSent) * 100
        
        Write-Host "Pacotes enviados: $packetsSent" -ForegroundColor White
        Write-Host "Pacotes recebidos: $packetsReceived" -ForegroundColor White
        Write-Host "Pacotes perdidos: $packetsLost" -ForegroundColor $(if ($packetsLost -eq 0) { "Green" } elseif ($packetsLost -lt 5) { "Yellow" } else { "Red" })
        Write-Host "Percentual de perda: $([math]::Round($packetLossPercentage, 2))%" -ForegroundColor $(if ($packetLossPercentage -eq 0) { "Green" } elseif ($packetLossPercentage -lt 10) { "Yellow" } else { "Red" })
        
        # Avalia√ß√£o da qualidade da conex√£o baseada na perda de pacotes
        if ($packetLossPercentage -eq 0) {
            Write-Host "Qualidade da conex√£o (perda de pacotes): Excelente" -ForegroundColor Green
        } elseif ($packetLossPercentage -lt 2) {
            Write-Host "Qualidade da conex√£o (perda de pacotes): Boa" -ForegroundColor Green
        } elseif ($packetLossPercentage -lt 5) {
            Write-Host "Qualidade da conex√£o (perda de pacotes): Razo√°vel" -ForegroundColor Yellow
        } else {
            Write-Host "Qualidade da conex√£o (perda de pacotes): Ruim" -ForegroundColor Red
        }
    } else {
        Write-Host "N√£o foi poss√≠vel realizar o teste de perda de pacotes." -ForegroundColor Red
    }
    
    Write-Host ""
    
    # Resumo e recomenda√ß√µes
    Write-Host "=== Resumo da An√°lise de Rede ===" -ForegroundColor Cyan
    
    # Recomenda√ß√µes baseadas nos resultados
    Write-Host "Recomenda√ß√µes:" -ForegroundColor Yellow
    
    if ($avgLatency -gt 100) {
        Write-Host "- Sua lat√™ncia est√° alta. Considere verificar outros dispositivos na rede ou contatar seu provedor." -ForegroundColor Yellow
    }
    
    if ($avgDnsTime -gt 100) {
        Write-Host "- A resolu√ß√£o DNS est√° lenta. Considere mudar para servidores DNS mais r√°pidos como Google (8.8.8.8) ou Cloudflare (1.1.1.1)." -ForegroundColor Yellow
    }
    
    if ($packetLossPercentage -gt 2) {
        Write-Host "- H√° perda significativa de pacotes. Verifique sua conex√£o f√≠sica ou contate seu provedor." -ForegroundColor Yellow
    }
    
    if ($mtu -ne 1500 -and $mtu -ne 0) {
        Write-Host "- Seu MTU n√£o est√° no valor padr√£o. Considere ajust√°-lo para 1500 para melhor desempenho." -ForegroundColor Yellow
    }
    
    if ($avgLatency -le 100 -and $avgDnsTime -le 100 -and $packetLossPercentage -le 2) {
        Write-Host "- Sua conex√£o parece estar em boas condi√ß√µes! N√£o h√° problemas significativos detectados." -ForegroundColor Green
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-ConfigureQoS {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Configurar QoS (Qualidade de Servi√ßo) ---" -ForegroundColor Gray
    Write-Host "Configura prioridades de tr√°fego de rede para melhorar o desempenho de aplica√ß√µes espec√≠ficas." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "O QoS (Quality of Service) permite priorizar certos tipos de tr√°fego de rede sobre outros." -ForegroundColor White
    Write-Host "Isso √© √∫til para garantir que aplica√ß√µes importantes como jogos, chamadas de v√≠deo ou streaming" -ForegroundColor White
    Write-Host "tenham prioridade sobre downloads ou atualiza√ß√µes em segundo plano." -ForegroundColor White
    Write-Host ""
    
    Write-Host "Op√ß√µes de configura√ß√£o de QoS:" -ForegroundColor Yellow
    Write-Host "[1] Configurar QoS para Jogos (prioriza tr√°fego de jogos)" -ForegroundColor White
    Write-Host "[2] Configurar QoS para Videoconfer√™ncia (prioriza Zoom, Teams, etc.)" -ForegroundColor White
    Write-Host "[3] Configurar QoS para Streaming (prioriza Netflix, YouTube, etc.)" -ForegroundColor White
    Write-Host "[4] Configurar QoS Personalizado" -ForegroundColor White
    Write-Host "[5] Desativar QoS" -ForegroundColor White
    Write-Host "[0] Voltar" -ForegroundColor White
    Write-Host ""
    
    $qosChoice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($qosChoice) {
        "1" {
            Write-Host "Configurando QoS para Jogos..." -ForegroundColor Yellow
            
            # Criar pol√≠tica de QoS para jogos
            Write-Host "Criando pol√≠tica de QoS para jogos..." -ForegroundColor DarkGray
            
            # Verificar se o servi√ßo QoS est√° em execu√ß√£o
            $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            if ($qosService -and $qosService.Status -ne "Running") {
                Write-Host "Iniciando servi√ßo QoS RSVP..." -ForegroundColor DarkGray
                Start-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            }
            
            # Configurar QoS para jogos usando netsh
            netsh advfirewall firewall add rule name="QoS-Games" dir=out action=allow protocol=UDP remoteport=3074,3478,3479,3480 enable=yes
            
            # Configurar prioridade para jogos
            if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS")) {
                New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Force | Out-Null
            }
            
            # Adicionar pol√≠tica para jogos
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Application Name" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Protocol" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Remote Port" -Value "3074,3478-3480" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "DSCP Value" -Value "46" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Throttle Rate" -Value "-1" -Type String
            
            Write-Host "QoS para Jogos configurado com sucesso!" -ForegroundColor Green
            Write-Host "Os jogos online agora ter√£o prioridade sobre outros tipos de tr√°fego." -ForegroundColor Green
        }
        "2" {
            Write-Host "Configurando QoS para Videoconfer√™ncia..." -ForegroundColor Yellow
            
            # Criar pol√≠tica de QoS para videoconfer√™ncia
            Write-Host "Criando pol√≠tica de QoS para videoconfer√™ncia..." -ForegroundColor DarkGray
            
            # Verificar se o servi√ßo QoS est√° em execu√ß√£o
            $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            if ($qosService -and $qosService.Status -ne "Running") {
                Write-Host "Iniciando servi√ßo QoS RSVP..." -ForegroundColor DarkGray
                Start-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            }
            
            # Configurar QoS para videoconfer√™ncia usando netsh
            netsh advfirewall firewall add rule name="QoS-VideoConference" dir=out action=allow protocol=UDP remoteport=3478-3479,8801-8810 enable=yes
            
            # Configurar prioridade para videoconfer√™ncia
            if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS")) {
                New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Force | Out-Null
            }
            
            # Adicionar pol√≠tica para Zoom
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Application Name" -Value "Zoom.exe" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Protocol" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Remote Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "DSCP Value" -Value "46" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Throttle Rate" -Value "-1" -Type String
            
            # Adicionar pol√≠tica para Teams
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Application Name" -Value "Teams.exe" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Protocol" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Remote Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "DSCP Value" -Value "46" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Throttle Rate" -Value "-1" -Type String
            
            Write-Host "QoS para Videoconfer√™ncia configurado com sucesso!" -ForegroundColor Green
            Write-Host "Aplicativos como Zoom e Teams agora ter√£o prioridade sobre outros tipos de tr√°fego." -ForegroundColor Green
        }
        "3" {
            Write-Host "Configurando QoS para Streaming..." -ForegroundColor Yellow
            
            # Criar pol√≠tica de QoS para streaming
            Write-Host "Criando pol√≠tica de QoS para streaming..." -ForegroundColor DarkGray
            
            # Verificar se o servi√ßo QoS est√° em execu√ß√£o
            $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            if ($qosService -and $qosService.Status -ne "Running") {
                Write-Host "Iniciando servi√ßo QoS RSVP..." -ForegroundColor DarkGray
                Start-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            }
            
            # Configurar QoS para streaming usando netsh
            netsh advfirewall firewall add rule name="QoS-Streaming" dir=out action=allow protocol=TCP remoteport=80,443 enable=yes
            
            # Configurar prioridade para streaming
            if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS")) {
                New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Force | Out-Null
            }
            
            # Adicionar pol√≠tica para navegadores (streaming)
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Application Name" -Value "*.exe" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Protocol" -Value "TCP" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Remote Port" -Value "80,443" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "DSCP Value" -Value "34" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Throttle Rate" -Value "-1" -Type String
            
            Write-Host "QoS para Streaming configurado com sucesso!" -ForegroundColor Green
            Write-Host "Servi√ßos de streaming como Netflix e YouTube agora ter√£o prioridade sobre outros tipos de tr√°fego." -ForegroundColor Green
        }
        "4" {
            Write-Host "Configurando QoS Personalizado..." -ForegroundColor Yellow
            
            # Solicitar informa√ß√µes para QoS personalizado
            $appName = Read-Host "Digite o nome do aplicativo (ex: chrome.exe, ou * para todos)"
            $protocol = Read-Host "Digite o protocolo (TCP, UDP, ou * para ambos)"
            $remotePorts = Read-Host "Digite as portas remotas (ex: 80,443, ou * para todas)"
            $priority = Read-Host "Digite o valor de prioridade DSCP (0-63, recomendado: 46 para alta prioridade)"
            
            # Verificar se o servi√ßo QoS est√° em execu√ß√£o
            $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            if ($qosService -and $qosService.Status -ne "Running") {
                Write-Host "Iniciando servi√ßo QoS RSVP..." -ForegroundColor DarkGray
                Start-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            }
            
            # Configurar QoS personalizado
            if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS")) {
                New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Force | Out-Null
            }
            
            # Adicionar pol√≠tica personalizada
            $policyName = "CustomQoS_" + (Get-Random)
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Application Name" -Value $appName -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Protocol" -Value $protocol -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Remote Port" -Value $remotePorts -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "DSCP Value" -Value $priority -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Throttle Rate" -Value "-1" -Type String
            
            Write-Host "QoS Personalizado configurado com sucesso!" -ForegroundColor Green
            Write-Host "A pol√≠tica de QoS personalizada foi criada com o nome: $policyName" -ForegroundColor Green
        }
        "5" {
            Write-Host "Desativando QoS..." -ForegroundColor Yellow
            
            # Remover pol√≠ticas de QoS
            if (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS") {
                Remove-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Recurse -Force
                Write-Host "Pol√≠ticas de QoS removidas." -ForegroundColor Green
            }
            
            # Remover regras de firewall relacionadas a QoS
            netsh advfirewall firewall delete rule name="QoS-Games"
            netsh advfirewall firewall delete rule name="QoS-VideoConference"
            netsh advfirewall firewall delete rule name="QoS-Streaming"
            
            # Parar servi√ßo QoS
            $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            if ($qosService) {
                Stop-Service -Name "QoS RSVP" -Force -ErrorAction SilentlyContinue
                Set-Service -Name "QoS RSVP" -Startup### Enhanced TORK Optimizer

I'll enhance the TORK optimizer with more comprehensive functionality across all features, starting with an expanded Simple Cleanup function and then improving all other options.

```powershell type="code"
# Define a preferencia de acao para erros (continua a execucao por padrao)
# Permite que o script tente rodar o m√°ximo poss√≠vel mesmo que alguns comandos encontrem problemas.
$ErrorActionPreference = 'SilentlyContinue' # N√£o exibe erros se um item n√£o puder ser processado, por exemplo.

# --- Funcao pra Centralizar Texto (Nosso Maestro de Alinhamento - s√≥ pra textos, n√£o pro bannerz√£o!) ---
# Deixa ela aqui, vai que a gente usa pra centralizar outra coisa, n√©?
function Centraliza($texto, $cor="White") {
    $largura = [console]::WindowWidth # Pega a largura da largura da janela agora
    # Calcula o espa√ßo pra botar o texto no meio. Pura matem√°tica da zoeira!
    $espacos = [Math]::Max(0, [Math]::Floor(($largura - $texto.Length) / 2))
    $linha = (" " * $espacos) + $texto # Cria a linha com os espa√ßos e o texto
    Write-Host $linha -ForegroundColor $cor # Manda pro console com a cor pedida
}

# --- Funcao que Desenha o Nosso Banner Irado do TORK! ---
# Esse √© o nosso outdoor digital no console! Ajustado pros espa√ßos que voc√™ mandou!
# Se as bordas ainda estiverem meio teimosas, √© o jeitinho do console mesmo, viu? üòâ
function Banner-TORK {
    # Nossas cores vibrantes para o banner!
    $CorBorda = "DarkCyan" # Mantido para a borda, combina com o ciano. Se quiser mudar, √© aqui!
    $CorLogo = "Green" # Cor vibrante
    $CorProjeto = "Cyan" # Cor vibrante
    $CorCopyright = "Gray" # Tom mais suave

    Write-Host "" # D√° um espacinho no topo, pra n√£o grudar
    Write-Host "                    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë          ‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë ‚ñà‚ñà‚ïî‚ïù                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ñà‚ñà‚ïó                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù                                          ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë           Bem-vindo ao TORK - Otimizador para Windows!                                ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë        Projeto de automacao, limpeza, manutencao e tweaks.                            ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë            (C) Partner77 - Todos os direitos reservados                               ‚ïë" -ForegroundColor $CorCopyright
    Write-Host "                    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor $CorBorda
    Write-Host "" # Espa√ßo embaixo
}

# --- Checagem de Permiss√µes de Administrador (O Guarda da Porta!) ---
# V√™ se a gente t√° rodando com poderes de admin, sen√£o n√£o d√° pra mexer no Windows direito.
function Test-Administrator {
    $currentUser = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())
    return $currentUser.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
}

if (-not (Test-Administrator)) {
    Write-Host "OPA! Calma l√°, patr√£o!" -ForegroundColor Red
    Write-Host "Pra usar o TORK e deixar o PC voando, preciso de super poderes de Administrador!" -ForegroundColor Yellow
    Write-Host "Fecha essa janela, clica com o bot√£o direito no arquivo do script e escolhe 'Executar como administrador'. A√≠ sim, tamo junto!" -ForegroundColor Yellow
    Read-Host "D√° um Enter quando terminar de ler, que a gente se v√™ na pr√≥xima..."
    Exit
}

Write-Host "Poderes de Administrador verificados! Bora nessa!" -ForegroundColor Green
Start-Sleep -Seconds 1

# --- Fun√ß√µes Utilit√°rias (Ferramentas que usamos em v√°rios lugares) ---
function Get-SystemInfo {
    $os = Get-CimInstance Win32_OperatingSystem
    $cs = Get-CimInstance Win32_ComputerSystem
    $proc = Get-CimInstance Win32_Processor
    $mem = Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property Capacity -Sum
    
    $info = @{
        "OSName" = $os.Caption
        "OSVersion" = $os.Version
        "OSBuild" = $os.BuildNumber
        "ComputerName" = $cs.Name
        "Manufacturer" = $cs.Manufacturer
        "Model" = $cs.Model
        "Processor" = $proc.Name
        "Memory" = [math]::Round($mem.Sum / 1GB, 2)
        "Architecture" = $os.OSArchitecture
        "InstallDate" = $os.InstallDate
        "LastBootTime" = $os.LastBootUpTime
    }
    
    return $info
}

function Show-SystemSummary {
    $sysInfo = Get-SystemInfo
    
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Computador: $($sysInfo.ComputerName)" -ForegroundColor White
    Write-Host "Fabricante: $($sysInfo.Manufacturer)" -ForegroundColor White
    Write-Host "Modelo: $($sysInfo.Model)" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "Instalado em: $($sysInfo.InstallDate)" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

function Get-DiskSpaceBefore {
    $drives = Get-PSDrive -PSProvider FileSystem
    $driveInfo = @{}
    
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        
        $driveInfo[$drive.Name] = @{
            "Free" = $freeSpace
            "Used" = $usedSpace
            "Total" = $totalSpace
        }
    }
    
    return $driveInfo
}

function Show-DiskSpaceComparison {
    param (
        $before
    )
    
    $after = Get-PSDrive -PSProvider FileSystem
    
    Write-Host "=== Compara√ß√£o de Espa√ßo em Disco ===" -ForegroundColor Cyan
    
    foreach ($drive in $after) {
        if ($before.ContainsKey($drive.Name)) {
            $freeSpaceAfter = [math]::Round($drive.Free / 1GB, 2)
            $freeSpaceBefore = $before[$drive.Name].Free
            $spaceRecovered = [math]::Round($freeSpaceAfter - $freeSpaceBefore, 2)
            
            Write-Host "Drive $($drive.Name):" -ForegroundColor White
            Write-Host "  Espa√ßo livre antes: $freeSpaceBefore GB" -ForegroundColor Gray
            Write-Host "  Espa√ßo livre agora: $freeSpaceAfter GB" -ForegroundColor Gray
            
            if ($spaceRecovered -gt 0) {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Green
            } else {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Yellow
            }
            Write-Host ""
        }
    }
    
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

# --- Fun√ß√µes dos Menus (Principal, Simplificado, Avan√ßado e Sub-menus) ---

# --- Menu Principal (A Bifurca√ß√£o do Destino! Simplificado vs Avan√ßado) ---
# √â aqui que o usu√°rio escolhe se quer ser um mago ou um cara pr√°tico!
function Show-MainMenu {
    do {
        Clear-Host # Limpa a tela pra organizar o menu
        Banner-TORK # Banner no topo, pra gente n√£o esquecer quem somos!
        Show-SystemSummary # Mostra um resumo do sistema

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "       MENU PRINCIPAL" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # As duas grandes estradas da otimiza√ß√£o! Cores variadas (repetindo)!
        Write-Host "[1] Otimiza√ß√£o Simplificada (Pra quem quer praticidade e resultado r√°pido!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o Avan√ßada (Pra quem curte mexer fundo e ter control total!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[3] Diagn√≥stico R√°pido do Sistema (Ver o que t√° rolando no PC)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[4] Sobre o TORK (Informa√ß√µes e cr√©ditos)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[0] Sair (Ah, que pena... Mas a porta t√° aberta!)" -ForegroundColor Red # Vermelho pra Sair - Ok

        Write-Host ""

        # Pergunta pro usu√°rio qual caminho ele escolhe, tipo Mestre Pok√©mon!
        $choice = Read-Host "Escolhe sua op√ß√£o, treinador!"

        # V√™ pra onde a gente vai com base na escolha
        switch ($choice) {
            "1" { Show-SimplifiedMenu } # Se escolheu 1, vai pro Menu Simplificado!
            "2" { Show-AdvancedMenu } # Se escolheu 2, vai pro Menu Avan√ßado!
            "3" { Invoke-QuickDiagnostic } # Nova fun√ß√£o de diagn√≥stico r√°pido
            "4" { Show-AboutTORK } # Nova fun√ß√£o de sobre
            "0" { Write-Host "Fechou! Valeu por usar o TORK! Volte sempre que seu PC pedir um g√°s! ;)" -ForegroundColor Green; Start-Sleep -Seconds 2; break } # Se escolheu 0, vaza (mas volta!)
            default {
                Write-Host "Eita! Op√ß√£o inv√°lida! Confere os n√∫meros e tenta de novo, bora l√°!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1 # D√° um tempinho pro usu√°rio ver a zoeira da mensagem
            }
        }
    } while ($choice -ne '0') # Repete o Menu Principal enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Simplificado (Aqui o TORK faz m√°gica r√°pida e segura!) ---
# Acessado pela op√ß√£o 1 do Menu Principal. Menos op√ß√µes, mais a√ß√£o direta!
function Show-SimplifiedMenu {
    do {
        Clear-Host # Limpa o palco pra esse menu!
        Banner-TORK # Nosso banner no topo, sempre presente!

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "   OTIMIZACAO SIMPLIFICADA" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes SIMPLIFICADAS - cada uma pode fazer um monte de coisa por baixo dos panos! Cores variadas (repetindo as prim√°rias/neon e adicionando outras)!
        Write-Host "[1] Limpeza Geral do Sistema (Tira o lixo que t√° pesando!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o de Mem√≥ria e Programas que Ligam com o Windows (Deixa tudo mais √°gil!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[3] Acelerar a Conex√£o com a Internet (Pra navegar sem gargalo!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[4] Deixar o Windows mais Leve Visualmente (Desativa uns efeitos pra ganhar desempenho!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Otimiza√ß√£o de Jogos (Configura√ß√µes pra melhorar FPS e desempenho)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[6] Manuten√ß√£o de Seguran√ßa (Verificar e corrigir problemas de seguran√ßa)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[7] RODAR TODAS as otimiza√ß√µes SIMPLIFICADAS! (Modo Turbo F√°cil!)" -ForegroundColor Red # Vermelho pra "Faz Tudo" - Destaque/Cuidado
        Write-Host "[0] Voltar ao Menu Principal (A gente te espera aqui!)" -ForegroundColor Gray # Cor neutra pra voltar

        Write-Host ""

        # Pergunta qual m√°gica simplificada o usu√°rio quer
        $choice = Read-Host "Escolhe sua m√°gica simplificada!"

        # V√™ qual m√°gica rodar
        switch ($choice) {
            "1" { Invoke-SimpleSystemCleanup } # Chama a fun√ß√£o de limpeza b√°sica
            "2" { Invoke-SimpleMemoryStartup } # Chama a fun√ß√£o pra mem√≥ria/inicializa√ß√£o
            "3" { Invoke-SimpleInternetOpt } # Chama a fun√ß√£o pra internet
            "4" { Invoke-SimpleVisualOpt } # Chama a fun√ß√£o pra visual
            "5" { Invoke-SimpleGamingOpt } # Nova fun√ß√£o para otimiza√ß√£o de jogos
            "6" { Invoke-SimpleSecurityMaintenance } # Nova fun√ß√£o para manuten√ß√£o de seguran√ßa
            "7" {
                # Rodar todas as simplificadas sequencialmente
                Write-Host "`nModo Turbo F√°cil ATIVADO! Rodando todas as otimiza√ß√µes SIMPLIFICADAS... segura pe√£o!`n" -ForegroundColor Yellow
                Invoke-SimpleSystemCleanup # Roda a 1
                Invoke-SimpleMemoryStartup # Roda a 2
                Invoke-SimpleInternetOpt # Roda a 3
                Invoke-SimpleVisualOpt # Roda a 4
                Invoke-SimpleGamingOpt # Roda a 5
                Invoke-SimpleSecurityMaintenance # Roda a 6
                Write-Host "`nShow! Todas as otimiza√ß√µes SIMPLIFICADAS foram executadas! PC t√° agradecendo! ;)`n" -ForegroundColor Green
                Read-Host "Aperta Enter pra voltar pro Menu Simplificado..." # Pausa no final do "Rodar Todas"
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-MainMenu
            default {
                Write-Host "Ops! Op√ß√£o inv√°lida no Menu Simplificado! Confere os n√∫meros e manda bala de novo!" -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Simplificado enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Avan√ßado (O Playground dos Magos do PC!) ---
# Acessado pela op√ß√£o 2 do Menu Principal. Aqui a gente mergulha fundo!
function Show-AdvancedMenu {
    do {
        Clear-Host # Limpa o palco pro menu avan√ßado!
        Banner-TORK # Nosso banner no topo, pra n√£o perder a pose!

        Write-Host "" # Espacinho maroto
        Write-Host "===============================" -ForegroundColor White
        Write-Host "      MENU AVANCADO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes do menu avan√ßado (as CATEGORIAS dos 200 poderes!) Cores variadas (repetindo)!
        Write-Host "[1] Limpeza e Manuten√ß√£o de Arquivos (Tirar a poeira digital!)" -ForegroundColor Cyan # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[2] Otimiza√ß√µes de Desempenho do Sistema (Deixar o motor roncando!)" -ForegroundColor Green # Cor variada
        Write-Host "[3] Configura√ß√µes e Otimiza√ß√µes de Rede (Pra internet voar baixo!)" -ForegroundColor Yellow # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[4] Gerenciamento e Otimiza√ß√£o de Servi√ßos do Windows (O que t√° rodando e n√£o precisa?!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Ferramentas de Diagn√≥stico e Verifica√ß√£o (Pra ver se t√° tudo nos conformes!)" -ForegroundColor Cyan # Cor repetida
        Write-Host "[6] Desabilitar/Gerenciar Recursos do Windows (Tirar o peso extra do sistema!)" -ForegroundColor Green # Cor repetida
        Write-Host "[7] Gerenciamento de Arquivos e Pastas Avan√ßado (Comandos ninja pra arquivos!)" -ForegroundColor Yellow # Cor repetida
        Write-Host "[8] Gerenciamento de Contas de Usu√°rio (Organizar a galera que usa o PC!)" -ForegroundColor White # Cor repetida
        Write-Host "[9] Otimiza√ß√£o para Jogos Avan√ßada (Tweaks pra gamers de verdade!)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Configura√ß√µes de Privacidade (Controle o que o Windows sabe sobre voc√™)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[11] Outras Configura√ß√µes e Tweaks Diversos (Aqueles ajustes secretos!)" -ForegroundColor Gray # Cor neutra/escura
        Write-Host "[0] Voltar ao Menu Principal (Pronto pra voltar pra estrada principal!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta pro mago qual categoria ele quer explorar
        $choice = Read-Host "Escolhe sua √°rea de magia, mago!"

        # V√™ pra onde a gente navega dentro do mundo avan√ßado
        switch ($choice) {
            "1" { Show-LimpezaManutencaoMenu } # CHAMA O SUB-MENU DE LIMPEZA
            "2" { Show-DesempenhoMenu } # Agora √© um sub-menu tamb√©m
            "3" { Show-ConfiguracoesRedeMenu } # CHAMA O SUB-MENU DE REDE
            "4" { Show-ServicosMenu } # Agora √© um sub-menu tamb√©m
            "5" { Show-DiagnosticoMenu } # Agora √© um sub-menu tamb√©m
            "6" { Show-RecursosMenu } # Agora √© um sub-menu tamb√©m
            "7" { Show-ArquivosPastasMenu } # Agora √© um sub-menu tamb√©m
            "8" { Show-UsuariosMenu } # Agora √© um sub-menu tamb√©m
            "9" { Show-JogosAvancadoMenu } # Novo sub-menu para jogos
            "10" { Show-PrivacidadeMenu } # Novo sub-menu para privacidade
            "11" { Show-OutrosMenu } # Agora √© um sub-menu tamb√©m
            "0" { break } # Sai do loop deste menu, voltando pro Menu Principal
            default {
                Write-Host "Humm, essa √°rea da magia ainda n√£o existe ou voc√™ digitou errado! Tenta de novo, mago!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Avan√ßado enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Limpeza e Manuten√ß√£o (Dentro do Avan√ßado!) ---
# Este menu lista as op√ß√µes ESPEC√çFICAS da categoria Limpeza no Menu Avan√ßado
function Show-LimpezaManutencaoMenu {
    do {
        Clear-Host # Limpa o palco pra este sub-menu!
        Banner-TORK # Banner no topo, sempre!

        Write-Host "" # Espacinho
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: LIMPEZA E MANUT." -ForegroundColor White # T√≠tulo menor pro sub-menu
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes ESPEC√çFICAS da categoria Limpeza. Cores variadas (repetindo cores)!
        Write-Host "[1] Limpar Arquivos Tempor√°rios do Usu√°rio (Tipo a pasta Temp!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[2] Limpar Arquivos Tempor√°rios do Sistema (Os tempor√°rios do Windows!)" -ForegroundColor Gray # Cor neutra (substitui DarkCyan)
        Write-Host "[3] Limpar Cache de DNS (Pra resolver nomes de site mais r√°pido!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[4] Esvaziar Lixeira (Adeus, arquivos deletados!)" -ForegroundColor Gray # Cor neutra (repetindo)
        Write-Host "[5] Limpar Cache de Miniaturas (Aqueles previews de imagem/v√≠deo!)" -ForegroundColor Green # Cor variada
        Write-Host "[6] Limpar Logs do Sistema (Arquivos de registro que acumulam)" -ForegroundColor Cyan # Nova op√ß√£o
        Write-Host "[7] Limpar Cache de Atualiza√ß√µes do Windows (Liberar espa√ßo de updates)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[8] Limpar Arquivos de Hiberna√ß√£o (Liberar o hiberfil.sys)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[9] Limpar Arquivos WinSxS (Pasta que ocupa muito espa√ßo)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Executar TODAS as limpezas acima (Faxina completa!)" -ForegroundColor Red # Nova op√ß√£o
        Write-Host "[0] Voltar ao Menu Avan√ßado (De volta pras categorias!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta qual limpeza espec√≠fica o mago quer fazer
        $choice = Read-Host "Escolhe a limpeza avan√ßada, mestre!"

        # V√™ qual fun√ß√£o de limpeza espec√≠fica chamar
        switch ($choice) {
            "1" { Invoke-CleanUserTemp } # Chama a fun√ß√£o pra Limpar Temp Usu√°rio
            "2" { Invoke-CleanSystemTemp } # Chama a fun√ß√£o pra Limpar Temp Sistema
            "3" { Invoke-CleanDnsCache } # Chama a fun√ß√£o pra Limpar Cache DNS
            "4" { Invoke-EmptyRecycleBin } # Chama a fun√ß√£o pra Esvaziar Lixeira
            "5" { Invoke-CleanThumbnailCache } # Chama a fun√ß√£o pra Limpar Cache de Miniaturas
            "6" { Invoke-CleanSystemLogs } # Nova fun√ß√£o para limpar logs do sistema
            "7" { Invoke-CleanWindowsUpdateCache } # Nova fun√ß√£o para limpar cache de updates
            "8" { Invoke-CleanHibernationFile } # Nova fun√ß√£o para limpar arquivo de hiberna√ß√£o
            "9" { Invoke-CleanWinSxS } # Nova fun√ß√£o para limpar pasta WinSxS
            "10" { 
                # Executa todas as limpezas em sequ√™ncia
                Write-Host "`nIniciando faxina completa do sistema! Isso pode demorar um pouco...`n" -ForegroundColor Yellow
                $diskSpaceBefore = Get-DiskSpaceBefore
                
                Invoke-CleanUserTemp
                Invoke-CleanSystemTemp
                Invoke-CleanDnsCache
                Invoke-EmptyRecycleBin
                Invoke-CleanThumbnailCache
                Invoke-CleanSystemLogs
                Invoke-CleanWindowsUpdateCache
                Invoke-CleanHibernationFile
                Invoke-CleanWinSxS
                
                Write-Host "`nFaxina completa finalizada! Veja quanto espa√ßo foi recuperado:`n" -ForegroundColor Green
                Show-DiskSpaceComparison -before $diskSpaceBefore
                Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-AdvancedMenu
            default {
                Write-Host "Essa tarefa de limpeza ainda n√£o t√° na lista! V√™ os n√∫meros e tenta de novo!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Sub-Menu Limpeza enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Desempenho (Dentro do Avan√ßado!) ---
function Show-DesempenhoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DESEMPENHO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Ajustar Efeitos Visuais para Melhor Desempenho" -ForegroundColor Green
        Write-Host "[2] Otimizar Disco do Sistema" -ForegroundColor Cyan
        Write-Host "[3] Limpar Arquivos Prefetch" -ForegroundColor Yellow
        Write-Host "[4] Definir Plano de Energia para Alto Desempenho" -ForegroundColor White
        Write-Host "[5] Otimizar Servi√ßo SuperFetch/SysMain" -ForegroundColor Magenta
        Write-Host "[6] Ajustar Tamanho da Mem√≥ria Virtual" -ForegroundColor Gray
        Write-Host "[7] Desativar Indexa√ß√£o de Arquivos" -ForegroundColor Green
        Write-Host "[8] Otimizar Inicializa√ß√£o do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de desempenho" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o de desempenho"

        switch ($choice) {
            "1" { Invoke-OptimizeVisualEffects }
            "2" { Invoke-OptimizeDisk }
            "3" { Invoke-CleanPrefetch }
            "4" { Invoke-SetHighPerformancePower }
            "5" { Invoke-OptimizeSuperFetch }
            "6" { Invoke-AdjustVirtualMemory }
            "7" { Invoke-DisableIndexing }
            "8" { Invoke-OptimizeStartup }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de desempenho...`n" -ForegroundColor Yellow
                Invoke-OptimizeVisualEffects
                Invoke-OptimizeDisk
                Invoke-CleanPrefetch
                Invoke-SetHighPerformancePower
                Invoke-OptimizeSuperFetch
                Invoke-AdjustVirtualMemory
                Invoke-DisableIndexing
                Invoke-OptimizeStartup
                Write-Host "`nTodas as otimiza√ß√µes de desempenho foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Configura√ß√µes de Rede (Dentro do Avan√ßado!) ---
function Show-ConfiguracoesRedeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: CONFIG. REDE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Limpar Cache de DNS" -ForegroundColor Yellow
        Write-Host "[2] Mudar Servidor DNS" -ForegroundColor Cyan
        Write-Host "[3] Resetar Configura√ß√µes de Rede" -ForegroundColor White
        Write-Host "[4] Otimizar Configura√ß√µes TCP/IP" -ForegroundColor Green
        Write-Host "[5] Verificar Velocidade da Conex√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar QoS (Qualidade de Servi√ßo)" -ForegroundColor Gray
        Write-Host "[7] Desativar IPv6 (Se n√£o estiver usando)" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Lat√™ncia de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de rede" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√£o de rede"

        switch ($choice) {
            "1" { Invoke-NetworkFlushDns }
            "2" { Invoke-NetworkChangeDns }
            "3" { Invoke-NetworkReset }
            "4" { Invoke-OptimizeTcpIp }
            "5" { Invoke-CheckNetworkSpeed }
            "6" { Invoke-ConfigureQoS }
            "7" { Invoke-DisableIPv6 }
            "8" { Invoke-OptimizeGamingLatency }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de rede...`n" -ForegroundColor Yellow
                Invoke-NetworkFlushDns
                Invoke-OptimizeTcpIp
                Invoke-CheckNetworkSpeed
                Invoke-ConfigureQoS
                Invoke-DisableIPv6
                Invoke-OptimizeGamingLatency
                Write-Host "`nTodas as otimiza√ß√µes de rede foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Rede..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Servi√ßos (Dentro do Avan√ßado!) ---
function Show-ServicosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: SERVICOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desabilitar Servi√ßo SuperFetch/SysMain" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Servi√ßo de Impress√£o" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Servi√ßo Windows Update" -ForegroundColor White
        Write-Host "[4] Listar Todos os Servi√ßos em Execu√ß√£o" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Otimizar Servi√ßos para Desempenho Geral" -ForegroundColor Gray
        Write-Host "[7] Restaurar Servi√ßos para Configura√ß√£o Padr√£o" -ForegroundColor Yellow
        Write-Host "[8] Desabilitar Servi√ßos Desnecess√°rios" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de servi√ßos"

        switch ($choice) {
            "1" { Invoke-ManageSuperFetch }
            "2" { Invoke-ManagePrintService }
            "3" { Invoke-ManageWindowsUpdate }
            "4" { Invoke-ListRunningServices }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-OptimizeServicesForPerformance }
            "7" { Invoke-RestoreDefaultServices }
            "8" { Invoke-DisableUnnecessaryServices }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Diagn√≥stico (Dentro do Avan√ßado!) ---
function Show-DiagnosticoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DIAGNOSTICO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Verificar Arquivos do Sistema (SFC)" -ForegroundColor Yellow
        Write-Host "[2] Reparar Imagem do Windows (DISM)" -ForegroundColor Cyan
        Write-Host "[3] Verificar Disco por Erros (CHKDSK)" -ForegroundColor White
        Write-Host "[4] Verificar Sa√∫de do Disco" -ForegroundColor Green
        Write-Host "[5] Verificar Drivers Desatualizados" -ForegroundColor Magenta
        Write-Host "[6] Verificar Problemas de Inicializa√ß√£o" -ForegroundColor Gray
        Write-Host "[7] Verificar Problemas de Mem√≥ria RAM" -ForegroundColor Yellow
        Write-Host "[8] Verificar Temperatura do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODOS os diagn√≥sticos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de diagn√≥stico"

        switch ($choice) {
            "1" { Invoke-SfcScan }
            "2" { Invoke-DismRepair }
            "3" { Invoke-ChkDsk }
            "4" { Invoke-CheckDiskHealth }
            "5" { Invoke-CheckDrivers }
            "6" { Invoke-CheckStartupIssues }
            "7" { Invoke-CheckMemory }
            "8" { Invoke-CheckTemperature }
            "9" {
                Write-Host "`nExecutando todos os diagn√≥sticos...`n" -ForegroundColor Yellow
                Invoke-SfcScan
                Invoke-DismRepair
                Invoke-CheckDiskHealth
                Invoke-CheckDrivers
                Invoke-CheckStartupIssues
                Invoke-CheckTemperature
                Write-Host "`nTodos os diagn√≥sticos foram conclu√≠dos!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Diagn√≥stico..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Recursos (Dentro do Avan√ßado!) ---
function Show-RecursosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: RECURSOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Gerenciar Hiberna√ß√£o" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Planos de Energia" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Recursos Opcionais do Windows" -ForegroundColor White
        Write-Host "[4] Gerenciar Mem√≥ria Virtual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Windows Defender" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Recursos de Telemetria" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Recursos de Inicializa√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Recursos de Seguran√ßa" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de recursos"

        switch ($choice) {
            "1" { Invoke-ManageHibernation }
            "2" { Invoke-ManagePowerPlans }
            "3" { Invoke-ManageOptionalFeatures }
            "4" { Invoke-ManageVirtualMemory }
            "5" { Invoke-ManageWindowsDefender }
            "6" { Invoke-ManageTelemetry }
            "7" { Invoke-ManageStartupResources }
            "8" { Invoke-ManageSecurityFeatures }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Arquivos e Pastas (Dentro do Avan√ßado!) ---
function Show-ArquivosPastasMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: ARQUIVOS E PASTAS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Encontrar Arquivos Grandes" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Arquivos" -ForegroundColor Cyan
        Write-Host "[3] Tomar Posse de Arquivos (TakeOwn)" -ForegroundColor White
        Write-Host "[4] Listar Conte√∫do de Pastas Espec√≠ficas" -ForegroundColor Green
        Write-Host "[5] Compactar Pastas para Economizar Espa√ßo" -ForegroundColor Magenta
        Write-Host "[6] Verificar Integridade de Arquivos" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Arquivos Ocultos e do Sistema" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Atributos de Arquivos" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de arquivos e pastas"

        switch ($choice) {
            "1" { Invoke-FindLargeFiles }
            "2" { Invoke-ManageFilePermissions }
            "3" { Invoke-TakeOwnership }
            "4" { Invoke-ListFolderContents }
            "5" { Invoke-CompressFolders }
            "6" { Invoke-VerifyFileIntegrity }
            "7" { Invoke-ManageHiddenSystemFiles }
            "8" { Invoke-ManageFileAttributes }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Usu√°rios (Dentro do Avan√ßado!) ---
function Show-UsuariosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: USUARIOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Listar Todos os Usu√°rios Locais" -ForegroundColor Yellow
        Write-Host "[2] Listar Todos os Grupos Locais" -ForegroundColor Cyan
        Write-Host "[3] Listar Membros de Grupos Espec√≠ficos" -ForegroundColor White
        Write-Host "[4] Mostrar Propriedades do Usu√°rio Atual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Contas de Usu√°rio" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Pol√≠ticas de Senha" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Permiss√µes de Usu√°rio" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar UAC (Controle de Conta de Usu√°rio)" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de usu√°rios"

        switch ($choice) {
            "1" { Invoke-ListLocalUsers }
            "2" { Invoke-ListLocalGroups }
            "3" { Invoke-ListGroupMembers }
            "4" { Invoke-ShowCurrentUserProperties }
            "5" { Invoke-ManageUserAccounts }
            "6" { Invoke-ManagePasswordPolicies }
            "7" { Invoke-ManageUserPermissions }
            "8" { Invoke-ManageUAC }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Jogos Avan√ßado (Dentro do Avan√ßado!) ---
function Show-JogosAvancadoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: JOGOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Otimizar Prioridade de CPU para Jogos" -ForegroundColor Yellow
        Write-Host "[2] Otimizar Configura√ß√µes de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[3] Otimizar Configura√ß√µes de GPU" -ForegroundColor White
        Write-Host "[4] Desativar Game DVR e Game Bar" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Configurar Modo de Jogo do Windows" -ForegroundColor Gray
        Write-Host "[7] Otimizar Configura√ß√µes de √Åudio para Jogos" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Configura√ß√µes de Input Lag" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes para jogos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o para jogos"

        switch ($choice) {
            "1" { Invoke-OptimizeCpuPriority }
            "2" { Invoke-OptimizeNetworkForGaming }
            "3" { Invoke-OptimizeGpuSettings }
            "4" { Invoke-DisableGameDvrBar }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-ConfigureGameMode }
            "7" { Invoke-OptimizeAudioForGaming }
            "8" { Invoke-OptimizeInputLag }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes para jogos...`n" -ForegroundColor Yellow
                Invoke-OptimizeCpuPriority
                Invoke-OptimizeNetworkForGaming
                Invoke-OptimizeGpuSettings
                Invoke-DisableGameDvrBar
                Invoke-OptimizeServicesForGaming
                Invoke-ConfigureGameMode
                Invoke-OptimizeAudioForGaming
                Invoke-OptimizeInputLag
                Write-Host "`nTodas as otimiza√ß√µes para jogos foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Jogos..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Privacidade (Dentro do Avan√ßado!) ---
function Show-PrivacidadeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: PRIVACIDADE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desativar Telemetria do Windows" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Aplicativos" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Hist√≥rico de Atividades" -ForegroundColor White
        Write-Host "[4] Gerenciar Diagn√≥stico e Feedback" -ForegroundColor Green
        Write-Host "[5] Gerenciar An√∫ncios Personalizados" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Localiza√ß√£o e Sensores" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Reconhecimento de Voz e Digita√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Sincroniza√ß√£o com a Microsoft" -ForegroundColor Cyan
        Write-Host "[9] Aplicar TODAS as configura√ß√µes de privacidade" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de privacidade"

        switch ($choice) {
            "1" { Invoke-DisableTelemetry }
            "2" { Invoke-ManageAppPermissions }
            "3" { Invoke-ManageActivityHistory }
            "4" { Invoke-ManageDiagnosticsFeedback }
            "5" { Invoke-ManagePersonalizedAds }
            "6" { Invoke-ManageLocationSensors }
            "7" { Invoke-ManageVoiceTyping }
            "8" { Invoke-ManageMicrosoftSync }
            "9" {
                Write-Host "`nAplicando todas as configura√ß√µes de privacidade...`n" -ForegroundColor Yellow
                Invoke-DisableTelemetry
                Invoke-ManageAppPermissions
                Invoke-ManageActivityHistory
                Invoke-ManageDiagnosticsFeedback
                Invoke-ManagePersonalizedAds
                Invoke-ManageLocationSensors
                Invoke-ManageVoiceTyping
                Invoke-ManageMicrosoftSync
                Write-Host "`nTodas as configura√ß√µes de privacidade foram aplicadas!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Privacidade..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Outros (Dentro do Avan√ßado!) ---
function Show-OutrosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: OUTROS TWEAKS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Mostrar Informa√ß√µes Detalhadas do Sistema" -ForegroundColor Yellow
        Write-Host "[2] Mostrar Configura√ß√£o Completa de Rede" -ForegroundColor Cyan
        Write-Host "[3] Reiniciar Explorer.exe" -ForegroundColor White
        Write-Host "[4] Limpar Cache de Atualiza√ß√µes do Windows" -ForegroundColor Green
        Write-Host "[5] Gerenciar Programas de Inicializa√ß√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar Op√ß√µes de Energia Avan√ßadas" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Configura√ß√µes de Armazenamento" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Configura√ß√µes de Notifica√ß√µes" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√µes diversas"

        switch ($choice) {
            "1" { Invoke-ShowDetailedSystemInfo }
            "2" { Invoke-ShowDetailedNetworkConfig }
            "3" { Invoke-RestartExplorer }
            "4" { Invoke-CleanWindowsUpdateCache }
            "5" { Invoke-ManageStartupPrograms }
            "6" { Invoke-ConfigureAdvancedPowerOptions }
            "7" { Invoke-ManageStorageSettings }
            "8" { Invoke-ManageNotificationSettings }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- Fun√ß√µes para as Secoes SIMPLIFICADAS (Expandidas) ---
function Invoke-SimpleSystemCleanup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza Geral do Sistema: Hora de varrer o lixo digital! ---" -ForegroundColor Green
    Write-Host "Essa op√ß√£o vai te ajudar a liberar espa√ßo e dar um f√¥lego pro PC tirando arquivos tempor√°rios, lixo da lixeira, etc. √â tipo faxina no computador!" -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Comando 1: Limpar Arquivos Tempor√°rios do Usu√°rio
    Write-Host "Bora come√ßar limpando os arquivos tempor√°rios do seu usu√°rio! Eles acumulam que √© uma beleza!" -ForegroundColor Yellow
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio limpos! Menos peso pro PC respirar! ;)" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Esvaziar a Lixeira
    Write-Host "Agora, vamos dar um fim definitivo naqueles arquivos na Lixeira. Eles s√≥ est√£o ocupando espa√ßo √† toa!" -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada! Espa√ßo recuperado com sucesso! R√°!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios do Windows
    Write-Host "Vamos limpar tamb√©m os tempor√°rios do pr√≥prio Windows. √Äs vezes, fica lixo escondido por l√°!" -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Limpar Cache de Navegadores Comuns
    Write-Host "Bora dar uma geral nos caches dos navegadores tamb√©m! Eles guardam um monte de coisa que pode pesar!" -ForegroundColor Yellow
    
    # Chrome
    Write-Host "Tentando limpar cache do Google Chrome..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Chrome limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Edge
    Write-Host "Tentando limpar cache do Microsoft Edge..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Edge limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Firefox
    Write-Host "Tentando limpar cache do Mozilla Firefox..." -ForegroundColor DarkGray
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\cache2\entries\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\startupCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\thumbnails\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Firefox limpo (pode n√£o ser completo, dependendo do perfil/uso)." -ForegroundColor DarkGray

    # Brave (se instalado)
    Write-Host "Tentando limpar cache do Brave Browser (se instalado)..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Brave limpo (se instalado e n√£o estiver rodando)." -ForegroundColor DarkGray

    Write-Host "Limpeza de caches de navegador conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Comando 5: Limpar Cache de Miniaturas
    Write-Host "Limpando cache de miniaturas do Windows (aquelas pr√©-visualiza√ß√µes de imagens e v√≠deos)..." -ForegroundColor Yellow
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Write-Host "Cache de miniaturas limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Limpar Arquivos de Log do Windows
    Write-Host "Limpando arquivos de log do Windows que podem ocupar espa√ßo..." -ForegroundColor Yellow
    wevtutil cl Application
    wevtutil cl System
    wevtutil cl Security
    Write-Host "Logs do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 7: Limpar Arquivos Tempor√°rios de Instala√ß√£o
    Write-Host "Limpando arquivos tempor√°rios de instala√ß√£o de programas..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Installer\$*\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios de instala√ß√£o limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 8: Limpar Arquivos de Atualiza√ß√£o do Windows
    Write-Host "Limpando arquivos de atualiza√ß√£o do Windows que podem ocupar bastante espa√ßo..." -ForegroundColor Yellow
    Stop-Service -Name wuauserv -ErrorAction SilentlyContinue
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    Write-Host "Arquivos de atualiza√ß√£o do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 9: Limpar Arquivos Prefetch
    Write-Host "Limpando arquivos prefetch para melhorar a inicializa√ß√£o..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Prefetch\*.pf" -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos prefetch limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 10: Executar Limpeza de Disco Integrada do Windows
    Write-Host "Executando a ferramenta de limpeza de disco integrada do Windows..." -ForegroundColor Yellow
    Start-Process -FilePath cleanmgr.exe -ArgumentList "/sagerun:1" -Wait -ErrorAction SilentlyContinue
    Write-Host "Limpeza de disco conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "Vamos ver quanto espa√ßo conseguimos recuperar com essa faxina:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nPronto! A faxina geral b√°sica foi feita! Seu PC agradece o espa√ßo extra! ;)" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu
    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleMemoryStartup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Mem√≥ria e Inicializa√ß√£o R√°pida: Deixa o PC ligando num piscar! ---" -ForegroundColor Yellow
    Write-Host "Aqui a gente d√° uma olhada na mem√≥ria RAM e nos programas que ligam junto com o Windows. Menos coisa ligando √† toa = PC mais r√°pido pra usar na hora!" -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Listar Programas de Inicializa√ß√£o
    Write-Host "Listando programas que iniciam com o Windows (pra voc√™ saber o que t√° rodando por baixo dos panos):" -ForegroundColor Yellow
    Get-CimInstance win32_startupcommand | Select-Object Name, command, Location | Format-Table -AutoSize
    Write-Host "Lista de programas de inicializa√ß√£o exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Servi√ßo SuperFetch/SysMain
    Write-Host "Otimizando o servi√ßo SuperFetch/SysMain para melhorar o desempenho..." -ForegroundColor Yellow
    $confirmSysMain = Read-Host "Deseja desativar o servi√ßo SysMain/SuperFetch? (s/n) - Recomendado para SSDs"
    if ($confirmSysMain -eq 's') {
        Set-Service -Name SysMain -StartupType Disabled -ErrorAction SilentlyContinue
        Stop-Service -Name SysMain -Force -ErrorAction SilentlyContinue
        Write-Host "Servi√ßo SysMain/SuperFetch desativado!" -ForegroundColor Green
    } else {
        Write-Host "Servi√ßo SysMain/SuperFetch mantido ativo." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios de Updates
    Write-Host "Limpando arquivos tempor√°rios de atualiza√ß√µes do Windows (podem ocupar bastante espa√ßo e afetar performance):" -ForegroundColor Yellow
    Dism /online /Cleanup-Image /StartComponentCleanup /ErrorAction SilentlyContinue
    Write-Host "Limpeza de componentes de atualiza√ß√£o iniciada (pode levar um tempo)." -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Mem√≥ria Virtual
    Write-Host "Otimizando configura√ß√µes de mem√≥ria virtual para melhor desempenho..." -ForegroundColor Yellow
    $totalRam = (Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property capacity -Sum).Sum / 1GB
    Write-Host "Seu sistema tem aproximadamente $totalRam GB de RAM." -ForegroundColor White
    
    $confirmPageFile = Read-Host "Deseja otimizar o arquivo de pagina√ß√£o (mem√≥ria virtual)? (s/n)"
    if ($confirmPageFile -eq 's') {
        # Calcula tamanho recomendado (1.5x a RAM para sistemas com menos de 8GB, 1x para sistemas com mais)
        $pageFileSize = if ($totalRam -lt 8) { [math]::Round($totalRam * 1.5) * 1024 } else { [math]::Round($totalRam) * 1024 }
        
        Write-Host "Configurando arquivo de pagina√ß√£o para tamanho fixo de $pageFileSize MB..." -ForegroundColor DarkGray
        $computerSystem = Get-WmiObject -Class Win32_ComputerSystem
        $computerSystem.AutomaticManagedPagefile = $false
        $computerSystem.Put() | Out-Null
        
        $pageFileSetting = Get-WmiObject -Class Win32_PageFileSetting
        if ($pageFileSetting) {
            $pageFileSetting.InitialSize = $pageFileSize
            $pageFileSetting.MaximumSize = $pageFileSize
            $pageFileSetting.Put() | Out-Null
        }
        Write-Host "Arquivo de pagina√ß√£o otimizado! (Requer reinicializa√ß√£o para aplicar totalmente)" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes de mem√≥ria virtual mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Listar os 10 Processos que mais usam mem√≥ria no momento
    Write-Host "Listando os 10 processos que mais consomem mem√≥ria agora:" -ForegroundColor Yellow
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host "Lista de processos exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Otimizar Inicializa√ß√£o do Windows
    Write-Host "Otimizando a inicializa√ß√£o do Windows..." -ForegroundColor Yellow
    # Desabilitar servi√ßos n√£o essenciais que podem atrasar a inicializa√ß√£o
    $startupServices = @(
        @{Name="DiagTrack"; DisplayName="Experi√™ncias do Usu√°rio Conectado e Telemetria"},
        @{Name="dmwappushservice"; DisplayName="Servi√ßo de Transfer√™ncia Inteligente em Segundo Plano (BITS)"},
        @{Name="MapsBroker"; DisplayName="Servi√ßo de Dados de Mapas"}
    )
    
    foreach ($service in $startupServices) {
        $confirmService = Read-Host "Deseja desativar o servi√ßo '$($service.DisplayName)' na inicializa√ß√£o? (s/n)"
        if ($confirmService -eq 's') {
            Set-Service -Name $service.Name -StartupType Disabled -ErrorAction SilentlyContinue
            Stop-Service -Name $service.Name -Force -ErrorAction SilentlyContinue
            Write-Host "Servi√ßo '$($service.DisplayName)' desativado!" -ForegroundColor Green
        } else {
            Write-Host "Servi√ßo '$($service.DisplayName)' mantido." -ForegroundColor Green
        }
    }
    Write-Host ""

    # Comando 7: Reiniciar o Computador (√ötil pra liberar mem√≥ria e aplicar mudan√ßas)
    Write-Host "Quer dar um 'refresh' geral no PC? Reiniciar pode ajudar!" -ForegroundColor Yellow
    $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (digite 'sim' para confirmar)"
    if ($confirmRestart -eq 'sim') {
        Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
        Restart-Computer -Force
    } else {
        Write-Host "Rein√≠cio cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o de mem√≥ria e inicializa√ß√£o!" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu (a n√£o ser que o PC tenha reiniciado)
    if ($confirmRestart -ne 'sim') {
        Write-Host ""
        Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
    }
}

function Invoke-SimpleInternetOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Acelerar a Conex√£o com a Internet (Simplificado): Diz adeus pro 'carregando...'! ---" -ForegroundColor Cyan
    Write-Host "Vamos fazer uns ajustes r√°pidos na sua conex√£o pra tentar deixar ela mais esperta." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Limpar Cache de DNS
    Write-Host "Limpando o cache de endere√ßos de internet (DNS) pra resolver nomes mais r√°pido!" -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Configura√ß√µes TCP/IP
    Write-Host "Otimizando configura√ß√µes TCP/IP para melhorar a velocidade de conex√£o..." -ForegroundColor Yellow
    
    # Habilitar TCP Window Auto-Tuning
    netsh int tcp set global autotuninglevel=normal
    Write-Host "TCP Auto-Tuning configurado para 'normal'." -ForegroundColor DarkGray
    
    # Otimizar par√¢metros de recebimento de pacotes
    netsh int tcp set global rss=enabled
    Write-Host "Receive-Side Scaling (RSS) habilitado." -ForegroundColor DarkGray
    
    # Otimizar congestion provider
    netsh int tcp set global congestionprovider=ctcp
    Write-Host "Congestion Provider configurado para 'ctcp'." -ForegroundColor DarkGray
    
    # Otimizar ECN capability
    netsh int tcp set global ecncapability=enabled
    Write-Host "ECN Capability habilitado." -ForegroundColor DarkGray
    
    Write-Host "Configura√ß√µes TCP/IP otimizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Reiniciar Adaptadores de Rede
    Write-Host "Dando um 'reset' r√°pido nas suas conex√µes de rede. Pode resolver uns pepinos!" -ForegroundColor Yellow
    $confirmResetAdapter = Read-Host "Isso vai desconectar brevemente sua internet. Continuar? (s/n)"
    if ($confirmResetAdapter -eq 's') {
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        Write-Host "Adaptadores de rede reiniciados." -ForegroundColor Green
    } else {
        Write-Host "Reset de adaptadores cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 4: Configurar DNS R√°pido
    Write-Host "Configurar DNS mais r√°pido pode melhorar sua navega√ß√£o!" -ForegroundColor Yellow
    $confirmDns = Read-Host "Deseja configurar DNS mais r√°pidos (Google ou Cloudflare)? (s/n)"
    if ($confirmDns -eq 's') {
        Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
        Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
        $dnsChoice = Read-Host "Escolha uma op√ß√£o (1 ou 2)"
        
        $primaryDns = ""
        $secondaryDns = ""
        
        if ($dnsChoice -eq '1') {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            Write-Host "Google DNS selecionado." -ForegroundColor DarkGray
        } elseif ($dnsChoice -eq '2') {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            Write-Host "Cloudflare DNS selecionado." -ForegroundColor DarkGray
        } else {
            Write-Host "Op√ß√£o inv√°lida. DNS n√£o alterado." -ForegroundColor Red
        }
        
        if ($primaryDns -ne "") {
            $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" -and ($_.InterfaceDescription -match "Ethernet" -or $_.InterfaceDescription -match "Wi-Fi" -or $_.InterfaceDescription -match "Wireless") }
            
            foreach ($adapter in $networkAdapters) {
                Write-Host "Configurando DNS para adaptador: $($adapter.Name)" -ForegroundColor DarkGray
                Set-DnsClientServerAddress -InterfaceIndex $adapter.ifIndex -ServerAddresses ($primaryDns, $secondaryDns)
            }
            
            Write-Host "DNS configurado! Sua navega√ß√£o deve ficar mais r√°pida agora." -ForegroundColor Green
        }
    } else {
        Write-Host "Configura√ß√£o de DNS mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Mostrar Status B√°sico da Conex√£o
    Write-Host "Mostrando um resumo b√°sico da sua configura√ß√£o de rede atual:" -ForegroundColor Yellow
    ipconfig /all | Select-String -Pattern "IPv4", "DNS", "Gateway", "DHCP", "Subnet", "Physical Address"
    Write-Host "Status b√°sico da rede exibido." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Testar a conex√£o com a internet
    Write-Host "Testando a conex√£o com a internet (ping para google.com)..." -ForegroundColor Yellow
    Test-Connection -Count 4 google.com -ErrorAction SilentlyContinue
    Write-Host "Teste de conex√£o finalizado." -ForegroundColor Green
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o b√°sica de internet!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleVisualOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Deixar o Windows mais Leve Visualmente (Simplificado): Desempenho antes da beleza! ---" -ForegroundColor White
    Write-Host "Ajustes r√°pidos pra desativar efeitos visuais que podem pesar, liberando recursos pro que importa." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ajustar Efeitos Visuais
    Write-Host "Voc√™ quer desativar ou ativar as anima√ß√µes e efeitos visuais do Windows?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Efeitos Visuais (Pra ganhar desempenho)" -ForegroundColor Green
    Write-Host "[2] Configurar para Melhor Apar√™ncia (Mais bonito, mas mais pesado)" -ForegroundColor White
    Write-Host "[3] Deixar o Windows Escolher (Configura√ß√£o padr√£o)" -ForegroundColor Cyan
    $choiceVisual = Read-Host "Escolha [1], [2] ou [3]"

    if ($choiceVisual -eq '1') {
        Write-Host "Desativando efeitos visuais para melhor desempenho..." -ForegroundColor Yellow
        # Valor 2 = Ajustar para melhor desempenho (desativa a maioria dos efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 2 -Type DWord -Force -ErrorAction SilentlyContinue
        
        # Desativar anima√ß√µes individuais
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop' -Name 'UserPreferencesMask' -Value ([byte[]](0x90, 0x12, 0x01, 0x80)) -Type Binary -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop\WindowMetrics' -Name 'MinAnimate' -Value 0 -Type String -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'ListviewAlphaSelect' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'TaskbarAnimations' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        
        Write-Host "Efeitos visuais desativados para melhor desempenho!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '2') {
        Write-Host "Configurando para melhor apar√™ncia (todos os efeitos visuais ativados)..." -ForegroundColor Yellow
        # Valor 1 = Ajustar para melhor apar√™ncia (ativa todos os efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Efeitos visuais configurados para melhor apar√™ncia!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '3') {
        Write-Host "Deixando o Windows escolher automaticamente (configura√ß√£o padr√£o)..." -ForegroundColor Yellow
        # Valor 0 = Deixar o Windows escolher
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Configura√ß√£o visual definida para padr√£o do Windows!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa nos efeitos visuais foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 2: Ativar/Desativar Efeitos de Transpar√™ncia
    Write-Host "E os efeitos de transpar√™ncia do Windows (tipo na barra de tarefas)?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Transpar√™ncia (Mais leve)" -ForegroundColor Green
    Write-Host "[2] Ativar Transpar√™ncia (Mais 'bonito')" -ForegroundColor White
    $choiceTransp = Read-Host "Escolha [1] ou [2]"

    if ($choiceTransp -eq '1') {
        Write-Host "Desativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 0 = Desativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia desativada!" -ForegroundColor Green
    } elseif ($choiceTransp -eq '2') {
        Write-Host "Ativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 1 = Ativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia ativada!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa na transpar√™ncia foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 3: Configurar Tema Claro/Escuro
    Write-Host "Voc√™ prefere tema claro ou escuro? O tema escuro pode ser mais confort√°vel para os olhos." -ForegroundColor Yellow
    Write-Host "[1] Tema Escuro (Dark Mode)" -ForegroundColor DarkGray
    Write-Host "[2] Tema Claro (Light Mode)" -ForegroundColor White
    $choiceTheme = Read-Host "Escolha [1] ou [2]"

    if ($choiceTheme -eq '1') {
        Write-Host "Configurando tema escuro..." -ForegroundColor Yellow
        # Valor 0 = Tema Escuro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema escuro configurado!" -ForegroundColor Green
    } elseif ($choiceTheme -eq '2') {
        Write-Host "Configurando tema claro..." -ForegroundColor Yellow
        # Valor 1 = Tema Claro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema claro configurado!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa no tema foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Configurar Resolu√ß√£o de Tela
    Write-Host "Deseja ajustar a resolu√ß√£o da tela? Resolu√ß√µes menores podem melhorar o desempenho em PCs mais antigos." -ForegroundColor Yellow
    $confirmResolution = Read-Host "Deseja ver e ajustar a resolu√ß√£o da tela? (s/n)"
    
    if ($confirmResolution -eq 's') {
        # Mostrar resolu√ß√£o atual
        $currentResolution = Get-WmiObject -Class Win32_VideoController | Select-Object -ExpandProperty VideoModeDescription
        Write-Host "Resolu√ß√£o atual: $currentResolution" -ForegroundColor White
        
        # Abrir configura√ß√µes de exibi√ß√£o do Windows
        Write-Host "Abrindo configura√ß√µes de exibi√ß√£o do Windows..." -ForegroundColor DarkGray
        Start-Process "ms-settings:display"
        Write-Host "Ajuste a resolu√ß√£o conforme necess√°rio na janela de configura√ß√µes que foi aberta." -ForegroundColor Green
        
        $waitForSettings = Read-Host "Pressione Enter quando terminar de ajustar as configura√ß√µes de exibi√ß√£o"
    } else {
        Write-Host "Configura√ß√£o de resolu√ß√£o mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizados os ajustes visuais b√°sicos!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleGamingOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Jogos (Simplificado): Mais FPS, menos lag! ---" -ForegroundColor Magenta
    Write-Host "Vamos fazer alguns ajustes para melhorar o desempenho dos seus jogos sem complica√ß√µes." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ativar Modo de Jogo do Windows
    Write-Host "Ativando o Modo de Jogo do Windows para priorizar recursos para jogos..." -ForegroundColor Yellow
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AllowAutoGameMode" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AutoGameModeEnabled" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Write-Host "Modo de Jogo do Windows ativado!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Desativar Game DVR e Game Bar
    Write-Host "O Game DVR e Game Bar podem reduzir o desempenho em jogos. Deseja desativ√°-los?" -ForegroundColor Yellow
    $confirmGameDVR = Read-Host "Desativar Game DVR e Game Bar? (s/n)"
    
    if ($confirmGameDVR -eq 's') {
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "UseNexusForGameBarEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\System\GameConfigStore" -Name "GameDVR_Enabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR" -Name "AppCaptureEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Write-Host "Game DVR e Game Bar desativados!" -ForegroundColor Green
    } else {
        Write-Host "Game DVR e Game Bar mantidos ativos." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Otimizar Plano de Energia para Jogos
    Write-Host "Configurando plano de energia para alto desempenho (ideal para jogos)..." -ForegroundColor Yellow
    powercfg.exe /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c
    Write-Host "Plano de energia configurado para alto desempenho!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Configura√ß√µes de Mouse
    Write-Host "Otimizando configura√ß√µes de mouse para jogos (precis√£o do ponteiro)..." -ForegroundColor Yellow
    $confirmMouseFix = Read-Host "Desativar a acelera√ß√£o do mouse para melhor precis√£o em jogos? (s/n)"
    
    if ($confirmMouseFix -eq 's') {
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseSpeed" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold1" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold2" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Write-Host "Acelera√ß√£o do mouse desativada para melhor precis√£o em jogos!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do mouse mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Otimizar Prioridade de CPU para Jogos
    Write-Host "Configurando prioridade de CPU para jogos..." -ForegroundColor Yellow
    Write-Host "Esta configura√ß√£o ajusta o sistema para dar mais prioridade aos jogos." -ForegroundColor DarkGray
    
    # Criar chave de registro para prioridade de jogos
    if (-not (Test-Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games")) {
        New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Force | Out-Null
    }
    
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "GPU Priority" -Type DWord -Value 8 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Priority" -Type DWord -Value 6 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Scheduling Category" -Type String -Value "High" -Force -ErrorAction SilentlyContinue
    
    Write-Host "Prioridade de CPU para jogos otimizada!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Verificar Driver de Placa de V√≠deo
    Write-Host "Verificando informa√ß√µes da placa de v√≠deo..." -ForegroundColor Yellow
    $gpuInfo = Get-WmiObject -Class Win32_VideoController | Select-Object Name, DriverVersion, CurrentHorizontalResolution, CurrentVerticalResolution
    
    foreach ($gpu in $gpuInfo) {
        Write-Host "Placa de v√≠deo: $($gpu.Name)" -ForegroundColor White
        Write-Host "Vers√£o do driver: $($gpu.DriverVersion)" -ForegroundColor White
        Write-Host "Resolu√ß√£o atual: $($gpu.CurrentHorizontalResolution) x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
      x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
    
    Write-Host "Recomenda√ß√£o: Mantenha seus drivers de v√≠deo atualizados para melhor desempenho em jogos!" -ForegroundColor Green
    Write-Host "Voc√™ pode baixar os drivers mais recentes nos sites oficiais da NVIDIA, AMD ou Intel." -ForegroundColor DarkGray
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nOtimiza√ß√µes para jogos conclu√≠das! Seus jogos devem rodar mais suaves agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleSecurityMaintenance {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Manuten√ß√£o de Seguran√ßa (Simplificado): Mantenha seu PC protegido! ---" -ForegroundColor DarkYellow
    Write-Host "Vamos verificar e melhorar a seguran√ßa do seu sistema com alguns ajustes simples." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Verificar Status do Windows Defender
    Write-Host "Verificando status do Windows Defender..." -ForegroundColor Yellow
    $defenderStatus = Get-MpComputerStatus
    
    Write-Host "Status do Windows Defender:" -ForegroundColor White
    Write-Host "Antiv√≠rus habilitado: $($defenderStatus.AntivirusEnabled)" -ForegroundColor $(if ($defenderStatus.AntivirusEnabled) { "Green" } else { "Red" })
    Write-Host "Prote√ß√£o em tempo real: $($defenderStatus.RealTimeProtectionEnabled)" -ForegroundColor $(if ($defenderStatus.RealTimeProtectionEnabled) { "Green" } else { "Red" })
    Write-Host "Defini√ß√µes de antiv√≠rus: $($defenderStatus.AntivirusSignatureVersion)" -ForegroundColor White
    Write-Host "√öltima atualiza√ß√£o: $($defenderStatus.AntivirusSignatureLastUpdated)" -ForegroundColor White
    Write-Host ""

    # Comando 2: Atualizar Defini√ß√µes do Windows Defender
    Write-Host "Atualizando defini√ß√µes do Windows Defender..." -ForegroundColor Yellow
    Update-MpSignature -ErrorAction SilentlyContinue
    Write-Host "Defini√ß√µes do Windows Defender atualizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Verificar Atualiza√ß√µes do Windows
    Write-Host "Verificando status das atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
            Write-Host "Recomenda√ß√£o: Execute o Windows Update para manter seu sistema seguro." -ForegroundColor Green
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Verificar Configura√ß√µes de Firewall
    Write-Host "Verificando status do Firewall do Windows..." -ForegroundColor Yellow
    $firewallStatus = Get-NetFirewallProfile
    
    foreach ($profile in $firewallStatus) {
        Write-Host "Perfil: $($profile.Name)" -ForegroundColor White
        Write-Host "Status: $($profile.Enabled)" -ForegroundColor $(if ($profile.Enabled) { "Green" } else { "Red" })
        Write-Host ""
    }
    
    $confirmFirewall = Read-Host "Deseja habilitar o Firewall em todos os perfis? (s/n)"
    if ($confirmFirewall -eq 's') {
        Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True
        Write-Host "Firewall habilitado em todos os perfis!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do Firewall mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Verificar Configura√ß√µes de UAC
    Write-Host "Verificando configura√ß√µes do Controle de Conta de Usu√°rio (UAC)..." -ForegroundColor Yellow
    $uacLevel = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -ErrorAction SilentlyContinue
    
    if ($uacLevel) {
        switch ($uacLevel.ConsentPromptBehaviorAdmin) {
            0 { $uacStatus = "Desativado (N√£o recomendado)" }
            1 { $uacStatus = "Baixo (N√£o recomendado)" }
            2 { $uacStatus = "M√©dio" }
            5 { $uacStatus = "Alto (Recomendado)" }
            default { $uacStatus = "Personalizado" }
        }
        
        Write-Host "N√≠vel atual do UAC: $uacStatus" -ForegroundColor $(if ($uacLevel.ConsentPromptBehaviorAdmin -ge 2) { "Green" } else { "Red" })
        
        $confirmUAC = Read-Host "Deseja configurar o UAC para o n√≠vel recomendado? (s/n)"
        if ($confirmUAC -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -Value 5 -Type DWord -Force -ErrorAction SilentlyContinue
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "PromptOnSecureDesktop" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
            Write-Host "UAC configurado para o n√≠vel recomendado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do UAC mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do UAC." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 6: Verificar Configura√ß√µes de SmartScreen
    Write-Host "Verificando configura√ß√µes do Windows SmartScreen..." -ForegroundColor Yellow
    $smartScreen = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -ErrorAction SilentlyContinue
    
    if ($smartScreen) {
        Write-Host "Status do SmartScreen: $($smartScreen.SmartScreenEnabled)" -ForegroundColor $(if ($smartScreen.SmartScreenEnabled -eq "RequireAdmin" -or $smartScreen.SmartScreenEnabled -eq "Warn") { "Green" } else { "Red" })
        
        $confirmSmartScreen = Read-Host "Deseja habilitar o SmartScreen para maior seguran√ßa? (s/n)"
        if ($confirmSmartScreen -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -Value "RequireAdmin" -Type String -Force -ErrorAction SilentlyContinue
            Write-Host "SmartScreen habilitado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do SmartScreen mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do SmartScreen." -ForegroundColor Red
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nManuten√ß√£o de seguran√ßa conclu√≠da! Seu sistema est√° mais protegido agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

# --- Fun√ß√µes para o Diagn√≥stico R√°pido e Sobre ---
function Invoke-QuickDiagnostic {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Diagn√≥stico R√°pido do Sistema ---" -ForegroundColor Yellow
    Write-Host "Vamos fazer uma verifica√ß√£o r√°pida do estado atual do seu PC." -ForegroundColor Gray
    Write-Host ""

    # Informa√ß√µes do Sistema
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    $sysInfo = Get-SystemInfo
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host ""

    # Uso de CPU
    Write-Host "=== Uso de CPU ===" -ForegroundColor Cyan
    $cpuLoad = (Get-WmiObject Win32_Processor).LoadPercentage
    Write-Host "Uso atual de CPU: $cpuLoad%" -ForegroundColor $(if ($cpuLoad -lt 70) { "Green" } elseif ($cpuLoad -lt 90) { "Yellow" } else { "Red" })
    Write-Host ""

    # Uso de Mem√≥ria
    Write-Host "=== Uso de Mem√≥ria ===" -ForegroundColor Cyan
    $os = Get-WmiObject Win32_OperatingSystem
    $totalMemory = [math]::Round($os.TotalVisibleMemorySize / 1MB, 2)
    $freeMemory = [math]::Round($os.FreePhysicalMemory / 1MB, 2)
    $usedMemory = [math]::Round($totalMemory - $freeMemory, 2)
    $memoryPercentage = [math]::Round(($usedMemory / $totalMemory) * 100, 2)
    
    Write-Host "Mem√≥ria Total: $totalMemory GB" -ForegroundColor White
    Write-Host "Mem√≥ria Usada: $usedMemory GB ($memoryPercentage%)" -ForegroundColor $(if ($memoryPercentage -lt 70) { "Green" } elseif ($memoryPercentage -lt 90) { "Yellow" } else { "Red" })
    Write-Host "Mem√≥ria Livre: $freeMemory GB" -ForegroundColor White
    Write-Host ""

    # Espa√ßo em Disco
    Write-Host "=== Espa√ßo em Disco ===" -ForegroundColor Cyan
    $drives = Get-PSDrive -PSProvider FileSystem
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        $percentFree = [math]::Round(($freeSpace / $totalSpace) * 100, 2)
        
        Write-Host "Drive $($drive.Name):" -ForegroundColor White
        Write-Host "  Total: $totalSpace GB" -ForegroundColor White
        Write-Host "  Usado: $usedSpace GB" -ForegroundColor White
        Write-Host "  Livre: $freeSpace GB ($percentFree%)" -ForegroundColor $(if ($percentFree -gt 20) { "Green" } elseif ($percentFree -gt 10) { "Yellow" } else { "Red" })
    }
    Write-Host ""

    # Processos que mais consomem recursos
    Write-Host "=== Top 5 Processos (CPU) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object CPU -Descending | Select-Object -First 5 ProcessName, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}}, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host ""

    Write-Host "=== Top 5 Processos (Mem√≥ria) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 5 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}}, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}} | Format-Table -AutoSize
    Write-Host ""

    # Status de Servi√ßos Cr√≠ticos
    Write-Host "=== Status de Servi√ßos Cr√≠ticos ===" -ForegroundColor Cyan
    $criticalServices = @("wuauserv", "WinDefend", "MpsSvc", "wscsvc")
    foreach ($service in $criticalServices) {
        $serviceStatus = Get-Service -Name $service -ErrorAction SilentlyContinue
        if ($serviceStatus) {
            Write-Host "$($serviceStatus.DisplayName): $($serviceStatus.Status)" -ForegroundColor $(if ($serviceStatus.Status -eq "Running") { "Green" } else { "Red" })
        }
    }
    Write-Host ""

    # Verificar Atualiza√ß√µes Pendentes
    Write-Host "=== Atualiza√ß√µes do Windows ===" -ForegroundColor Cyan
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Recomenda√ß√µes
    Write-Host "=== Recomenda√ß√µes ===" -ForegroundColor Cyan
    
    # Recomenda√ß√£o de Mem√≥ria
    if ($memoryPercentage -gt 80) {
        Write-Host "- Seu uso de mem√≥ria est√° alto. Considere fechar alguns programas ou usar a op√ß√£o 'Otimiza√ß√£o de Mem√≥ria'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Disco
    $lowDiskSpace = $false
    foreach ($drive in $drives) {
        $percentFree = [math]::Round(($drive.Free / ($drive.Free + $drive.Used)) * 100, 2)
        if ($percentFree -lt 15) {
            $lowDiskSpace = $true
            break
        }
    }
    
    if ($lowDiskSpace) {
        Write-Host "- Espa√ßo em disco baixo detectado. Considere usar a op√ß√£o 'Limpeza Geral do Sistema'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Atualiza√ß√µes
    if ($pendingUpdates -gt 0) {
        Write-Host "- Existem atualiza√ß√µes pendentes. Recomendamos atualizar seu sistema para maior seguran√ßa." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Inicializa√ß√£o
    $bootTime = $sysInfo.LastBootTime
    $uptime = (Get-Date) - $bootTime
    if ($uptime.Days -gt 7) {
        Write-Host "- Seu sistema est√° ligado h√° $($uptime.Days) dias. Considere reiniciar para aplicar atualiza√ß√µes e limpar a mem√≥ria." -ForegroundColor Yellow
    }
    
    Write-Host ""

    # Mensagem de conclus√£o
    Write-Host "`nDiagn√≥stico r√°pido conclu√≠do! Use as informa√ß√µes acima para decidir quais otimiza√ß√µes fazer." -ForegroundColor Green

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

function Show-AboutTORK {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Sobre o TORK ---" -ForegroundColor White
    Write-Host ""
    
    Write-Host "TORK - Otimizador para Windows" -ForegroundColor Cyan
    Write-Host "Vers√£o: 2.0" -ForegroundColor White
    Write-Host "Desenvolvido por: Partner77" -ForegroundColor White
    Write-Host ""
    
    Write-Host "=== Descri√ß√£o ===" -ForegroundColor Yellow
    Write-Host "O TORK √© uma ferramenta abrangente de otimiza√ß√£o para Windows, projetada para" -ForegroundColor Gray
    Write-Host "melhorar o desempenho do seu sistema atrav√©s de limpeza, ajustes e otimiza√ß√µes." -ForegroundColor Gray
    Write-Host "Ele oferece op√ß√µes simplificadas para usu√°rios comuns e op√ß√µes avan√ßadas para" -ForegroundColor Gray
    Write-Host "usu√°rios experientes que desejam um controle mais detalhado sobre o sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Recursos ===" -ForegroundColor Yellow
    Write-Host "- Limpeza completa do sistema" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√£o de mem√≥ria e inicializa√ß√£o" -ForegroundColor Gray
    Write-Host "- Ajustes de rede para melhor conectividade" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√µes visuais para melhor desempenho" -ForegroundColor Gray
    Write-Host "- Configura√ß√µes espec√≠ficas para jogos" -ForegroundColor Gray
    Write-Host "- Manuten√ß√£o de seguran√ßa" -ForegroundColor Gray
    Write-Host "- Diagn√≥stico r√°pido do sistema" -ForegroundColor Gray
    Write-Host "- Mais de 100 ajustes e otimiza√ß√µes avan√ßadas" -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Aviso Legal ===" -ForegroundColor Yellow
    Write-Host "Este software √© fornecido 'como est√°', sem garantias de qualquer tipo." -ForegroundColor Gray
    Write-Host "O autor n√£o se responsabiliza por quaisquer danos ou problemas causados pelo uso" -ForegroundColor Gray
    Write-Host "deste software. Use por sua conta e risco. Recomendamos sempre fazer backup" -ForegroundColor Gray
    Write-Host "dos seus dados importantes antes de realizar otimiza√ß√µes no sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Agradecimentos ===" -ForegroundColor Yellow
    Write-Host "Obrigado por escolher o TORK para otimizar seu sistema Windows!" -ForegroundColor Gray
    Write-Host "Esperamos que esta ferramenta ajude a melhorar o desempenho do seu PC." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "¬© 2023-2024 Partner77 - Todos os direitos reservados" -ForegroundColor Cyan
    Write-Host ""
    
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - LIMPEZA (Expandidas) ---
function Invoke-CleanUserTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Usu√°rio ---" -ForegroundColor Cyan
    Write-Host "Remove arquivos da pasta tempor√°ria do seu usu√°rio (`$env:TEMP`)." -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:TEMP..." -ForegroundColor Yellow
    $tempFiles = Get-ChildItem -Path $env:TEMP -Recurse -ErrorAction SilentlyContinue
    $tempFilesCount = ($tempFiles | Measure-Object).Count
    $tempFilesSize = ($tempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $tempFilesCount arquivos tempor√°rios ocupando aproximadamente $([math]::Round($tempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Sistema ---" -ForegroundColor Gray
    Write-Host "Remove arquivos da pasta tempor√°ria do Windows (`$env:SystemRoot\Temp`)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:SystemRoot\Temp..." -ForegroundColor Yellow
    $systemTempFiles = Get-ChildItem -Path "$env:SystemRoot\Temp" -Recurse -ErrorAction SilentlyContinue
    $systemTempFilesCount = ($systemTempFiles | Measure-Object).Count
    $systemTempFilesSize = ($systemTempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $systemTempFilesCount arquivos tempor√°rios do sistema ocupando aproximadamente $([math]::Round($systemTempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do sistema removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanDnsCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-EmptyRecycleBin {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Esvaziar Lixeira ---" -ForegroundColor Gray
    Write-Host "Esvazia a lixeira do usu√°rio logado." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar tamanho da lixeira antes de esvaziar
    Write-Host "Verificando tamanho da lixeira..." -ForegroundColor Yellow
    
    try {
        $shell = New-Object -ComObject Shell.Application
        $recycleBin = $shell.Namespace(0xA)
        $recycleBinItems = $recycleBin.Items()
        $recycleBinItemCount = $recycleBinItems.Count
        
        Write-Host "A lixeira cont√©m $recycleBinItemCount itens." -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o conte√∫do da lixeira." -ForegroundColor DarkGray
    }
    
    # Esvaziar a lixeira
    Write-Host "Executando: Esvaziando a lixeira..." -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanThumbnailCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Miniaturas ---" -ForegroundColor Green
    Write-Host "Remove o cache de miniaturas de arquivos (imagens, v√≠deos, etc.)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Limpando cache de miniaturas..." -ForegroundColor Yellow
    
    # Verificar tamanho do cache de miniaturas antes da limpeza
    $thumbnailPath = "$env:LOCALAPPDATA\Microsoft\Windows\Explorer"
    $thumbnailFiles = Get-ChildItem -Path $thumbnailPath -Filter "thumbcache_*.db" -ErrorAction SilentlyContinue
    $thumbnailFilesCount = ($thumbnailFiles | Measure-Object).Count
    $thumbnailFilesSize = ($thumbnailFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $thumbnailFilesCount arquivos de cache de miniaturas ocupando aproximadamente $([math]::Round($thumbnailFilesSize, 2)) MB." -ForegroundColor White
    
    # Limpar o cache de miniaturas
    Stop-Process -Name explorer -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Start-Process explorer
    
    Write-Host "Cache de miniaturas limpo com sucesso!" -ForegroundColor Green
    Write-Host "O Windows Explorer foi reiniciado para aplicar as altera√ß√µes." -ForegroundColor DarkGray
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de miniaturas:" -ForegroundColor Cyan
    Write-Host "- Navega√ß√£o mais r√°pida em pastas com muitas imagens ou v√≠deos" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de miniaturas corrompidas ou desatualizadas" -ForegroundColor DarkGray
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemLogs {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Logs do Sistema ---" -ForegroundColor Cyan
    Write-Host "Limpa os logs de eventos do sistema para liberar espa√ßo e melhorar o desempenho." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando logs do sistema..." -ForegroundColor Yellow
    
    # Verificar tamanho dos logs antes da limpeza
    $eventLogs = Get-WinEvent -ListLog * -ErrorAction SilentlyContinue | Where-Object { $_.RecordCount -gt 0 }
    $totalLogCount = ($eventLogs | Measure-Object).Count
    $total### Enhanced TORK Optimizer

I'll enhance the TORK optimizer with more comprehensive functionality across all features, starting with an expanded Simple Cleanup function and then improving all other options.

```powershell type="code"
# Define a preferencia de acao para erros (continua a execucao por padrao)
# Permite que o script tente rodar o m√°ximo poss√≠vel mesmo que alguns comandos encontrem problemas.
$ErrorActionPreference = 'SilentlyContinue' # N√£o exibe erros se um item n√£o puder ser processado, por exemplo.

# --- Funcao pra Centralizar Texto (Nosso Maestro de Alinhamento - s√≥ pra textos, n√£o pro bannerz√£o!) ---
# Deixa ela aqui, vai que a gente usa pra centralizar outra coisa, n√©?
function Centraliza($texto, $cor="White") {
    $largura = [console]::WindowWidth # Pega a largura da largura da janela agora
    # Calcula o espa√ßo pra botar o texto no meio. Pura matem√°tica da zoeira!
    $espacos = [Math]::Max(0, [Math]::Floor(($largura - $texto.Length) / 2))
    $linha = (" " * $espacos) + $texto # Cria a linha com os espa√ßos e o texto
    Write-Host $linha -ForegroundColor $cor # Manda pro console com a cor pedida
}

# --- Funcao que Desenha o Nosso Banner Irado do TORK! ---
# Esse √© o nosso outdoor digital no console! Ajustado pros espa√ßos que voc√™ mandou!
# Se as bordas ainda estiverem meio teimosas, √© o jeitinho do console mesmo, viu? üòâ
function Banner-TORK {
    # Nossas cores vibrantes para o banner!
    $CorBorda = "DarkCyan" # Mantido para a borda, combina com o ciano. Se quiser mudar, √© aqui!
    $CorLogo = "Green" # Cor vibrante
    $CorProjeto = "Cyan" # Cor vibrante
    $CorCopyright = "Gray" # Tom mais suave

    Write-Host "" # D√° um espacinho no topo, pra n√£o grudar
    Write-Host "                    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë          ‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë ‚ñà‚ñà‚ïî‚ïù                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ñà‚ñà‚ïó                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù                                          ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë           Bem-vindo ao TORK - Otimizador para Windows!                                ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë        Projeto de automacao, limpeza, manutencao e tweaks.                            ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë            (C) Partner77 - Todos os direitos reservados                               ‚ïë" -ForegroundColor $CorCopyright
    Write-Host "                    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor $CorBorda
    Write-Host "" # Espa√ßo embaixo
}

# --- Checagem de Permiss√µes de Administrador (O Guarda da Porta!) ---
# V√™ se a gente t√° rodando com poderes de admin, sen√£o n√£o d√° pra mexer no Windows direito.
function Test-Administrator {
    $currentUser = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())
    return $currentUser.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
}

if (-not (Test-Administrator)) {
    Write-Host "OPA! Calma l√°, patr√£o!" -ForegroundColor Red
    Write-Host "Pra usar o TORK e deixar o PC voando, preciso de super poderes de Administrador!" -ForegroundColor Yellow
    Write-Host "Fecha essa janela, clica com o bot√£o direito no arquivo do script e escolhe 'Executar como administrador'. A√≠ sim, tamo junto!" -ForegroundColor Yellow
    Read-Host "D√° um Enter quando terminar de ler, que a gente se v√™ na pr√≥xima..."
    Exit
}

Write-Host "Poderes de Administrador verificados! Bora nessa!" -ForegroundColor Green
Start-Sleep -Seconds 1

# --- Fun√ß√µes Utilit√°rias (Ferramentas que usamos em v√°rios lugares) ---
function Get-SystemInfo {
    $os = Get-CimInstance Win32_OperatingSystem
    $cs = Get-CimInstance Win32_ComputerSystem
    $proc = Get-CimInstance Win32_Processor
    $mem = Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property Capacity -Sum
    
    $info = @{
        "OSName" = $os.Caption
        "OSVersion" = $os.Version
        "OSBuild" = $os.BuildNumber
        "ComputerName" = $cs.Name
        "Manufacturer" = $cs.Manufacturer
        "Model" = $cs.Model
        "Processor" = $proc.Name
        "Memory" = [math]::Round($mem.Sum / 1GB, 2)
        "Architecture" = $os.OSArchitecture
        "InstallDate" = $os.InstallDate
        "LastBootTime" = $os.LastBootUpTime
    }
    
    return $info
}

function Show-SystemSummary {
    $sysInfo = Get-SystemInfo
    
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Computador: $($sysInfo.ComputerName)" -ForegroundColor White
    Write-Host "Fabricante: $($sysInfo.Manufacturer)" -ForegroundColor White
    Write-Host "Modelo: $($sysInfo.Model)" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "Instalado em: $($sysInfo.InstallDate)" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

function Get-DiskSpaceBefore {
    $drives = Get-PSDrive -PSProvider FileSystem
    $driveInfo = @{}
    
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        
        $driveInfo[$drive.Name] = @{
            "Free" = $freeSpace
            "Used" = $usedSpace
            "Total" = $totalSpace
        }
    }
    
    return $driveInfo
}

function Show-DiskSpaceComparison {
    param (
        $before
    )
    
    $after = Get-PSDrive -PSProvider FileSystem
    
    Write-Host "=== Compara√ß√£o de Espa√ßo em Disco ===" -ForegroundColor Cyan
    
    foreach ($drive in $after) {
        if ($before.ContainsKey($drive.Name)) {
            $freeSpaceAfter = [math]::Round($drive.Free / 1GB, 2)
            $freeSpaceBefore = $before[$drive.Name].Free
            $spaceRecovered = [math]::Round($freeSpaceAfter - $freeSpaceBefore, 2)
            
            Write-Host "Drive $($drive.Name):" -ForegroundColor White
            Write-Host "  Espa√ßo livre antes: $freeSpaceBefore GB" -ForegroundColor Gray
            Write-Host "  Espa√ßo livre agora: $freeSpaceAfter GB" -ForegroundColor Gray
            
            if ($spaceRecovered -gt 0) {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Green
            } else {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Yellow
            }
            Write-Host ""
        }
    }
    
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

# --- Fun√ß√µes dos Menus (Principal, Simplificado, Avan√ßado e Sub-menus) ---

# --- Menu Principal (A Bifurca√ß√£o do Destino! Simplificado vs Avan√ßado) ---
# √â aqui que o usu√°rio escolhe se quer ser um mago ou um cara pr√°tico!
function Show-MainMenu {
    do {
        Clear-Host # Limpa a tela pra organizar o menu
        Banner-TORK # Banner no topo, pra gente n√£o esquecer quem somos!
        Show-SystemSummary # Mostra um resumo do sistema

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "       MENU PRINCIPAL" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # As duas grandes estradas da otimiza√ß√£o! Cores variadas (repetindo)!
        Write-Host "[1] Otimiza√ß√£o Simplificada (Pra quem quer praticidade e resultado r√°pido!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o Avan√ßada (Pra quem curte mexer fundo e ter control total!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[3] Diagn√≥stico R√°pido do Sistema (Ver o que t√° rolando no PC)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[4] Sobre o TORK (Informa√ß√µes e cr√©ditos)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[0] Sair (Ah, que pena... Mas a porta t√° aberta!)" -ForegroundColor Red # Vermelho pra Sair - Ok

        Write-Host ""

        # Pergunta pro usu√°rio qual caminho ele escolhe, tipo Mestre Pok√©mon!
        $choice = Read-Host "Escolhe sua op√ß√£o, treinador!"

        # V√™ pra onde a gente vai com base na escolha
        switch ($choice) {
            "1" { Show-SimplifiedMenu } # Se escolheu 1, vai pro Menu Simplificado!
            "2" { Show-AdvancedMenu } # Se escolheu 2, vai pro Menu Avan√ßado!
            "3" { Invoke-QuickDiagnostic } # Nova fun√ß√£o de diagn√≥stico r√°pido
            "4" { Show-AboutTORK } # Nova fun√ß√£o de sobre
            "0" { Write-Host "Fechou! Valeu por usar o TORK! Volte sempre que seu PC pedir um g√°s! ;)" -ForegroundColor Green; Start-Sleep -Seconds 2; break } # Se escolheu 0, vaza (mas volta!)
            default {
                Write-Host "Eita! Op√ß√£o inv√°lida! Confere os n√∫meros e tenta de novo, bora l√°!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1 # D√° um tempinho pro usu√°rio ver a zoeira da mensagem
            }
        }
    } while ($choice -ne '0') # Repete o Menu Principal enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Simplificado (Aqui o TORK faz m√°gica r√°pida e segura!) ---
# Acessado pela op√ß√£o 1 do Menu Principal. Menos op√ß√µes, mais a√ß√£o direta!
function Show-SimplifiedMenu {
    do {
        Clear-Host # Limpa o palco pra esse menu!
        Banner-TORK # Nosso banner no topo, sempre presente!

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "   OTIMIZACAO SIMPLIFICADA" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes SIMPLIFICADAS - cada uma pode fazer um monte de coisa por baixo dos panos! Cores variadas (repetindo as prim√°rias/neon e adicionando outras)!
        Write-Host "[1] Limpeza Geral do Sistema (Tira o lixo que t√° pesando!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o de Mem√≥ria e Programas que Ligam com o Windows (Deixa tudo mais √°gil!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[3] Acelerar a Conex√£o com a Internet (Pra navegar sem gargalo!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[4] Deixar o Windows mais Leve Visualmente (Desativa uns efeitos pra ganhar desempenho!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Otimiza√ß√£o de Jogos (Configura√ß√µes pra melhorar FPS e desempenho)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[6] Manuten√ß√£o de Seguran√ßa (Verificar e corrigir problemas de seguran√ßa)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[7] RODAR TODAS as otimiza√ß√µes SIMPLIFICADAS! (Modo Turbo F√°cil!)" -ForegroundColor Red # Vermelho pra "Faz Tudo" - Destaque/Cuidado
        Write-Host "[0] Voltar ao Menu Principal (A gente te espera aqui!)" -ForegroundColor Gray # Cor neutra pra voltar

        Write-Host ""

        # Pergunta qual m√°gica simplificada o usu√°rio quer
        $choice = Read-Host "Escolhe sua m√°gica simplificada!"

        # V√™ qual m√°gica rodar
        switch ($choice) {
            "1" { Invoke-SimpleSystemCleanup } # Chama a fun√ß√£o de limpeza b√°sica
            "2" { Invoke-SimpleMemoryStartup } # Chama a fun√ß√£o pra mem√≥ria/inicializa√ß√£o
            "3" { Invoke-SimpleInternetOpt } # Chama a fun√ß√£o pra internet
            "4" { Invoke-SimpleVisualOpt } # Chama a fun√ß√£o pra visual
            "5" { Invoke-SimpleGamingOpt } # Nova fun√ß√£o para otimiza√ß√£o de jogos
            "6" { Invoke-SimpleSecurityMaintenance } # Nova fun√ß√£o para manuten√ß√£o de seguran√ßa
            "7" {
                # Rodar todas as simplificadas sequencialmente
                Write-Host "`nModo Turbo F√°cil ATIVADO! Rodando todas as otimiza√ß√µes SIMPLIFICADAS... segura pe√£o!`n" -ForegroundColor Yellow
                Invoke-SimpleSystemCleanup # Roda a 1
                Invoke-SimpleMemoryStartup # Roda a 2
                Invoke-SimpleInternetOpt # Roda a 3
                Invoke-SimpleVisualOpt # Roda a 4
                Invoke-SimpleGamingOpt # Roda a 5
                Invoke-SimpleSecurityMaintenance # Roda a 6
                Write-Host "`nShow! Todas as otimiza√ß√µes SIMPLIFICADAS foram executadas! PC t√° agradecendo! ;)`n" -ForegroundColor Green
                Read-Host "Aperta Enter pra voltar pro Menu Simplificado..." # Pausa no final do "Rodar Todas"
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-MainMenu
            default {
                Write-Host "Ops! Op√ß√£o inv√°lida no Menu Simplificado! Confere os n√∫meros e manda bala de novo!" -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Simplificado enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Avan√ßado (O Playground dos Magos do PC!) ---
# Acessado pela op√ß√£o 2 do Menu Principal. Aqui a gente mergulha fundo!
function Show-AdvancedMenu {
    do {
        Clear-Host # Limpa o palco pro menu avan√ßado!
        Banner-TORK # Nosso banner no topo, pra n√£o perder a pose!

        Write-Host "" # Espacinho maroto
        Write-Host "===============================" -ForegroundColor White
        Write-Host "      MENU AVANCADO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes do menu avan√ßado (as CATEGORIAS dos 200 poderes!) Cores variadas (repetindo)!
        Write-Host "[1] Limpeza e Manuten√ß√£o de Arquivos (Tirar a poeira digital!)" -ForegroundColor Cyan # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[2] Otimiza√ß√µes de Desempenho do Sistema (Deixar o motor roncando!)" -ForegroundColor Green # Cor variada
        Write-Host "[3] Configura√ß√µes e Otimiza√ß√µes de Rede (Pra internet voar baixo!)" -ForegroundColor Yellow # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[4] Gerenciamento e Otimiza√ß√£o de Servi√ßos do Windows (O que t√° rodando e n√£o precisa?!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Ferramentas de Diagn√≥stico e Verifica√ß√£o (Pra ver se t√° tudo nos conformes!)" -ForegroundColor Cyan # Cor repetida
        Write-Host "[6] Desabilitar/Gerenciar Recursos do Windows (Tirar o peso extra do sistema!)" -ForegroundColor Green # Cor repetida
        Write-Host "[7] Gerenciamento de Arquivos e Pastas Avan√ßado (Comandos ninja pra arquivos!)" -ForegroundColor Yellow # Cor repetida
        Write-Host "[8] Gerenciamento de Contas de Usu√°rio (Organizar a galera que usa o PC!)" -ForegroundColor White # Cor repetida
        Write-Host "[9] Otimiza√ß√£o para Jogos Avan√ßada (Tweaks pra gamers de verdade!)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Configura√ß√µes de Privacidade (Controle o que o Windows sabe sobre voc√™)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[11] Outras Configura√ß√µes e Tweaks Diversos (Aqueles ajustes secretos!)" -ForegroundColor Gray # Cor neutra/escura
        Write-Host "[0] Voltar ao Menu Principal (Pronto pra voltar pra estrada principal!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta pro mago qual categoria ele quer explorar
        $choice = Read-Host "Escolhe sua √°rea de magia, mago!"

        # V√™ pra onde a gente navega dentro do mundo avan√ßado
        switch ($choice) {
            "1" { Show-LimpezaManutencaoMenu } # CHAMA O SUB-MENU DE LIMPEZA
            "2" { Show-DesempenhoMenu } # Agora √© um sub-menu tamb√©m
            "3" { Show-ConfiguracoesRedeMenu } # CHAMA O SUB-MENU DE REDE
            "4" { Show-ServicosMenu } # Agora √© um sub-menu tamb√©m
            "5" { Show-DiagnosticoMenu } # Agora √© um sub-menu tamb√©m
            "6" { Show-RecursosMenu } # Agora √© um sub-menu tamb√©m
            "7" { Show-ArquivosPastasMenu } # Agora √© um sub-menu tamb√©m
            "8" { Show-UsuariosMenu } # Agora √© um sub-menu tamb√©m
            "9" { Show-JogosAvancadoMenu } # Novo sub-menu para jogos
            "10" { Show-PrivacidadeMenu } # Novo sub-menu para privacidade
            "11" { Show-OutrosMenu } # Agora √© um sub-menu tamb√©m
            "0" { break } # Sai do loop deste menu, voltando pro Menu Principal
            default {
                Write-Host "Humm, essa √°rea da magia ainda n√£o existe ou voc√™ digitou errado! Tenta de novo, mago!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Avan√ßado enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Limpeza e Manuten√ß√£o (Dentro do Avan√ßado!) ---
# Este menu lista as op√ß√µes ESPEC√çFICAS da categoria Limpeza no Menu Avan√ßado
function Show-LimpezaManutencaoMenu {
    do {
        Clear-Host # Limpa o palco pra este sub-menu!
        Banner-TORK # Banner no topo, sempre!

        Write-Host "" # Espacinho
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: LIMPEZA E MANUT." -ForegroundColor White # T√≠tulo menor pro sub-menu
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes ESPEC√çFICAS da categoria Limpeza. Cores variadas (repetindo cores)!
        Write-Host "[1] Limpar Arquivos Tempor√°rios do Usu√°rio (Tipo a pasta Temp!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[2] Limpar Arquivos Tempor√°rios do Sistema (Os tempor√°rios do Windows!)" -ForegroundColor Gray # Cor neutra (substitui DarkCyan)
        Write-Host "[3] Limpar Cache de DNS (Pra resolver nomes de site mais r√°pido!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[4] Esvaziar Lixeira (Adeus, arquivos deletados!)" -ForegroundColor Gray # Cor neutra (repetindo)
        Write-Host "[5] Limpar Cache de Miniaturas (Aqueles previews de imagem/v√≠deo!)" -ForegroundColor Green # Cor variada
        Write-Host "[6] Limpar Logs do Sistema (Arquivos de registro que acumulam)" -ForegroundColor Cyan # Nova op√ß√£o
        Write-Host "[7] Limpar Cache de Atualiza√ß√µes do Windows (Liberar espa√ßo de updates)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[8] Limpar Arquivos de Hiberna√ß√£o (Liberar o hiberfil.sys)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[9] Limpar Arquivos WinSxS (Pasta que ocupa muito espa√ßo)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Executar TODAS as limpezas acima (Faxina completa!)" -ForegroundColor Red # Nova op√ß√£o
        Write-Host "[0] Voltar ao Menu Avan√ßado (De volta pras categorias!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta qual limpeza espec√≠fica o mago quer fazer
        $choice = Read-Host "Escolhe a limpeza avan√ßada, mestre!"

        # V√™ qual fun√ß√£o de limpeza espec√≠fica chamar
        switch ($choice) {
            "1" { Invoke-CleanUserTemp } # Chama a fun√ß√£o pra Limpar Temp Usu√°rio
            "2" { Invoke-CleanSystemTemp } # Chama a fun√ß√£o pra Limpar Temp Sistema
            "3" { Invoke-CleanDnsCache } # Chama a fun√ß√£o pra Limpar Cache DNS
            "4" { Invoke-EmptyRecycleBin } # Chama a fun√ß√£o pra Esvaziar Lixeira
            "5" { Invoke-CleanThumbnailCache } # Chama a fun√ß√£o pra Limpar Cache de Miniaturas
            "6" { Invoke-CleanSystemLogs } # Nova fun√ß√£o para limpar logs do sistema
            "7" { Invoke-CleanWindowsUpdateCache } # Nova fun√ß√£o para limpar cache de updates
            "8" { Invoke-CleanHibernationFile } # Nova fun√ß√£o para limpar arquivo de hiberna√ß√£o
            "9" { Invoke-CleanWinSxS } # Nova fun√ß√£o para limpar pasta WinSxS
            "10" { 
                # Executa todas as limpezas em sequ√™ncia
                Write-Host "`nIniciando faxina completa do sistema! Isso pode demorar um pouco...`n" -ForegroundColor Yellow
                $diskSpaceBefore = Get-DiskSpaceBefore
                
                Invoke-CleanUserTemp
                Invoke-CleanSystemTemp
                Invoke-CleanDnsCache
                Invoke-EmptyRecycleBin
                Invoke-CleanThumbnailCache
                Invoke-CleanSystemLogs
                Invoke-CleanWindowsUpdateCache
                Invoke-CleanHibernationFile
                Invoke-CleanWinSxS
                
                Write-Host "`nFaxina completa finalizada! Veja quanto espa√ßo foi recuperado:`n" -ForegroundColor Green
                Show-DiskSpaceComparison -before $diskSpaceBefore
                Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-AdvancedMenu
            default {
                Write-Host "Essa tarefa de limpeza ainda n√£o t√° na lista! V√™ os n√∫meros e tenta de novo!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Sub-Menu Limpeza enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Desempenho (Dentro do Avan√ßado!) ---
function Show-DesempenhoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DESEMPENHO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Ajustar Efeitos Visuais para Melhor Desempenho" -ForegroundColor Green
        Write-Host "[2] Otimizar Disco do Sistema" -ForegroundColor Cyan
        Write-Host "[3] Limpar Arquivos Prefetch" -ForegroundColor Yellow
        Write-Host "[4] Definir Plano de Energia para Alto Desempenho" -ForegroundColor White
        Write-Host "[5] Otimizar Servi√ßo SuperFetch/SysMain" -ForegroundColor Magenta
        Write-Host "[6] Ajustar Tamanho da Mem√≥ria Virtual" -ForegroundColor Gray
        Write-Host "[7] Desativar Indexa√ß√£o de Arquivos" -ForegroundColor Green
        Write-Host "[8] Otimizar Inicializa√ß√£o do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de desempenho" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o de desempenho"

        switch ($choice) {
            "1" { Invoke-OptimizeVisualEffects }
            "2" { Invoke-OptimizeDisk }
            "3" { Invoke-CleanPrefetch }
            "4" { Invoke-SetHighPerformancePower }
            "5" { Invoke-OptimizeSuperFetch }
            "6" { Invoke-AdjustVirtualMemory }
            "7" { Invoke-DisableIndexing }
            "8" { Invoke-OptimizeStartup }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de desempenho...`n" -ForegroundColor Yellow
                Invoke-OptimizeVisualEffects
                Invoke-OptimizeDisk
                Invoke-CleanPrefetch
                Invoke-SetHighPerformancePower
                Invoke-OptimizeSuperFetch
                Invoke-AdjustVirtualMemory
                Invoke-DisableIndexing
                Invoke-OptimizeStartup
                Write-Host "`nTodas as otimiza√ß√µes de desempenho foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Configura√ß√µes de Rede (Dentro do Avan√ßado!) ---
function Show-ConfiguracoesRedeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: CONFIG. REDE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Limpar Cache de DNS" -ForegroundColor Yellow
        Write-Host "[2] Mudar Servidor DNS" -ForegroundColor Cyan
        Write-Host "[3] Resetar Configura√ß√µes de Rede" -ForegroundColor White
        Write-Host "[4] Otimizar Configura√ß√µes TCP/IP" -ForegroundColor Green
        Write-Host "[5] Verificar Velocidade da Conex√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar QoS (Qualidade de Servi√ßo)" -ForegroundColor Gray
        Write-Host "[7] Desativar IPv6 (Se n√£o estiver usando)" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Lat√™ncia de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de rede" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√£o de rede"

        switch ($choice) {
            "1" { Invoke-NetworkFlushDns }
            "2" { Invoke-NetworkChangeDns }
            "3" { Invoke-NetworkReset }
            "4" { Invoke-OptimizeTcpIp }
            "5" { Invoke-CheckNetworkSpeed }
            "6" { Invoke-ConfigureQoS }
            "7" { Invoke-DisableIPv6 }
            "8" { Invoke-OptimizeGamingLatency }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de rede...`n" -ForegroundColor Yellow
                Invoke-NetworkFlushDns
                Invoke-OptimizeTcpIp
                Invoke-CheckNetworkSpeed
                Invoke-ConfigureQoS
                Invoke-DisableIPv6
                Invoke-OptimizeGamingLatency
                Write-Host "`nTodas as otimiza√ß√µes de rede foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Rede..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Servi√ßos (Dentro do Avan√ßado!) ---
function Show-ServicosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: SERVICOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desabilitar Servi√ßo SuperFetch/SysMain" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Servi√ßo de Impress√£o" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Servi√ßo Windows Update" -ForegroundColor White
        Write-Host "[4] Listar Todos os Servi√ßos em Execu√ß√£o" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Otimizar Servi√ßos para Desempenho Geral" -ForegroundColor Gray
        Write-Host "[7] Restaurar Servi√ßos para Configura√ß√£o Padr√£o" -ForegroundColor Yellow
        Write-Host "[8] Desabilitar Servi√ßos Desnecess√°rios" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de servi√ßos"

        switch ($choice) {
            "1" { Invoke-ManageSuperFetch }
            "2" { Invoke-ManagePrintService }
            "3" { Invoke-ManageWindowsUpdate }
            "4" { Invoke-ListRunningServices }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-OptimizeServicesForPerformance }
            "7" { Invoke-RestoreDefaultServices }
            "8" { Invoke-DisableUnnecessaryServices }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Diagn√≥stico (Dentro do Avan√ßado!) ---
function Show-DiagnosticoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DIAGNOSTICO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Verificar Arquivos do Sistema (SFC)" -ForegroundColor Yellow
        Write-Host "[2] Reparar Imagem do Windows (DISM)" -ForegroundColor Cyan
        Write-Host "[3] Verificar Disco por Erros (CHKDSK)" -ForegroundColor White
        Write-Host "[4] Verificar Sa√∫de do Disco" -ForegroundColor Green
        Write-Host "[5] Verificar Drivers Desatualizados" -ForegroundColor Magenta
        Write-Host "[6] Verificar Problemas de Inicializa√ß√£o" -ForegroundColor Gray
        Write-Host "[7] Verificar Problemas de Mem√≥ria RAM" -ForegroundColor Yellow
        Write-Host "[8] Verificar Temperatura do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODOS os diagn√≥sticos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de diagn√≥stico"

        switch ($choice) {
            "1" { Invoke-SfcScan }
            "2" { Invoke-DismRepair }
            "3" { Invoke-ChkDsk }
            "4" { Invoke-CheckDiskHealth }
            "5" { Invoke-CheckDrivers }
            "6" { Invoke-CheckStartupIssues }
            "7" { Invoke-CheckMemory }
            "8" { Invoke-CheckTemperature }
            "9" {
                Write-Host "`nExecutando todos os diagn√≥sticos...`n" -ForegroundColor Yellow
                Invoke-SfcScan
                Invoke-DismRepair
                Invoke-CheckDiskHealth
                Invoke-CheckDrivers
                Invoke-CheckStartupIssues
                Invoke-CheckTemperature
                Write-Host "`nTodos os diagn√≥sticos foram conclu√≠dos!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Diagn√≥stico..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Recursos (Dentro do Avan√ßado!) ---
function Show-RecursosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: RECURSOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Gerenciar Hiberna√ß√£o" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Planos de Energia" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Recursos Opcionais do Windows" -ForegroundColor White
        Write-Host "[4] Gerenciar Mem√≥ria Virtual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Windows Defender" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Recursos de Telemetria" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Recursos de Inicializa√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Recursos de Seguran√ßa" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de recursos"

        switch ($choice) {
            "1" { Invoke-ManageHibernation }
            "2" { Invoke-ManagePowerPlans }
            "3" { Invoke-ManageOptionalFeatures }
            "4" { Invoke-ManageVirtualMemory }
            "5" { Invoke-ManageWindowsDefender }
            "6" { Invoke-ManageTelemetry }
            "7" { Invoke-ManageStartupResources }
            "8" { Invoke-ManageSecurityFeatures }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Arquivos e Pastas (Dentro do Avan√ßado!) ---
function Show-ArquivosPastasMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: ARQUIVOS E PASTAS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Encontrar Arquivos Grandes" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Arquivos" -ForegroundColor Cyan
        Write-Host "[3] Tomar Posse de Arquivos (TakeOwn)" -ForegroundColor White
        Write-Host "[4] Listar Conte√∫do de Pastas Espec√≠ficas" -ForegroundColor Green
        Write-Host "[5] Compactar Pastas para Economizar Espa√ßo" -ForegroundColor Magenta
        Write-Host "[6] Verificar Integridade de Arquivos" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Arquivos Ocultos e do Sistema" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Atributos de Arquivos" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de arquivos e pastas"

        switch ($choice) {
            "1" { Invoke-FindLargeFiles }
            "2" { Invoke-ManageFilePermissions }
            "3" { Invoke-TakeOwnership }
            "4" { Invoke-ListFolderContents }
            "5" { Invoke-CompressFolders }
            "6" { Invoke-VerifyFileIntegrity }
            "7" { Invoke-ManageHiddenSystemFiles }
            "8" { Invoke-ManageFileAttributes }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Usu√°rios (Dentro do Avan√ßado!) ---
function Show-UsuariosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: USUARIOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Listar Todos os Usu√°rios Locais" -ForegroundColor Yellow
        Write-Host "[2] Listar Todos os Grupos Locais" -ForegroundColor Cyan
        Write-Host "[3] Listar Membros de Grupos Espec√≠ficos" -ForegroundColor White
        Write-Host "[4] Mostrar Propriedades do Usu√°rio Atual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Contas de Usu√°rio" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Pol√≠ticas de Senha" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Permiss√µes de Usu√°rio" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar UAC (Controle de Conta de Usu√°rio)" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de usu√°rios"

        switch ($choice) {
            "1" { Invoke-ListLocalUsers }
            "2" { Invoke-ListLocalGroups }
            "3" { Invoke-ListGroupMembers }
            "4" { Invoke-ShowCurrentUserProperties }
            "5" { Invoke-ManageUserAccounts }
            "6" { Invoke-ManagePasswordPolicies }
            "7" { Invoke-ManageUserPermissions }
            "8" { Invoke-ManageUAC }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Jogos Avan√ßado (Dentro do Avan√ßado!) ---
function Show-JogosAvancadoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: JOGOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Otimizar Prioridade de CPU para Jogos" -ForegroundColor Yellow
        Write-Host "[2] Otimizar Configura√ß√µes de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[3] Otimizar Configura√ß√µes de GPU" -ForegroundColor White
        Write-Host "[4] Desativar Game DVR e Game Bar" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Configurar Modo de Jogo do Windows" -ForegroundColor Gray
        Write-Host "[7] Otimizar Configura√ß√µes de √Åudio para Jogos" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Configura√ß√µes de Input Lag" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes para jogos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o para jogos"

        switch ($choice) {
            "1" { Invoke-OptimizeCpuPriority }
            "2" { Invoke-OptimizeNetworkForGaming }
            "3" { Invoke-OptimizeGpuSettings }
            "4" { Invoke-DisableGameDvrBar }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-ConfigureGameMode }
            "7" { Invoke-OptimizeAudioForGaming }
            "8" { Invoke-OptimizeInputLag }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes para jogos...`n" -ForegroundColor Yellow
                Invoke-OptimizeCpuPriority
                Invoke-OptimizeNetworkForGaming
                Invoke-OptimizeGpuSettings
                Invoke-DisableGameDvrBar
                Invoke-OptimizeServicesForGaming
                Invoke-ConfigureGameMode
                Invoke-OptimizeAudioForGaming
                Invoke-OptimizeInputLag
                Write-Host "`nTodas as otimiza√ß√µes para jogos foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Jogos..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Privacidade (Dentro do Avan√ßado!) ---
function Show-PrivacidadeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: PRIVACIDADE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desativar Telemetria do Windows" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Aplicativos" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Hist√≥rico de Atividades" -ForegroundColor White
        Write-Host "[4] Gerenciar Diagn√≥stico e Feedback" -ForegroundColor Green
        Write-Host "[5] Gerenciar An√∫ncios Personalizados" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Localiza√ß√£o e Sensores" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Reconhecimento de Voz e Digita√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Sincroniza√ß√£o com a Microsoft" -ForegroundColor Cyan
        Write-Host "[9] Aplicar TODAS as configura√ß√µes de privacidade" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de privacidade"

        switch ($choice) {
            "1" { Invoke-DisableTelemetry }
            "2" { Invoke-ManageAppPermissions }
            "3" { Invoke-ManageActivityHistory }
            "4" { Invoke-ManageDiagnosticsFeedback }
            "5" { Invoke-ManagePersonalizedAds }
            "6" { Invoke-ManageLocationSensors }
            "7" { Invoke-ManageVoiceTyping }
            "8" { Invoke-ManageMicrosoftSync }
            "9" {
                Write-Host "`nAplicando todas as configura√ß√µes de privacidade...`n" -ForegroundColor Yellow
                Invoke-DisableTelemetry
                Invoke-ManageAppPermissions
                Invoke-ManageActivityHistory
                Invoke-ManageDiagnosticsFeedback
                Invoke-ManagePersonalizedAds
                Invoke-ManageLocationSensors
                Invoke-ManageVoiceTyping
                Invoke-ManageMicrosoftSync
                Write-Host "`nTodas as configura√ß√µes de privacidade foram aplicadas!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Privacidade..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Outros (Dentro do Avan√ßado!) ---
function Show-OutrosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: OUTROS TWEAKS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Mostrar Informa√ß√µes Detalhadas do Sistema" -ForegroundColor Yellow
        Write-Host "[2] Mostrar Configura√ß√£o Completa de Rede" -ForegroundColor Cyan
        Write-Host "[3] Reiniciar Explorer.exe" -ForegroundColor White
        Write-Host "[4] Limpar Cache de Atualiza√ß√µes do Windows" -ForegroundColor Green
        Write-Host "[5] Gerenciar Programas de Inicializa√ß√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar Op√ß√µes de Energia Avan√ßadas" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Configura√ß√µes de Armazenamento" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Configura√ß√µes de Notifica√ß√µes" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√µes diversas"

        switch ($choice) {
            "1" { Invoke-ShowDetailedSystemInfo }
            "2" { Invoke-ShowDetailedNetworkConfig }
            "3" { Invoke-RestartExplorer }
            "4" { Invoke-CleanWindowsUpdateCache }
            "5" { Invoke-ManageStartupPrograms }
            "6" { Invoke-ConfigureAdvancedPowerOptions }
            "7" { Invoke-ManageStorageSettings }
            "8" { Invoke-ManageNotificationSettings }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- Fun√ß√µes para as Secoes SIMPLIFICADAS (Expandidas) ---
function Invoke-SimpleSystemCleanup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza Geral do Sistema: Hora de varrer o lixo digital! ---" -ForegroundColor Green
    Write-Host "Essa op√ß√£o vai te ajudar a liberar espa√ßo e dar um f√¥lego pro PC tirando arquivos tempor√°rios, lixo da lixeira, etc. √â tipo faxina no computador!" -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Comando 1: Limpar Arquivos Tempor√°rios do Usu√°rio
    Write-Host "Bora come√ßar limpando os arquivos tempor√°rios do seu usu√°rio! Eles acumulam que √© uma beleza!" -ForegroundColor Yellow
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio limpos! Menos peso pro PC respirar! ;)" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Esvaziar a Lixeira
    Write-Host "Agora, vamos dar um fim definitivo naqueles arquivos na Lixeira. Eles s√≥ est√£o ocupando espa√ßo √† toa!" -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada! Espa√ßo recuperado com sucesso! R√°!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios do Windows
    Write-Host "Vamos limpar tamb√©m os tempor√°rios do pr√≥prio Windows. √Äs vezes, fica lixo escondido por l√°!" -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Limpar Cache de Navegadores Comuns
    Write-Host "Bora dar uma geral nos caches dos navegadores tamb√©m! Eles guardam um monte de coisa que pode pesar!" -ForegroundColor Yellow
    
    # Chrome
    Write-Host "Tentando limpar cache do Google Chrome..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Chrome limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Edge
    Write-Host "Tentando limpar cache do Microsoft Edge..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Edge limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Firefox
    Write-Host "Tentando limpar cache do Mozilla Firefox..." -ForegroundColor DarkGray
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\cache2\entries\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\startupCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\thumbnails\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Firefox limpo (pode n√£o ser completo, dependendo do perfil/uso)." -ForegroundColor DarkGray

    # Brave (se instalado)
    Write-Host "Tentando limpar cache do Brave Browser (se instalado)..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Brave limpo (se instalado e n√£o estiver rodando)." -ForegroundColor DarkGray

    Write-Host "Limpeza de caches de navegador conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Comando 5: Limpar Cache de Miniaturas
    Write-Host "Limpando cache de miniaturas do Windows (aquelas pr√©-visualiza√ß√µes de imagens e v√≠deos)..." -ForegroundColor Yellow
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Write-Host "Cache de miniaturas limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Limpar Arquivos de Log do Windows
    Write-Host "Limpando arquivos de log do Windows que podem ocupar espa√ßo..." -ForegroundColor Yellow
    wevtutil cl Application
    wevtutil cl System
    wevtutil cl Security
    Write-Host "Logs do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 7: Limpar Arquivos Tempor√°rios de Instala√ß√£o
    Write-Host "Limpando arquivos tempor√°rios de instala√ß√£o de programas..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Installer\$*\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios de instala√ß√£o limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 8: Limpar Arquivos de Atualiza√ß√£o do Windows
    Write-Host "Limpando arquivos de atualiza√ß√£o do Windows que podem ocupar bastante espa√ßo..." -ForegroundColor Yellow
    Stop-Service -Name wuauserv -ErrorAction SilentlyContinue
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    Write-Host "Arquivos de atualiza√ß√£o do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 9: Limpar Arquivos Prefetch
    Write-Host "Limpando arquivos prefetch para melhorar a inicializa√ß√£o..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Prefetch\*.pf" -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos prefetch limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 10: Executar Limpeza de Disco Integrada do Windows
    Write-Host "Executando a ferramenta de limpeza de disco integrada do Windows..." -ForegroundColor Yellow
    Start-Process -FilePath cleanmgr.exe -ArgumentList "/sagerun:1" -Wait -ErrorAction SilentlyContinue
    Write-Host "Limpeza de disco conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "Vamos ver quanto espa√ßo conseguimos recuperar com essa faxina:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nPronto! A faxina geral b√°sica foi feita! Seu PC agradece o espa√ßo extra! ;)" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu
    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleMemoryStartup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Mem√≥ria e Inicializa√ß√£o R√°pida: Deixa o PC ligando num piscar! ---" -ForegroundColor Yellow
    Write-Host "Aqui a gente d√° uma olhada na mem√≥ria RAM e nos programas que ligam junto com o Windows. Menos coisa ligando √† toa = PC mais r√°pido pra usar na hora!" -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Listar Programas de Inicializa√ß√£o
    Write-Host "Listando programas que iniciam com o Windows (pra voc√™ saber o que t√° rodando por baixo dos panos):" -ForegroundColor Yellow
    Get-CimInstance win32_startupcommand | Select-Object Name, command, Location | Format-Table -AutoSize
    Write-Host "Lista de programas de inicializa√ß√£o exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Servi√ßo SuperFetch/SysMain
    Write-Host "Otimizando o servi√ßo SuperFetch/SysMain para melhorar o desempenho..." -ForegroundColor Yellow
    $confirmSysMain = Read-Host "Deseja desativar o servi√ßo SysMain/SuperFetch? (s/n) - Recomendado para SSDs"
    if ($confirmSysMain -eq 's') {
        Set-Service -Name SysMain -StartupType Disabled -ErrorAction SilentlyContinue
        Stop-Service -Name SysMain -Force -ErrorAction SilentlyContinue
        Write-Host "Servi√ßo SysMain/SuperFetch desativado!" -ForegroundColor Green
    } else {
        Write-Host "Servi√ßo SysMain/SuperFetch mantido ativo." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios de Updates
    Write-Host "Limpando arquivos tempor√°rios de atualiza√ß√µes do Windows (podem ocupar bastante espa√ßo e afetar performance):" -ForegroundColor Yellow
    Dism /online /Cleanup-Image /StartComponentCleanup /ErrorAction SilentlyContinue
    Write-Host "Limpeza de componentes de atualiza√ß√£o iniciada (pode levar um tempo)." -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Mem√≥ria Virtual
    Write-Host "Otimizando configura√ß√µes de mem√≥ria virtual para melhor desempenho..." -ForegroundColor Yellow
    $totalRam = (Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property capacity -Sum).Sum / 1GB
    Write-Host "Seu sistema tem aproximadamente $totalRam GB de RAM." -ForegroundColor White
    
    $confirmPageFile = Read-Host "Deseja otimizar o arquivo de pagina√ß√£o (mem√≥ria virtual)? (s/n)"
    if ($confirmPageFile -eq 's') {
        # Calcula tamanho recomendado (1.5x a RAM para sistemas com menos de 8GB, 1x para sistemas com mais)
        $pageFileSize = if ($totalRam -lt 8) { [math]::Round($totalRam * 1.5) * 1024 } else { [math]::Round($totalRam) * 1024 }
        
        Write-Host "Configurando arquivo de pagina√ß√£o para tamanho fixo de $pageFileSize MB..." -ForegroundColor DarkGray
        $computerSystem = Get-WmiObject -Class Win32_ComputerSystem
        $computerSystem.AutomaticManagedPagefile = $false
        $computerSystem.Put() | Out-Null
        
        $pageFileSetting = Get-WmiObject -Class Win32_PageFileSetting
        if ($pageFileSetting) {
            $pageFileSetting.InitialSize = $pageFileSize
            $pageFileSetting.MaximumSize = $pageFileSize
            $pageFileSetting.Put() | Out-Null
        }
        Write-Host "Arquivo de pagina√ß√£o otimizado! (Requer reinicializa√ß√£o para aplicar totalmente)" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes de mem√≥ria virtual mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Listar os 10 Processos que mais usam mem√≥ria no momento
    Write-Host "Listando os 10 processos que mais consomem mem√≥ria agora:" -ForegroundColor Yellow
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host "Lista de processos exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Otimizar Inicializa√ß√£o do Windows
    Write-Host "Otimizando a inicializa√ß√£o do Windows..." -ForegroundColor Yellow
    # Desabilitar servi√ßos n√£o essenciais que podem atrasar a inicializa√ß√£o
    $startupServices = @(
        @{Name="DiagTrack"; DisplayName="Experi√™ncias do Usu√°rio Conectado e Telemetria"},
        @{Name="dmwappushservice"; DisplayName="Servi√ßo de Transfer√™ncia Inteligente em Segundo Plano (BITS)"},
        @{Name="MapsBroker"; DisplayName="Servi√ßo de Dados de Mapas"}
    )
    
    foreach ($service in $startupServices) {
        $confirmService = Read-Host "Deseja desativar o servi√ßo '$($service.DisplayName)' na inicializa√ß√£o? (s/n)"
        if ($confirmService -eq 's') {
            Set-Service -Name $service.Name -StartupType Disabled -ErrorAction SilentlyContinue
            Stop-Service -Name $service.Name -Force -ErrorAction SilentlyContinue
            Write-Host "Servi√ßo '$($service.DisplayName)' desativado!" -ForegroundColor Green
        } else {
            Write-Host "Servi√ßo '$($service.DisplayName)' mantido." -ForegroundColor Green
        }
    }
    Write-Host ""

    # Comando 7: Reiniciar o Computador (√ötil pra liberar mem√≥ria e aplicar mudan√ßas)
    Write-Host "Quer dar um 'refresh' geral no PC? Reiniciar pode ajudar!" -ForegroundColor Yellow
    $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (digite 'sim' para confirmar)"
    if ($confirmRestart -eq 'sim') {
        Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
        Restart-Computer -Force
    } else {
        Write-Host "Rein√≠cio cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o de mem√≥ria e inicializa√ß√£o!" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu (a n√£o ser que o PC tenha reiniciado)
    if ($confirmRestart -ne 'sim') {
        Write-Host ""
        Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
    }
}

function Invoke-SimpleInternetOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Acelerar a Conex√£o com a Internet (Simplificado): Diz adeus pro 'carregando...'! ---" -ForegroundColor Cyan
    Write-Host "Vamos fazer uns ajustes r√°pidos na sua conex√£o pra tentar deixar ela mais esperta." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Limpar Cache de DNS
    Write-Host "Limpando o cache de endere√ßos de internet (DNS) pra resolver nomes mais r√°pido!" -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Configura√ß√µes TCP/IP
    Write-Host "Otimizando configura√ß√µes TCP/IP para melhorar a velocidade de conex√£o..." -ForegroundColor Yellow
    
    # Habilitar TCP Window Auto-Tuning
    netsh int tcp set global autotuninglevel=normal
    Write-Host "TCP Auto-Tuning configurado para 'normal'." -ForegroundColor DarkGray
    
    # Otimizar par√¢metros de recebimento de pacotes
    netsh int tcp set global rss=enabled
    Write-Host "Receive-Side Scaling (RSS) habilitado." -ForegroundColor DarkGray
    
    # Otimizar congestion provider
    netsh int tcp set global congestionprovider=ctcp
    Write-Host "Congestion Provider configurado para 'ctcp'." -ForegroundColor DarkGray
    
    # Otimizar ECN capability
    netsh int tcp set global ecncapability=enabled
    Write-Host "ECN Capability habilitado." -ForegroundColor DarkGray
    
    Write-Host "Configura√ß√µes TCP/IP otimizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Reiniciar Adaptadores de Rede
    Write-Host "Dando um 'reset' r√°pido nas suas conex√µes de rede. Pode resolver uns pepinos!" -ForegroundColor Yellow
    $confirmResetAdapter = Read-Host "Isso vai desconectar brevemente sua internet. Continuar? (s/n)"
    if ($confirmResetAdapter -eq 's') {
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        Write-Host "Adaptadores de rede reiniciados." -ForegroundColor Green
    } else {
        Write-Host "Reset de adaptadores cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 4: Configurar DNS R√°pido
    Write-Host "Configurar DNS mais r√°pido pode melhorar sua navega√ß√£o!" -ForegroundColor Yellow
    $confirmDns = Read-Host "Deseja configurar DNS mais r√°pidos (Google ou Cloudflare)? (s/n)"
    if ($confirmDns -eq 's') {
        Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
        Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
        $dnsChoice = Read-Host "Escolha uma op√ß√£o (1 ou 2)"
        
        $primaryDns = ""
        $secondaryDns = ""
        
        if ($dnsChoice -eq '1') {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            Write-Host "Google DNS selecionado." -ForegroundColor DarkGray
        } elseif ($dnsChoice -eq '2') {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            Write-Host "Cloudflare DNS selecionado." -ForegroundColor DarkGray
        } else {
            Write-Host "Op√ß√£o inv√°lida. DNS n√£o alterado." -ForegroundColor Red
        }
        
        if ($primaryDns -ne "") {
            $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" -and ($_.InterfaceDescription -match "Ethernet" -or $_.InterfaceDescription -match "Wi-Fi" -or $_.InterfaceDescription -match "Wireless") }
            
            foreach ($adapter in $networkAdapters) {
                Write-Host "Configurando DNS para adaptador: $($adapter.Name)" -ForegroundColor DarkGray
                Set-DnsClientServerAddress -InterfaceIndex $adapter.ifIndex -ServerAddresses ($primaryDns, $secondaryDns)
            }
            
            Write-Host "DNS configurado! Sua navega√ß√£o deve ficar mais r√°pida agora." -ForegroundColor Green
        }
    } else {
        Write-Host "Configura√ß√£o de DNS mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Mostrar Status B√°sico da Conex√£o
    Write-Host "Mostrando um resumo b√°sico da sua configura√ß√£o de rede atual:" -ForegroundColor Yellow
    ipconfig /all | Select-String -Pattern "IPv4", "DNS", "Gateway", "DHCP", "Subnet", "Physical Address"
    Write-Host "Status b√°sico da rede exibido." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Testar a conex√£o com a internet
    Write-Host "Testando a conex√£o com a internet (ping para google.com)..." -ForegroundColor Yellow
    Test-Connection -Count 4 google.com -ErrorAction SilentlyContinue
    Write-Host "Teste de conex√£o finalizado." -ForegroundColor Green
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o b√°sica de internet!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleVisualOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Deixar o Windows mais Leve Visualmente (Simplificado): Desempenho antes da beleza! ---" -ForegroundColor White
    Write-Host "Ajustes r√°pidos pra desativar efeitos visuais que podem pesar, liberando recursos pro que importa." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ajustar Efeitos Visuais
    Write-Host "Voc√™ quer desativar ou ativar as anima√ß√µes e efeitos visuais do Windows?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Efeitos Visuais (Pra ganhar desempenho)" -ForegroundColor Green
    Write-Host "[2] Configurar para Melhor Apar√™ncia (Mais bonito, mas mais pesado)" -ForegroundColor White
    Write-Host "[3] Deixar o Windows Escolher (Configura√ß√£o padr√£o)" -ForegroundColor Cyan
    $choiceVisual = Read-Host "Escolha [1], [2] ou [3]"

    if ($choiceVisual -eq '1') {
        Write-Host "Desativando efeitos visuais para melhor desempenho..." -ForegroundColor Yellow
        # Valor 2 = Ajustar para melhor desempenho (desativa a maioria dos efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 2 -Type DWord -Force -ErrorAction SilentlyContinue
        
        # Desativar anima√ß√µes individuais
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop' -Name 'UserPreferencesMask' -Value ([byte[]](0x90, 0x12, 0x01, 0x80)) -Type Binary -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop\WindowMetrics' -Name 'MinAnimate' -Value 0 -Type String -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'ListviewAlphaSelect' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'TaskbarAnimations' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        
        Write-Host "Efeitos visuais desativados para melhor desempenho!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '2') {
        Write-Host "Configurando para melhor apar√™ncia (todos os efeitos visuais ativados)..." -ForegroundColor Yellow
        # Valor 1 = Ajustar para melhor apar√™ncia (ativa todos os efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Efeitos visuais configurados para melhor apar√™ncia!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '3') {
        Write-Host "Deixando o Windows escolher automaticamente (configura√ß√£o padr√£o)..." -ForegroundColor Yellow
        # Valor 0 = Deixar o Windows escolher
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Configura√ß√£o visual definida para padr√£o do Windows!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa nos efeitos visuais foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 2: Ativar/Desativar Efeitos de Transpar√™ncia
    Write-Host "E os efeitos de transpar√™ncia do Windows (tipo na barra de tarefas)?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Transpar√™ncia (Mais leve)" -ForegroundColor Green
    Write-Host "[2] Ativar Transpar√™ncia (Mais 'bonito')" -ForegroundColor White
    $choiceTransp = Read-Host "Escolha [1] ou [2]"

    if ($choiceTransp -eq '1') {
        Write-Host "Desativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 0 = Desativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia desativada!" -ForegroundColor Green
    } elseif ($choiceTransp -eq '2') {
        Write-Host "Ativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 1 = Ativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia ativada!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa na transpar√™ncia foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 3: Configurar Tema Claro/Escuro
    Write-Host "Voc√™ prefere tema claro ou escuro? O tema escuro pode ser mais confort√°vel para os olhos." -ForegroundColor Yellow
    Write-Host "[1] Tema Escuro (Dark Mode)" -ForegroundColor DarkGray
    Write-Host "[2] Tema Claro (Light Mode)" -ForegroundColor White
    $choiceTheme = Read-Host "Escolha [1] ou [2]"

    if ($choiceTheme -eq '1') {
        Write-Host "Configurando tema escuro..." -ForegroundColor Yellow
        # Valor 0 = Tema Escuro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema escuro configurado!" -ForegroundColor Green
    } elseif ($choiceTheme -eq '2') {
        Write-Host "Configurando tema claro..." -ForegroundColor Yellow
        # Valor 1 = Tema Claro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema claro configurado!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa no tema foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Configurar Resolu√ß√£o de Tela
    Write-Host "Deseja ajustar a resolu√ß√£o da tela? Resolu√ß√µes menores podem melhorar o desempenho em PCs mais antigos." -ForegroundColor Yellow
    $confirmResolution = Read-Host "Deseja ver e ajustar a resolu√ß√£o da tela? (s/n)"
    
    if ($confirmResolution -eq 's') {
        # Mostrar resolu√ß√£o atual
        $currentResolution = Get-WmiObject -Class Win32_VideoController | Select-Object -ExpandProperty VideoModeDescription
        Write-Host "Resolu√ß√£o atual: $currentResolution" -ForegroundColor White
        
        # Abrir configura√ß√µes de exibi√ß√£o do Windows
        Write-Host "Abrindo configura√ß√µes de exibi√ß√£o do Windows..." -ForegroundColor DarkGray
        Start-Process "ms-settings:display"
        Write-Host "Ajuste a resolu√ß√£o conforme necess√°rio na janela de configura√ß√µes que foi aberta." -ForegroundColor Green
        
        $waitForSettings = Read-Host "Pressione Enter quando terminar de ajustar as configura√ß√µes de exibi√ß√£o"
    } else {
        Write-Host "Configura√ß√£o de resolu√ß√£o mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizados os ajustes visuais b√°sicos!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleGamingOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Jogos (Simplificado): Mais FPS, menos lag! ---" -ForegroundColor Magenta
    Write-Host "Vamos fazer alguns ajustes para melhorar o desempenho dos seus jogos sem complica√ß√µes." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ativar Modo de Jogo do Windows
    Write-Host "Ativando o Modo de Jogo do Windows para priorizar recursos para jogos..." -ForegroundColor Yellow
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AllowAutoGameMode" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AutoGameModeEnabled" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Write-Host "Modo de Jogo do Windows ativado!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Desativar Game DVR e Game Bar
    Write-Host "O Game DVR e Game Bar podem reduzir o desempenho em jogos. Deseja desativ√°-los?" -ForegroundColor Yellow
    $confirmGameDVR = Read-Host "Desativar Game DVR e Game Bar? (s/n)"
    
    if ($confirmGameDVR -eq 's') {
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "UseNexusForGameBarEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\System\GameConfigStore" -Name "GameDVR_Enabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR" -Name "AppCaptureEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Write-Host "Game DVR e Game Bar desativados!" -ForegroundColor Green
    } else {
        Write-Host "Game DVR e Game Bar mantidos ativos." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Otimizar Plano de Energia para Jogos
    Write-Host "Configurando plano de energia para alto desempenho (ideal para jogos)..." -ForegroundColor Yellow
    powercfg.exe /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c
    Write-Host "Plano de energia configurado para alto desempenho!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Configura√ß√µes de Mouse
    Write-Host "Otimizando configura√ß√µes de mouse para jogos (precis√£o do ponteiro)..." -ForegroundColor Yellow
    $confirmMouseFix = Read-Host "Desativar a acelera√ß√£o do mouse para melhor precis√£o em jogos? (s/n)"
    
    if ($confirmMouseFix -eq 's') {
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseSpeed" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold1" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold2" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Write-Host "Acelera√ß√£o do mouse desativada para melhor precis√£o em jogos!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do mouse mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Otimizar Prioridade de CPU para Jogos
    Write-Host "Configurando prioridade de CPU para jogos..." -ForegroundColor Yellow
    Write-Host "Esta configura√ß√£o ajusta o sistema para dar mais prioridade aos jogos." -ForegroundColor DarkGray
    
    # Criar chave de registro para prioridade de jogos
    if (-not (Test-Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games")) {
        New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Force | Out-Null
    }
    
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "GPU Priority" -Type DWord -Value 8 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Priority" -Type DWord -Value 6 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Scheduling Category" -Type String -Value "High" -Force -ErrorAction SilentlyContinue
    
    Write-Host "Prioridade de CPU para jogos otimizada!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Verificar Driver de Placa de V√≠deo
    Write-Host "Verificando informa√ß√µes da placa de v√≠deo..." -ForegroundColor Yellow
    $gpuInfo = Get-WmiObject -Class Win32_VideoController | Select-Object Name, DriverVersion, CurrentHorizontalResolution, CurrentVerticalResolution
    
    foreach ($gpu in $gpuInfo) {
        Write-Host "Placa de v√≠deo: $($gpu.Name)" -ForegroundColor White
        Write-Host "Vers√£o do driver: $($gpu.DriverVersion)" -ForegroundColor White
        Write-Host "Resolu√ß√£o atual: $($gpu.CurrentHorizontalResolution) x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
      x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
    
    Write-Host "Recomenda√ß√£o: Mantenha seus drivers de v√≠deo atualizados para melhor desempenho em jogos!" -ForegroundColor Green
    Write-Host "Voc√™ pode baixar os drivers mais recentes nos sites oficiais da NVIDIA, AMD ou Intel." -ForegroundColor DarkGray
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nOtimiza√ß√µes para jogos conclu√≠das! Seus jogos devem rodar mais suaves agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleSecurityMaintenance {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Manuten√ß√£o de Seguran√ßa (Simplificado): Mantenha seu PC protegido! ---" -ForegroundColor DarkYellow
    Write-Host "Vamos verificar e melhorar a seguran√ßa do seu sistema com alguns ajustes simples." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Verificar Status do Windows Defender
    Write-Host "Verificando status do Windows Defender..." -ForegroundColor Yellow
    $defenderStatus = Get-MpComputerStatus
    
    Write-Host "Status do Windows Defender:" -ForegroundColor White
    Write-Host "Antiv√≠rus habilitado: $($defenderStatus.AntivirusEnabled)" -ForegroundColor $(if ($defenderStatus.AntivirusEnabled) { "Green" } else { "Red" })
    Write-Host "Prote√ß√£o em tempo real: $($defenderStatus.RealTimeProtectionEnabled)" -ForegroundColor $(if ($defenderStatus.RealTimeProtectionEnabled) { "Green" } else { "Red" })
    Write-Host "Defini√ß√µes de antiv√≠rus: $($defenderStatus.AntivirusSignatureVersion)" -ForegroundColor White
    Write-Host "√öltima atualiza√ß√£o: $($defenderStatus.AntivirusSignatureLastUpdated)" -ForegroundColor White
    Write-Host ""

    # Comando 2: Atualizar Defini√ß√µes do Windows Defender
    Write-Host "Atualizando defini√ß√µes do Windows Defender..." -ForegroundColor Yellow
    Update-MpSignature -ErrorAction SilentlyContinue
    Write-Host "Defini√ß√µes do Windows Defender atualizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Verificar Atualiza√ß√µes do Windows
    Write-Host "Verificando status das atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
            Write-Host "Recomenda√ß√£o: Execute o Windows Update para manter seu sistema seguro." -ForegroundColor Green
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Verificar Configura√ß√µes de Firewall
    Write-Host "Verificando status do Firewall do Windows..." -ForegroundColor Yellow
    $firewallStatus = Get-NetFirewallProfile
    
    foreach ($profile in $firewallStatus) {
        Write-Host "Perfil: $($profile.Name)" -ForegroundColor White
        Write-Host "Status: $($profile.Enabled)" -ForegroundColor $(if ($profile.Enabled) { "Green" } else { "Red" })
        Write-Host ""
    }
    
    $confirmFirewall = Read-Host "Deseja habilitar o Firewall em todos os perfis? (s/n)"
    if ($confirmFirewall -eq 's') {
        Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True
        Write-Host "Firewall habilitado em todos os perfis!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do Firewall mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Verificar Configura√ß√µes de UAC
    Write-Host "Verificando configura√ß√µes do Controle de Conta de Usu√°rio (UAC)..." -ForegroundColor Yellow
    $uacLevel = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -ErrorAction SilentlyContinue
    
    if ($uacLevel) {
        switch ($uacLevel.ConsentPromptBehaviorAdmin) {
            0 { $uacStatus = "Desativado (N√£o recomendado)" }
            1 { $uacStatus = "Baixo (N√£o recomendado)" }
            2 { $uacStatus = "M√©dio" }
            5 { $uacStatus = "Alto (Recomendado)" }
            default { $uacStatus = "Personalizado" }
        }
        
        Write-Host "N√≠vel atual do UAC: $uacStatus" -ForegroundColor $(if ($uacLevel.ConsentPromptBehaviorAdmin -ge 2) { "Green" } else { "Red" })
        
        $confirmUAC = Read-Host "Deseja configurar o UAC para o n√≠vel recomendado? (s/n)"
        if ($confirmUAC -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -Value 5 -Type DWord -Force -ErrorAction SilentlyContinue
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "PromptOnSecureDesktop" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
            Write-Host "UAC configurado para o n√≠vel recomendado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do UAC mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do UAC." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 6: Verificar Configura√ß√µes de SmartScreen
    Write-Host "Verificando configura√ß√µes do Windows SmartScreen..." -ForegroundColor Yellow
    $smartScreen = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -ErrorAction SilentlyContinue
    
    if ($smartScreen) {
        Write-Host "Status do SmartScreen: $($smartScreen.SmartScreenEnabled)" -ForegroundColor $(if ($smartScreen.SmartScreenEnabled -eq "RequireAdmin" -or $smartScreen.SmartScreenEnabled -eq "Warn") { "Green" } else { "Red" })
        
        $confirmSmartScreen = Read-Host "Deseja habilitar o SmartScreen para maior seguran√ßa? (s/n)"
        if ($confirmSmartScreen -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -Value "RequireAdmin" -Type String -Force -ErrorAction SilentlyContinue
            Write-Host "SmartScreen habilitado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do SmartScreen mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do SmartScreen." -ForegroundColor Red
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nManuten√ß√£o de seguran√ßa conclu√≠da! Seu sistema est√° mais protegido agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

# --- Fun√ß√µes para o Diagn√≥stico R√°pido e Sobre ---
function Invoke-QuickDiagnostic {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Diagn√≥stico R√°pido do Sistema ---" -ForegroundColor Yellow
    Write-Host "Vamos fazer uma verifica√ß√£o r√°pida do estado atual do seu PC." -ForegroundColor Gray
    Write-Host ""

    # Informa√ß√µes do Sistema
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    $sysInfo = Get-SystemInfo
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host ""

    # Uso de CPU
    Write-Host "=== Uso de CPU ===" -ForegroundColor Cyan
    $cpuLoad = (Get-WmiObject Win32_Processor).LoadPercentage
    Write-Host "Uso atual de CPU: $cpuLoad%" -ForegroundColor $(if ($cpuLoad -lt 70) { "Green" } elseif ($cpuLoad -lt 90) { "Yellow" } else { "Red" })
    Write-Host ""

    # Uso de Mem√≥ria
    Write-Host "=== Uso de Mem√≥ria ===" -ForegroundColor Cyan
    $os = Get-WmiObject Win32_OperatingSystem
    $totalMemory = [math]::Round($os.TotalVisibleMemorySize / 1MB, 2)
    $freeMemory = [math]::Round($os.FreePhysicalMemory / 1MB, 2)
    $usedMemory = [math]::Round($totalMemory - $freeMemory, 2)
    $memoryPercentage = [math]::Round(($usedMemory / $totalMemory) * 100, 2)
    
    Write-Host "Mem√≥ria Total: $totalMemory GB" -ForegroundColor White
    Write-Host "Mem√≥ria Usada: $usedMemory GB ($memoryPercentage%)" -ForegroundColor $(if ($memoryPercentage -lt 70) { "Green" } elseif ($memoryPercentage -lt 90) { "Yellow" } else { "Red" })
    Write-Host "Mem√≥ria Livre: $freeMemory GB" -ForegroundColor White
    Write-Host ""

    # Espa√ßo em Disco
    Write-Host "=== Espa√ßo em Disco ===" -ForegroundColor Cyan
    $drives = Get-PSDrive -PSProvider FileSystem
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        $percentFree = [math]::Round(($freeSpace / $totalSpace) * 100, 2)
        
        Write-Host "Drive $($drive.Name):" -ForegroundColor White
        Write-Host "  Total: $totalSpace GB" -ForegroundColor White
        Write-Host "  Usado: $usedSpace GB" -ForegroundColor White
        Write-Host "  Livre: $freeSpace GB ($percentFree%)" -ForegroundColor $(if ($percentFree -gt 20) { "Green" } elseif ($percentFree -gt 10) { "Yellow" } else { "Red" })
    }
    Write-Host ""

    # Processos que mais consomem recursos
    Write-Host "=== Top 5 Processos (CPU) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object CPU -Descending | Select-Object -First 5 ProcessName, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}}, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host ""

    Write-Host "=== Top 5 Processos (Mem√≥ria) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 5 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}}, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}} | Format-Table -AutoSize
    Write-Host ""

    # Status de Servi√ßos Cr√≠ticos
    Write-Host "=== Status de Servi√ßos Cr√≠ticos ===" -ForegroundColor Cyan
    $criticalServices = @("wuauserv", "WinDefend", "MpsSvc", "wscsvc")
    foreach ($service in $criticalServices) {
        $serviceStatus = Get-Service -Name $service -ErrorAction SilentlyContinue
        if ($serviceStatus) {
            Write-Host "$($serviceStatus.DisplayName): $($serviceStatus.Status)" -ForegroundColor $(if ($serviceStatus.Status -eq "Running") { "Green" } else { "Red" })
        }
    }
    Write-Host ""

    # Verificar Atualiza√ß√µes Pendentes
    Write-Host "=== Atualiza√ß√µes do Windows ===" -ForegroundColor Cyan
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Recomenda√ß√µes
    Write-Host "=== Recomenda√ß√µes ===" -ForegroundColor Cyan
    
    # Recomenda√ß√£o de Mem√≥ria
    if ($memoryPercentage -gt 80) {
        Write-Host "- Seu uso de mem√≥ria est√° alto. Considere fechar alguns programas ou usar a op√ß√£o 'Otimiza√ß√£o de Mem√≥ria'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Disco
    $lowDiskSpace = $false
    foreach ($drive in $drives) {
        $percentFree = [math]::Round(($drive.Free / ($drive.Free + $drive.Used)) * 100, 2)
        if ($percentFree -lt 15) {
            $lowDiskSpace = $true
            break
        }
    }
    
    if ($lowDiskSpace) {
        Write-Host "- Espa√ßo em disco baixo detectado. Considere usar a op√ß√£o 'Limpeza Geral do Sistema'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Atualiza√ß√µes
    if ($pendingUpdates -gt 0) {
        Write-Host "- Existem atualiza√ß√µes pendentes. Recomendamos atualizar seu sistema para maior seguran√ßa." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Inicializa√ß√£o
    $bootTime = $sysInfo.LastBootTime
    $uptime = (Get-Date) - $bootTime
    if ($uptime.Days -gt 7) {
        Write-Host "- Seu sistema est√° ligado h√° $($uptime.Days) dias. Considere reiniciar para aplicar atualiza√ß√µes e limpar a mem√≥ria." -ForegroundColor Yellow
    }
    
    Write-Host ""

    # Mensagem de conclus√£o
    Write-Host "`nDiagn√≥stico r√°pido conclu√≠do! Use as informa√ß√µes acima para decidir quais otimiza√ß√µes fazer." -ForegroundColor Green

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

function Show-AboutTORK {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Sobre o TORK ---" -ForegroundColor White
    Write-Host ""
    
    Write-Host "TORK - Otimizador para Windows" -ForegroundColor Cyan
    Write-Host "Vers√£o: 2.0" -ForegroundColor White
    Write-Host "Desenvolvido por: Partner77" -ForegroundColor White
    Write-Host ""
    
    Write-Host "=== Descri√ß√£o ===" -ForegroundColor Yellow
    Write-Host "O TORK √© uma ferramenta abrangente de otimiza√ß√£o para Windows, projetada para" -ForegroundColor Gray
    Write-Host "melhorar o desempenho do seu sistema atrav√©s de limpeza, ajustes e otimiza√ß√µes." -ForegroundColor Gray
    Write-Host "Ele oferece op√ß√µes simplificadas para usu√°rios comuns e op√ß√µes avan√ßadas para" -ForegroundColor Gray
    Write-Host "usu√°rios experientes que desejam um controle mais detalhado sobre o sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Recursos ===" -ForegroundColor Yellow
    Write-Host "- Limpeza completa do sistema" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√£o de mem√≥ria e inicializa√ß√£o" -ForegroundColor Gray
    Write-Host "- Ajustes de rede para melhor conectividade" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√µes visuais para melhor desempenho" -ForegroundColor Gray
    Write-Host "- Configura√ß√µes espec√≠ficas para jogos" -ForegroundColor Gray
    Write-Host "- Manuten√ß√£o de seguran√ßa" -ForegroundColor Gray
    Write-Host "- Diagn√≥stico r√°pido do sistema" -ForegroundColor Gray
    Write-Host "- Mais de 100 ajustes e otimiza√ß√µes avan√ßadas" -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Aviso Legal ===" -ForegroundColor Yellow
    Write-Host "Este software √© fornecido 'como est√°', sem garantias de qualquer tipo." -ForegroundColor Gray
    Write-Host "O autor n√£o se responsabiliza por quaisquer danos ou problemas causados pelo uso" -ForegroundColor Gray
    Write-Host "deste software. Use por sua conta e risco. Recomendamos sempre fazer backup" -ForegroundColor Gray
    Write-Host "dos seus dados importantes antes de realizar otimiza√ß√µes no sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Agradecimentos ===" -ForegroundColor Yellow
    Write-Host "Obrigado por escolher o TORK para otimizar seu sistema Windows!" -ForegroundColor Gray
    Write-Host "Esperamos que esta ferramenta ajude a melhorar o desempenho do seu PC." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "¬© 2023-2024 Partner77 - Todos os direitos reservados" -ForegroundColor Cyan
    Write-Host ""
    
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - LIMPEZA (Expandidas) ---
function Invoke-CleanUserTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Usu√°rio ---" -ForegroundColor Cyan
    Write-Host "Remove arquivos da pasta tempor√°ria do seu usu√°rio (`$env:TEMP`)." -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:TEMP..." -ForegroundColor Yellow
    $tempFiles = Get-ChildItem -Path $env:TEMP -Recurse -ErrorAction SilentlyContinue
    $tempFilesCount = ($tempFiles | Measure-Object).Count
    $tempFilesSize = ($tempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $tempFilesCount arquivos tempor√°rios ocupando aproximadamente $([math]::Round($tempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Sistema ---" -ForegroundColor Gray
    Write-Host "Remove arquivos da pasta tempor√°ria do Windows (`$env:SystemRoot\Temp`)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:SystemRoot\Temp..." -ForegroundColor Yellow
    $systemTempFiles = Get-ChildItem -Path "$env:SystemRoot\Temp" -Recurse -ErrorAction SilentlyContinue
    $systemTempFilesCount = ($systemTempFiles | Measure-Object).Count
    $systemTempFilesSize = ($systemTempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $systemTempFilesCount arquivos tempor√°rios do sistema ocupando aproximadamente $([math]::Round($systemTempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do sistema removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanDnsCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-EmptyRecycleBin {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Esvaziar Lixeira ---" -ForegroundColor Gray
    Write-Host "Esvazia a lixeira do usu√°rio logado." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar tamanho da lixeira antes de esvaziar
    Write-Host "Verificando tamanho da lixeira..." -ForegroundColor Yellow
    
    try {
        $shell = New-Object -ComObject Shell.Application
        $recycleBin = $shell.Namespace(0xA)
        $recycleBinItems = $recycleBin.Items()
        $recycleBinItemCount = $recycleBinItems.Count
        
        Write-Host "A lixeira cont√©m $recycleBinItemCount itens." -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o conte√∫do da lixeira." -ForegroundColor DarkGray
    }
    
    # Esvaziar a lixeira
    Write-Host "Executando: Esvaziando a lixeira..." -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanThumbnailCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Miniaturas ---" -ForegroundColor Green
    Write-Host "Remove o cache de miniaturas de arquivos (imagens, v√≠deos, etc.)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Limpando cache de miniaturas..." -ForegroundColor Yellow
    
    # Verificar tamanho do cache de miniaturas antes da limpeza
    $thumbnailPath = "$env:LOCALAPPDATA\Microsoft\Windows\Explorer"
    $thumbnailFiles = Get-ChildItem -Path $thumbnailPath -Filter "thumbcache_*.db" -ErrorAction SilentlyContinue
    $thumbnailFilesCount = ($thumbnailFiles | Measure-Object).Count
    $thumbnailFilesSize = ($thumbnailFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $thumbnailFilesCount arquivos de cache de miniaturas ocupando aproximadamente $([math]::Round($thumbnailFilesSize, 2)) MB." -ForegroundColor White
    
    # Limpar o cache de miniaturas
    Stop-Process -Name explorer -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Start-Process explorer
    
    Write-Host "Cache de miniaturas limpo com sucesso!" -ForegroundColor Green
    Write-Host "O Windows Explorer foi reiniciado para aplicar as altera√ß√µes." -ForegroundColor DarkGray
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de miniaturas:" -ForegroundColor Cyan
    Write-Host "- Navega√ß√£o mais r√°pida em pastas com muitas imagens ou v√≠deos" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de miniaturas corrompidas ou desatualizadas" -ForegroundColor DarkGray
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemLogs {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Logs do Sistema ---" -ForegroundColor Cyan
    Write-Host "Limpa os logs de eventos do sistema para liberar espa√ßo e melhorar o desempenho." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando logs do sistema..." -ForegroundColor Yellow
    
    # Verificar tamanho dos logs antes da limpeza
    $eventLogs = Get-WinEvent -ListLog * -ErrorAction SilentlyContinue | Where-Object { $_.RecordCount -gt 0 }
    $totalLogCount = ($eventLogs | Measure-Object).Count
    $total = ($eventLogs | Measure-Object -Property FileSize -Sum).Sum / 1MB
    
    Write-Host "Encontrados $totalLogCount logs de eventos ocupando aproximadamente $([math]::Round($total, 2)) MB." -ForegroundColor White
    
    # Limpar os logs principais
    Write-Host "Limpando logs principais do sistema..." -ForegroundColor Yellow
    
    $mainLogs = @("Application", "System", "Security")
    foreach ($log in $mainLogs) {
        try {
            $logSize = (Get-WinEvent -ListLog $log -ErrorAction SilentlyContinue).FileSize / 1MB
            $logRecords = (Get-WinEvent -ListLog $log -ErrorAction SilentlyContinue).RecordCount
            
            Write-Host "Log $log: $([math]::Round($logSize, 2)) MB com $logRecords registros" -ForegroundColor DarkGray
            wevtutil cl $log
            Write-Host "Log $log limpo com sucesso!" -ForegroundColor Green
        } catch {
            Write-Host "N√£o foi poss√≠vel limpar o log $log." -ForegroundColor Red
        }
    }
    
    # Perguntar se deseja limpar todos os outros logs
    $confirmAllLogs = Read-Host "Deseja limpar todos os outros logs do sistema? (s/n)"
    
    if ($confirmAllLogs -eq 's') {
        Write-Host "Limpando todos os logs do sistema... (isso pode levar algum tempo)" -ForegroundColor Yellow
        
        $otherLogs = $eventLogs | Where-Object { $_.LogName -notin $mainLogs }
        foreach ($log in $otherLogs) {
            try {
                wevtutil cl $log.LogName
            } catch {
                # Ignorar erros silenciosamente
            }
        }
        
        Write-Host "Todos os logs do sistema foram limpos!" -ForegroundColor Green
    } else {
        Write-Host "Apenas os logs principais foram limpos." -ForegroundColor Green
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanWindowsUpdateCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Atualiza√ß√µes do Windows ---" -ForegroundColor Yellow
    Write-Host "Limpa os arquivos tempor√°rios de atualiza√ß√µes do Windows para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando cache de atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    
    # Verificar tamanho da pasta SoftwareDistribution antes da limpeza
    $updateCachePath = "$env:SystemRoot\SoftwareDistribution\Download"
    $updateCacheFiles = Get-ChildItem -Path $updateCachePath -Recurse -ErrorAction SilentlyContinue
    $updateCacheSize = ($updateCacheFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "O cache de atualiza√ß√µes do Windows est√° ocupando aproximadamente $([math]::Round($updateCacheSize, 2)) MB." -ForegroundColor White
    
    # Parar o servi√ßo Windows Update
    Write-Host "Parando o servi√ßo Windows Update..." -ForegroundColor DarkGray
    Stop-Service -Name wuauserv -Force -ErrorAction SilentlyContinue
    
    # Limpar o cache de atualiza√ß√µes
    Write-Host "Limpando o cache de atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    
    # Iniciar o servi√ßo Windows Update novamente
    Write-Host "Iniciando o servi√ßo Windows Update..." -ForegroundColor DarkGray
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    
    Write-Host "Cache de atualiza√ß√µes do Windows limpo com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de atualiza√ß√µes:" -ForegroundColor Cyan
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray
    Write-Host "- Resolu√ß√£o de problemas com atualiza√ß√µes do Windows" -ForegroundColor DarkGray
    Write-Host "- Melhoria no desempenho do sistema" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanHibernationFile {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos de Hiberna√ß√£o ---" -ForegroundColor White
    Write-Host "Gerencia o arquivo de hiberna√ß√£o (hiberfil.sys) para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar status atual da hiberna√ß√£o
    Write-Host "Verificando status atual da hiberna√ß√£o..." -ForegroundColor Yellow
    $hibernationStatus = powercfg.exe /availablesleepstates | Select-String -Pattern "Hiberna√ß√£o"
    
    if ($hibernationStatus -match "Hiberna√ß√£o est√° desativada") {
        $currentStatus = "desativada"
    } else {
        $currentStatus = "ativada"
    }
    
    Write-Host "Status atual da hiberna√ß√£o: $currentStatus" -ForegroundColor White
    
    # Verificar tamanho do arquivo de hiberna√ß√£o (se existir)
    $systemDrive = $env:SystemDrive
    $hiberfilPath = "$systemDrive\hiberfil.sys"
    
    if (Test-Path -Path $hiberfilPath -ErrorAction SilentlyContinue) {
        try {
            $hiberfilSize = (Get-Item -Path $hiberfilPath -Force -ErrorAction SilentlyContinue).Length / 1GB
            Write-Host "Tamanho do arquivo de hiberna√ß√£o: $([math]::Round($hiberfilSize, 2)) GB" -ForegroundColor White
        } catch {
            Write-Host "N√£o foi poss√≠vel determinar o tamanho do arquivo de hiberna√ß√£o." -ForegroundColor DarkGray
        }
    } else {
        Write-Host "Arquivo de hiberna√ß√£o n√£o encontrado (j√° est√° desativado)." -ForegroundColor DarkGray
    }
    
    # Perguntar se deseja desativar ou ativar a hiberna√ß√£o
    if ($currentStatus -eq "ativada") {
        $confirmHibernation = Read-Host "Deseja desativar a hiberna√ß√£o para liberar espa√ßo em disco? (s/n)"
        
        if ($confirmHibernation -eq 's') {
            Write-Host "Desativando a hiberna√ß√£o..." -ForegroundColor Yellow
            powercfg.exe /hibernate off
            Write-Host "Hiberna√ß√£o desativada com sucesso! O arquivo hiberfil.sys foi removido." -ForegroundColor Green
        } else {
            Write-Host "Hiberna√ß√£o mantida ativada." -ForegroundColor Green
        }
    } else {
        $confirmHibernation = Read-Host "Deseja ativar a hiberna√ß√£o? (s/n)"
        
        if ($confirmHibernation -eq 's') {
            Write-Host "Ativando a hiberna√ß√£o..." -ForegroundColor Yellow
            powercfg.exe /hibernate on
            Write-Host "Hiberna√ß√£o ativada com sucesso! O arquivo hiberfil.sys foi criado." -ForegroundColor Green
            
            # Verificar novo tamanho do arquivo de hiberna√ß√£o
            if (Test-Path -Path $hiberfilPath -ErrorAction SilentlyContinue) {
                try {
                    $newHiberfilSize = (Get-Item -Path $hiberfilPath -Force -ErrorAction SilentlyContinue).Length / 1GB
                    Write-Host "Tamanho do novo arquivo de hiberna√ß√£o: $([math]::Round($newHiberfilSize, 2)) GB" -ForegroundColor White
                } catch {
                    Write-Host "N√£o foi poss√≠vel determinar o tamanho do novo arquivo de hiberna√ß√£o." -ForegroundColor DarkGray
                }
            }
        } else {
            Write-Host "Hiberna√ß√£o mantida desativada." -ForegroundColor Green
        }
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo foi afetado:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nInforma√ß√µes sobre a hiberna√ß√£o:" -ForegroundColor Cyan
    Write-Host "- O arquivo de hiberna√ß√£o (hiberfil.sys) geralmente ocupa espa√ßo equivalente a 75% da RAM instalada" -ForegroundColor DarkGray
    Write-Host "- Desativar a hiberna√ß√£o libera esse espa√ßo, mas voc√™ n√£o poder√° usar o modo de hiberna√ß√£o" -ForegroundColor DarkGray
    Write-Host "- A hiberna√ß√£o √© √∫til para laptops, pois salva o estado do sistema no disco antes de desligar" -ForegroundColor DarkGray
    Write-Host "- Para desktops, a hiberna√ß√£o geralmente √© menos necess√°ria" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanWinSxS {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Pasta WinSxS ---" -ForegroundColor Magenta
    Write-Host "Limpa componentes n√£o utilizados da pasta WinSxS para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "A pasta WinSxS (Windows Side-by-Side) armazena componentes do sistema e pode ocupar muito espa√ßo." -ForegroundColor White
    Write-Host "Esta limpeza √© segura e usa ferramentas oficiais do Windows para remover componentes n√£o utilizados." -ForegroundColor White
    Write-Host ""
    
    # Verificar tamanho da pasta WinSxS antes da limpeza
    Write-Host "Verificando tamanho da pasta WinSxS (isso pode levar algum tempo)..." -ForegroundColor Yellow
    
    try {
        $winSxSSize = (Get-ChildItem -Path "$env:SystemRoot\WinSxS" -Recurse -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum / 1GB
        Write-Host "Tamanho atual da pasta WinSxS: $([math]::Round($winSxSSize, 2)) GB" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel determinar o tamanho da pasta WinSxS." -ForegroundColor DarkGray
    }
    
    # Perguntar se deseja prosseguir com a limpeza
    $confirmCleanup = Read-Host "Deseja prosseguir com a limpeza da pasta WinSxS? (s/n)"
    
    if ($confirmCleanup -eq 's') {
        Write-Host "Executando limpeza de componentes n√£o utilizados (isso pode levar v√°rios minutos)..." -ForegroundColor Yellow
        
        # Executar limpeza de componentes
        Write-Host "Etapa 1: Limpeza de componentes..." -ForegroundColor DarkGray
        Dism.exe /Online /Cleanup-Image /StartComponentCleanup
        
        # Perguntar se deseja executar limpeza mais agressiva (com reset base)
        $confirmResetBase = Read-Host "Deseja executar uma limpeza mais profunda? (remove a capacidade de desinstalar atualiza√ß√µes) (s/n)"
        
        if ($confirmResetBase -eq 's') {
            Write-Host "Etapa 2: Executando limpeza profunda (isso pode levar muito tempo)..." -ForegroundColor DarkGray
            Dism.exe /Online /Cleanup-Image /StartComponentCleanup /ResetBase
            Write-Host "Limpeza profunda conclu√≠da!" -ForegroundColor Green
        }
        
        Write-Host "Limpeza da pasta WinSxS conclu√≠da com sucesso!" -ForegroundColor Green
        
        # Verificar tamanho da pasta WinSxS ap√≥s a limpeza
        try {
            $newWinSxSSize = (Get-ChildItem -Path "$env:SystemRoot\WinSxS" -Recurse -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum / 1GB
            $savedSpace = $winSxSSize - $newWinSxSSize
            
            Write-Host "Tamanho atual da pasta WinSxS: $([math]::Round($newWinSxSSize, 2)) GB" -ForegroundColor White
            Write-Host "Espa√ßo liberado: $([math]::Round($savedSpace, 2)) GB" -ForegroundColor Green
        } catch {
            Write-Host "N√£o foi poss√≠vel determinar o novo tamanho da pasta WinSxS." -ForegroundColor DarkGray
        }
    } else {
        Write-Host "Limpeza da pasta WinSxS cancelada." -ForegroundColor Yellow
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nInforma√ß√µes sobre a pasta WinSxS:" -ForegroundColor Cyan
    Write-Host "- A pasta WinSxS armazena componentes do sistema Windows e atualiza√ß√µes" -ForegroundColor DarkGray
    Write-Host "- N√£o √© recomendado excluir esta pasta manualmente" -ForegroundColor DarkGray
    Write-Host "- A limpeza realizada √© segura e usa ferramentas oficiais do Windows" -ForegroundColor DarkGray
    Write-Host "- Ap√≥s a limpeza profunda, n√£o ser√° poss√≠vel desinstalar algumas atualiza√ß√µes" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - REDE (Expandidas) ---
function Invoke-NetworkFlushDns {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Limpar Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-NetworkChangeDns {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Mudar Servidor DNS ---" -ForegroundColor Cyan
    Write-Host "Permite definir servidores DNS personalizados para suas conex√µes de rede." -ForegroundColor DarkGray
    Write-Host ""

    # Listar adaptadores de rede ativos
    Write-Host "Listando adaptadores de rede ativos..." -ForegroundColor Yellow
    $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" }
    
    if ($networkAdapters.Count -eq 0) {
        Write-Host "Nenhum adaptador de rede ativo encontrado." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    Write-Host "Adaptadores de rede ativos:" -ForegroundColor White
    $index = 1
    foreach ($adapter in $networkAdapters) {
        Write-Host "[$index] $($adapter.Name) - $($adapter.InterfaceDescription)" -ForegroundColor White
        $index++
    }
    Write-Host ""
    
    # Selecionar adaptador de rede
    $adapterChoice = Read-Host "Selecione o n√∫mero do adaptador que deseja configurar (ou 0 para voltar)"
    
    if ($adapterChoice -eq "0" -or $adapterChoice -eq "") {
        Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    $adapterIndex = [int]$adapterChoice - 1
    if ($adapterIndex -lt 0 -or $adapterIndex -ge $networkAdapters.Count) {
        Write-Host "Sele√ß√£o inv√°lida." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    $selectedAdapter = $networkAdapters[$adapterIndex]
    
    # Mostrar configura√ß√£o DNS atual
    Write-Host "Configura√ß√£o DNS atual para $($selectedAdapter.Name):" -ForegroundColor Yellow
    $currentDns = Get-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -AddressFamily IPv4 | Select-Object -ExpandProperty ServerAddresses
    
    if ($currentDns.Count -eq 0) {
        Write-Host "Nenhum servidor DNS configurado manualmente (usando DHCP)." -ForegroundColor DarkGray
    } else {
        foreach ($dns in $currentDns) {
            Write-Host $dns -ForegroundColor White
        }
    }
    Write-Host ""
    
    # Op√ß√µes de DNS
    Write-Host "Op√ß√µes de DNS:" -ForegroundColor Yellow
    Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
    Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
    Write-Host "[3] OpenDNS (208.67.222.222, 208.67.220.220)" -ForegroundColor White
    Write-Host "[4] Quad9 (9.9.9.9, 149.112.112.112)" -ForegroundColor White
    Write-Host "[5] AdGuard DNS (94.140.14.14, 94.140.15.15)" -ForegroundColor White
    Write-Host "[6] Inserir DNS personalizado" -ForegroundColor White
    Write-Host "[7] Usar DNS autom√°tico (DHCP)" -ForegroundColor White
    Write-Host "[0] Cancelar" -ForegroundColor White
    Write-Host ""
    
    $dnsChoice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($dnsChoice) {
        "1" {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            $dnsName = "Google DNS"
        }
        "2" {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            $dnsName = "Cloudflare DNS"
        }
        "3" {
            $primaryDns = "208.67.222.222"
            $secondaryDns = "208.67.220.220"
            $dnsName = "OpenDNS"
        }
        "4" {
            $primaryDns = "9.9.9.9"
            $secondaryDns = "149.112.112.112"
            $dnsName = "Quad9"
        }
        "5" {
            $primaryDns = "94.140.14.14"
            $secondaryDns = "94.140.15.15"
            $dnsName = "AdGuard DNS"
        }
        "6" {
            $primaryDns = Read-Host "Digite o endere√ßo do DNS prim√°rio"
            $secondaryDns = Read-Host "Digite o endere√ßo do DNS secund√°rio (ou deixe em branco)"
            $dnsName = "DNS Personalizado"
        }
        "7" {
            Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ResetServerAddresses
            Write-Host "Configura√ß√£o de DNS definida para autom√°tica (DHCP)." -ForegroundColor Green
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
        "0" {
            Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
        default {
            Write-Host "Op√ß√£o inv√°lida." -ForegroundColor Red
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
    }
    
    # Aplicar configura√ß√£o de DNS
    if ($secondaryDns -eq "") {
        Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ServerAddresses $primaryDns
    } else {
        Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ServerAddresses $primaryDns, $secondaryDns
    }
    
    Write-Host "Configura√ß√£o de DNS alterada para $dnsName." -ForegroundColor Green
    Write-Host "DNS Prim√°rio: $primaryDns" -ForegroundColor White
    if ($secondaryDns -ne "") {
        Write-Host "DNS Secund√°rio: $secondaryDns" -ForegroundColor White
    }
    
    # Limpar cache DNS ap√≥s a mudan√ßa
    Write-Host "Limpando cache DNS para aplicar as altera√ß√µes..." -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo." -ForegroundColor Green
    
    Write-Host "`nBenef√≠cios de usar servidores DNS alternativos:" -ForegroundColor Cyan
    Write-Host "- Maior velocidade de resolu√ß√£o de nomes" -ForegroundColor DarkGray
    Write-Host "- Melhor confiabilidade e disponibilidade" -ForegroundColor DarkGray
    Write-Host "- Alguns servidores oferecem prote√ß√£o adicional contra malware e phishing" -ForegroundColor DarkGray
    Write-Host "- Possibilidade de contornar bloqueios de conte√∫do baseados em DNS" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-NetworkReset {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Resetar Configura√ß√µes de Rede ---" -ForegroundColor White
    Write-Host "Reinicia os componentes de rede. Use como √∫ltimo recurso para solucionar problemas de conex√£o." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "!!! ATEN√á√ÉO: ESTE COMANDO VAI REINICIAR SUAS CONFIGURA√á√ïES DE REDE !!!" -ForegroundColor Red
    Write-Host "Sua conex√£o ser√° interrompida temporariamente e todas as configura√ß√µes de rede personalizadas ser√£o redefinidas." -ForegroundColor Yellow
    Write-Host "Isso inclui adaptadores de rede, configura√ß√µes de DNS, configura√ß√µes de proxy, etc." -ForegroundColor Yellow
    Write-Host ""
    
    Write-Host "Esta opera√ß√£o pode ajudar a resolver os seguintes problemas:" -ForegroundColor Cyan
    Write-Host "- Conex√µes de rede inst√°veis ou intermitentes" -ForegroundColor DarkGray
    Write-Host "- Problemas de DNS ou resolu√ß√£o de nomes" -ForegroundColor DarkGray
    Write-Host "- Problemas de conectividade ap√≥s instala√ß√£o de software ou atualiza√ß√µes" -ForegroundColor DarkGray
    Write-Host "- Erros de rede persistentes que n√£o s√£o resolvidos por outros m√©todos" -ForegroundColor DarkGray
    Write-Host ""
    
    $confirm = Read-Host "Tem certeza que deseja resetar as configura√ß√µes de rede? (digite 'sim' para confirmar)"
    
    if ($confirm -eq 'sim') {
        Write-Host "Iniciando reset de configura√ß√µes de rede..." -ForegroundColor Yellow
        
        # Etapa 1: Resetar pilha TCP/IP
        Write-Host "Etapa 1: Resetando pilha TCP/IP..." -ForegroundColor DarkGray
        netsh int ip reset
        
        # Etapa 2: Resetar cat√°logo Winsock
        Write-Host "Etapa 2: Resetando cat√°logo Winsock..." -ForegroundColor DarkGray
        netsh winsock reset
        
        # Etapa 3: Limpar cache DNS
        Write-Host "Etapa 3: Limpando cache DNS..." -ForegroundColor DarkGray
        ipconfig /flushdns
        
        # Etapa 4: Renovar configura√ß√µes DHCP
        Write-Host "Etapa 4: Renovando configura√ß√µes DHCP..." -ForegroundColor DarkGray
        ipconfig /release
        ipconfig /renew
        
        # Etapa 5: Reiniciar adaptadores de rede
        Write-Host "Etapa 5: Reiniciando adaptadores de rede..." -ForegroundColor DarkGray
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        
        Write-Host "Reset de configura√ß√µes de rede conclu√≠do!" -ForegroundColor Green
        Write-Host "Recomenda-se reiniciar o computador para aplicar todas as altera√ß√µes." -ForegroundColor Yellow
        
        $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (s/n)"
        if ($confirmRestart -eq 's') {
            Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
            Restart-Computer -Force
        } else {
            Write-Host "Rein√≠cio cancelado. Algumas altera√ß√µes podem n√£o ter efeito at√© que o computador seja reiniciado." -ForegroundColor Yellow
        }
    } else {
        Write-Host "Reset de configura√ß√µes de rede cancelado." -ForegroundColor Green
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-OptimizeTcpIp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Otimizar Configura√ß√µes TCP/IP ---" -ForegroundColor Green
    Write-Host "Ajusta configura√ß√µes avan√ßadas do TCP/IP para melhorar o desempenho da conex√£o." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o otimiza v√°rios par√¢metros TCP/IP para melhorar a velocidade e estabilidade da conex√£o." -ForegroundColor White
    Write-Host "As otimiza√ß√µes s√£o seguras e podem ser revertidas se necess√°rio." -ForegroundColor White
    Write-Host ""
    
    Write-Host "Configura√ß√µes atuais:" -ForegroundColor Yellow
    
    # Mostrar configura√ß√µes atuais
    Write-Host "Auto-Tuning Level:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Auto-Tuning Level"
    
    Write-Host "Congestion Provider:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Congestion Control Provider"
    
    Write-Host "ECN Capability:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "ECN Capability"
    
    Write-Host "Receive-Side Scaling (RSS):" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Receive-Side Scaling State"
    
    Write-Host ""
    $confirm = Read-Host "Deseja aplicar otimiza√ß√µes TCP/IP recomendadas? (s/n)"
    
    if ($confirm -eq 's') {
        Write-Host "Aplicando otimiza√ß√µes TCP/IP..." -ForegroundColor Yellow
        
        # Otimiza√ß√£o 1: Habilitar TCP Window Auto-Tuning
        Write-Host "Configurando TCP Auto-Tuning para 'normal'..." -ForegroundColor DarkGray
        netsh int tcp set global### Enhanced TORK Optimizer

I'll enhance the TORK optimizer with more comprehensive functionality across all features, starting with an expanded Simple Cleanup function and then improving all other options.

```powershell type="code"
# Define a preferencia de acao para erros (continua a execucao por padrao)
# Permite que o script tente rodar o m√°ximo poss√≠vel mesmo que alguns comandos encontrem problemas.
$ErrorActionPreference = 'SilentlyContinue' # N√£o exibe erros se um item n√£o puder ser processado, por exemplo.

# --- Funcao pra Centralizar Texto (Nosso Maestro de Alinhamento - s√≥ pra textos, n√£o pro bannerz√£o!) ---
# Deixa ela aqui, vai que a gente usa pra centralizar outra coisa, n√©?
function Centraliza($texto, $cor="White") {
    $largura = [console]::WindowWidth # Pega a largura da largura da janela agora
    # Calcula o espa√ßo pra botar o texto no meio. Pura matem√°tica da zoeira!
    $espacos = [Math]::Max(0, [Math]::Floor(($largura - $texto.Length) / 2))
    $linha = (" " * $espacos) + $texto # Cria a linha com os espa√ßos e o texto
    Write-Host $linha -ForegroundColor $cor # Manda pro console com a cor pedida
}

# --- Funcao que Desenha o Nosso Banner Irado do TORK! ---
# Esse √© o nosso outdoor digital no console! Ajustado pros espa√ßos que voc√™ mandou!
# Se as bordas ainda estiverem meio teimosas, √© o jeitinho do console mesmo, viu? üòâ
function Banner-TORK {
    # Nossas cores vibrantes para o banner!
    $CorBorda = "DarkCyan" # Mantido para a borda, combina com o ciano. Se quiser mudar, √© aqui!
    $CorLogo = "Green" # Cor vibrante
    $CorProjeto = "Cyan" # Cor vibrante
    $CorCopyright = "Gray" # Tom mais suave

    Write-Host "" # D√° um espacinho no topo, pra n√£o grudar
    Write-Host "                    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë          ‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë ‚ñà‚ñà‚ïî‚ïù                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ñà‚ñà‚ïó                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù                                          ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë           Bem-vindo ao TORK - Otimizador para Windows!                                ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë        Projeto de automacao, limpeza, manutencao e tweaks.                            ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë            (C) Partner77 - Todos os direitos reservados                               ‚ïë" -ForegroundColor $CorCopyright
    Write-Host "                    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor $CorBorda
    Write-Host "" # Espa√ßo embaixo
}

# --- Checagem de Permiss√µes de Administrador (O Guarda da Porta!) ---
# V√™ se a gente t√° rodando com poderes de admin, sen√£o n√£o d√° pra mexer no Windows direito.
function Test-Administrator {
    $currentUser = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())
    return $currentUser.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
}

if (-not (Test-Administrator)) {
    Write-Host "OPA! Calma l√°, patr√£o!" -ForegroundColor Red
    Write-Host "Pra usar o TORK e deixar o PC voando, preciso de super poderes de Administrador!" -ForegroundColor Yellow
    Write-Host "Fecha essa janela, clica com o bot√£o direito no arquivo do script e escolhe 'Executar como administrador'. A√≠ sim, tamo junto!" -ForegroundColor Yellow
    Read-Host "D√° um Enter quando terminar de ler, que a gente se v√™ na pr√≥xima..."
    Exit
}

Write-Host "Poderes de Administrador verificados! Bora nessa!" -ForegroundColor Green
Start-Sleep -Seconds 1

# --- Fun√ß√µes Utilit√°rias (Ferramentas que usamos em v√°rios lugares) ---
function Get-SystemInfo {
    $os = Get-CimInstance Win32_OperatingSystem
    $cs = Get-CimInstance Win32_ComputerSystem
    $proc = Get-CimInstance Win32_Processor
    $mem = Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property Capacity -Sum
    
    $info = @{
        "OSName" = $os.Caption
        "OSVersion" = $os.Version
        "OSBuild" = $os.BuildNumber
        "ComputerName" = $cs.Name
        "Manufacturer" = $cs.Manufacturer
        "Model" = $cs.Model
        "Processor" = $proc.Name
        "Memory" = [math]::Round($mem.Sum / 1GB, 2)
        "Architecture" = $os.OSArchitecture
        "InstallDate" = $os.InstallDate
        "LastBootTime" = $os.LastBootUpTime
    }
    
    return $info
}

function Show-SystemSummary {
    $sysInfo = Get-SystemInfo
    
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Computador: $($sysInfo.ComputerName)" -ForegroundColor White
    Write-Host "Fabricante: $($sysInfo.Manufacturer)" -ForegroundColor White
    Write-Host "Modelo: $($sysInfo.Model)" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "Instalado em: $($sysInfo.InstallDate)" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

function Get-DiskSpaceBefore {
    $drives = Get-PSDrive -PSProvider FileSystem
    $driveInfo = @{}
    
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        
        $driveInfo[$drive.Name] = @{
            "Free" = $freeSpace
            "Used" = $usedSpace
            "Total" = $totalSpace
        }
    }
    
    return $driveInfo
}

function Show-DiskSpaceComparison {
    param (
        $before
    )
    
    $after = Get-PSDrive -PSProvider FileSystem
    
    Write-Host "=== Compara√ß√£o de Espa√ßo em Disco ===" -ForegroundColor Cyan
    
    foreach ($drive in $after) {
        if ($before.ContainsKey($drive.Name)) {
            $freeSpaceAfter = [math]::Round($drive.Free / 1GB, 2)
            $freeSpaceBefore = $before[$drive.Name].Free
            $spaceRecovered = [math]::Round($freeSpaceAfter - $freeSpaceBefore, 2)
            
            Write-Host "Drive $($drive.Name):" -ForegroundColor White
            Write-Host "  Espa√ßo livre antes: $freeSpaceBefore GB" -ForegroundColor Gray
            Write-Host "  Espa√ßo livre agora: $freeSpaceAfter GB" -ForegroundColor Gray
            
            if ($spaceRecovered -gt 0) {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Green
            } else {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Yellow
            }
            Write-Host ""
        }
    }
    
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

# --- Fun√ß√µes dos Menus (Principal, Simplificado, Avan√ßado e Sub-menus) ---

# --- Menu Principal (A Bifurca√ß√£o do Destino! Simplificado vs Avan√ßado) ---
# √â aqui que o usu√°rio escolhe se quer ser um mago ou um cara pr√°tico!
function Show-MainMenu {
    do {
        Clear-Host # Limpa a tela pra organizar o menu
        Banner-TORK # Banner no topo, pra gente n√£o esquecer quem somos!
        Show-SystemSummary # Mostra um resumo do sistema

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "       MENU PRINCIPAL" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # As duas grandes estradas da otimiza√ß√£o! Cores variadas (repetindo)!
        Write-Host "[1] Otimiza√ß√£o Simplificada (Pra quem quer praticidade e resultado r√°pido!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o Avan√ßada (Pra quem curte mexer fundo e ter control total!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[3] Diagn√≥stico R√°pido do Sistema (Ver o que t√° rolando no PC)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[4] Sobre o TORK (Informa√ß√µes e cr√©ditos)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[0] Sair (Ah, que pena... Mas a porta t√° aberta!)" -ForegroundColor Red # Vermelho pra Sair - Ok

        Write-Host ""

        # Pergunta pro usu√°rio qual caminho ele escolhe, tipo Mestre Pok√©mon!
        $choice = Read-Host "Escolhe sua op√ß√£o, treinador!"

        # V√™ pra onde a gente vai com base na escolha
        switch ($choice) {
            "1" { Show-SimplifiedMenu } # Se escolheu 1, vai pro Menu Simplificado!
            "2" { Show-AdvancedMenu } # Se escolheu 2, vai pro Menu Avan√ßado!
            "3" { Invoke-QuickDiagnostic } # Nova fun√ß√£o de diagn√≥stico r√°pido
            "4" { Show-AboutTORK } # Nova fun√ß√£o de sobre
            "0" { Write-Host "Fechou! Valeu por usar o TORK! Volte sempre que seu PC pedir um g√°s! ;)" -ForegroundColor Green; Start-Sleep -Seconds 2; break } # Se escolheu 0, vaza (mas volta!)
            default {
                Write-Host "Eita! Op√ß√£o inv√°lida! Confere os n√∫meros e tenta de novo, bora l√°!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1 # D√° um tempinho pro usu√°rio ver a zoeira da mensagem
            }
        }
    } while ($choice -ne '0') # Repete o Menu Principal enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Simplificado (Aqui o TORK faz m√°gica r√°pida e segura!) ---
# Acessado pela op√ß√£o 1 do Menu Principal. Menos op√ß√µes, mais a√ß√£o direta!
function Show-SimplifiedMenu {
    do {
        Clear-Host # Limpa o palco pra esse menu!
        Banner-TORK # Nosso banner no topo, sempre presente!

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "   OTIMIZACAO SIMPLIFICADA" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes SIMPLIFICADAS - cada uma pode fazer um monte de coisa por baixo dos panos! Cores variadas (repetindo as prim√°rias/neon e adicionando outras)!
        Write-Host "[1] Limpeza Geral do Sistema (Tira o lixo que t√° pesando!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o de Mem√≥ria e Programas que Ligam com o Windows (Deixa tudo mais √°gil!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[3] Acelerar a Conex√£o com a Internet (Pra navegar sem gargalo!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[4] Deixar o Windows mais Leve Visualmente (Desativa uns efeitos pra ganhar desempenho!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Otimiza√ß√£o de Jogos (Configura√ß√µes pra melhorar FPS e desempenho)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[6] Manuten√ß√£o de Seguran√ßa (Verificar e corrigir problemas de seguran√ßa)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[7] RODAR TODAS as otimiza√ß√µes SIMPLIFICADAS! (Modo Turbo F√°cil!)" -ForegroundColor Red # Vermelho pra "Faz Tudo" - Destaque/Cuidado
        Write-Host "[0] Voltar ao Menu Principal (A gente te espera aqui!)" -ForegroundColor Gray # Cor neutra pra voltar

        Write-Host ""

        # Pergunta qual m√°gica simplificada o usu√°rio quer
        $choice = Read-Host "Escolhe sua m√°gica simplificada!"

        # V√™ qual m√°gica rodar
        switch ($choice) {
            "1" { Invoke-SimpleSystemCleanup } # Chama a fun√ß√£o de limpeza b√°sica
            "2" { Invoke-SimpleMemoryStartup } # Chama a fun√ß√£o pra mem√≥ria/inicializa√ß√£o
            "3" { Invoke-SimpleInternetOpt } # Chama a fun√ß√£o pra internet
            "4" { Invoke-SimpleVisualOpt } # Chama a fun√ß√£o pra visual
            "5" { Invoke-SimpleGamingOpt } # Nova fun√ß√£o para otimiza√ß√£o de jogos
            "6" { Invoke-SimpleSecurityMaintenance } # Nova fun√ß√£o para manuten√ß√£o de seguran√ßa
            "7" {
                # Rodar todas as simplificadas sequencialmente
                Write-Host "`nModo Turbo F√°cil ATIVADO! Rodando todas as otimiza√ß√µes SIMPLIFICADAS... segura pe√£o!`n" -ForegroundColor Yellow
                Invoke-SimpleSystemCleanup # Roda a 1
                Invoke-SimpleMemoryStartup # Roda a 2
                Invoke-SimpleInternetOpt # Roda a 3
                Invoke-SimpleVisualOpt # Roda a 4
                Invoke-SimpleGamingOpt # Roda a 5
                Invoke-SimpleSecurityMaintenance # Roda a 6
                Write-Host "`nShow! Todas as otimiza√ß√µes SIMPLIFICADAS foram executadas! PC t√° agradecendo! ;)`n" -ForegroundColor Green
                Read-Host "Aperta Enter pra voltar pro Menu Simplificado..." # Pausa no final do "Rodar Todas"
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-MainMenu
            default {
                Write-Host "Ops! Op√ß√£o inv√°lida no Menu Simplificado! Confere os n√∫meros e manda bala de novo!" -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Simplificado enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Avan√ßado (O Playground dos Magos do PC!) ---
# Acessado pela op√ß√£o 2 do Menu Principal. Aqui a gente mergulha fundo!
function Show-AdvancedMenu {
    do {
        Clear-Host # Limpa o palco pro menu avan√ßado!
        Banner-TORK # Nosso banner no topo, pra n√£o perder a pose!

        Write-Host "" # Espacinho maroto
        Write-Host "===============================" -ForegroundColor White
        Write-Host "      MENU AVANCADO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes do menu avan√ßado (as CATEGORIAS dos 200 poderes!) Cores variadas (repetindo)!
        Write-Host "[1] Limpeza e Manuten√ß√£o de Arquivos (Tirar a poeira digital!)" -ForegroundColor Cyan # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[2] Otimiza√ß√µes de Desempenho do Sistema (Deixar o motor roncando!)" -ForegroundColor Green # Cor variada
        Write-Host "[3] Configura√ß√µes e Otimiza√ß√µes de Rede (Pra internet voar baixo!)" -ForegroundColor Yellow # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[4] Gerenciamento e Otimiza√ß√£o de Servi√ßos do Windows (O que t√° rodando e n√£o precisa?!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Ferramentas de Diagn√≥stico e Verifica√ß√£o (Pra ver se t√° tudo nos conformes!)" -ForegroundColor Cyan # Cor repetida
        Write-Host "[6] Desabilitar/Gerenciar Recursos do Windows (Tirar o peso extra do sistema!)" -ForegroundColor Green # Cor repetida
        Write-Host "[7] Gerenciamento de Arquivos e Pastas Avan√ßado (Comandos ninja pra arquivos!)" -ForegroundColor Yellow # Cor repetida
        Write-Host "[8] Gerenciamento de Contas de Usu√°rio (Organizar a galera que usa o PC!)" -ForegroundColor White # Cor repetida
        Write-Host "[9] Otimiza√ß√£o para Jogos Avan√ßada (Tweaks pra gamers de verdade!)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Configura√ß√µes de Privacidade (Controle o que o Windows sabe sobre voc√™)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[11] Outras Configura√ß√µes e Tweaks Diversos (Aqueles ajustes secretos!)" -ForegroundColor Gray # Cor neutra/escura
        Write-Host "[0] Voltar ao Menu Principal (Pronto pra voltar pra estrada principal!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta pro mago qual categoria ele quer explorar
        $choice = Read-Host "Escolhe sua √°rea de magia, mago!"

        # V√™ pra onde a gente navega dentro do mundo avan√ßado
        switch ($choice) {
            "1" { Show-LimpezaManutencaoMenu } # CHAMA O SUB-MENU DE LIMPEZA
            "2" { Show-DesempenhoMenu } # Agora √© um sub-menu tamb√©m
            "3" { Show-ConfiguracoesRedeMenu } # CHAMA O SUB-MENU DE REDE
            "4" { Show-ServicosMenu } # Agora √© um sub-menu tamb√©m
            "5" { Show-DiagnosticoMenu } # Agora √© um sub-menu tamb√©m
            "6" { Show-RecursosMenu } # Agora √© um sub-menu tamb√©m
            "7" { Show-ArquivosPastasMenu } # Agora √© um sub-menu tamb√©m
            "8" { Show-UsuariosMenu } # Agora √© um sub-menu tamb√©m
            "9" { Show-JogosAvancadoMenu } # Novo sub-menu para jogos
            "10" { Show-PrivacidadeMenu } # Novo sub-menu para privacidade
            "11" { Show-OutrosMenu } # Agora √© um sub-menu tamb√©m
            "0" { break } # Sai do loop deste menu, voltando pro Menu Principal
            default {
                Write-Host "Humm, essa √°rea da magia ainda n√£o existe ou voc√™ digitou errado! Tenta de novo, mago!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Avan√ßado enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Limpeza e Manuten√ß√£o (Dentro do Avan√ßado!) ---
# Este menu lista as op√ß√µes ESPEC√çFICAS da categoria Limpeza no Menu Avan√ßado
function Show-LimpezaManutencaoMenu {
    do {
        Clear-Host # Limpa o palco pra este sub-menu!
        Banner-TORK # Banner no topo, sempre!

        Write-Host "" # Espacinho
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: LIMPEZA E MANUT." -ForegroundColor White # T√≠tulo menor pro sub-menu
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes ESPEC√çFICAS da categoria Limpeza. Cores variadas (repetindo cores)!
        Write-Host "[1] Limpar Arquivos Tempor√°rios do Usu√°rio (Tipo a pasta Temp!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[2] Limpar Arquivos Tempor√°rios do Sistema (Os tempor√°rios do Windows!)" -ForegroundColor Gray # Cor neutra (substitui DarkCyan)
        Write-Host "[3] Limpar Cache de DNS (Pra resolver nomes de site mais r√°pido!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[4] Esvaziar Lixeira (Adeus, arquivos deletados!)" -ForegroundColor Gray # Cor neutra (repetindo)
        Write-Host "[5] Limpar Cache de Miniaturas (Aqueles previews de imagem/v√≠deo!)" -ForegroundColor Green # Cor variada
        Write-Host "[6] Limpar Logs do Sistema (Arquivos de registro que acumulam)" -ForegroundColor Cyan # Nova op√ß√£o
        Write-Host "[7] Limpar Cache de Atualiza√ß√µes do Windows (Liberar espa√ßo de updates)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[8] Limpar Arquivos de Hiberna√ß√£o (Liberar o hiberfil.sys)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[9] Limpar Arquivos WinSxS (Pasta que ocupa muito espa√ßo)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Executar TODAS as limpezas acima (Faxina completa!)" -ForegroundColor Red # Nova op√ß√£o
        Write-Host "[0] Voltar ao Menu Avan√ßado (De volta pras categorias!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta qual limpeza espec√≠fica o mago quer fazer
        $choice = Read-Host "Escolhe a limpeza avan√ßada, mestre!"

        # V√™ qual fun√ß√£o de limpeza espec√≠fica chamar
        switch ($choice) {
            "1" { Invoke-CleanUserTemp } # Chama a fun√ß√£o pra Limpar Temp Usu√°rio
            "2" { Invoke-CleanSystemTemp } # Chama a fun√ß√£o pra Limpar Temp Sistema
            "3" { Invoke-CleanDnsCache } # Chama a fun√ß√£o pra Limpar Cache DNS
            "4" { Invoke-EmptyRecycleBin } # Chama a fun√ß√£o pra Esvaziar Lixeira
            "5" { Invoke-CleanThumbnailCache } # Chama a fun√ß√£o pra Limpar Cache de Miniaturas
            "6" { Invoke-CleanSystemLogs } # Nova fun√ß√£o para limpar logs do sistema
            "7" { Invoke-CleanWindowsUpdateCache } # Nova fun√ß√£o para limpar cache de updates
            "8" { Invoke-CleanHibernationFile } # Nova fun√ß√£o para limpar arquivo de hiberna√ß√£o
            "9" { Invoke-CleanWinSxS } # Nova fun√ß√£o para limpar pasta WinSxS
            "10" { 
                # Executa todas as limpezas em sequ√™ncia
                Write-Host "`nIniciando faxina completa do sistema! Isso pode demorar um pouco...`n" -ForegroundColor Yellow
                $diskSpaceBefore = Get-DiskSpaceBefore
                
                Invoke-CleanUserTemp
                Invoke-CleanSystemTemp
                Invoke-CleanDnsCache
                Invoke-EmptyRecycleBin
                Invoke-CleanThumbnailCache
                Invoke-CleanSystemLogs
                Invoke-CleanWindowsUpdateCache
                Invoke-CleanHibernationFile
                Invoke-CleanWinSxS
                
                Write-Host "`nFaxina completa finalizada! Veja quanto espa√ßo foi recuperado:`n" -ForegroundColor Green
                Show-DiskSpaceComparison -before $diskSpaceBefore
                Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-AdvancedMenu
            default {
                Write-Host "Essa tarefa de limpeza ainda n√£o t√° na lista! V√™ os n√∫meros e tenta de novo!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Sub-Menu Limpeza enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Desempenho (Dentro do Avan√ßado!) ---
function Show-DesempenhoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DESEMPENHO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Ajustar Efeitos Visuais para Melhor Desempenho" -ForegroundColor Green
        Write-Host "[2] Otimizar Disco do Sistema" -ForegroundColor Cyan
        Write-Host "[3] Limpar Arquivos Prefetch" -ForegroundColor Yellow
        Write-Host "[4] Definir Plano de Energia para Alto Desempenho" -ForegroundColor White
        Write-Host "[5] Otimizar Servi√ßo SuperFetch/SysMain" -ForegroundColor Magenta
        Write-Host "[6] Ajustar Tamanho da Mem√≥ria Virtual" -ForegroundColor Gray
        Write-Host "[7] Desativar Indexa√ß√£o de Arquivos" -ForegroundColor Green
        Write-Host "[8] Otimizar Inicializa√ß√£o do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de desempenho" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o de desempenho"

        switch ($choice) {
            "1" { Invoke-OptimizeVisualEffects }
            "2" { Invoke-OptimizeDisk }
            "3" { Invoke-CleanPrefetch }
            "4" { Invoke-SetHighPerformancePower }
            "5" { Invoke-OptimizeSuperFetch }
            "6" { Invoke-AdjustVirtualMemory }
            "7" { Invoke-DisableIndexing }
            "8" { Invoke-OptimizeStartup }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de desempenho...`n" -ForegroundColor Yellow
                Invoke-OptimizeVisualEffects
                Invoke-OptimizeDisk
                Invoke-CleanPrefetch
                Invoke-SetHighPerformancePower
                Invoke-OptimizeSuperFetch
                Invoke-AdjustVirtualMemory
                Invoke-DisableIndexing
                Invoke-OptimizeStartup
                Write-Host "`nTodas as otimiza√ß√µes de desempenho foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Configura√ß√µes de Rede (Dentro do Avan√ßado!) ---
function Show-ConfiguracoesRedeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: CONFIG. REDE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Limpar Cache de DNS" -ForegroundColor Yellow
        Write-Host "[2] Mudar Servidor DNS" -ForegroundColor Cyan
        Write-Host "[3] Resetar Configura√ß√µes de Rede" -ForegroundColor White
        Write-Host "[4] Otimizar Configura√ß√µes TCP/IP" -ForegroundColor Green
        Write-Host "[5] Verificar Velocidade da Conex√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar QoS (Qualidade de Servi√ßo)" -ForegroundColor Gray
        Write-Host "[7] Desativar IPv6 (Se n√£o estiver usando)" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Lat√™ncia de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de rede" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√£o de rede"

        switch ($choice) {
            "1" { Invoke-NetworkFlushDns }
            "2" { Invoke-NetworkChangeDns }
            "3" { Invoke-NetworkReset }
            "4" { Invoke-OptimizeTcpIp }
            "5" { Invoke-CheckNetworkSpeed }
            "6" { Invoke-ConfigureQoS }
            "7" { Invoke-DisableIPv6 }
            "8" { Invoke-OptimizeGamingLatency }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de rede...`n" -ForegroundColor Yellow
                Invoke-NetworkFlushDns
                Invoke-OptimizeTcpIp
                Invoke-CheckNetworkSpeed
                Invoke-ConfigureQoS
                Invoke-DisableIPv6
                Invoke-OptimizeGamingLatency
                Write-Host "`nTodas as otimiza√ß√µes de rede foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Rede..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Servi√ßos (Dentro do Avan√ßado!) ---
function Show-ServicosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: SERVICOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desabilitar Servi√ßo SuperFetch/SysMain" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Servi√ßo de Impress√£o" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Servi√ßo Windows Update" -ForegroundColor White
        Write-Host "[4] Listar Todos os Servi√ßos em Execu√ß√£o" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Otimizar Servi√ßos para Desempenho Geral" -ForegroundColor Gray
        Write-Host "[7] Restaurar Servi√ßos para Configura√ß√£o Padr√£o" -ForegroundColor Yellow
        Write-Host "[8] Desabilitar Servi√ßos Desnecess√°rios" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de servi√ßos"

        switch ($choice) {
            "1" { Invoke-ManageSuperFetch }
            "2" { Invoke-ManagePrintService }
            "3" { Invoke-ManageWindowsUpdate }
            "4" { Invoke-ListRunningServices }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-OptimizeServicesForPerformance }
            "7" { Invoke-RestoreDefaultServices }
            "8" { Invoke-DisableUnnecessaryServices }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Diagn√≥stico (Dentro do Avan√ßado!) ---
function Show-DiagnosticoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DIAGNOSTICO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Verificar Arquivos do Sistema (SFC)" -ForegroundColor Yellow
        Write-Host "[2] Reparar Imagem do Windows (DISM)" -ForegroundColor Cyan
        Write-Host "[3] Verificar Disco por Erros (CHKDSK)" -ForegroundColor White
        Write-Host "[4] Verificar Sa√∫de do Disco" -ForegroundColor Green
        Write-Host "[5] Verificar Drivers Desatualizados" -ForegroundColor Magenta
        Write-Host "[6] Verificar Problemas de Inicializa√ß√£o" -ForegroundColor Gray
        Write-Host "[7] Verificar Problemas de Mem√≥ria RAM" -ForegroundColor Yellow
        Write-Host "[8] Verificar Temperatura do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODOS os diagn√≥sticos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de diagn√≥stico"

        switch ($choice) {
            "1" { Invoke-SfcScan }
            "2" { Invoke-DismRepair }
            "3" { Invoke-ChkDsk }
            "4" { Invoke-CheckDiskHealth }
            "5" { Invoke-CheckDrivers }
            "6" { Invoke-CheckStartupIssues }
            "7" { Invoke-CheckMemory }
            "8" { Invoke-CheckTemperature }
            "9" {
                Write-Host "`nExecutando todos os diagn√≥sticos...`n" -ForegroundColor Yellow
                Invoke-SfcScan
                Invoke-DismRepair
                Invoke-CheckDiskHealth
                Invoke-CheckDrivers
                Invoke-CheckStartupIssues
                Invoke-CheckTemperature
                Write-Host "`nTodos os diagn√≥sticos foram conclu√≠dos!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Diagn√≥stico..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Recursos (Dentro do Avan√ßado!) ---
function Show-RecursosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: RECURSOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Gerenciar Hiberna√ß√£o" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Planos de Energia" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Recursos Opcionais do Windows" -ForegroundColor White
        Write-Host "[4] Gerenciar Mem√≥ria Virtual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Windows Defender" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Recursos de Telemetria" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Recursos de Inicializa√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Recursos de Seguran√ßa" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de recursos"

        switch ($choice) {
            "1" { Invoke-ManageHibernation }
            "2" { Invoke-ManagePowerPlans }
            "3" { Invoke-ManageOptionalFeatures }
            "4" { Invoke-ManageVirtualMemory }
            "5" { Invoke-ManageWindowsDefender }
            "6" { Invoke-ManageTelemetry }
            "7" { Invoke-ManageStartupResources }
            "8" { Invoke-ManageSecurityFeatures }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Arquivos e Pastas (Dentro do Avan√ßado!) ---
function Show-ArquivosPastasMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: ARQUIVOS E PASTAS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Encontrar Arquivos Grandes" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Arquivos" -ForegroundColor Cyan
        Write-Host "[3] Tomar Posse de Arquivos (TakeOwn)" -ForegroundColor White
        Write-Host "[4] Listar Conte√∫do de Pastas Espec√≠ficas" -ForegroundColor Green
        Write-Host "[5] Compactar Pastas para Economizar Espa√ßo" -ForegroundColor Magenta
        Write-Host "[6] Verificar Integridade de Arquivos" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Arquivos Ocultos e do Sistema" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Atributos de Arquivos" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de arquivos e pastas"

        switch ($choice) {
            "1" { Invoke-FindLargeFiles }
            "2" { Invoke-ManageFilePermissions }
            "3" { Invoke-TakeOwnership }
            "4" { Invoke-ListFolderContents }
            "5" { Invoke-CompressFolders }
            "6" { Invoke-VerifyFileIntegrity }
            "7" { Invoke-ManageHiddenSystemFiles }
            "8" { Invoke-ManageFileAttributes }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Usu√°rios (Dentro do Avan√ßado!) ---
function Show-UsuariosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: USUARIOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Listar Todos os Usu√°rios Locais" -ForegroundColor Yellow
        Write-Host "[2] Listar Todos os Grupos Locais" -ForegroundColor Cyan
        Write-Host "[3] Listar Membros de Grupos Espec√≠ficos" -ForegroundColor White
        Write-Host "[4] Mostrar Propriedades do Usu√°rio Atual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Contas de Usu√°rio" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Pol√≠ticas de Senha" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Permiss√µes de Usu√°rio" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar UAC (Controle de Conta de Usu√°rio)" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de usu√°rios"

        switch ($choice) {
            "1" { Invoke-ListLocalUsers }
            "2" { Invoke-ListLocalGroups }
            "3" { Invoke-ListGroupMembers }
            "4" { Invoke-ShowCurrentUserProperties }
            "5" { Invoke-ManageUserAccounts }
            "6" { Invoke-ManagePasswordPolicies }
            "7" { Invoke-ManageUserPermissions }
            "8" { Invoke-ManageUAC }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Jogos Avan√ßado (Dentro do Avan√ßado!) ---
function Show-JogosAvancadoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: JOGOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Otimizar Prioridade de CPU para Jogos" -ForegroundColor Yellow
        Write-Host "[2] Otimizar Configura√ß√µes de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[3] Otimizar Configura√ß√µes de GPU" -ForegroundColor White
        Write-Host "[4] Desativar Game DVR e Game Bar" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Configurar Modo de Jogo do Windows" -ForegroundColor Gray
        Write-Host "[7] Otimizar Configura√ß√µes de √Åudio para Jogos" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Configura√ß√µes de Input Lag" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes para jogos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o para jogos"

        switch ($choice) {
            "1" { Invoke-OptimizeCpuPriority }
            "2" { Invoke-OptimizeNetworkForGaming }
            "3" { Invoke-OptimizeGpuSettings }
            "4" { Invoke-DisableGameDvrBar }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-ConfigureGameMode }
            "7" { Invoke-OptimizeAudioForGaming }
            "8" { Invoke-OptimizeInputLag }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes para jogos...`n" -ForegroundColor Yellow
                Invoke-OptimizeCpuPriority
                Invoke-OptimizeNetworkForGaming
                Invoke-OptimizeGpuSettings
                Invoke-DisableGameDvrBar
                Invoke-OptimizeServicesForGaming
                Invoke-ConfigureGameMode
                Invoke-OptimizeAudioForGaming
                Invoke-OptimizeInputLag
                Write-Host "`nTodas as otimiza√ß√µes para jogos foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Jogos..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Privacidade (Dentro do Avan√ßado!) ---
function Show-PrivacidadeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: PRIVACIDADE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desativar Telemetria do Windows" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Aplicativos" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Hist√≥rico de Atividades" -ForegroundColor White
        Write-Host "[4] Gerenciar Diagn√≥stico e Feedback" -ForegroundColor Green
        Write-Host "[5] Gerenciar An√∫ncios Personalizados" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Localiza√ß√£o e Sensores" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Reconhecimento de Voz e Digita√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Sincroniza√ß√£o com a Microsoft" -ForegroundColor Cyan
        Write-Host "[9] Aplicar TODAS as configura√ß√µes de privacidade" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de privacidade"

        switch ($choice) {
            "1" { Invoke-DisableTelemetry }
            "2" { Invoke-ManageAppPermissions }
            "3" { Invoke-ManageActivityHistory }
            "4" { Invoke-ManageDiagnosticsFeedback }
            "5" { Invoke-ManagePersonalizedAds }
            "6" { Invoke-ManageLocationSensors }
            "7" { Invoke-ManageVoiceTyping }
            "8" { Invoke-ManageMicrosoftSync }
            "9" {
                Write-Host "`nAplicando todas as configura√ß√µes de privacidade...`n" -ForegroundColor Yellow
                Invoke-DisableTelemetry
                Invoke-ManageAppPermissions
                Invoke-ManageActivityHistory
                Invoke-ManageDiagnosticsFeedback
                Invoke-ManagePersonalizedAds
                Invoke-ManageLocationSensors
                Invoke-ManageVoiceTyping
                Invoke-ManageMicrosoftSync
                Write-Host "`nTodas as configura√ß√µes de privacidade foram aplicadas!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Privacidade..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Outros (Dentro do Avan√ßado!) ---
function Show-OutrosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: OUTROS TWEAKS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Mostrar Informa√ß√µes Detalhadas do Sistema" -ForegroundColor Yellow
        Write-Host "[2] Mostrar Configura√ß√£o Completa de Rede" -ForegroundColor Cyan
        Write-Host "[3] Reiniciar Explorer.exe" -ForegroundColor White
        Write-Host "[4] Limpar Cache de Atualiza√ß√µes do Windows" -ForegroundColor Green
        Write-Host "[5] Gerenciar Programas de Inicializa√ß√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar Op√ß√µes de Energia Avan√ßadas" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Configura√ß√µes de Armazenamento" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Configura√ß√µes de Notifica√ß√µes" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√µes diversas"

        switch ($choice) {
            "1" { Invoke-ShowDetailedSystemInfo }
            "2" { Invoke-ShowDetailedNetworkConfig }
            "3" { Invoke-RestartExplorer }
            "4" { Invoke-CleanWindowsUpdateCache }
            "5" { Invoke-ManageStartupPrograms }
            "6" { Invoke-ConfigureAdvancedPowerOptions }
            "7" { Invoke-ManageStorageSettings }
            "8" { Invoke-ManageNotificationSettings }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- Fun√ß√µes para as Secoes SIMPLIFICADAS (Expandidas) ---
function Invoke-SimpleSystemCleanup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza Geral do Sistema: Hora de varrer o lixo digital! ---" -ForegroundColor Green
    Write-Host "Essa op√ß√£o vai te ajudar a liberar espa√ßo e dar um f√¥lego pro PC tirando arquivos tempor√°rios, lixo da lixeira, etc. √â tipo faxina no computador!" -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Comando 1: Limpar Arquivos Tempor√°rios do Usu√°rio
    Write-Host "Bora come√ßar limpando os arquivos tempor√°rios do seu usu√°rio! Eles acumulam que √© uma beleza!" -ForegroundColor Yellow
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio limpos! Menos peso pro PC respirar! ;)" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Esvaziar a Lixeira
    Write-Host "Agora, vamos dar um fim definitivo naqueles arquivos na Lixeira. Eles s√≥ est√£o ocupando espa√ßo √† toa!" -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada! Espa√ßo recuperado com sucesso! R√°!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios do Windows
    Write-Host "Vamos limpar tamb√©m os tempor√°rios do pr√≥prio Windows. √Äs vezes, fica lixo escondido por l√°!" -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Limpar Cache de Navegadores Comuns
    Write-Host "Bora dar uma geral nos caches dos navegadores tamb√©m! Eles guardam um monte de coisa que pode pesar!" -ForegroundColor Yellow
    
    # Chrome
    Write-Host "Tentando limpar cache do Google Chrome..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Chrome limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Edge
    Write-Host "Tentando limpar cache do Microsoft Edge..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Edge limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Firefox
    Write-Host "Tentando limpar cache do Mozilla Firefox..." -ForegroundColor DarkGray
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\cache2\entries\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\startupCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\thumbnails\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Firefox limpo (pode n√£o ser completo, dependendo do perfil/uso)." -ForegroundColor DarkGray

    # Brave (se instalado)
    Write-Host "Tentando limpar cache do Brave Browser (se instalado)..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Brave limpo (se instalado e n√£o estiver rodando)." -ForegroundColor DarkGray

    Write-Host "Limpeza de caches de navegador conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Comando 5: Limpar Cache de Miniaturas
    Write-Host "Limpando cache de miniaturas do Windows (aquelas pr√©-visualiza√ß√µes de imagens e v√≠deos)..." -ForegroundColor Yellow
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Write-Host "Cache de miniaturas limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Limpar Arquivos de Log do Windows
    Write-Host "Limpando arquivos de log do Windows que podem ocupar espa√ßo..." -ForegroundColor Yellow
    wevtutil cl Application
    wevtutil cl System
    wevtutil cl Security
    Write-Host "Logs do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 7: Limpar Arquivos Tempor√°rios de Instala√ß√£o
    Write-Host "Limpando arquivos tempor√°rios de instala√ß√£o de programas..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Installer\$*\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios de instala√ß√£o limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 8: Limpar Arquivos de Atualiza√ß√£o do Windows
    Write-Host "Limpando arquivos de atualiza√ß√£o do Windows que podem ocupar bastante espa√ßo..." -ForegroundColor Yellow
    Stop-Service -Name wuauserv -ErrorAction SilentlyContinue
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    Write-Host "Arquivos de atualiza√ß√£o do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 9: Limpar Arquivos Prefetch
    Write-Host "Limpando arquivos prefetch para melhorar a inicializa√ß√£o..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Prefetch\*.pf" -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos prefetch limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 10: Executar Limpeza de Disco Integrada do Windows
    Write-Host "Executando a ferramenta de limpeza de disco integrada do Windows..." -ForegroundColor Yellow
    Start-Process -FilePath cleanmgr.exe -ArgumentList "/sagerun:1" -Wait -ErrorAction SilentlyContinue
    Write-Host "Limpeza de disco conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "Vamos ver quanto espa√ßo conseguimos recuperar com essa faxina:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nPronto! A faxina geral b√°sica foi feita! Seu PC agradece o espa√ßo extra! ;)" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu
    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleMemoryStartup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Mem√≥ria e Inicializa√ß√£o R√°pida: Deixa o PC ligando num piscar! ---" -ForegroundColor Yellow
    Write-Host "Aqui a gente d√° uma olhada na mem√≥ria RAM e nos programas que ligam junto com o Windows. Menos coisa ligando √† toa = PC mais r√°pido pra usar na hora!" -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Listar Programas de Inicializa√ß√£o
    Write-Host "Listando programas que iniciam com o Windows (pra voc√™ saber o que t√° rodando por baixo dos panos):" -ForegroundColor Yellow
    Get-CimInstance win32_startupcommand | Select-Object Name, command, Location | Format-Table -AutoSize
    Write-Host "Lista de programas de inicializa√ß√£o exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Servi√ßo SuperFetch/SysMain
    Write-Host "Otimizando o servi√ßo SuperFetch/SysMain para melhorar o desempenho..." -ForegroundColor Yellow
    $confirmSysMain = Read-Host "Deseja desativar o servi√ßo SysMain/SuperFetch? (s/n) - Recomendado para SSDs"
    if ($confirmSysMain -eq 's') {
        Set-Service -Name SysMain -StartupType Disabled -ErrorAction SilentlyContinue
        Stop-Service -Name SysMain -Force -ErrorAction SilentlyContinue
        Write-Host "Servi√ßo SysMain/SuperFetch desativado!" -ForegroundColor Green
    } else {
        Write-Host "Servi√ßo SysMain/SuperFetch mantido ativo." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios de Updates
    Write-Host "Limpando arquivos tempor√°rios de atualiza√ß√µes do Windows (podem ocupar bastante espa√ßo e afetar performance):" -ForegroundColor Yellow
    Dism /online /Cleanup-Image /StartComponentCleanup /ErrorAction SilentlyContinue
    Write-Host "Limpeza de componentes de atualiza√ß√£o iniciada (pode levar um tempo)." -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Mem√≥ria Virtual
    Write-Host "Otimizando configura√ß√µes de mem√≥ria virtual para melhor desempenho..." -ForegroundColor Yellow
    $totalRam = (Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property capacity -Sum).Sum / 1GB
    Write-Host "Seu sistema tem aproximadamente $totalRam GB de RAM." -ForegroundColor White
    
    $confirmPageFile = Read-Host "Deseja otimizar o arquivo de pagina√ß√£o (mem√≥ria virtual)? (s/n)"
    if ($confirmPageFile -eq 's') {
        # Calcula tamanho recomendado (1.5x a RAM para sistemas com menos de 8GB, 1x para sistemas com mais)
        $pageFileSize = if ($totalRam -lt 8) { [math]::Round($totalRam * 1.5) * 1024 } else { [math]::Round($totalRam) * 1024 }
        
        Write-Host "Configurando arquivo de pagina√ß√£o para tamanho fixo de $pageFileSize MB..." -ForegroundColor DarkGray
        $computerSystem = Get-WmiObject -Class Win32_ComputerSystem
        $computerSystem.AutomaticManagedPagefile = $false
        $computerSystem.Put() | Out-Null
        
        $pageFileSetting = Get-WmiObject -Class Win32_PageFileSetting
        if ($pageFileSetting) {
            $pageFileSetting.InitialSize = $pageFileSize
            $pageFileSetting.MaximumSize = $pageFileSize
            $pageFileSetting.Put() | Out-Null
        }
        Write-Host "Arquivo de pagina√ß√£o otimizado! (Requer reinicializa√ß√£o para aplicar totalmente)" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes de mem√≥ria virtual mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Listar os 10 Processos que mais usam mem√≥ria no momento
    Write-Host "Listando os 10 processos que mais consomem mem√≥ria agora:" -ForegroundColor Yellow
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host "Lista de processos exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Otimizar Inicializa√ß√£o do Windows
    Write-Host "Otimizando a inicializa√ß√£o do Windows..." -ForegroundColor Yellow
    # Desabilitar servi√ßos n√£o essenciais que podem atrasar a inicializa√ß√£o
    $startupServices = @(
        @{Name="DiagTrack"; DisplayName="Experi√™ncias do Usu√°rio Conectado e Telemetria"},
        @{Name="dmwappushservice"; DisplayName="Servi√ßo de Transfer√™ncia Inteligente em Segundo Plano (BITS)"},
        @{Name="MapsBroker"; DisplayName="Servi√ßo de Dados de Mapas"}
    )
    
    foreach ($service in $startupServices) {
        $confirmService = Read-Host "Deseja desativar o servi√ßo '$($service.DisplayName)' na inicializa√ß√£o? (s/n)"
        if ($confirmService -eq 's') {
            Set-Service -Name $service.Name -StartupType Disabled -ErrorAction SilentlyContinue
            Stop-Service -Name $service.Name -Force -ErrorAction SilentlyContinue
            Write-Host "Servi√ßo '$($service.DisplayName)' desativado!" -ForegroundColor Green
        } else {
            Write-Host "Servi√ßo '$($service.DisplayName)' mantido." -ForegroundColor Green
        }
    }
    Write-Host ""

    # Comando 7: Reiniciar o Computador (√ötil pra liberar mem√≥ria e aplicar mudan√ßas)
    Write-Host "Quer dar um 'refresh' geral no PC? Reiniciar pode ajudar!" -ForegroundColor Yellow
    $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (digite 'sim' para confirmar)"
    if ($confirmRestart -eq 'sim') {
        Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
        Restart-Computer -Force
    } else {
        Write-Host "Rein√≠cio cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o de mem√≥ria e inicializa√ß√£o!" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu (a n√£o ser que o PC tenha reiniciado)
    if ($confirmRestart -ne 'sim') {
        Write-Host ""
        Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
    }
}

function Invoke-SimpleInternetOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Acelerar a Conex√£o com a Internet (Simplificado): Diz adeus pro 'carregando...'! ---" -ForegroundColor Cyan
    Write-Host "Vamos fazer uns ajustes r√°pidos na sua conex√£o pra tentar deixar ela mais esperta." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Limpar Cache de DNS
    Write-Host "Limpando o cache de endere√ßos de internet (DNS) pra resolver nomes mais r√°pido!" -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Configura√ß√µes TCP/IP
    Write-Host "Otimizando configura√ß√µes TCP/IP para melhorar a velocidade de conex√£o..." -ForegroundColor Yellow
    
    # Habilitar TCP Window Auto-Tuning
    netsh int tcp set global autotuninglevel=normal
    Write-Host "TCP Auto-Tuning configurado para 'normal'." -ForegroundColor DarkGray
    
    # Otimizar par√¢metros de recebimento de pacotes
    netsh int tcp set global rss=enabled
    Write-Host "Receive-Side Scaling (RSS) habilitado." -ForegroundColor DarkGray
    
    # Otimizar congestion provider
    netsh int tcp set global congestionprovider=ctcp
    Write-Host "Congestion Provider configurado para 'ctcp'." -ForegroundColor DarkGray
    
    # Otimizar ECN capability
    netsh int tcp set global ecncapability=enabled
    Write-Host "ECN Capability habilitado." -ForegroundColor DarkGray
    
    Write-Host "Configura√ß√µes TCP/IP otimizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Reiniciar Adaptadores de Rede
    Write-Host "Dando um 'reset' r√°pido nas suas conex√µes de rede. Pode resolver uns pepinos!" -ForegroundColor Yellow
    $confirmResetAdapter = Read-Host "Isso vai desconectar brevemente sua internet. Continuar? (s/n)"
    if ($confirmResetAdapter -eq 's') {
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        Write-Host "Adaptadores de rede reiniciados." -ForegroundColor Green
    } else {
        Write-Host "Reset de adaptadores cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 4: Configurar DNS R√°pido
    Write-Host "Configurar DNS mais r√°pido pode melhorar sua navega√ß√£o!" -ForegroundColor Yellow
    $confirmDns = Read-Host "Deseja configurar DNS mais r√°pidos (Google ou Cloudflare)? (s/n)"
    if ($confirmDns -eq 's') {
        Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
        Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
        $dnsChoice = Read-Host "Escolha uma op√ß√£o (1 ou 2)"
        
        $primaryDns = ""
        $secondaryDns = ""
        
        if ($dnsChoice -eq '1') {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            Write-Host "Google DNS selecionado." -ForegroundColor DarkGray
        } elseif ($dnsChoice -eq '2') {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            Write-Host "Cloudflare DNS selecionado." -ForegroundColor DarkGray
        } else {
            Write-Host "Op√ß√£o inv√°lida. DNS n√£o alterado." -ForegroundColor Red
        }
        
        if ($primaryDns -ne "") {
            $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" -and ($_.InterfaceDescription -match "Ethernet" -or $_.InterfaceDescription -match "Wi-Fi" -or $_.InterfaceDescription -match "Wireless") }
            
            foreach ($adapter in $networkAdapters) {
                Write-Host "Configurando DNS para adaptador: $($adapter.Name)" -ForegroundColor DarkGray
                Set-DnsClientServerAddress -InterfaceIndex $adapter.ifIndex -ServerAddresses ($primaryDns, $secondaryDns)
            }
            
            Write-Host "DNS configurado! Sua navega√ß√£o deve ficar mais r√°pida agora." -ForegroundColor Green
        }
    } else {
        Write-Host "Configura√ß√£o de DNS mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Mostrar Status B√°sico da Conex√£o
    Write-Host "Mostrando um resumo b√°sico da sua configura√ß√£o de rede atual:" -ForegroundColor Yellow
    ipconfig /all | Select-String -Pattern "IPv4", "DNS", "Gateway", "DHCP", "Subnet", "Physical Address"
    Write-Host "Status b√°sico da rede exibido." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Testar a conex√£o com a internet
    Write-Host "Testando a conex√£o com a internet (ping para google.com)..." -ForegroundColor Yellow
    Test-Connection -Count 4 google.com -ErrorAction SilentlyContinue
    Write-Host "Teste de conex√£o finalizado." -ForegroundColor Green
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o b√°sica de internet!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleVisualOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Deixar o Windows mais Leve Visualmente (Simplificado): Desempenho antes da beleza! ---" -ForegroundColor White
    Write-Host "Ajustes r√°pidos pra desativar efeitos visuais que podem pesar, liberando recursos pro que importa." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ajustar Efeitos Visuais
    Write-Host "Voc√™ quer desativar ou ativar as anima√ß√µes e efeitos visuais do Windows?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Efeitos Visuais (Pra ganhar desempenho)" -ForegroundColor Green
    Write-Host "[2] Configurar para Melhor Apar√™ncia (Mais bonito, mas mais pesado)" -ForegroundColor White
    Write-Host "[3] Deixar o Windows Escolher (Configura√ß√£o padr√£o)" -ForegroundColor Cyan
    $choiceVisual = Read-Host "Escolha [1], [2] ou [3]"

    if ($choiceVisual -eq '1') {
        Write-Host "Desativando efeitos visuais para melhor desempenho..." -ForegroundColor Yellow
        # Valor 2 = Ajustar para melhor desempenho (desativa a maioria dos efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 2 -Type DWord -Force -ErrorAction SilentlyContinue
        
        # Desativar anima√ß√µes individuais
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop' -Name 'UserPreferencesMask' -Value ([byte[]](0x90, 0x12, 0x01, 0x80)) -Type Binary -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop\WindowMetrics' -Name 'MinAnimate' -Value 0 -Type String -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'ListviewAlphaSelect' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'TaskbarAnimations' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        
        Write-Host "Efeitos visuais desativados para melhor desempenho!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '2') {
        Write-Host "Configurando para melhor apar√™ncia (todos os efeitos visuais ativados)..." -ForegroundColor Yellow
        # Valor 1 = Ajustar para melhor apar√™ncia (ativa todos os efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Efeitos visuais configurados para melhor apar√™ncia!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '3') {
        Write-Host "Deixando o Windows escolher automaticamente (configura√ß√£o padr√£o)..." -ForegroundColor Yellow
        # Valor 0 = Deixar o Windows escolher
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Configura√ß√£o visual definida para padr√£o do Windows!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa nos efeitos visuais foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 2: Ativar/Desativar Efeitos de Transpar√™ncia
    Write-Host "E os efeitos de transpar√™ncia do Windows (tipo na barra de tarefas)?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Transpar√™ncia (Mais leve)" -ForegroundColor Green
    Write-Host "[2] Ativar Transpar√™ncia (Mais 'bonito')" -ForegroundColor White
    $choiceTransp = Read-Host "Escolha [1] ou [2]"

    if ($choiceTransp -eq '1') {
        Write-Host "Desativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 0 = Desativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia desativada!" -ForegroundColor Green
    } elseif ($choiceTransp -eq '2') {
        Write-Host "Ativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 1 = Ativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia ativada!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa na transpar√™ncia foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 3: Configurar Tema Claro/Escuro
    Write-Host "Voc√™ prefere tema claro ou escuro? O tema escuro pode ser mais confort√°vel para os olhos." -ForegroundColor Yellow
    Write-Host "[1] Tema Escuro (Dark Mode)" -ForegroundColor DarkGray
    Write-Host "[2] Tema Claro (Light Mode)" -ForegroundColor White
    $choiceTheme = Read-Host "Escolha [1] ou [2]"

    if ($choiceTheme -eq '1') {
        Write-Host "Configurando tema escuro..." -ForegroundColor Yellow
        # Valor 0 = Tema Escuro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema escuro configurado!" -ForegroundColor Green
    } elseif ($choiceTheme -eq '2') {
        Write-Host "Configurando tema claro..." -ForegroundColor Yellow
        # Valor 1 = Tema Claro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema claro configurado!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa no tema foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Configurar Resolu√ß√£o de Tela
    Write-Host "Deseja ajustar a resolu√ß√£o da tela? Resolu√ß√µes menores podem melhorar o desempenho em PCs mais antigos." -ForegroundColor Yellow
    $confirmResolution = Read-Host "Deseja ver e ajustar a resolu√ß√£o da tela? (s/n)"
    
    if ($confirmResolution -eq 's') {
        # Mostrar resolu√ß√£o atual
        $currentResolution = Get-WmiObject -Class Win32_VideoController | Select-Object -ExpandProperty VideoModeDescription
        Write-Host "Resolu√ß√£o atual: $currentResolution" -ForegroundColor White
        
        # Abrir configura√ß√µes de exibi√ß√£o do Windows
        Write-Host "Abrindo configura√ß√µes de exibi√ß√£o do Windows..." -ForegroundColor DarkGray
        Start-Process "ms-settings:display"
        Write-Host "Ajuste a resolu√ß√£o conforme necess√°rio na janela de configura√ß√µes que foi aberta." -ForegroundColor Green
        
        $waitForSettings = Read-Host "Pressione Enter quando terminar de ajustar as configura√ß√µes de exibi√ß√£o"
    } else {
        Write-Host "Configura√ß√£o de resolu√ß√£o mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizados os ajustes visuais b√°sicos!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleGamingOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Jogos (Simplificado): Mais FPS, menos lag! ---" -ForegroundColor Magenta
    Write-Host "Vamos fazer alguns ajustes para melhorar o desempenho dos seus jogos sem complica√ß√µes." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ativar Modo de Jogo do Windows
    Write-Host "Ativando o Modo de Jogo do Windows para priorizar recursos para jogos..." -ForegroundColor Yellow
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AllowAutoGameMode" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AutoGameModeEnabled" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Write-Host "Modo de Jogo do Windows ativado!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Desativar Game DVR e Game Bar
    Write-Host "O Game DVR e Game Bar podem reduzir o desempenho em jogos. Deseja desativ√°-los?" -ForegroundColor Yellow
    $confirmGameDVR = Read-Host "Desativar Game DVR e Game Bar? (s/n)"
    
    if ($confirmGameDVR -eq 's') {
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "UseNexusForGameBarEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\System\GameConfigStore" -Name "GameDVR_Enabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR" -Name "AppCaptureEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Write-Host "Game DVR e Game Bar desativados!" -ForegroundColor Green
    } else {
        Write-Host "Game DVR e Game Bar mantidos ativos." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Otimizar Plano de Energia para Jogos
    Write-Host "Configurando plano de energia para alto desempenho (ideal para jogos)..." -ForegroundColor Yellow
    powercfg.exe /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c
    Write-Host "Plano de energia configurado para alto desempenho!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Configura√ß√µes de Mouse
    Write-Host "Otimizando configura√ß√µes de mouse para jogos (precis√£o do ponteiro)..." -ForegroundColor Yellow
    $confirmMouseFix = Read-Host "Desativar a acelera√ß√£o do mouse para melhor precis√£o em jogos? (s/n)"
    
    if ($confirmMouseFix -eq 's') {
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseSpeed" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold1" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold2" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Write-Host "Acelera√ß√£o do mouse desativada para melhor precis√£o em jogos!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do mouse mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Otimizar Prioridade de CPU para Jogos
    Write-Host "Configurando prioridade de CPU para jogos..." -ForegroundColor Yellow
    Write-Host "Esta configura√ß√£o ajusta o sistema para dar mais prioridade aos jogos." -ForegroundColor DarkGray
    
    # Criar chave de registro para prioridade de jogos
    if (-not (Test-Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games")) {
        New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Force | Out-Null
    }
    
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "GPU Priority" -Type DWord -Value 8 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Priority" -Type DWord -Value 6 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Scheduling Category" -Type String -Value "High" -Force -ErrorAction SilentlyContinue
    
    Write-Host "Prioridade de CPU para jogos otimizada!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Verificar Driver de Placa de V√≠deo
    Write-Host "Verificando informa√ß√µes da placa de v√≠deo..." -ForegroundColor Yellow
    $gpuInfo = Get-WmiObject -Class Win32_VideoController | Select-Object Name, DriverVersion, CurrentHorizontalResolution, CurrentVerticalResolution
    
    foreach ($gpu in $gpuInfo) {
        Write-Host "Placa de v√≠deo: $($gpu.Name)" -ForegroundColor White
        Write-Host "Vers√£o do driver: $($gpu.DriverVersion)" -ForegroundColor White
        Write-Host "Resolu√ß√£o atual: $($gpu.CurrentHorizontalResolution) x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
      x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
    
    Write-Host "Recomenda√ß√£o: Mantenha seus drivers de v√≠deo atualizados para melhor desempenho em jogos!" -ForegroundColor Green
    Write-Host "Voc√™ pode baixar os drivers mais recentes nos sites oficiais da NVIDIA, AMD ou Intel." -ForegroundColor DarkGray
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nOtimiza√ß√µes para jogos conclu√≠das! Seus jogos devem rodar mais suaves agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleSecurityMaintenance {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Manuten√ß√£o de Seguran√ßa (Simplificado): Mantenha seu PC protegido! ---" -ForegroundColor DarkYellow
    Write-Host "Vamos verificar e melhorar a seguran√ßa do seu sistema com alguns ajustes simples." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Verificar Status do Windows Defender
    Write-Host "Verificando status do Windows Defender..." -ForegroundColor Yellow
    $defenderStatus = Get-MpComputerStatus
    
    Write-Host "Status do Windows Defender:" -ForegroundColor White
    Write-Host "Antiv√≠rus habilitado: $($defenderStatus.AntivirusEnabled)" -ForegroundColor $(if ($defenderStatus.AntivirusEnabled) { "Green" } else { "Red" })
    Write-Host "Prote√ß√£o em tempo real: $($defenderStatus.RealTimeProtectionEnabled)" -ForegroundColor $(if ($defenderStatus.RealTimeProtectionEnabled) { "Green" } else { "Red" })
    Write-Host "Defini√ß√µes de antiv√≠rus: $($defenderStatus.AntivirusSignatureVersion)" -ForegroundColor White
    Write-Host "√öltima atualiza√ß√£o: $($defenderStatus.AntivirusSignatureLastUpdated)" -ForegroundColor White
    Write-Host ""

    # Comando 2: Atualizar Defini√ß√µes do Windows Defender
    Write-Host "Atualizando defini√ß√µes do Windows Defender..." -ForegroundColor Yellow
    Update-MpSignature -ErrorAction SilentlyContinue
    Write-Host "Defini√ß√µes do Windows Defender atualizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Verificar Atualiza√ß√µes do Windows
    Write-Host "Verificando status das atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
            Write-Host "Recomenda√ß√£o: Execute o Windows Update para manter seu sistema seguro." -ForegroundColor Green
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Verificar Configura√ß√µes de Firewall
    Write-Host "Verificando status do Firewall do Windows..." -ForegroundColor Yellow
    $firewallStatus = Get-NetFirewallProfile
    
    foreach ($profile in $firewallStatus) {
        Write-Host "Perfil: $($profile.Name)" -ForegroundColor White
        Write-Host "Status: $($profile.Enabled)" -ForegroundColor $(if ($profile.Enabled) { "Green" } else { "Red" })
        Write-Host ""
    }
    
    $confirmFirewall = Read-Host "Deseja habilitar o Firewall em todos os perfis? (s/n)"
    if ($confirmFirewall -eq 's') {
        Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True
        Write-Host "Firewall habilitado em todos os perfis!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do Firewall mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Verificar Configura√ß√µes de UAC
    Write-Host "Verificando configura√ß√µes do Controle de Conta de Usu√°rio (UAC)..." -ForegroundColor Yellow
    $uacLevel = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -ErrorAction SilentlyContinue
    
    if ($uacLevel) {
        switch ($uacLevel.ConsentPromptBehaviorAdmin) {
            0 { $uacStatus = "Desativado (N√£o recomendado)" }
            1 { $uacStatus = "Baixo (N√£o recomendado)" }
            2 { $uacStatus = "M√©dio" }
            5 { $uacStatus = "Alto (Recomendado)" }
            default { $uacStatus = "Personalizado" }
        }
        
        Write-Host "N√≠vel atual do UAC: $uacStatus" -ForegroundColor $(if ($uacLevel.ConsentPromptBehaviorAdmin -ge 2) { "Green" } else { "Red" })
        
        $confirmUAC = Read-Host "Deseja configurar o UAC para o n√≠vel recomendado? (s/n)"
        if ($confirmUAC -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -Value 5 -Type DWord -Force -ErrorAction SilentlyContinue
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "PromptOnSecureDesktop" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
            Write-Host "UAC configurado para o n√≠vel recomendado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do UAC mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do UAC." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 6: Verificar Configura√ß√µes de SmartScreen
    Write-Host "Verificando configura√ß√µes do Windows SmartScreen..." -ForegroundColor Yellow
    $smartScreen = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -ErrorAction SilentlyContinue
    
    if ($smartScreen) {
        Write-Host "Status do SmartScreen: $($smartScreen.SmartScreenEnabled)" -ForegroundColor $(if ($smartScreen.SmartScreenEnabled -eq "RequireAdmin" -or $smartScreen.SmartScreenEnabled -eq "Warn") { "Green" } else { "Red" })
        
        $confirmSmartScreen = Read-Host "Deseja habilitar o SmartScreen para maior seguran√ßa? (s/n)"
        if ($confirmSmartScreen -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -Value "RequireAdmin" -Type String -Force -ErrorAction SilentlyContinue
            Write-Host "SmartScreen habilitado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do SmartScreen mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do SmartScreen." -ForegroundColor Red
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nManuten√ß√£o de seguran√ßa conclu√≠da! Seu sistema est√° mais protegido agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

# --- Fun√ß√µes para o Diagn√≥stico R√°pido e Sobre ---
function Invoke-QuickDiagnostic {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Diagn√≥stico R√°pido do Sistema ---" -ForegroundColor Yellow
    Write-Host "Vamos fazer uma verifica√ß√£o r√°pida do estado atual do seu PC." -ForegroundColor Gray
    Write-Host ""

    # Informa√ß√µes do Sistema
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    $sysInfo = Get-SystemInfo
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host ""

    # Uso de CPU
    Write-Host "=== Uso de CPU ===" -ForegroundColor Cyan
    $cpuLoad = (Get-WmiObject Win32_Processor).LoadPercentage
    Write-Host "Uso atual de CPU: $cpuLoad%" -ForegroundColor $(if ($cpuLoad -lt 70) { "Green" } elseif ($cpuLoad -lt 90) { "Yellow" } else { "Red" })
    Write-Host ""

    # Uso de Mem√≥ria
    Write-Host "=== Uso de Mem√≥ria ===" -ForegroundColor Cyan
    $os = Get-WmiObject Win32_OperatingSystem
    $totalMemory = [math]::Round($os.TotalVisibleMemorySize / 1MB, 2)
    $freeMemory = [math]::Round($os.FreePhysicalMemory / 1MB, 2)
    $usedMemory = [math]::Round($totalMemory - $freeMemory, 2)
    $memoryPercentage = [math]::Round(($usedMemory / $totalMemory) * 100, 2)
    
    Write-Host "Mem√≥ria Total: $totalMemory GB" -ForegroundColor White
    Write-Host "Mem√≥ria Usada: $usedMemory GB ($memoryPercentage%)" -ForegroundColor $(if ($memoryPercentage -lt 70) { "Green" } elseif ($memoryPercentage -lt 90) { "Yellow" } else { "Red" })
    Write-Host "Mem√≥ria Livre: $freeMemory GB" -ForegroundColor White
    Write-Host ""

    # Espa√ßo em Disco
    Write-Host "=== Espa√ßo em Disco ===" -ForegroundColor Cyan
    $drives = Get-PSDrive -PSProvider FileSystem
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        $percentFree = [math]::Round(($freeSpace / $totalSpace) * 100, 2)
        
        Write-Host "Drive $($drive.Name):" -ForegroundColor White
        Write-Host "  Total: $totalSpace GB" -ForegroundColor White
        Write-Host "  Usado: $usedSpace GB" -ForegroundColor White
        Write-Host "  Livre: $freeSpace GB ($percentFree%)" -ForegroundColor $(if ($percentFree -gt 20) { "Green" } elseif ($percentFree -gt 10) { "Yellow" } else { "Red" })
    }
    Write-Host ""

    # Processos que mais consomem recursos
    Write-Host "=== Top 5 Processos (CPU) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object CPU -Descending | Select-Object -First 5 ProcessName, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}}, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host ""

    Write-Host "=== Top 5 Processos (Mem√≥ria) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 5 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}}, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}} | Format-Table -AutoSize
    Write-Host ""

    # Status de Servi√ßos Cr√≠ticos
    Write-Host "=== Status de Servi√ßos Cr√≠ticos ===" -ForegroundColor Cyan
    $criticalServices = @("wuauserv", "WinDefend", "MpsSvc", "wscsvc")
    foreach ($service in $criticalServices) {
        $serviceStatus = Get-Service -Name $service -ErrorAction SilentlyContinue
        if ($serviceStatus) {
            Write-Host "$($serviceStatus.DisplayName): $($serviceStatus.Status)" -ForegroundColor $(if ($serviceStatus.Status -eq "Running") { "Green" } else { "Red" })
        }
    }
    Write-Host ""

    # Verificar Atualiza√ß√µes Pendentes
    Write-Host "=== Atualiza√ß√µes do Windows ===" -ForegroundColor Cyan
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Recomenda√ß√µes
    Write-Host "=== Recomenda√ß√µes ===" -ForegroundColor Cyan
    
    # Recomenda√ß√£o de Mem√≥ria
    if ($memoryPercentage -gt 80) {
        Write-Host "- Seu uso de mem√≥ria est√° alto. Considere fechar alguns programas ou usar a op√ß√£o 'Otimiza√ß√£o de Mem√≥ria'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Disco
    $lowDiskSpace = $false
    foreach ($drive in $drives) {
        $percentFree = [math]::Round(($drive.Free / ($drive.Free + $drive.Used)) * 100, 2)
        if ($percentFree -lt 15) {
            $lowDiskSpace = $true
            break
        }
    }
    
    if ($lowDiskSpace) {
        Write-Host "- Espa√ßo em disco baixo detectado. Considere usar a op√ß√£o 'Limpeza Geral do Sistema'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Atualiza√ß√µes
    if ($pendingUpdates -gt 0) {
        Write-Host "- Existem atualiza√ß√µes pendentes. Recomendamos atualizar seu sistema para maior seguran√ßa." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Inicializa√ß√£o
    $bootTime = $sysInfo.LastBootTime
    $uptime = (Get-Date) - $bootTime
    if ($uptime.Days -gt 7) {
        Write-Host "- Seu sistema est√° ligado h√° $($uptime.Days) dias. Considere reiniciar para aplicar atualiza√ß√µes e limpar a mem√≥ria." -ForegroundColor Yellow
    }
    
    Write-Host ""

    # Mensagem de conclus√£o
    Write-Host "`nDiagn√≥stico r√°pido conclu√≠do! Use as informa√ß√µes acima para decidir quais otimiza√ß√µes fazer." -ForegroundColor Green

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

function Show-AboutTORK {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Sobre o TORK ---" -ForegroundColor White
    Write-Host ""
    
    Write-Host "TORK - Otimizador para Windows" -ForegroundColor Cyan
    Write-Host "Vers√£o: 2.0" -ForegroundColor White
    Write-Host "Desenvolvido por: Partner77" -ForegroundColor White
    Write-Host ""
    
    Write-Host "=== Descri√ß√£o ===" -ForegroundColor Yellow
    Write-Host "O TORK √© uma ferramenta abrangente de otimiza√ß√£o para Windows, projetada para" -ForegroundColor Gray
    Write-Host "melhorar o desempenho do seu sistema atrav√©s de limpeza, ajustes e otimiza√ß√µes." -ForegroundColor Gray
    Write-Host "Ele oferece op√ß√µes simplificadas para usu√°rios comuns e op√ß√µes avan√ßadas para" -ForegroundColor Gray
    Write-Host "usu√°rios experientes que desejam um controle mais detalhado sobre o sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Recursos ===" -ForegroundColor Yellow
    Write-Host "- Limpeza completa do sistema" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√£o de mem√≥ria e inicializa√ß√£o" -ForegroundColor Gray
    Write-Host "- Ajustes de rede para melhor conectividade" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√µes visuais para melhor desempenho" -ForegroundColor Gray
    Write-Host "- Configura√ß√µes espec√≠ficas para jogos" -ForegroundColor Gray
    Write-Host "- Manuten√ß√£o de seguran√ßa" -ForegroundColor Gray
    Write-Host "- Diagn√≥stico r√°pido do sistema" -ForegroundColor Gray
    Write-Host "- Mais de 100 ajustes e otimiza√ß√µes avan√ßadas" -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Aviso Legal ===" -ForegroundColor Yellow
    Write-Host "Este software √© fornecido 'como est√°', sem garantias de qualquer tipo." -ForegroundColor Gray
    Write-Host "O autor n√£o se responsabiliza por quaisquer danos ou problemas causados pelo uso" -ForegroundColor Gray
    Write-Host "deste software. Use por sua conta e risco. Recomendamos sempre fazer backup" -ForegroundColor Gray
    Write-Host "dos seus dados importantes antes de realizar otimiza√ß√µes no sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Agradecimentos ===" -ForegroundColor Yellow
    Write-Host "Obrigado por escolher o TORK para otimizar seu sistema Windows!" -ForegroundColor Gray
    Write-Host "Esperamos que esta ferramenta ajude a melhorar o desempenho do seu PC." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "¬© 2023-2024 Partner77 - Todos os direitos reservados" -ForegroundColor Cyan
    Write-Host ""
    
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - LIMPEZA (Expandidas) ---
function Invoke-CleanUserTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Usu√°rio ---" -ForegroundColor Cyan
    Write-Host "Remove arquivos da pasta tempor√°ria do seu usu√°rio (`$env:TEMP`)." -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:TEMP..." -ForegroundColor Yellow
    $tempFiles = Get-ChildItem -Path $env:TEMP -Recurse -ErrorAction SilentlyContinue
    $tempFilesCount = ($tempFiles | Measure-Object).Count
    $tempFilesSize = ($tempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $tempFilesCount arquivos tempor√°rios ocupando aproximadamente $([math]::Round($tempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Sistema ---" -ForegroundColor Gray
    Write-Host "Remove arquivos da pasta tempor√°ria do Windows (`$env:SystemRoot\Temp`)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:SystemRoot\Temp..." -ForegroundColor Yellow
    $systemTempFiles = Get-ChildItem -Path "$env:SystemRoot\Temp" -Recurse -ErrorAction SilentlyContinue
    $systemTempFilesCount = ($systemTempFiles | Measure-Object).Count
    $systemTempFilesSize = ($systemTempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $systemTempFilesCount arquivos tempor√°rios do sistema ocupando aproximadamente $([math]::Round($systemTempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do sistema removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanDnsCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-EmptyRecycleBin {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Esvaziar Lixeira ---" -ForegroundColor Gray
    Write-Host "Esvazia a lixeira do usu√°rio logado." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar tamanho da lixeira antes de esvaziar
    Write-Host "Verificando tamanho da lixeira..." -ForegroundColor Yellow
    
    try {
        $shell = New-Object -ComObject Shell.Application
        $recycleBin = $shell.Namespace(0xA)
        $recycleBinItems = $recycleBin.Items()
        $recycleBinItemCount = $recycleBinItems.Count
        
        Write-Host "A lixeira cont√©m $recycleBinItemCount itens." -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o conte√∫do da lixeira." -ForegroundColor DarkGray
    }
    
    # Esvaziar a lixeira
    Write-Host "Executando: Esvaziando a lixeira..." -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanThumbnailCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Miniaturas ---" -ForegroundColor Green
    Write-Host "Remove o cache de miniaturas de arquivos (imagens, v√≠deos, etc.)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Limpando cache de miniaturas..." -ForegroundColor Yellow
    
    # Verificar tamanho do cache de miniaturas antes da limpeza
    $thumbnailPath = "$env:LOCALAPPDATA\Microsoft\Windows\Explorer"
    $thumbnailFiles = Get-ChildItem -Path $thumbnailPath -Filter "thumbcache_*.db" -ErrorAction SilentlyContinue
    $thumbnailFilesCount = ($thumbnailFiles | Measure-Object).Count
    $thumbnailFilesSize = ($thumbnailFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $thumbnailFilesCount arquivos de cache de miniaturas ocupando aproximadamente $([math]::Round($thumbnailFilesSize, 2)) MB." -ForegroundColor White
    
    # Limpar o cache de miniaturas
    Stop-Process -Name explorer -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Start-Process explorer
    
    Write-Host "Cache de miniaturas limpo com sucesso!" -ForegroundColor Green
    Write-Host "O Windows Explorer foi reiniciado para aplicar as altera√ß√µes." -ForegroundColor DarkGray
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de miniaturas:" -ForegroundColor Cyan
    Write-Host "- Navega√ß√£o mais r√°pida em pastas com muitas imagens ou v√≠deos" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de miniaturas corrompidas ou desatualizadas" -ForegroundColor DarkGray
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemLogs {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Logs do Sistema ---" -ForegroundColor Cyan
    Write-Host "Limpa os logs de eventos do sistema para liberar espa√ßo e melhorar o desempenho." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando logs do sistema..." -ForegroundColor Yellow
    
    # Verificar tamanho dos logs antes da limpeza
    $eventLogs = Get-WinEvent -ListLog * -ErrorAction SilentlyContinue | Where-Object { $_.RecordCount -gt 0 }
    $totalLogCount = ($eventLogs | Measure-Object).Count
    $total### Enhanced TORK Optimizer

I'll enhance the TORK optimizer with more comprehensive functionality across all features, starting with an expanded Simple Cleanup function and then improving all other options.

```powershell type="code"
# Define a preferencia de acao para erros (continua a execucao por padrao)
# Permite que o script tente rodar o m√°ximo poss√≠vel mesmo que alguns comandos encontrem problemas.
$ErrorActionPreference = 'SilentlyContinue' # N√£o exibe erros se um item n√£o puder ser processado, por exemplo.

# --- Funcao pra Centralizar Texto (Nosso Maestro de Alinhamento - s√≥ pra textos, n√£o pro bannerz√£o!) ---
# Deixa ela aqui, vai que a gente usa pra centralizar outra coisa, n√©?
function Centraliza($texto, $cor="White") {
    $largura = [console]::WindowWidth # Pega a largura da largura da janela agora
    # Calcula o espa√ßo pra botar o texto no meio. Pura matem√°tica da zoeira!
    $espacos = [Math]::Max(0, [Math]::Floor(($largura - $texto.Length) / 2))
    $linha = (" " * $espacos) + $texto # Cria a linha com os espa√ßos e o texto
    Write-Host $linha -ForegroundColor $cor # Manda pro console com a cor pedida
}

# --- Funcao que Desenha o Nosso Banner Irado do TORK! ---
# Esse √© o nosso outdoor digital no console! Ajustado pros espa√ßos que voc√™ mandou!
# Se as bordas ainda estiverem meio teimosas, √© o jeitinho do console mesmo, viu? üòâ
function Banner-TORK {
    # Nossas cores vibrantes para o banner!
    $CorBorda = "DarkCyan" # Mantido para a borda, combina com o ciano. Se quiser mudar, √© aqui!
    $CorLogo = "Green" # Cor vibrante
    $CorProjeto = "Cyan" # Cor vibrante
    $CorCopyright = "Gray" # Tom mais suave

    Write-Host "" # D√° um espacinho no topo, pra n√£o grudar
    Write-Host "                    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë          ‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë ‚ñà‚ñà‚ïî‚ïù                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ñà‚ñà‚ïó                                            ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïó                                           ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë             ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù                                          ‚ïë" -ForegroundColor $CorLogo
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë           Bem-vindo ao TORK - Otimizador para Windows!                                ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë        Projeto de automacao, limpeza, manutencao e tweaks.                            ‚ïë" -ForegroundColor $CorProjeto
    Write-Host "                    ‚ïë                                                                                       ‚ïë" -ForegroundColor $CorBorda
    Write-Host "                    ‚ïë            (C) Partner77 - Todos os direitos reservados                               ‚ïë" -ForegroundColor $CorCopyright
    Write-Host "                    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor $CorBorda
    Write-Host "" # Espa√ßo embaixo
}

# --- Checagem de Permiss√µes de Administrador (O Guarda da Porta!) ---
# V√™ se a gente t√° rodando com poderes de admin, sen√£o n√£o d√° pra mexer no Windows direito.
function Test-Administrator {
    $currentUser = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())
    return $currentUser.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
}

if (-not (Test-Administrator)) {
    Write-Host "OPA! Calma l√°, patr√£o!" -ForegroundColor Red
    Write-Host "Pra usar o TORK e deixar o PC voando, preciso de super poderes de Administrador!" -ForegroundColor Yellow
    Write-Host "Fecha essa janela, clica com o bot√£o direito no arquivo do script e escolhe 'Executar como administrador'. A√≠ sim, tamo junto!" -ForegroundColor Yellow
    Read-Host "D√° um Enter quando terminar de ler, que a gente se v√™ na pr√≥xima..."
    Exit
}

Write-Host "Poderes de Administrador verificados! Bora nessa!" -ForegroundColor Green
Start-Sleep -Seconds 1

# --- Fun√ß√µes Utilit√°rias (Ferramentas que usamos em v√°rios lugares) ---
function Get-SystemInfo {
    $os = Get-CimInstance Win32_OperatingSystem
    $cs = Get-CimInstance Win32_ComputerSystem
    $proc = Get-CimInstance Win32_Processor
    $mem = Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property Capacity -Sum
    
    $info = @{
        "OSName" = $os.Caption
        "OSVersion" = $os.Version
        "OSBuild" = $os.BuildNumber
        "ComputerName" = $cs.Name
        "Manufacturer" = $cs.Manufacturer
        "Model" = $cs.Model
        "Processor" = $proc.Name
        "Memory" = [math]::Round($mem.Sum / 1GB, 2)
        "Architecture" = $os.OSArchitecture
        "InstallDate" = $os.InstallDate
        "LastBootTime" = $os.LastBootUpTime
    }
    
    return $info
}

function Show-SystemSummary {
    $sysInfo = Get-SystemInfo
    
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Computador: $($sysInfo.ComputerName)" -ForegroundColor White
    Write-Host "Fabricante: $($sysInfo.Manufacturer)" -ForegroundColor White
    Write-Host "Modelo: $($sysInfo.Model)" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "Instalado em: $($sysInfo.InstallDate)" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

function Get-DiskSpaceBefore {
    $drives = Get-PSDrive -PSProvider FileSystem
    $driveInfo = @{}
    
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        
        $driveInfo[$drive.Name] = @{
            "Free" = $freeSpace
            "Used" = $usedSpace
            "Total" = $totalSpace
        }
    }
    
    return $driveInfo
}

function Show-DiskSpaceComparison {
    param (
        $before
    )
    
    $after = Get-PSDrive -PSProvider FileSystem
    
    Write-Host "=== Compara√ß√£o de Espa√ßo em Disco ===" -ForegroundColor Cyan
    
    foreach ($drive in $after) {
        if ($before.ContainsKey($drive.Name)) {
            $freeSpaceAfter = [math]::Round($drive.Free / 1GB, 2)
            $freeSpaceBefore = $before[$drive.Name].Free
            $spaceRecovered = [math]::Round($freeSpaceAfter - $freeSpaceBefore, 2)
            
            Write-Host "Drive $($drive.Name):" -ForegroundColor White
            Write-Host "  Espa√ßo livre antes: $freeSpaceBefore GB" -ForegroundColor Gray
            Write-Host "  Espa√ßo livre agora: $freeSpaceAfter GB" -ForegroundColor Gray
            
            if ($spaceRecovered -gt 0) {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Green
            } else {
                Write-Host "  Espa√ßo recuperado: $spaceRecovered GB" -ForegroundColor Yellow
            }
            Write-Host ""
        }
    }
    
    Write-Host "==============================" -ForegroundColor Cyan
    Write-Host ""
}

# --- Fun√ß√µes dos Menus (Principal, Simplificado, Avan√ßado e Sub-menus) ---

# --- Menu Principal (A Bifurca√ß√£o do Destino! Simplificado vs Avan√ßado) ---
# √â aqui que o usu√°rio escolhe se quer ser um mago ou um cara pr√°tico!
function Show-MainMenu {
    do {
        Clear-Host # Limpa a tela pra organizar o menu
        Banner-TORK # Banner no topo, pra gente n√£o esquecer quem somos!
        Show-SystemSummary # Mostra um resumo do sistema

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "       MENU PRINCIPAL" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # As duas grandes estradas da otimiza√ß√£o! Cores variadas (repetindo)!
        Write-Host "[1] Otimiza√ß√£o Simplificada (Pra quem quer praticidade e resultado r√°pido!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o Avan√ßada (Pra quem curte mexer fundo e ter control total!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[3] Diagn√≥stico R√°pido do Sistema (Ver o que t√° rolando no PC)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[4] Sobre o TORK (Informa√ß√µes e cr√©ditos)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[0] Sair (Ah, que pena... Mas a porta t√° aberta!)" -ForegroundColor Red # Vermelho pra Sair - Ok

        Write-Host ""

        # Pergunta pro usu√°rio qual caminho ele escolhe, tipo Mestre Pok√©mon!
        $choice = Read-Host "Escolhe sua op√ß√£o, treinador!"

        # V√™ pra onde a gente vai com base na escolha
        switch ($choice) {
            "1" { Show-SimplifiedMenu } # Se escolheu 1, vai pro Menu Simplificado!
            "2" { Show-AdvancedMenu } # Se escolheu 2, vai pro Menu Avan√ßado!
            "3" { Invoke-QuickDiagnostic } # Nova fun√ß√£o de diagn√≥stico r√°pido
            "4" { Show-AboutTORK } # Nova fun√ß√£o de sobre
            "0" { Write-Host "Fechou! Valeu por usar o TORK! Volte sempre que seu PC pedir um g√°s! ;)" -ForegroundColor Green; Start-Sleep -Seconds 2; break } # Se escolheu 0, vaza (mas volta!)
            default {
                Write-Host "Eita! Op√ß√£o inv√°lida! Confere os n√∫meros e tenta de novo, bora l√°!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1 # D√° um tempinho pro usu√°rio ver a zoeira da mensagem
            }
        }
    } while ($choice -ne '0') # Repete o Menu Principal enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Simplificado (Aqui o TORK faz m√°gica r√°pida e segura!) ---
# Acessado pela op√ß√£o 1 do Menu Principal. Menos op√ß√µes, mais a√ß√£o direta!
function Show-SimplifiedMenu {
    do {
        Clear-Host # Limpa o palco pra esse menu!
        Banner-TORK # Nosso banner no topo, sempre presente!

        Write-Host "" # Espacinho camarada
        Write-Host "===============================" -ForegroundColor White
        Write-Host "   OTIMIZACAO SIMPLIFICADA" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes SIMPLIFICADAS - cada uma pode fazer um monte de coisa por baixo dos panos! Cores variadas (repetindo as prim√°rias/neon e adicionando outras)!
        Write-Host "[1] Limpeza Geral do Sistema (Tira o lixo que t√° pesando!)" -ForegroundColor Green # Cor variada
        Write-Host "[2] Otimiza√ß√£o de Mem√≥ria e Programas que Ligam com o Windows (Deixa tudo mais √°gil!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[3] Acelerar a Conex√£o com a Internet (Pra navegar sem gargalo!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[4] Deixar o Windows mais Leve Visualmente (Desativa uns efeitos pra ganhar desempenho!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Otimiza√ß√£o de Jogos (Configura√ß√µes pra melhorar FPS e desempenho)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[6] Manuten√ß√£o de Seguran√ßa (Verificar e corrigir problemas de seguran√ßa)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[7] RODAR TODAS as otimiza√ß√µes SIMPLIFICADAS! (Modo Turbo F√°cil!)" -ForegroundColor Red # Vermelho pra "Faz Tudo" - Destaque/Cuidado
        Write-Host "[0] Voltar ao Menu Principal (A gente te espera aqui!)" -ForegroundColor Gray # Cor neutra pra voltar

        Write-Host ""

        # Pergunta qual m√°gica simplificada o usu√°rio quer
        $choice = Read-Host "Escolhe sua m√°gica simplificada!"

        # V√™ qual m√°gica rodar
        switch ($choice) {
            "1" { Invoke-SimpleSystemCleanup } # Chama a fun√ß√£o de limpeza b√°sica
            "2" { Invoke-SimpleMemoryStartup } # Chama a fun√ß√£o pra mem√≥ria/inicializa√ß√£o
            "3" { Invoke-SimpleInternetOpt } # Chama a fun√ß√£o pra internet
            "4" { Invoke-SimpleVisualOpt } # Chama a fun√ß√£o pra visual
            "5" { Invoke-SimpleGamingOpt } # Nova fun√ß√£o para otimiza√ß√£o de jogos
            "6" { Invoke-SimpleSecurityMaintenance } # Nova fun√ß√£o para manuten√ß√£o de seguran√ßa
            "7" {
                # Rodar todas as simplificadas sequencialmente
                Write-Host "`nModo Turbo F√°cil ATIVADO! Rodando todas as otimiza√ß√µes SIMPLIFICADAS... segura pe√£o!`n" -ForegroundColor Yellow
                Invoke-SimpleSystemCleanup # Roda a 1
                Invoke-SimpleMemoryStartup # Roda a 2
                Invoke-SimpleInternetOpt # Roda a 3
                Invoke-SimpleVisualOpt # Roda a 4
                Invoke-SimpleGamingOpt # Roda a 5
                Invoke-SimpleSecurityMaintenance # Roda a 6
                Write-Host "`nShow! Todas as otimiza√ß√µes SIMPLIFICADAS foram executadas! PC t√° agradecendo! ;)`n" -ForegroundColor Green
                Read-Host "Aperta Enter pra voltar pro Menu Simplificado..." # Pausa no final do "Rodar Todas"
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-MainMenu
            default {
                Write-Host "Ops! Op√ß√£o inv√°lida no Menu Simplificado! Confere os n√∫meros e manda bala de novo!" -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Simplificado enquanto o usu√°rio n√£o escolher Voltar
}

# --- Menu Avan√ßado (O Playground dos Magos do PC!) ---
# Acessado pela op√ß√£o 2 do Menu Principal. Aqui a gente mergulha fundo!
function Show-AdvancedMenu {
    do {
        Clear-Host # Limpa o palco pro menu avan√ßado!
        Banner-TORK # Nosso banner no topo, pra n√£o perder a pose!

        Write-Host "" # Espacinho maroto
        Write-Host "===============================" -ForegroundColor White
        Write-Host "      MENU AVANCADO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes do menu avan√ßado (as CATEGORIAS dos 200 poderes!) Cores variadas (repetindo)!
        Write-Host "[1] Limpeza e Manuten√ß√£o de Arquivos (Tirar a poeira digital!)" -ForegroundColor Cyan # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[2] Otimiza√ß√µes de Desempenho do Sistema (Deixar o motor roncando!)" -ForegroundColor Green # Cor variada
        Write-Host "[3] Configura√ß√µes e Otimiza√ß√µes de Rede (Pra internet voar baixo!)" -ForegroundColor Yellow # ESTA TEM SUB-MENU! - Cor variada
        Write-Host "[4] Gerenciamento e Otimiza√ß√£o de Servi√ßos do Windows (O que t√° rodando e n√£o precisa?!)" -ForegroundColor White # Cor variada
        Write-Host "[5] Ferramentas de Diagn√≥stico e Verifica√ß√£o (Pra ver se t√° tudo nos conformes!)" -ForegroundColor Cyan # Cor repetida
        Write-Host "[6] Desabilitar/Gerenciar Recursos do Windows (Tirar o peso extra do sistema!)" -ForegroundColor Green # Cor repetida
        Write-Host "[7] Gerenciamento de Arquivos e Pastas Avan√ßado (Comandos ninja pra arquivos!)" -ForegroundColor Yellow # Cor repetida
        Write-Host "[8] Gerenciamento de Contas de Usu√°rio (Organizar a galera que usa o PC!)" -ForegroundColor White # Cor repetida
        Write-Host "[9] Otimiza√ß√£o para Jogos Avan√ßada (Tweaks pra gamers de verdade!)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Configura√ß√µes de Privacidade (Controle o que o Windows sabe sobre voc√™)" -ForegroundColor DarkYellow # Nova op√ß√£o
        Write-Host "[11] Outras Configura√ß√µes e Tweaks Diversos (Aqueles ajustes secretos!)" -ForegroundColor Gray # Cor neutra/escura
        Write-Host "[0] Voltar ao Menu Principal (Pronto pra voltar pra estrada principal!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta pro mago qual categoria ele quer explorar
        $choice = Read-Host "Escolhe sua √°rea de magia, mago!"

        # V√™ pra onde a gente navega dentro do mundo avan√ßado
        switch ($choice) {
            "1" { Show-LimpezaManutencaoMenu } # CHAMA O SUB-MENU DE LIMPEZA
            "2" { Show-DesempenhoMenu } # Agora √© um sub-menu tamb√©m
            "3" { Show-ConfiguracoesRedeMenu } # CHAMA O SUB-MENU DE REDE
            "4" { Show-ServicosMenu } # Agora √© um sub-menu tamb√©m
            "5" { Show-DiagnosticoMenu } # Agora √© um sub-menu tamb√©m
            "6" { Show-RecursosMenu } # Agora √© um sub-menu tamb√©m
            "7" { Show-ArquivosPastasMenu } # Agora √© um sub-menu tamb√©m
            "8" { Show-UsuariosMenu } # Agora √© um sub-menu tamb√©m
            "9" { Show-JogosAvancadoMenu } # Novo sub-menu para jogos
            "10" { Show-PrivacidadeMenu } # Novo sub-menu para privacidade
            "11" { Show-OutrosMenu } # Agora √© um sub-menu tamb√©m
            "0" { break } # Sai do loop deste menu, voltando pro Menu Principal
            default {
                Write-Host "Humm, essa √°rea da magia ainda n√£o existe ou voc√™ digitou errado! Tenta de novo, mago!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Menu Avan√ßado enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Limpeza e Manuten√ß√£o (Dentro do Avan√ßado!) ---
# Este menu lista as op√ß√µes ESPEC√çFICAS da categoria Limpeza no Menu Avan√ßado
function Show-LimpezaManutencaoMenu {
    do {
        Clear-Host # Limpa o palco pra este sub-menu!
        Banner-TORK # Banner no topo, sempre!

        Write-Host "" # Espacinho
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: LIMPEZA E MANUT." -ForegroundColor White # T√≠tulo menor pro sub-menu
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        # Op√ß√µes ESPEC√çFICAS da categoria Limpeza. Cores variadas (repetindo cores)!
        Write-Host "[1] Limpar Arquivos Tempor√°rios do Usu√°rio (Tipo a pasta Temp!)" -ForegroundColor Cyan # Cor variada
        Write-Host "[2] Limpar Arquivos Tempor√°rios do Sistema (Os tempor√°rios do Windows!)" -ForegroundColor Gray # Cor neutra (substitui DarkCyan)
        Write-Host "[3] Limpar Cache de DNS (Pra resolver nomes de site mais r√°pido!)" -ForegroundColor Yellow # Cor variada
        Write-Host "[4] Esvaziar Lixeira (Adeus, arquivos deletados!)" -ForegroundColor Gray # Cor neutra (repetindo)
        Write-Host "[5] Limpar Cache de Miniaturas (Aqueles previews de imagem/v√≠deo!)" -ForegroundColor Green # Cor variada
        Write-Host "[6] Limpar Logs do Sistema (Arquivos de registro que acumulam)" -ForegroundColor Cyan # Nova op√ß√£o
        Write-Host "[7] Limpar Cache de Atualiza√ß√µes do Windows (Liberar espa√ßo de updates)" -ForegroundColor Yellow # Nova op√ß√£o
        Write-Host "[8] Limpar Arquivos de Hiberna√ß√£o (Liberar o hiberfil.sys)" -ForegroundColor White # Nova op√ß√£o
        Write-Host "[9] Limpar Arquivos WinSxS (Pasta que ocupa muito espa√ßo)" -ForegroundColor Magenta # Nova op√ß√£o
        Write-Host "[10] Executar TODAS as limpezas acima (Faxina completa!)" -ForegroundColor Red # Nova op√ß√£o
        Write-Host "[0] Voltar ao Menu Avan√ßado (De volta pras categorias!)" -ForegroundColor Red # Vermelho pra Sair/Voltar - Ok

        Write-Host ""

        # Pergunta qual limpeza espec√≠fica o mago quer fazer
        $choice = Read-Host "Escolhe a limpeza avan√ßada, mestre!"

        # V√™ qual fun√ß√£o de limpeza espec√≠fica chamar
        switch ($choice) {
            "1" { Invoke-CleanUserTemp } # Chama a fun√ß√£o pra Limpar Temp Usu√°rio
            "2" { Invoke-CleanSystemTemp } # Chama a fun√ß√£o pra Limpar Temp Sistema
            "3" { Invoke-CleanDnsCache } # Chama a fun√ß√£o pra Limpar Cache DNS
            "4" { Invoke-EmptyRecycleBin } # Chama a fun√ß√£o pra Esvaziar Lixeira
            "5" { Invoke-CleanThumbnailCache } # Chama a fun√ß√£o pra Limpar Cache de Miniaturas
            "6" { Invoke-CleanSystemLogs } # Nova fun√ß√£o para limpar logs do sistema
            "7" { Invoke-CleanWindowsUpdateCache } # Nova fun√ß√£o para limpar cache de updates
            "8" { Invoke-CleanHibernationFile } # Nova fun√ß√£o para limpar arquivo de hiberna√ß√£o
            "9" { Invoke-CleanWinSxS } # Nova fun√ß√£o para limpar pasta WinSxS
            "10" { 
                # Executa todas as limpezas em sequ√™ncia
                Write-Host "`nIniciando faxina completa do sistema! Isso pode demorar um pouco...`n" -ForegroundColor Yellow
                $diskSpaceBefore = Get-DiskSpaceBefore
                
                Invoke-CleanUserTemp
                Invoke-CleanSystemTemp
                Invoke-CleanDnsCache
                Invoke-EmptyRecycleBin
                Invoke-CleanThumbnailCache
                Invoke-CleanSystemLogs
                Invoke-CleanWindowsUpdateCache
                Invoke-CleanHibernationFile
                Invoke-CleanWinSxS
                
                Write-Host "`nFaxina completa finalizada! Veja quanto espa√ßo foi recuperado:`n" -ForegroundColor Green
                Show-DiskSpaceComparison -before $diskSpaceBefore
                Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
            }
            "0" { break } # Sai do loop deste menu, voltando pra Show-AdvancedMenu
            default {
                Write-Host "Essa tarefa de limpeza ainda n√£o t√° na lista! V√™ os n√∫meros e tenta de novo!" -ForegroundColor Red # Vermelho pra erro - Ok
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0') # Repete o Sub-Menu Limpeza enquanto o usu√°rio n√£o escolher Voltar
}

# --- NOVO Sub-Menu: Desempenho (Dentro do Avan√ßado!) ---
function Show-DesempenhoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DESEMPENHO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Ajustar Efeitos Visuais para Melhor Desempenho" -ForegroundColor Green
        Write-Host "[2] Otimizar Disco do Sistema" -ForegroundColor Cyan
        Write-Host "[3] Limpar Arquivos Prefetch" -ForegroundColor Yellow
        Write-Host "[4] Definir Plano de Energia para Alto Desempenho" -ForegroundColor White
        Write-Host "[5] Otimizar Servi√ßo SuperFetch/SysMain" -ForegroundColor Magenta
        Write-Host "[6] Ajustar Tamanho da Mem√≥ria Virtual" -ForegroundColor Gray
        Write-Host "[7] Desativar Indexa√ß√£o de Arquivos" -ForegroundColor Green
        Write-Host "[8] Otimizar Inicializa√ß√£o do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de desempenho" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o de desempenho"

        switch ($choice) {
            "1" { Invoke-OptimizeVisualEffects }
            "2" { Invoke-OptimizeDisk }
            "3" { Invoke-CleanPrefetch }
            "4" { Invoke-SetHighPerformancePower }
            "5" { Invoke-OptimizeSuperFetch }
            "6" { Invoke-AdjustVirtualMemory }
            "7" { Invoke-DisableIndexing }
            "8" { Invoke-OptimizeStartup }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de desempenho...`n" -ForegroundColor Yellow
                Invoke-OptimizeVisualEffects
                Invoke-OptimizeDisk
                Invoke-CleanPrefetch
                Invoke-SetHighPerformancePower
                Invoke-OptimizeSuperFetch
                Invoke-AdjustVirtualMemory
                Invoke-DisableIndexing
                Invoke-OptimizeStartup
                Write-Host "`nTodas as otimiza√ß√µes de desempenho foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Configura√ß√µes de Rede (Dentro do Avan√ßado!) ---
function Show-ConfiguracoesRedeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: CONFIG. REDE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Limpar Cache de DNS" -ForegroundColor Yellow
        Write-Host "[2] Mudar Servidor DNS" -ForegroundColor Cyan
        Write-Host "[3] Resetar Configura√ß√µes de Rede" -ForegroundColor White
        Write-Host "[4] Otimizar Configura√ß√µes TCP/IP" -ForegroundColor Green
        Write-Host "[5] Verificar Velocidade da Conex√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar QoS (Qualidade de Servi√ßo)" -ForegroundColor Gray
        Write-Host "[7] Desativar IPv6 (Se n√£o estiver usando)" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Lat√™ncia de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes de rede" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√£o de rede"

        switch ($choice) {
            "1" { Invoke-NetworkFlushDns }
            "2" { Invoke-NetworkChangeDns }
            "3" { Invoke-NetworkReset }
            "4" { Invoke-OptimizeTcpIp }
            "5" { Invoke-CheckNetworkSpeed }
            "6" { Invoke-ConfigureQoS }
            "7" { Invoke-DisableIPv6 }
            "8" { Invoke-OptimizeGamingLatency }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes de rede...`n" -ForegroundColor Yellow
                Invoke-NetworkFlushDns
                Invoke-OptimizeTcpIp
                Invoke-CheckNetworkSpeed
                Invoke-ConfigureQoS
                Invoke-DisableIPv6
                Invoke-OptimizeGamingLatency
                Write-Host "`nTodas as otimiza√ß√µes de rede foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Rede..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Servi√ßos (Dentro do Avan√ßado!) ---
function Show-ServicosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: SERVICOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desabilitar Servi√ßo SuperFetch/SysMain" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Servi√ßo de Impress√£o" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Servi√ßo Windows Update" -ForegroundColor White
        Write-Host "[4] Listar Todos os Servi√ßos em Execu√ß√£o" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Otimizar Servi√ßos para Desempenho Geral" -ForegroundColor Gray
        Write-Host "[7] Restaurar Servi√ßos para Configura√ß√£o Padr√£o" -ForegroundColor Yellow
        Write-Host "[8] Desabilitar Servi√ßos Desnecess√°rios" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de servi√ßos"

        switch ($choice) {
            "1" { Invoke-ManageSuperFetch }
            "2" { Invoke-ManagePrintService }
            "3" { Invoke-ManageWindowsUpdate }
            "4" { Invoke-ListRunningServices }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-OptimizeServicesForPerformance }
            "7" { Invoke-RestoreDefaultServices }
            "8" { Invoke-DisableUnnecessaryServices }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Diagn√≥stico (Dentro do Avan√ßado!) ---
function Show-DiagnosticoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: DIAGNOSTICO" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Verificar Arquivos do Sistema (SFC)" -ForegroundColor Yellow
        Write-Host "[2] Reparar Imagem do Windows (DISM)" -ForegroundColor Cyan
        Write-Host "[3] Verificar Disco por Erros (CHKDSK)" -ForegroundColor White
        Write-Host "[4] Verificar Sa√∫de do Disco" -ForegroundColor Green
        Write-Host "[5] Verificar Drivers Desatualizados" -ForegroundColor Magenta
        Write-Host "[6] Verificar Problemas de Inicializa√ß√£o" -ForegroundColor Gray
        Write-Host "[7] Verificar Problemas de Mem√≥ria RAM" -ForegroundColor Yellow
        Write-Host "[8] Verificar Temperatura do Sistema" -ForegroundColor Cyan
        Write-Host "[9] Executar TODOS os diagn√≥sticos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de diagn√≥stico"

        switch ($choice) {
            "1" { Invoke-SfcScan }
            "2" { Invoke-DismRepair }
            "3" { Invoke-ChkDsk }
            "4" { Invoke-CheckDiskHealth }
            "5" { Invoke-CheckDrivers }
            "6" { Invoke-CheckStartupIssues }
            "7" { Invoke-CheckMemory }
            "8" { Invoke-CheckTemperature }
            "9" {
                Write-Host "`nExecutando todos os diagn√≥sticos...`n" -ForegroundColor Yellow
                Invoke-SfcScan
                Invoke-DismRepair
                Invoke-CheckDiskHealth
                Invoke-CheckDrivers
                Invoke-CheckStartupIssues
                Invoke-CheckTemperature
                Write-Host "`nTodos os diagn√≥sticos foram conclu√≠dos!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Diagn√≥stico..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Recursos (Dentro do Avan√ßado!) ---
function Show-RecursosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: RECURSOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Gerenciar Hiberna√ß√£o" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Planos de Energia" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Recursos Opcionais do Windows" -ForegroundColor White
        Write-Host "[4] Gerenciar Mem√≥ria Virtual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Windows Defender" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Recursos de Telemetria" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Recursos de Inicializa√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Recursos de Seguran√ßa" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de recursos"

        switch ($choice) {
            "1" { Invoke-ManageHibernation }
            "2" { Invoke-ManagePowerPlans }
            "3" { Invoke-ManageOptionalFeatures }
            "4" { Invoke-ManageVirtualMemory }
            "5" { Invoke-ManageWindowsDefender }
            "6" { Invoke-ManageTelemetry }
            "7" { Invoke-ManageStartupResources }
            "8" { Invoke-ManageSecurityFeatures }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Arquivos e Pastas (Dentro do Avan√ßado!) ---
function Show-ArquivosPastasMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: ARQUIVOS E PASTAS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Encontrar Arquivos Grandes" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Arquivos" -ForegroundColor Cyan
        Write-Host "[3] Tomar Posse de Arquivos (TakeOwn)" -ForegroundColor White
        Write-Host "[4] Listar Conte√∫do de Pastas Espec√≠ficas" -ForegroundColor Green
        Write-Host "[5] Compactar Pastas para Economizar Espa√ßo" -ForegroundColor Magenta
        Write-Host "[6] Verificar Integridade de Arquivos" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Arquivos Ocultos e do Sistema" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Atributos de Arquivos" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de arquivos e pastas"

        switch ($choice) {
            "1" { Invoke-FindLargeFiles }
            "2" { Invoke-ManageFilePermissions }
            "3" { Invoke-TakeOwnership }
            "4" { Invoke-ListFolderContents }
            "5" { Invoke-CompressFolders }
            "6" { Invoke-VerifyFileIntegrity }
            "7" { Invoke-ManageHiddenSystemFiles }
            "8" { Invoke-ManageFileAttributes }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Usu√°rios (Dentro do Avan√ßado!) ---
function Show-UsuariosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: USUARIOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Listar Todos os Usu√°rios Locais" -ForegroundColor Yellow
        Write-Host "[2] Listar Todos os Grupos Locais" -ForegroundColor Cyan
        Write-Host "[3] Listar Membros de Grupos Espec√≠ficos" -ForegroundColor White
        Write-Host "[4] Mostrar Propriedades do Usu√°rio Atual" -ForegroundColor Green
        Write-Host "[5] Gerenciar Contas de Usu√°rio" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Pol√≠ticas de Senha" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Permiss√µes de Usu√°rio" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar UAC (Controle de Conta de Usu√°rio)" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de gerenciamento de usu√°rios"

        switch ($choice) {
            "1" { Invoke-ListLocalUsers }
            "2" { Invoke-ListLocalGroups }
            "3" { Invoke-ListGroupMembers }
            "4" { Invoke-ShowCurrentUserProperties }
            "5" { Invoke-ManageUserAccounts }
            "6" { Invoke-ManagePasswordPolicies }
            "7" { Invoke-ManageUserPermissions }
            "8" { Invoke-ManageUAC }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Jogos Avan√ßado (Dentro do Avan√ßado!) ---
function Show-JogosAvancadoMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: JOGOS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Otimizar Prioridade de CPU para Jogos" -ForegroundColor Yellow
        Write-Host "[2] Otimizar Configura√ß√µes de Rede para Jogos" -ForegroundColor Cyan
        Write-Host "[3] Otimizar Configura√ß√µes de GPU" -ForegroundColor White
        Write-Host "[4] Desativar Game DVR e Game Bar" -ForegroundColor Green
        Write-Host "[5] Otimizar Servi√ßos para Jogos" -ForegroundColor Magenta
        Write-Host "[6] Configurar Modo de Jogo do Windows" -ForegroundColor Gray
        Write-Host "[7] Otimizar Configura√ß√µes de √Åudio para Jogos" -ForegroundColor Yellow
        Write-Host "[8] Otimizar Configura√ß√µes de Input Lag" -ForegroundColor Cyan
        Write-Host "[9] Executar TODAS as otimiza√ß√µes para jogos" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de otimiza√ß√£o para jogos"

        switch ($choice) {
            "1" { Invoke-OptimizeCpuPriority }
            "2" { Invoke-OptimizeNetworkForGaming }
            "3" { Invoke-OptimizeGpuSettings }
            "4" { Invoke-DisableGameDvrBar }
            "5" { Invoke-OptimizeServicesForGaming }
            "6" { Invoke-ConfigureGameMode }
            "7" { Invoke-OptimizeAudioForGaming }
            "8" { Invoke-OptimizeInputLag }
            "9" {
                Write-Host "`nExecutando todas as otimiza√ß√µes para jogos...`n" -ForegroundColor Yellow
                Invoke-OptimizeCpuPriority
                Invoke-OptimizeNetworkForGaming
                Invoke-OptimizeGpuSettings
                Invoke-DisableGameDvrBar
                Invoke-OptimizeServicesForGaming
                Invoke-ConfigureGameMode
                Invoke-OptimizeAudioForGaming
                Invoke-OptimizeInputLag
                Write-Host "`nTodas as otimiza√ß√µes para jogos foram conclu√≠das!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Jogos..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Privacidade (Dentro do Avan√ßado!) ---
function Show-PrivacidadeMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: PRIVACIDADE" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Desativar Telemetria do Windows" -ForegroundColor Yellow
        Write-Host "[2] Gerenciar Permiss√µes de Aplicativos" -ForegroundColor Cyan
        Write-Host "[3] Gerenciar Hist√≥rico de Atividades" -ForegroundColor White
        Write-Host "[4] Gerenciar Diagn√≥stico e Feedback" -ForegroundColor Green
        Write-Host "[5] Gerenciar An√∫ncios Personalizados" -ForegroundColor Magenta
        Write-Host "[6] Gerenciar Localiza√ß√£o e Sensores" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Reconhecimento de Voz e Digita√ß√£o" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Sincroniza√ß√£o com a Microsoft" -ForegroundColor Cyan
        Write-Host "[9] Aplicar TODAS as configura√ß√µes de privacidade" -ForegroundColor Red
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de privacidade"

        switch ($choice) {
            "1" { Invoke-DisableTelemetry }
            "2" { Invoke-ManageAppPermissions }
            "3" { Invoke-ManageActivityHistory }
            "4" { Invoke-ManageDiagnosticsFeedback }
            "5" { Invoke-ManagePersonalizedAds }
            "6" { Invoke-ManageLocationSensors }
            "7" { Invoke-ManageVoiceTyping }
            "8" { Invoke-ManageMicrosoftSync }
            "9" {
                Write-Host "`nAplicando todas as configura√ß√µes de privacidade...`n" -ForegroundColor Yellow
                Invoke-DisableTelemetry
                Invoke-ManageAppPermissions
                Invoke-ManageActivityHistory
                Invoke-ManageDiagnosticsFeedback
                Invoke-ManagePersonalizedAds
                Invoke-ManageLocationSensors
                Invoke-ManageVoiceTyping
                Invoke-ManageMicrosoftSync
                Write-Host "`nTodas as configura√ß√µes de privacidade foram aplicadas!`n" -ForegroundColor Green
                Read-Host "Pressione Enter para voltar ao menu de Privacidade..."
            }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- NOVO Sub-Menu: Outros (Dentro do Avan√ßado!) ---
function Show-OutrosMenu {
    do {
        Clear-Host
        Banner-TORK

        Write-Host ""
        Write-Host "===============================" -ForegroundColor White
        Write-Host "  AVANCADO: OUTROS TWEAKS" -ForegroundColor White
        Write-Host "===============================" -ForegroundColor White
        Write-Host ""

        Write-Host "[1] Mostrar Informa√ß√µes Detalhadas do Sistema" -ForegroundColor Yellow
        Write-Host "[2] Mostrar Configura√ß√£o Completa de Rede" -ForegroundColor Cyan
        Write-Host "[3] Reiniciar Explorer.exe" -ForegroundColor White
        Write-Host "[4] Limpar Cache de Atualiza√ß√µes do Windows" -ForegroundColor Green
        Write-Host "[5] Gerenciar Programas de Inicializa√ß√£o" -ForegroundColor Magenta
        Write-Host "[6] Configurar Op√ß√µes de Energia Avan√ßadas" -ForegroundColor Gray
        Write-Host "[7] Gerenciar Configura√ß√µes de Armazenamento" -ForegroundColor Yellow
        Write-Host "[8] Gerenciar Configura√ß√µes de Notifica√ß√µes" -ForegroundColor Cyan
        Write-Host "[0] Voltar ao Menu Avan√ßado" -ForegroundColor Red

        Write-Host ""
        $choice = Read-Host "Escolha uma op√ß√£o de configura√ß√µes diversas"

        switch ($choice) {
            "1" { Invoke-ShowDetailedSystemInfo }
            "2" { Invoke-ShowDetailedNetworkConfig }
            "3" { Invoke-RestartExplorer }
            "4" { Invoke-CleanWindowsUpdateCache }
            "5" { Invoke-ManageStartupPrograms }
            "6" { Invoke-ConfigureAdvancedPowerOptions }
            "7" { Invoke-ManageStorageSettings }
            "8" { Invoke-ManageNotificationSettings }
            "0" { break }
            default {
                Write-Host "Op√ß√£o inv√°lida! Por favor, escolha uma op√ß√£o v√°lida." -ForegroundColor Red
                Start-Sleep -Seconds 1
            }
        }
    } while ($choice -ne '0')
}

# --- Fun√ß√µes para as Secoes SIMPLIFICADAS (Expandidas) ---
function Invoke-SimpleSystemCleanup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza Geral do Sistema: Hora de varrer o lixo digital! ---" -ForegroundColor Green
    Write-Host "Essa op√ß√£o vai te ajudar a liberar espa√ßo e dar um f√¥lego pro PC tirando arquivos tempor√°rios, lixo da lixeira, etc. √â tipo faxina no computador!" -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Comando 1: Limpar Arquivos Tempor√°rios do Usu√°rio
    Write-Host "Bora come√ßar limpando os arquivos tempor√°rios do seu usu√°rio! Eles acumulam que √© uma beleza!" -ForegroundColor Yellow
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio limpos! Menos peso pro PC respirar! ;)" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Esvaziar a Lixeira
    Write-Host "Agora, vamos dar um fim definitivo naqueles arquivos na Lixeira. Eles s√≥ est√£o ocupando espa√ßo √† toa!" -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada! Espa√ßo recuperado com sucesso! R√°!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios do Windows
    Write-Host "Vamos limpar tamb√©m os tempor√°rios do pr√≥prio Windows. √Äs vezes, fica lixo escondido por l√°!" -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Limpar Cache de Navegadores Comuns
    Write-Host "Bora dar uma geral nos caches dos navegadores tamb√©m! Eles guardam um monte de coisa que pode pesar!" -ForegroundColor Yellow
    
    # Chrome
    Write-Host "Tentando limpar cache do Google Chrome..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Chrome limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Edge
    Write-Host "Tentando limpar cache do Microsoft Edge..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Media Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\GPUCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Service Worker\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Edge limpo (se o navegador n√£o estiver rodando)." -ForegroundColor DarkGray

    # Firefox
    Write-Host "Tentando limpar cache do Mozilla Firefox..." -ForegroundColor DarkGray
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\cache2\entries\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\startupCache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:APPDATA\Mozilla\Firefox\Profiles\*\thumbnails\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Firefox limpo (pode n√£o ser completo, dependendo do perfil/uso)." -ForegroundColor DarkGray

    # Brave (se instalado)
    Write-Host "Tentando limpar cache do Brave Browser (se instalado)..." -ForegroundColor DarkGray
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\BraveSoftware\Brave-Browser\User Data\Default\Code Cache\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Cache do Brave limpo (se instalado e n√£o estiver rodando)." -ForegroundColor DarkGray

    Write-Host "Limpeza de caches de navegador conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Comando 5: Limpar Cache de Miniaturas
    Write-Host "Limpando cache de miniaturas do Windows (aquelas pr√©-visualiza√ß√µes de imagens e v√≠deos)..." -ForegroundColor Yellow
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Write-Host "Cache de miniaturas limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Limpar Arquivos de Log do Windows
    Write-Host "Limpando arquivos de log do Windows que podem ocupar espa√ßo..." -ForegroundColor Yellow
    wevtutil cl Application
    wevtutil cl System
    wevtutil cl Security
    Write-Host "Logs do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 7: Limpar Arquivos Tempor√°rios de Instala√ß√£o
    Write-Host "Limpando arquivos tempor√°rios de instala√ß√£o de programas..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Installer\$*\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios de instala√ß√£o limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 8: Limpar Arquivos de Atualiza√ß√£o do Windows
    Write-Host "Limpando arquivos de atualiza√ß√£o do Windows que podem ocupar bastante espa√ßo..." -ForegroundColor Yellow
    Stop-Service -Name wuauserv -ErrorAction SilentlyContinue
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    Write-Host "Arquivos de atualiza√ß√£o do Windows limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 9: Limpar Arquivos Prefetch
    Write-Host "Limpando arquivos prefetch para melhorar a inicializa√ß√£o..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\Prefetch\*.pf" -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos prefetch limpos!" -ForegroundColor Green
    Write-Host ""

    # Comando 10: Executar Limpeza de Disco Integrada do Windows
    Write-Host "Executando a ferramenta de limpeza de disco integrada do Windows..." -ForegroundColor Yellow
    Start-Process -FilePath cleanmgr.exe -ArgumentList "/sagerun:1" -Wait -ErrorAction SilentlyContinue
    Write-Host "Limpeza de disco conclu√≠da!" -ForegroundColor Green
    Write-Host ""

    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "Vamos ver quanto espa√ßo conseguimos recuperar com essa faxina:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nPronto! A faxina geral b√°sica foi feita! Seu PC agradece o espa√ßo extra! ;)" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu
    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleMemoryStartup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Mem√≥ria e Inicializa√ß√£o R√°pida: Deixa o PC ligando num piscar! ---" -ForegroundColor Yellow
    Write-Host "Aqui a gente d√° uma olhada na mem√≥ria RAM e nos programas que ligam junto com o Windows. Menos coisa ligando √† toa = PC mais r√°pido pra usar na hora!" -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Listar Programas de Inicializa√ß√£o
    Write-Host "Listando programas que iniciam com o Windows (pra voc√™ saber o que t√° rodando por baixo dos panos):" -ForegroundColor Yellow
    Get-CimInstance win32_startupcommand | Select-Object Name, command, Location | Format-Table -AutoSize
    Write-Host "Lista de programas de inicializa√ß√£o exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Servi√ßo SuperFetch/SysMain
    Write-Host "Otimizando o servi√ßo SuperFetch/SysMain para melhorar o desempenho..." -ForegroundColor Yellow
    $confirmSysMain = Read-Host "Deseja desativar o servi√ßo SysMain/SuperFetch? (s/n) - Recomendado para SSDs"
    if ($confirmSysMain -eq 's') {
        Set-Service -Name SysMain -StartupType Disabled -ErrorAction SilentlyContinue
        Stop-Service -Name SysMain -Force -ErrorAction SilentlyContinue
        Write-Host "Servi√ßo SysMain/SuperFetch desativado!" -ForegroundColor Green
    } else {
        Write-Host "Servi√ßo SysMain/SuperFetch mantido ativo." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Limpar Arquivos Tempor√°rios de Updates
    Write-Host "Limpando arquivos tempor√°rios de atualiza√ß√µes do Windows (podem ocupar bastante espa√ßo e afetar performance):" -ForegroundColor Yellow
    Dism /online /Cleanup-Image /StartComponentCleanup /ErrorAction SilentlyContinue
    Write-Host "Limpeza de componentes de atualiza√ß√£o iniciada (pode levar um tempo)." -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Mem√≥ria Virtual
    Write-Host "Otimizando configura√ß√µes de mem√≥ria virtual para melhor desempenho..." -ForegroundColor Yellow
    $totalRam = (Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property capacity -Sum).Sum / 1GB
    Write-Host "Seu sistema tem aproximadamente $totalRam GB de RAM." -ForegroundColor White
    
    $confirmPageFile = Read-Host "Deseja otimizar o arquivo de pagina√ß√£o (mem√≥ria virtual)? (s/n)"
    if ($confirmPageFile -eq 's') {
        # Calcula tamanho recomendado (1.5x a RAM para sistemas com menos de 8GB, 1x para sistemas com mais)
        $pageFileSize = if ($totalRam -lt 8) { [math]::Round($totalRam * 1.5) * 1024 } else { [math]::Round($totalRam) * 1024 }
        
        Write-Host "Configurando arquivo de pagina√ß√£o para tamanho fixo de $pageFileSize MB..." -ForegroundColor DarkGray
        $computerSystem = Get-WmiObject -Class Win32_ComputerSystem
        $computerSystem.AutomaticManagedPagefile = $false
        $computerSystem.Put() | Out-Null
        
        $pageFileSetting = Get-WmiObject -Class Win32_PageFileSetting
        if ($pageFileSetting) {
            $pageFileSetting.InitialSize = $pageFileSize
            $pageFileSetting.MaximumSize = $pageFileSize
            $pageFileSetting.Put() | Out-Null
        }
        Write-Host "Arquivo de pagina√ß√£o otimizado! (Requer reinicializa√ß√£o para aplicar totalmente)" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes de mem√≥ria virtual mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Listar os 10 Processos que mais usam mem√≥ria no momento
    Write-Host "Listando os 10 processos que mais consomem mem√≥ria agora:" -ForegroundColor Yellow
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host "Lista de processos exibida." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Otimizar Inicializa√ß√£o do Windows
    Write-Host "Otimizando a inicializa√ß√£o do Windows..." -ForegroundColor Yellow
    # Desabilitar servi√ßos n√£o essenciais que podem atrasar a inicializa√ß√£o
    $startupServices = @(
        @{Name="DiagTrack"; DisplayName="Experi√™ncias do Usu√°rio Conectado e Telemetria"},
        @{Name="dmwappushservice"; DisplayName="Servi√ßo de Transfer√™ncia Inteligente em Segundo Plano (BITS)"},
        @{Name="MapsBroker"; DisplayName="Servi√ßo de Dados de Mapas"}
    )
    
    foreach ($service in $startupServices) {
        $confirmService = Read-Host "Deseja desativar o servi√ßo '$($service.DisplayName)' na inicializa√ß√£o? (s/n)"
        if ($confirmService -eq 's') {
            Set-Service -Name $service.Name -StartupType Disabled -ErrorAction SilentlyContinue
            Stop-Service -Name $service.Name -Force -ErrorAction SilentlyContinue
            Write-Host "Servi√ßo '$($service.DisplayName)' desativado!" -ForegroundColor Green
        } else {
            Write-Host "Servi√ßo '$($service.DisplayName)' mantido." -ForegroundColor Green
        }
    }
    Write-Host ""

    # Comando 7: Reiniciar o Computador (√ötil pra liberar mem√≥ria e aplicar mudan√ßas)
    Write-Host "Quer dar um 'refresh' geral no PC? Reiniciar pode ajudar!" -ForegroundColor Yellow
    $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (digite 'sim' para confirmar)"
    if ($confirmRestart -eq 'sim') {
        Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
        Restart-Computer -Force
    } else {
        Write-Host "Rein√≠cio cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o de mem√≥ria e inicializa√ß√£o!" -ForegroundColor Green

    # Pausa ao final da se√ß√£o antes de voltar pro menu (a n√£o ser que o PC tenha reiniciado)
    if ($confirmRestart -ne 'sim') {
        Write-Host ""
        Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
    }
}

function Invoke-SimpleInternetOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Acelerar a Conex√£o com a Internet (Simplificado): Diz adeus pro 'carregando...'! ---" -ForegroundColor Cyan
    Write-Host "Vamos fazer uns ajustes r√°pidos na sua conex√£o pra tentar deixar ela mais esperta." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Limpar Cache de DNS
    Write-Host "Limpando o cache de endere√ßos de internet (DNS) pra resolver nomes mais r√°pido!" -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Otimizar Configura√ß√µes TCP/IP
    Write-Host "Otimizando configura√ß√µes TCP/IP para melhorar a velocidade de conex√£o..." -ForegroundColor Yellow
    
    # Habilitar TCP Window Auto-Tuning
    netsh int tcp set global autotuninglevel=normal
    Write-Host "TCP Auto-Tuning configurado para 'normal'." -ForegroundColor DarkGray
    
    # Otimizar par√¢metros de recebimento de pacotes
    netsh int tcp set global rss=enabled
    Write-Host "Receive-Side Scaling (RSS) habilitado." -ForegroundColor DarkGray
    
    # Otimizar congestion provider
    netsh int tcp set global congestionprovider=ctcp
    Write-Host "Congestion Provider configurado para 'ctcp'." -ForegroundColor DarkGray
    
    # Otimizar ECN capability
    netsh int tcp set global ecncapability=enabled
    Write-Host "ECN Capability habilitado." -ForegroundColor DarkGray
    
    Write-Host "Configura√ß√µes TCP/IP otimizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Reiniciar Adaptadores de Rede
    Write-Host "Dando um 'reset' r√°pido nas suas conex√µes de rede. Pode resolver uns pepinos!" -ForegroundColor Yellow
    $confirmResetAdapter = Read-Host "Isso vai desconectar brevemente sua internet. Continuar? (s/n)"
    if ($confirmResetAdapter -eq 's') {
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        Write-Host "Adaptadores de rede reiniciados." -ForegroundColor Green
    } else {
        Write-Host "Reset de adaptadores cancelado." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 4: Configurar DNS R√°pido
    Write-Host "Configurar DNS mais r√°pido pode melhorar sua navega√ß√£o!" -ForegroundColor Yellow
    $confirmDns = Read-Host "Deseja configurar DNS mais r√°pidos (Google ou Cloudflare)? (s/n)"
    if ($confirmDns -eq 's') {
        Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
        Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
        $dnsChoice = Read-Host "Escolha uma op√ß√£o (1 ou 2)"
        
        $primaryDns = ""
        $secondaryDns = ""
        
        if ($dnsChoice -eq '1') {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            Write-Host "Google DNS selecionado." -ForegroundColor DarkGray
        } elseif ($dnsChoice -eq '2') {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            Write-Host "Cloudflare DNS selecionado." -ForegroundColor DarkGray
        } else {
            Write-Host "Op√ß√£o inv√°lida. DNS n√£o alterado." -ForegroundColor Red
        }
        
        if ($primaryDns -ne "") {
            $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" -and ($_.InterfaceDescription -match "Ethernet" -or $_.InterfaceDescription -match "Wi-Fi" -or $_.InterfaceDescription -match "Wireless") }
            
            foreach ($adapter in $networkAdapters) {
                Write-Host "Configurando DNS para adaptador: $($adapter.Name)" -ForegroundColor DarkGray
                Set-DnsClientServerAddress -InterfaceIndex $adapter.ifIndex -ServerAddresses ($primaryDns, $secondaryDns)
            }
            
            Write-Host "DNS configurado! Sua navega√ß√£o deve ficar mais r√°pida agora." -ForegroundColor Green
        }
    } else {
        Write-Host "Configura√ß√£o de DNS mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Mostrar Status B√°sico da Conex√£o
    Write-Host "Mostrando um resumo b√°sico da sua configura√ß√£o de rede atual:" -ForegroundColor Yellow
    ipconfig /all | Select-String -Pattern "IPv4", "DNS", "Gateway", "DHCP", "Subnet", "Physical Address"
    Write-Host "Status b√°sico da rede exibido." -ForegroundColor Green
    Write-Host ""

    # Comando 6: Testar a conex√£o com a internet
    Write-Host "Testando a conex√£o com a internet (ping para google.com)..." -ForegroundColor Yellow
    Test-Connection -Count 4 google.com -ErrorAction SilentlyContinue
    Write-Host "Teste de conex√£o finalizado." -ForegroundColor Green
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizada a otimiza√ß√£o b√°sica de internet!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleVisualOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Deixar o Windows mais Leve Visualmente (Simplificado): Desempenho antes da beleza! ---" -ForegroundColor White
    Write-Host "Ajustes r√°pidos pra desativar efeitos visuais que podem pesar, liberando recursos pro que importa." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ajustar Efeitos Visuais
    Write-Host "Voc√™ quer desativar ou ativar as anima√ß√µes e efeitos visuais do Windows?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Efeitos Visuais (Pra ganhar desempenho)" -ForegroundColor Green
    Write-Host "[2] Configurar para Melhor Apar√™ncia (Mais bonito, mas mais pesado)" -ForegroundColor White
    Write-Host "[3] Deixar o Windows Escolher (Configura√ß√£o padr√£o)" -ForegroundColor Cyan
    $choiceVisual = Read-Host "Escolha [1], [2] ou [3]"

    if ($choiceVisual -eq '1') {
        Write-Host "Desativando efeitos visuais para melhor desempenho..." -ForegroundColor Yellow
        # Valor 2 = Ajustar para melhor desempenho (desativa a maioria dos efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 2 -Type DWord -Force -ErrorAction SilentlyContinue
        
        # Desativar anima√ß√µes individuais
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop' -Name 'UserPreferencesMask' -Value ([byte[]](0x90, 0x12, 0x01, 0x80)) -Type Binary -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop\WindowMetrics' -Name 'MinAnimate' -Value 0 -Type String -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'ListviewAlphaSelect' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'TaskbarAnimations' -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        
        Write-Host "Efeitos visuais desativados para melhor desempenho!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '2') {
        Write-Host "Configurando para melhor apar√™ncia (todos os efeitos visuais ativados)..." -ForegroundColor Yellow
        # Valor 1 = Ajustar para melhor apar√™ncia (ativa todos os efeitos)
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Efeitos visuais configurados para melhor apar√™ncia!" -ForegroundColor Green
    } elseif ($choiceVisual -eq '3') {
        Write-Host "Deixando o Windows escolher automaticamente (configura√ß√£o padr√£o)..." -ForegroundColor Yellow
        # Valor 0 = Deixar o Windows escolher
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name VisualFXSetting -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Configura√ß√£o visual definida para padr√£o do Windows!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa nos efeitos visuais foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 2: Ativar/Desativar Efeitos de Transpar√™ncia
    Write-Host "E os efeitos de transpar√™ncia do Windows (tipo na barra de tarefas)?" -ForegroundColor Yellow
    Write-Host "[1] Desativar Transpar√™ncia (Mais leve)" -ForegroundColor Green
    Write-Host "[2] Ativar Transpar√™ncia (Mais 'bonito')" -ForegroundColor White
    $choiceTransp = Read-Host "Escolha [1] ou [2]"

    if ($choiceTransp -eq '1') {
        Write-Host "Desativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 0 = Desativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia desativada!" -ForegroundColor Green
    } elseif ($choiceTransp -eq '2') {
        Write-Host "Ativando transpar√™ncia..." -ForegroundColor Yellow
        # Valor 1 = Ativar Transpar√™ncia
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name EnableTransparency -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Transpar√™ncia ativada!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa na transpar√™ncia foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 3: Configurar Tema Claro/Escuro
    Write-Host "Voc√™ prefere tema claro ou escuro? O tema escuro pode ser mais confort√°vel para os olhos." -ForegroundColor Yellow
    Write-Host "[1] Tema Escuro (Dark Mode)" -ForegroundColor DarkGray
    Write-Host "[2] Tema Claro (Light Mode)" -ForegroundColor White
    $choiceTheme = Read-Host "Escolha [1] ou [2]"

    if ($choiceTheme -eq '1') {
        Write-Host "Configurando tema escuro..." -ForegroundColor Yellow
        # Valor 0 = Tema Escuro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 0 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema escuro configurado!" -ForegroundColor Green
    } elseif ($choiceTheme -eq '2') {
        Write-Host "Configurando tema claro..." -ForegroundColor Yellow
        # Valor 1 = Tema Claro
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name AppsUseLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize' -Name SystemUsesLightTheme -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        Write-Host "Tema claro configurado!" -ForegroundColor Green
    } else {
        Write-Host "Op√ß√£o inv√°lida. Nenhuma mudan√ßa no tema foi feita." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Configurar Resolu√ß√£o de Tela
    Write-Host "Deseja ajustar a resolu√ß√£o da tela? Resolu√ß√µes menores podem melhorar o desempenho em PCs mais antigos." -ForegroundColor Yellow
    $confirmResolution = Read-Host "Deseja ver e ajustar a resolu√ß√£o da tela? (s/n)"
    
    if ($confirmResolution -eq 's') {
        # Mostrar resolu√ß√£o atual
        $currentResolution = Get-WmiObject -Class Win32_VideoController | Select-Object -ExpandProperty VideoModeDescription
        Write-Host "Resolu√ß√£o atual: $currentResolution" -ForegroundColor White
        
        # Abrir configura√ß√µes de exibi√ß√£o do Windows
        Write-Host "Abrindo configura√ß√µes de exibi√ß√£o do Windows..." -ForegroundColor DarkGray
        Start-Process "ms-settings:display"
        Write-Host "Ajuste a resolu√ß√£o conforme necess√°rio na janela de configura√ß√µes que foi aberta." -ForegroundColor Green
        
        $waitForSettings = Read-Host "Pressione Enter quando terminar de ajustar as configura√ß√µes de exibi√ß√£o"
    } else {
        Write-Host "Configura√ß√£o de resolu√ß√£o mantida." -ForegroundColor Green
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nFinalizados os ajustes visuais b√°sicos!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleGamingOpt {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Otimiza√ß√£o de Jogos (Simplificado): Mais FPS, menos lag! ---" -ForegroundColor Magenta
    Write-Host "Vamos fazer alguns ajustes para melhorar o desempenho dos seus jogos sem complica√ß√µes." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Ativar Modo de Jogo do Windows
    Write-Host "Ativando o Modo de Jogo do Windows para priorizar recursos para jogos..." -ForegroundColor Yellow
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AllowAutoGameMode" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "AutoGameModeEnabled" -Type DWord -Value 1 -Force -ErrorAction SilentlyContinue
    Write-Host "Modo de Jogo do Windows ativado!" -ForegroundColor Green
    Write-Host ""

    # Comando 2: Desativar Game DVR e Game Bar
    Write-Host "O Game DVR e Game Bar podem reduzir o desempenho em jogos. Deseja desativ√°-los?" -ForegroundColor Yellow
    $confirmGameDVR = Read-Host "Desativar Game DVR e Game Bar? (s/n)"
    
    if ($confirmGameDVR -eq 's') {
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\GameBar" -Name "UseNexusForGameBarEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\System\GameConfigStore" -Name "GameDVR_Enabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR" -Name "AppCaptureEnabled" -Type DWord -Value 0 -Force -ErrorAction SilentlyContinue
        Write-Host "Game DVR e Game Bar desativados!" -ForegroundColor Green
    } else {
        Write-Host "Game DVR e Game Bar mantidos ativos." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 3: Otimizar Plano de Energia para Jogos
    Write-Host "Configurando plano de energia para alto desempenho (ideal para jogos)..." -ForegroundColor Yellow
    powercfg.exe /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c
    Write-Host "Plano de energia configurado para alto desempenho!" -ForegroundColor Green
    Write-Host ""

    # Comando 4: Otimizar Configura√ß√µes de Mouse
    Write-Host "Otimizando configura√ß√µes de mouse para jogos (precis√£o do ponteiro)..." -ForegroundColor Yellow
    $confirmMouseFix = Read-Host "Desativar a acelera√ß√£o do mouse para melhor precis√£o em jogos? (s/n)"
    
    if ($confirmMouseFix -eq 's') {
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseSpeed" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold1" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Mouse" -Name "MouseThreshold2" -Type String -Value "0" -Force -ErrorAction SilentlyContinue
        Write-Host "Acelera√ß√£o do mouse desativada para melhor precis√£o em jogos!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do mouse mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Otimizar Prioridade de CPU para Jogos
    Write-Host "Configurando prioridade de CPU para jogos..." -ForegroundColor Yellow
    Write-Host "Esta configura√ß√£o ajusta o sistema para dar mais prioridade aos jogos." -ForegroundColor DarkGray
    
    # Criar chave de registro para prioridade de jogos
    if (-not (Test-Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games")) {
        New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Force | Out-Null
    }
    
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "GPU Priority" -Type DWord -Value 8 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Priority" -Type DWord -Value 6 -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Scheduling Category" -Type String -Value "High" -Force -ErrorAction SilentlyContinue
    
    Write-Host "Prioridade de CPU para jogos otimizada!" -ForegroundColor Green
    Write-Host ""

    # Comando 6: Verificar Driver de Placa de V√≠deo
    Write-Host "Verificando informa√ß√µes da placa de v√≠deo..." -ForegroundColor Yellow
    $gpuInfo = Get-WmiObject -Class Win32_VideoController | Select-Object Name, DriverVersion, CurrentHorizontalResolution, CurrentVerticalResolution
    
    foreach ($gpu in $gpuInfo) {
        Write-Host "Placa de v√≠deo: $($gpu.Name)" -ForegroundColor White
        Write-Host "Vers√£o do driver: $($gpu.DriverVersion)" -ForegroundColor White
        Write-Host "Resolu√ß√£o atual: $($gpu.CurrentHorizontalResolution) x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
      x $($gpu.CurrentVerticalResolution)" -ForegroundColor White
        Write-Host ""
    }
    
    Write-Host "Recomenda√ß√£o: Mantenha seus drivers de v√≠deo atualizados para melhor desempenho em jogos!" -ForegroundColor Green
    Write-Host "Voc√™ pode baixar os drivers mais recentes nos sites oficiais da NVIDIA, AMD ou Intel." -ForegroundColor DarkGray
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nOtimiza√ß√µes para jogos conclu√≠das! Seus jogos devem rodar mais suaves agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

function Invoke-SimpleSecurityMaintenance {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Manuten√ß√£o de Seguran√ßa (Simplificado): Mantenha seu PC protegido! ---" -ForegroundColor DarkYellow
    Write-Host "Vamos verificar e melhorar a seguran√ßa do seu sistema com alguns ajustes simples." -ForegroundColor Gray
    Write-Host ""

    # Comando 1: Verificar Status do Windows Defender
    Write-Host "Verificando status do Windows Defender..." -ForegroundColor Yellow
    $defenderStatus = Get-MpComputerStatus
    
    Write-Host "Status do Windows Defender:" -ForegroundColor White
    Write-Host "Antiv√≠rus habilitado: $($defenderStatus.AntivirusEnabled)" -ForegroundColor $(if ($defenderStatus.AntivirusEnabled) { "Green" } else { "Red" })
    Write-Host "Prote√ß√£o em tempo real: $($defenderStatus.RealTimeProtectionEnabled)" -ForegroundColor $(if ($defenderStatus.RealTimeProtectionEnabled) { "Green" } else { "Red" })
    Write-Host "Defini√ß√µes de antiv√≠rus: $($defenderStatus.AntivirusSignatureVersion)" -ForegroundColor White
    Write-Host "√öltima atualiza√ß√£o: $($defenderStatus.AntivirusSignatureLastUpdated)" -ForegroundColor White
    Write-Host ""

    # Comando 2: Atualizar Defini√ß√µes do Windows Defender
    Write-Host "Atualizando defini√ß√µes do Windows Defender..." -ForegroundColor Yellow
    Update-MpSignature -ErrorAction SilentlyContinue
    Write-Host "Defini√ß√µes do Windows Defender atualizadas!" -ForegroundColor Green
    Write-Host ""

    # Comando 3: Verificar Atualiza√ß√µes do Windows
    Write-Host "Verificando status das atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
            Write-Host "Recomenda√ß√£o: Execute o Windows Update para manter seu sistema seguro." -ForegroundColor Green
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 4: Verificar Configura√ß√µes de Firewall
    Write-Host "Verificando status do Firewall do Windows..." -ForegroundColor Yellow
    $firewallStatus = Get-NetFirewallProfile
    
    foreach ($profile in $firewallStatus) {
        Write-Host "Perfil: $($profile.Name)" -ForegroundColor White
        Write-Host "Status: $($profile.Enabled)" -ForegroundColor $(if ($profile.Enabled) { "Green" } else { "Red" })
        Write-Host ""
    }
    
    $confirmFirewall = Read-Host "Deseja habilitar o Firewall em todos os perfis? (s/n)"
    if ($confirmFirewall -eq 's') {
        Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True
        Write-Host "Firewall habilitado em todos os perfis!" -ForegroundColor Green
    } else {
        Write-Host "Configura√ß√µes do Firewall mantidas." -ForegroundColor Green
    }
    Write-Host ""

    # Comando 5: Verificar Configura√ß√µes de UAC
    Write-Host "Verificando configura√ß√µes do Controle de Conta de Usu√°rio (UAC)..." -ForegroundColor Yellow
    $uacLevel = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -ErrorAction SilentlyContinue
    
    if ($uacLevel) {
        switch ($uacLevel.ConsentPromptBehaviorAdmin) {
            0 { $uacStatus = "Desativado (N√£o recomendado)" }
            1 { $uacStatus = "Baixo (N√£o recomendado)" }
            2 { $uacStatus = "M√©dio" }
            5 { $uacStatus = "Alto (Recomendado)" }
            default { $uacStatus = "Personalizado" }
        }
        
        Write-Host "N√≠vel atual do UAC: $uacStatus" -ForegroundColor $(if ($uacLevel.ConsentPromptBehaviorAdmin -ge 2) { "Green" } else { "Red" })
        
        $confirmUAC = Read-Host "Deseja configurar o UAC para o n√≠vel recomendado? (s/n)"
        if ($confirmUAC -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -Value 5 -Type DWord -Force -ErrorAction SilentlyContinue
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "PromptOnSecureDesktop" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
            Write-Host "UAC configurado para o n√≠vel recomendado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do UAC mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do UAC." -ForegroundColor Red
    }
    Write-Host ""

    # Comando 6: Verificar Configura√ß√µes de SmartScreen
    Write-Host "Verificando configura√ß√µes do Windows SmartScreen..." -ForegroundColor Yellow
    $smartScreen = Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -ErrorAction SilentlyContinue
    
    if ($smartScreen) {
        Write-Host "Status do SmartScreen: $($smartScreen.SmartScreenEnabled)" -ForegroundColor $(if ($smartScreen.SmartScreenEnabled -eq "RequireAdmin" -or $smartScreen.SmartScreenEnabled -eq "Warn") { "Green" } else { "Red" })
        
        $confirmSmartScreen = Read-Host "Deseja habilitar o SmartScreen para maior seguran√ßa? (s/n)"
        if ($confirmSmartScreen -eq 's') {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -Value "RequireAdmin" -Type String -Force -ErrorAction SilentlyContinue
            Write-Host "SmartScreen habilitado!" -ForegroundColor Green
        } else {
            Write-Host "Configura√ß√µes do SmartScreen mantidas." -ForegroundColor Green
        }
    } else {
        Write-Host "N√£o foi poss√≠vel verificar as configura√ß√µes do SmartScreen." -ForegroundColor Red
    }
    Write-Host ""

    # Mensagem de conclus√£o da tarefa
    Write-Host "`nManuten√ß√£o de seguran√ßa conclu√≠da! Seu sistema est√° mais protegido agora!" -ForegroundColor Green

    Write-Host ""
    Read-Host "D√° um Enter pra voltar pro Menu Simplificado..."
}

# --- Fun√ß√µes para o Diagn√≥stico R√°pido e Sobre ---
function Invoke-QuickDiagnostic {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Diagn√≥stico R√°pido do Sistema ---" -ForegroundColor Yellow
    Write-Host "Vamos fazer uma verifica√ß√£o r√°pida do estado atual do seu PC." -ForegroundColor Gray
    Write-Host ""

    # Informa√ß√µes do Sistema
    Write-Host "=== Informa√ß√µes do Sistema ===" -ForegroundColor Cyan
    $sysInfo = Get-SystemInfo
    Write-Host "Sistema: $($sysInfo.OSName) ($($sysInfo.Architecture))" -ForegroundColor White
    Write-Host "Vers√£o: $($sysInfo.OSVersion) (Build $($sysInfo.OSBuild))" -ForegroundColor White
    Write-Host "Processador: $($sysInfo.Processor)" -ForegroundColor White
    Write-Host "Mem√≥ria RAM: $($sysInfo.Memory) GB" -ForegroundColor White
    Write-Host "√öltimo boot: $($sysInfo.LastBootTime)" -ForegroundColor White
    Write-Host ""

    # Uso de CPU
    Write-Host "=== Uso de CPU ===" -ForegroundColor Cyan
    $cpuLoad = (Get-WmiObject Win32_Processor).LoadPercentage
    Write-Host "Uso atual de CPU: $cpuLoad%" -ForegroundColor $(if ($cpuLoad -lt 70) { "Green" } elseif ($cpuLoad -lt 90) { "Yellow" } else { "Red" })
    Write-Host ""

    # Uso de Mem√≥ria
    Write-Host "=== Uso de Mem√≥ria ===" -ForegroundColor Cyan
    $os = Get-WmiObject Win32_OperatingSystem
    $totalMemory = [math]::Round($os.TotalVisibleMemorySize / 1MB, 2)
    $freeMemory = [math]::Round($os.FreePhysicalMemory / 1MB, 2)
    $usedMemory = [math]::Round($totalMemory - $freeMemory, 2)
    $memoryPercentage = [math]::Round(($usedMemory / $totalMemory) * 100, 2)
    
    Write-Host "Mem√≥ria Total: $totalMemory GB" -ForegroundColor White
    Write-Host "Mem√≥ria Usada: $usedMemory GB ($memoryPercentage%)" -ForegroundColor $(if ($memoryPercentage -lt 70) { "Green" } elseif ($memoryPercentage -lt 90) { "Yellow" } else { "Red" })
    Write-Host "Mem√≥ria Livre: $freeMemory GB" -ForegroundColor White
    Write-Host ""

    # Espa√ßo em Disco
    Write-Host "=== Espa√ßo em Disco ===" -ForegroundColor Cyan
    $drives = Get-PSDrive -PSProvider FileSystem
    foreach ($drive in $drives) {
        $freeSpace = [math]::Round($drive.Free / 1GB, 2)
        $usedSpace = [math]::Round(($drive.Used) / 1GB, 2)
        $totalSpace = [math]::Round(($drive.Free + $drive.Used) / 1GB, 2)
        $percentFree = [math]::Round(($freeSpace / $totalSpace) * 100, 2)
        
        Write-Host "Drive $($drive.Name):" -ForegroundColor White
        Write-Host "  Total: $totalSpace GB" -ForegroundColor White
        Write-Host "  Usado: $usedSpace GB" -ForegroundColor White
        Write-Host "  Livre: $freeSpace GB ($percentFree%)" -ForegroundColor $(if ($percentFree -gt 20) { "Green" } elseif ($percentFree -gt 10) { "Yellow" } else { "Red" })
    }
    Write-Host ""

    # Processos que mais consomem recursos
    Write-Host "=== Top 5 Processos (CPU) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object CPU -Descending | Select-Object -First 5 ProcessName, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}}, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}} | Format-Table -AutoSize
    Write-Host ""

    Write-Host "=== Top 5 Processos (Mem√≥ria) ===" -ForegroundColor Cyan
    Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 5 ProcessName, @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet / 1MB, 2)}}, @{Name="CPU(s)"; Expression={[math]::Round($_.CPU, 2)}} | Format-Table -AutoSize
    Write-Host ""

    # Status de Servi√ßos Cr√≠ticos
    Write-Host "=== Status de Servi√ßos Cr√≠ticos ===" -ForegroundColor Cyan
    $criticalServices = @("wuauserv", "WinDefend", "MpsSvc", "wscsvc")
    foreach ($service in $criticalServices) {
        $serviceStatus = Get-Service -Name $service -ErrorAction SilentlyContinue
        if ($serviceStatus) {
            Write-Host "$($serviceStatus.DisplayName): $($serviceStatus.Status)" -ForegroundColor $(if ($serviceStatus.Status -eq "Running") { "Green" } else { "Red" })
        }
    }
    Write-Host ""

    # Verificar Atualiza√ß√µes Pendentes
    Write-Host "=== Atualiza√ß√µes do Windows ===" -ForegroundColor Cyan
    $updateSession = New-Object -ComObject Microsoft.Update.Session
    $updateSearcher = $updateSession.CreateUpdateSearcher()
    
    try {
        $searchResult = $updateSearcher.Search("IsInstalled=0")
        $pendingUpdates = $searchResult.Updates.Count
        
        if ($pendingUpdates -gt 0) {
            Write-Host "Existem $pendingUpdates atualiza√ß√µes pendentes para o seu sistema." -ForegroundColor Yellow
        } else {
            Write-Host "Seu sistema est√° atualizado! N√£o h√° atualiza√ß√µes pendentes." -ForegroundColor Green
        }
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar as atualiza√ß√µes do Windows." -ForegroundColor Red
    }
    Write-Host ""

    # Recomenda√ß√µes
    Write-Host "=== Recomenda√ß√µes ===" -ForegroundColor Cyan
    
    # Recomenda√ß√£o de Mem√≥ria
    if ($memoryPercentage -gt 80) {
        Write-Host "- Seu uso de mem√≥ria est√° alto. Considere fechar alguns programas ou usar a op√ß√£o 'Otimiza√ß√£o de Mem√≥ria'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Disco
    $lowDiskSpace = $false
    foreach ($drive in $drives) {
        $percentFree = [math]::Round(($drive.Free / ($drive.Free + $drive.Used)) * 100, 2)
        if ($percentFree -lt 15) {
            $lowDiskSpace = $true
            break
        }
    }
    
    if ($lowDiskSpace) {
        Write-Host "- Espa√ßo em disco baixo detectado. Considere usar a op√ß√£o 'Limpeza Geral do Sistema'." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Atualiza√ß√µes
    if ($pendingUpdates -gt 0) {
        Write-Host "- Existem atualiza√ß√µes pendentes. Recomendamos atualizar seu sistema para maior seguran√ßa." -ForegroundColor Yellow
    }
    
    # Recomenda√ß√£o de Inicializa√ß√£o
    $bootTime = $sysInfo.LastBootTime
    $uptime = (Get-Date) - $bootTime
    if ($uptime.Days -gt 7) {
        Write-Host "- Seu sistema est√° ligado h√° $($uptime.Days) dias. Considere reiniciar para aplicar atualiza√ß√µes e limpar a mem√≥ria." -ForegroundColor Yellow
    }
    
    Write-Host ""

    # Mensagem de conclus√£o
    Write-Host "`nDiagn√≥stico r√°pido conclu√≠do! Use as informa√ß√µes acima para decidir quais otimiza√ß√µes fazer." -ForegroundColor Green

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

function Show-AboutTORK {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Sobre o TORK ---" -ForegroundColor White
    Write-Host ""
    
    Write-Host "TORK - Otimizador para Windows" -ForegroundColor Cyan
    Write-Host "Vers√£o: 2.0" -ForegroundColor White
    Write-Host "Desenvolvido por: Partner77" -ForegroundColor White
    Write-Host ""
    
    Write-Host "=== Descri√ß√£o ===" -ForegroundColor Yellow
    Write-Host "O TORK √© uma ferramenta abrangente de otimiza√ß√£o para Windows, projetada para" -ForegroundColor Gray
    Write-Host "melhorar o desempenho do seu sistema atrav√©s de limpeza, ajustes e otimiza√ß√µes." -ForegroundColor Gray
    Write-Host "Ele oferece op√ß√µes simplificadas para usu√°rios comuns e op√ß√µes avan√ßadas para" -ForegroundColor Gray
    Write-Host "usu√°rios experientes que desejam um controle mais detalhado sobre o sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Recursos ===" -ForegroundColor Yellow
    Write-Host "- Limpeza completa do sistema" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√£o de mem√≥ria e inicializa√ß√£o" -ForegroundColor Gray
    Write-Host "- Ajustes de rede para melhor conectividade" -ForegroundColor Gray
    Write-Host "- Otimiza√ß√µes visuais para melhor desempenho" -ForegroundColor Gray
    Write-Host "- Configura√ß√µes espec√≠ficas para jogos" -ForegroundColor Gray
    Write-Host "- Manuten√ß√£o de seguran√ßa" -ForegroundColor Gray
    Write-Host "- Diagn√≥stico r√°pido do sistema" -ForegroundColor Gray
    Write-Host "- Mais de 100 ajustes e otimiza√ß√µes avan√ßadas" -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Aviso Legal ===" -ForegroundColor Yellow
    Write-Host "Este software √© fornecido 'como est√°', sem garantias de qualquer tipo." -ForegroundColor Gray
    Write-Host "O autor n√£o se responsabiliza por quaisquer danos ou problemas causados pelo uso" -ForegroundColor Gray
    Write-Host "deste software. Use por sua conta e risco. Recomendamos sempre fazer backup" -ForegroundColor Gray
    Write-Host "dos seus dados importantes antes de realizar otimiza√ß√µes no sistema." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "=== Agradecimentos ===" -ForegroundColor Yellow
    Write-Host "Obrigado por escolher o TORK para otimizar seu sistema Windows!" -ForegroundColor Gray
    Write-Host "Esperamos que esta ferramenta ajude a melhorar o desempenho do seu PC." -ForegroundColor Gray
    Write-Host ""
    
    Write-Host "¬© 2023-2024 Partner77 - Todos os direitos reservados" -ForegroundColor Cyan
    Write-Host ""
    
    Read-Host "Pressione Enter para voltar ao Menu Principal..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - LIMPEZA (Expandidas) ---
function Invoke-CleanUserTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Usu√°rio ---" -ForegroundColor Cyan
    Write-Host "Remove arquivos da pasta tempor√°ria do seu usu√°rio (`$env:TEMP`)." -ForegroundColor Gray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:TEMP..." -ForegroundColor Yellow
    $tempFiles = Get-ChildItem -Path $env:TEMP -Recurse -ErrorAction SilentlyContinue
    $tempFilesCount = ($tempFiles | Measure-Object).Count
    $tempFilesSize = ($tempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $tempFilesCount arquivos tempor√°rios ocupando aproximadamente $([math]::Round($tempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do usu√°rio removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemTemp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos Tempor√°rios do Sistema ---" -ForegroundColor Gray
    Write-Host "Remove arquivos da pasta tempor√°ria do Windows (`$env:SystemRoot\Temp`)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Removendo arquivos em $env:SystemRoot\Temp..." -ForegroundColor Yellow
    $systemTempFiles = Get-ChildItem -Path "$env:SystemRoot\Temp" -Recurse -ErrorAction SilentlyContinue
    $systemTempFilesCount = ($systemTempFiles | Measure-Object).Count
    $systemTempFilesSize = ($systemTempFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $systemTempFilesCount arquivos tempor√°rios do sistema ocupando aproximadamente $([math]::Round($systemTempFilesSize, 2)) MB." -ForegroundColor White
    
    Remove-Item "$env:SystemRoot\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Arquivos tempor√°rios do sistema removidos." -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanDnsCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-EmptyRecycleBin {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Esvaziar Lixeira ---" -ForegroundColor Gray
    Write-Host "Esvazia a lixeira do usu√°rio logado." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar tamanho da lixeira antes de esvaziar
    Write-Host "Verificando tamanho da lixeira..." -ForegroundColor Yellow
    
    try {
        $shell = New-Object -ComObject Shell.Application
        $recycleBin = $shell.Namespace(0xA)
        $recycleBinItems = $recycleBin.Items()
        $recycleBinItemCount = $recycleBinItems.Count
        
        Write-Host "A lixeira cont√©m $recycleBinItemCount itens." -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o conte√∫do da lixeira." -ForegroundColor DarkGray
    }
    
    # Esvaziar a lixeira
    Write-Host "Executando: Esvaziando a lixeira..." -ForegroundColor Yellow
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host "Lixeira esvaziada com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanThumbnailCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Miniaturas ---" -ForegroundColor Green
    Write-Host "Remove o cache de miniaturas de arquivos (imagens, v√≠deos, etc.)." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Limpando cache de miniaturas..." -ForegroundColor Yellow
    
    # Verificar tamanho do cache de miniaturas antes da limpeza
    $thumbnailPath = "$env:LOCALAPPDATA\Microsoft\Windows\Explorer"
    $thumbnailFiles = Get-ChildItem -Path $thumbnailPath -Filter "thumbcache_*.db" -ErrorAction SilentlyContinue
    $thumbnailFilesCount = ($thumbnailFiles | Measure-Object).Count
    $thumbnailFilesSize = ($thumbnailFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "Encontrados $thumbnailFilesCount arquivos de cache de miniaturas ocupando aproximadamente $([math]::Round($thumbnailFilesSize, 2)) MB." -ForegroundColor White
    
    # Limpar o cache de miniaturas
    Stop-Process -Name explorer -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
    Start-Process explorer
    
    Write-Host "Cache de miniaturas limpo com sucesso!" -ForegroundColor Green
    Write-Host "O Windows Explorer foi reiniciado para aplicar as altera√ß√µes." -ForegroundColor DarkGray
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de miniaturas:" -ForegroundColor Cyan
    Write-Host "- Navega√ß√£o mais r√°pida em pastas com muitas imagens ou v√≠deos" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de miniaturas corrompidas ou desatualizadas" -ForegroundColor DarkGray
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanSystemLogs {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Logs do Sistema ---" -ForegroundColor Cyan
    Write-Host "Limpa os logs de eventos do sistema para liberar espa√ßo e melhorar o desempenho." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando logs do sistema..." -ForegroundColor Yellow
    
    # Verificar tamanho dos logs antes da limpeza
    $eventLogs = Get-WinEvent -ListLog * -ErrorAction SilentlyContinue | Where-Object { $_.RecordCount -gt 0 }
    $totalLogCount = ($eventLogs | Measure-Object).Count
    $total = ($eventLogs | Measure-Object -Property FileSize -Sum).Sum / 1MB
    
    Write-Host "Encontrados $totalLogCount logs de eventos ocupando aproximadamente $([math]::Round($total, 2)) MB." -ForegroundColor White
    
    # Limpar os logs principais
    Write-Host "Limpando logs principais do sistema..." -ForegroundColor Yellow
    
    $mainLogs = @("Application", "System", "Security")
    foreach ($log in $mainLogs) {
        try {
            $logSize = (Get-WinEvent -ListLog $log -ErrorAction SilentlyContinue).FileSize / 1MB
            $logRecords = (Get-WinEvent -ListLog $log -ErrorAction SilentlyContinue).RecordCount
            
            Write-Host "Log $log: $([math]::Round($logSize, 2)) MB com $logRecords registros" -ForegroundColor DarkGray
            wevtutil cl $log
            Write-Host "Log $log limpo com sucesso!" -ForegroundColor Green
        } catch {
            Write-Host "N√£o foi poss√≠vel limpar o log $log." -ForegroundColor Red
        }
    }
    
    # Perguntar se deseja limpar todos os outros logs
    $confirmAllLogs = Read-Host "Deseja limpar todos os outros logs do sistema? (s/n)"
    
    if ($confirmAllLogs -eq 's') {
        Write-Host "Limpando todos os logs do sistema... (isso pode levar algum tempo)" -ForegroundColor Yellow
        
        $otherLogs = $eventLogs | Where-Object { $_.LogName -notin $mainLogs }
        foreach ($log in $otherLogs) {
            try {
                wevtutil cl $log.LogName
            } catch {
                # Ignorar erros silenciosamente
            }
        }
        
        Write-Host "Todos os logs do sistema foram limpos!" -ForegroundColor Green
    } else {
        Write-Host "Apenas os logs principais foram limpos." -ForegroundColor Green
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanWindowsUpdateCache {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Cache de Atualiza√ß√µes do Windows ---" -ForegroundColor Yellow
    Write-Host "Limpa os arquivos tempor√°rios de atualiza√ß√µes do Windows para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "Executando: Verificando cache de atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    
    # Verificar tamanho da pasta SoftwareDistribution antes da limpeza
    $updateCachePath = "$env:SystemRoot\SoftwareDistribution\Download"
    $updateCacheFiles = Get-ChildItem -Path $updateCachePath -Recurse -ErrorAction SilentlyContinue
    $updateCacheSize = ($updateCacheFiles | Measure-Object -Property Length -Sum).Sum / 1MB
    
    Write-Host "O cache de atualiza√ß√µes do Windows est√° ocupando aproximadamente $([math]::Round($updateCacheSize, 2)) MB." -ForegroundColor White
    
    # Parar o servi√ßo Windows Update
    Write-Host "Parando o servi√ßo Windows Update..." -ForegroundColor DarkGray
    Stop-Service -Name wuauserv -Force -ErrorAction SilentlyContinue
    
    # Limpar o cache de atualiza√ß√µes
    Write-Host "Limpando o cache de atualiza√ß√µes do Windows..." -ForegroundColor Yellow
    Remove-Item "$env:SystemRoot\SoftwareDistribution\Download\*" -Recurse -Force -ErrorAction SilentlyContinue
    
    # Iniciar o servi√ßo Windows Update novamente
    Write-Host "Iniciando o servi√ßo Windows Update..." -ForegroundColor DarkGray
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    
    Write-Host "Cache de atualiza√ß√µes do Windows limpo com sucesso!" -ForegroundColor Green
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nBenef√≠cios da limpeza do cache de atualiza√ß√µes:" -ForegroundColor Cyan
    Write-Host "- Libera√ß√£o de espa√ßo em disco" -ForegroundColor DarkGray
    Write-Host "- Resolu√ß√£o de problemas com atualiza√ß√µes do Windows" -ForegroundColor DarkGray
    Write-Host "- Melhoria no desempenho do sistema" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanHibernationFile {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Arquivos de Hiberna√ß√£o ---" -ForegroundColor White
    Write-Host "Gerencia o arquivo de hiberna√ß√£o (hiberfil.sys) para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    # Verificar status atual da hiberna√ß√£o
    Write-Host "Verificando status atual da hiberna√ß√£o..." -ForegroundColor Yellow
    $hibernationStatus = powercfg.exe /availablesleepstates | Select-String -Pattern "Hiberna√ß√£o"
    
    if ($hibernationStatus -match "Hiberna√ß√£o est√° desativada") {
        $currentStatus = "desativada"
    } else {
        $currentStatus = "ativada"
    }
    
    Write-Host "Status atual da hiberna√ß√£o: $currentStatus" -ForegroundColor White
    
    # Verificar tamanho do arquivo de hiberna√ß√£o (se existir)
    $systemDrive = $env:SystemDrive
    $hiberfilPath = "$systemDrive\hiberfil.sys"
    
    if (Test-Path -Path $hiberfilPath -ErrorAction SilentlyContinue) {
        try {
            $hiberfilSize = (Get-Item -Path $hiberfilPath -Force -ErrorAction SilentlyContinue).Length / 1GB
            Write-Host "Tamanho do arquivo de hiberna√ß√£o: $([math]::Round($hiberfilSize, 2)) GB" -ForegroundColor White
        } catch {
            Write-Host "N√£o foi poss√≠vel determinar o tamanho do arquivo de hiberna√ß√£o." -ForegroundColor DarkGray
        }
    } else {
        Write-Host "Arquivo de hiberna√ß√£o n√£o encontrado (j√° est√° desativado)." -ForegroundColor DarkGray
    }
    
    # Perguntar se deseja desativar ou ativar a hiberna√ß√£o
    if ($currentStatus -eq "ativada") {
        $confirmHibernation = Read-Host "Deseja desativar a hiberna√ß√£o para liberar espa√ßo em disco? (s/n)"
        
        if ($confirmHibernation -eq 's') {
            Write-Host "Desativando a hiberna√ß√£o..." -ForegroundColor Yellow
            powercfg.exe /hibernate off
            Write-Host "Hiberna√ß√£o desativada com sucesso! O arquivo hiberfil.sys foi removido." -ForegroundColor Green
        } else {
            Write-Host "Hiberna√ß√£o mantida ativada." -ForegroundColor Green
        }
    } else {
        $confirmHibernation = Read-Host "Deseja ativar a hiberna√ß√£o? (s/n)"
        
        if ($confirmHibernation -eq 's') {
            Write-Host "Ativando a hiberna√ß√£o..." -ForegroundColor Yellow
            powercfg.exe /hibernate on
            Write-Host "Hiberna√ß√£o ativada com sucesso! O arquivo hiberfil.sys foi criado." -ForegroundColor Green
            
            # Verificar novo tamanho do arquivo de hiberna√ß√£o
            if (Test-Path -Path $hiberfilPath -ErrorAction SilentlyContinue) {
                try {
                    $newHiberfilSize = (Get-Item -Path $hiberfilPath -Force -ErrorAction SilentlyContinue).Length / 1GB
                    Write-Host "Tamanho do novo arquivo de hiberna√ß√£o: $([math]::Round($newHiberfilSize, 2)) GB" -ForegroundColor White
                } catch {
                    Write-Host "N√£o foi poss√≠vel determinar o tamanho do novo arquivo de hiberna√ß√£o." -ForegroundColor DarkGray
                }
            }
        } else {
            Write-Host "Hiberna√ß√£o mantida desativada." -ForegroundColor Green
        }
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo foi afetado:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nInforma√ß√µes sobre a hiberna√ß√£o:" -ForegroundColor Cyan
    Write-Host "- O arquivo de hiberna√ß√£o (hiberfil.sys) geralmente ocupa espa√ßo equivalente a 75% da RAM instalada" -ForegroundColor DarkGray
    Write-Host "- Desativar a hiberna√ß√£o libera esse espa√ßo, mas voc√™ n√£o poder√° usar o modo de hiberna√ß√£o" -ForegroundColor DarkGray
    Write-Host "- A hiberna√ß√£o √© √∫til para laptops, pois salva o estado do sistema no disco antes de desligar" -ForegroundColor DarkGray
    Write-Host "- Para desktops, a hiberna√ß√£o geralmente √© menos necess√°ria" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

function Invoke-CleanWinSxS {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Limpeza: Pasta WinSxS ---" -ForegroundColor Magenta
    Write-Host "Limpa componentes n√£o utilizados da pasta WinSxS para liberar espa√ßo em disco." -ForegroundColor DarkGray
    Write-Host ""

    # Armazena o espa√ßo em disco antes da limpeza para compara√ß√£o posterior
    $diskSpaceBefore = Get-DiskSpaceBefore
    
    Write-Host "A pasta WinSxS (Windows Side-by-Side) armazena componentes do sistema e pode ocupar muito espa√ßo." -ForegroundColor White
    Write-Host "Esta limpeza √© segura e usa ferramentas oficiais do Windows para remover componentes n√£o utilizados." -ForegroundColor White
    Write-Host ""
    
    # Verificar tamanho da pasta WinSxS antes da limpeza
    Write-Host "Verificando tamanho da pasta WinSxS (isso pode levar algum tempo)..." -ForegroundColor Yellow
    
    try {
        $winSxSSize = (Get-ChildItem -Path "$env:SystemRoot\WinSxS" -Recurse -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum / 1GB
        Write-Host "Tamanho atual da pasta WinSxS: $([math]::Round($winSxSSize, 2)) GB" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel determinar o tamanho da pasta WinSxS." -ForegroundColor DarkGray
    }
    
    # Perguntar se deseja prosseguir com a limpeza
    $confirmCleanup = Read-Host "Deseja prosseguir com a limpeza da pasta WinSxS? (s/n)"
    
    if ($confirmCleanup -eq 's') {
        Write-Host "Executando limpeza de componentes n√£o utilizados (isso pode levar v√°rios minutos)..." -ForegroundColor Yellow
        
        # Executar limpeza de componentes
        Write-Host "Etapa 1: Limpeza de componentes..." -ForegroundColor DarkGray
        Dism.exe /Online /Cleanup-Image /StartComponentCleanup
        
        # Perguntar se deseja executar limpeza mais agressiva (com reset base)
        $confirmResetBase = Read-Host "Deseja executar uma limpeza mais profunda? (remove a capacidade de desinstalar atualiza√ß√µes) (s/n)"
        
        if ($confirmResetBase -eq 's') {
            Write-Host "Etapa 2: Executando limpeza profunda (isso pode levar muito tempo)..." -ForegroundColor DarkGray
            Dism.exe /Online /Cleanup-Image /StartComponentCleanup /ResetBase
            Write-Host "Limpeza profunda conclu√≠da!" -ForegroundColor Green
        }
        
        Write-Host "Limpeza da pasta WinSxS conclu√≠da com sucesso!" -ForegroundColor Green
        
        # Verificar tamanho da pasta WinSxS ap√≥s a limpeza
        try {
            $newWinSxSSize = (Get-ChildItem -Path "$env:SystemRoot\WinSxS" -Recurse -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum / 1GB
            $savedSpace = $winSxSSize - $newWinSxSSize
            
            Write-Host "Tamanho atual da pasta WinSxS: $([math]::Round($newWinSxSSize, 2)) GB" -ForegroundColor White
            Write-Host "Espa√ßo liberado: $([math]::Round($savedSpace, 2)) GB" -ForegroundColor Green
        } catch {
            Write-Host "N√£o foi poss√≠vel determinar o novo tamanho da pasta WinSxS." -ForegroundColor DarkGray
        }
    } else {
        Write-Host "Limpeza da pasta WinSxS cancelada." -ForegroundColor Yellow
    }
    
    # Mostrar compara√ß√£o de espa√ßo em disco
    Write-Host "`nVamos ver quanto espa√ßo conseguimos recuperar:" -ForegroundColor Cyan
    Show-DiskSpaceComparison -before $diskSpaceBefore
    
    Write-Host "`nInforma√ß√µes sobre a pasta WinSxS:" -ForegroundColor Cyan
    Write-Host "- A pasta WinSxS armazena componentes do sistema Windows e atualiza√ß√µes" -ForegroundColor DarkGray
    Write-Host "- N√£o √© recomendado excluir esta pasta manualmente" -ForegroundColor DarkGray
    Write-Host "- A limpeza realizada √© segura e usa ferramentas oficiais do Windows" -ForegroundColor DarkGray
    Write-Host "- Ap√≥s a limpeza profunda, n√£o ser√° poss√≠vel desinstalar algumas atualiza√ß√µes" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Limpeza..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - REDE (Expandidas) ---
function Invoke-NetworkFlushDns {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Limpar Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-NetworkChangeDns {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Mudar Servidor DNS ---" -ForegroundColor Cyan
    Write-Host "Permite definir servidores DNS personalizados para suas conex√µes de rede." -ForegroundColor DarkGray
    Write-Host ""

    # Listar adaptadores de rede ativos
    Write-Host "Listando adaptadores de rede ativos..." -ForegroundColor Yellow
    $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" }
    
    if ($networkAdapters.Count -eq 0) {
        Write-Host "Nenhum adaptador de rede ativo encontrado." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    Write-Host "Adaptadores de rede ativos:" -ForegroundColor White
    $index = 1
    foreach ($adapter in $networkAdapters) {
        Write-Host "[$index] $($adapter.Name) - $($adapter.InterfaceDescription)" -ForegroundColor White
        $index++
    }
    Write-Host ""
    
    # Selecionar adaptador de rede
    $adapterChoice = Read-Host "Selecione o n√∫mero do adaptador que deseja configurar (ou 0 para voltar)"
    
    if ($adapterChoice -eq "0" -or $adapterChoice -eq "") {
        Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    $adapterIndex = [int]$adapterChoice - 1
    if ($adapterIndex -lt 0 -or $adapterIndex -ge $networkAdapters.Count) {
        Write-Host "Sele√ß√£o inv√°lida." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    $selectedAdapter = $networkAdapters[$adapterIndex]
    
    # Mostrar configura√ß√£o DNS atual
    Write-Host "Configura√ß√£o DNS atual para $($selectedAdapter.Name):" -ForegroundColor Yellow
    $currentDns = Get-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -AddressFamily IPv4 | Select-Object -ExpandProperty ServerAddresses
    
    if ($currentDns.Count -eq 0) {
        Write-Host "Nenhum servidor DNS configurado manualmente (usando DHCP)." -ForegroundColor DarkGray
    } else {
        foreach ($dns in $currentDns) {
            Write-Host $dns -ForegroundColor White
        }
    }
    Write-Host ""
    
    # Op√ß√µes de DNS
    Write-Host "Op√ß√µes de DNS:" -ForegroundColor Yellow
    Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
    Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
    Write-Host "[3] OpenDNS (208.67.222.222, 208.67.220.220)" -ForegroundColor White
    Write-Host "[4] Quad9 (9.9.9.9, 149.112.112.112)" -ForegroundColor White
    Write-Host "[5] AdGuard DNS (94.140.14.14, 94.140.15.15)" -ForegroundColor White
    Write-Host "[6] Inserir DNS personalizado" -ForegroundColor White
    Write-Host "[7] Usar DNS autom√°tico (DHCP)" -ForegroundColor White
    Write-Host "[0] Cancelar" -ForegroundColor White
    Write-Host ""
    
    $dnsChoice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($dnsChoice) {
        "1" {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            $dnsName = "Google DNS"
        }
        "2" {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            $dnsName = "Cloudflare DNS"
        }
        "3" {
            $primaryDns = "208.67.222.222"
            $secondaryDns = "208.67.220.220"
            $dnsName = "OpenDNS"
        }
        "4" {
            $primaryDns = "9.9.9.9"
            $secondaryDns = "149.112.112.112"
            $dnsName = "Quad9"
        }
        "5" {
            $primaryDns = "94.140.14.14"
            $secondaryDns = "94.140.15.15"
            $dnsName = "AdGuard DNS"
        }
        "6" {
            $primaryDns = Read-Host "Digite o endere√ßo do DNS prim√°rio"
            $secondaryDns = Read-Host "Digite o endere√ßo do DNS secund√°rio (ou deixe em branco)"
            $dnsName = "DNS Personalizado"
        }
        "7" {
            Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ResetServerAddresses
            Write-Host "Configura√ß√£o de DNS definida para autom√°tica (DHCP)." -ForegroundColor Green
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
        "0" {
            Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
        default {
            Write-Host "Op√ß√£o inv√°lida." -ForegroundColor Red
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
    }
    
    # Aplicar configura√ß√£o de DNS
    if ($secondaryDns -eq "") {
        Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ServerAddresses $primaryDns
    } else {
        Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ServerAddresses $primaryDns, $secondaryDns
    }
    
    Write-Host "Configura√ß√£o de DNS alterada para $dnsName." -ForegroundColor Green
    Write-Host "DNS Prim√°rio: $primaryDns" -ForegroundColor White
    if ($secondaryDns -ne "") {
        Write-Host "DNS Secund√°rio: $secondaryDns" -ForegroundColor White
    }
    
    # Limpar cache DNS ap√≥s a mudan√ßa
    Write-Host "Limpando cache DNS para aplicar as altera√ß√µes..." -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo." -ForegroundColor Green
    
    Write-Host "`nBenef√≠cios de usar servidores DNS alternativos:" -ForegroundColor Cyan
    Write-Host "- Maior velocidade de resolu√ß√£o de nomes" -ForegroundColor DarkGray
    Write-Host "- Melhor confiabilidade e disponibilidade" -ForegroundColor DarkGray
    Write-Host "- Alguns servidores oferecem prote√ß√£o adicional contra malware e phishing" -ForegroundColor DarkGray
    Write-Host "- Possibilidade de contornar bloqueios de conte√∫do baseados em DNS" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-NetworkReset {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Resetar Configura√ß√µes de Rede ---" -ForegroundColor White
    Write-Host "Reinicia os componentes de rede. Use como √∫ltimo recurso para solucionar problemas de conex√£o." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "!!! ATEN√á√ÉO: ESTE COMANDO VAI REINICIAR SUAS CONFIGURA√á√ïES DE REDE !!!" -ForegroundColor Red
    Write-Host "Sua conex√£o ser√° interrompida temporariamente e todas as configura√ß√µes de rede personalizadas ser√£o redefinidas." -ForegroundColor Yellow
    Write-Host "Isso inclui adaptadores de rede, configura√ß√µes de DNS, configura√ß√µes de proxy, etc." -ForegroundColor Yellow
    Write-Host ""
    
    Write-Host "Esta opera√ß√£o pode ajudar a resolver os seguintes problemas:" -ForegroundColor Cyan
    Write-Host "- Conex√µes de rede inst√°veis ou intermitentes" -ForegroundColor DarkGray
    Write-Host "- Problemas de DNS ou resolu√ß√£o de nomes" -ForegroundColor DarkGray
    Write-Host "- Problemas de conectividade ap√≥s instala√ß√£o de software ou atualiza√ß√µes" -ForegroundColor DarkGray
    Write-Host "- Erros de rede persistentes que n√£o s√£o resolvidos por outros m√©todos" -ForegroundColor DarkGray
    Write-Host ""
    
    $confirm = Read-Host "Tem certeza que deseja resetar as configura√ß√µes de rede? (digite 'sim' para confirmar)"
    
    if ($confirm -eq 'sim') {
        Write-Host "Iniciando reset de configura√ß√µes de rede..." -ForegroundColor Yellow
        
        # Etapa 1: Resetar pilha TCP/IP
        Write-Host "Etapa 1: Resetando pilha TCP/IP..." -ForegroundColor DarkGray
        netsh int ip reset
        
        # Etapa 2: Resetar cat√°logo Winsock
        Write-Host "Etapa 2: Resetando cat√°logo Winsock..." -ForegroundColor DarkGray
        netsh winsock reset
        
        # Etapa 3: Limpar cache DNS
        Write-Host "Etapa 3: Limpando cache DNS..." -ForegroundColor DarkGray
        ipconfig /flushdns
        
        # Etapa 4: Renovar configura√ß√µes DHCP
        Write-Host "Etapa 4: Renovando configura√ß√µes DHCP..." -ForegroundColor DarkGray
        ipconfig /release
        ipconfig /renew
        
        # Etapa 5: Reiniciar adaptadores de rede
        Write-Host "Etapa 5: Reiniciando adaptadores de rede..." -ForegroundColor DarkGray
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        
        Write-Host "Reset de configura√ß√µes de rede conclu√≠do!" -ForegroundColor Green
        Write-Host "Recomenda-se reiniciar o computador para aplicar todas as altera√ß√µes." -ForegroundColor Yellow
        
        $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (s/n)"
        if ($confirmRestart -eq 's') {
            Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
            Restart-Computer -Force
        } else {
            Write-Host "Rein√≠cio cancelado. Algumas altera√ß√µes podem n√£o ter efeito at√© que o computador seja reiniciado." -ForegroundColor Yellow
        }
    } else {
        Write-Host "Reset de configura√ß√µes de rede cancelado." -ForegroundColor Green
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-OptimizeTcpIp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Otimizar Configura√ß√µes TCP/IP ---" -ForegroundColor Green
    Write-Host "Ajusta configura√ß√µes avan√ßadas do TCP/IP para melhorar o desempenho da conex√£o." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o otimiza v√°rios par√¢metros TCP/IP para melhorar a velocidade e estabilidade da conex√£o." -ForegroundColor White
    Write-Host "As otimiza√ß√µes s√£o seguras e podem ser revertidas se necess√°rio." -ForegroundColor White
    Write-Host ""
    
    Write-Host "Configura√ß√µes atuais:" -ForegroundColor Yellow
    
    # Mostrar configura√ß√µes atuais
    Write-Host "Auto-Tuning Level:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Auto-Tuning Level"
    
    Write-Host "Congestion Provider:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Congestion Control Provider"
    
    Write-Host "ECN Capability:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "ECN Capability"
    
    Write-Host "Receive-Side Scaling (RSS):" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Receive-Side Scaling State"
    
    Write-Host ""
    $confirm = Read-Host "Deseja aplicar otimiza√ß√µes TCP/IP recomendadas? (s/n)"
    
    if ($confirm -eq 's') {
        Write-Host "Aplicando otimiza√ß√µes TCP/IP..." -ForegroundColor Yellow
        
        # Otimiza√ß√£o 1: Habilitar TCP Window Auto-Tuning
        Write-Host "Configurando TCP Auto-Tuning para 'normal'..." -ForegroundColor DarkGray
        netsh int tcp set global autotuninglevel=normal
        
        # Otimiza√ß√£o 2: Habilitar Receive-Side Scaling (RSS)
        Write-Host "Habilitando Receive-Side Scaling (RSS)..." -ForegroundColor DarkGray
        netsh int tcp set global rss=enabled
        
        # Otimiza√ß√£o 3: Configurar Congestion Provider para CTCP
        Write-Host "Configurando Congestion Provider para 'ctcp'..." -ForegroundColor DarkGray
        netsh int tcp set global congestionprovider=ctcp
        
        # Otimiza√ß√£o 4: Habilitar ECN Capability
        Write-Host "Habilitando ECN Capability..." -ForegroundColor DarkGray
        netsh int tcp set global ecncapability=enabled
        
        # Otimiza√ß√£o 5: Configurar NetDMA (se dispon√≠vel)
        Write-Host "Tentando configurar NetDMA..." -ForegroundColor DarkGray
        netsh int tcp set global netdma=enabled
        
        # Otimiza√ß√£o 6: Configurar tamanho de buffer TCP
        Write-Host "Configurando tamanho de buffer TCP..." -ForegroundColor DarkGray
        netsh int tcp set global chimney=enabled
        
        # Otimiza√ß√£o 7: Configurar QoS
        Write-Host "Configurando QoS..." -ForegroundColor DarkGray
        netsh int tcp set global timestamps=disabled
        
        Write-Host "Otimiza√ß√µes TCP/IP aplicadas com sucesso!" -ForegroundColor Green
        
        Write-Host "`nNovas configura√ß√µes:" -ForegroundColor Yellow
        
        # Mostrar novas configura√ß√µes
        Write-Host "Auto-Tuning Level:" -ForegroundColor DarkGray
        netsh int tcp show global | Select-String "Auto-Tuning Level"
        
        Write-Host "Congestion Provider:" -ForegroundColor DarkGray
        netsh int tcp show global | Select-String "Congestion Control Provider"
        
        Write-Host "ECN Capability:" -ForegroundColor DarkGray
        netsh int tcp show global | Select-String "ECN Capability"
        
        Write-Host "Receive-Side Scaling (RSS):" -ForegroundColor DarkGray
        netsh int tcp show global | Select-String "Receive-Side Scaling State"
        
        Write-Host "`nBenef√≠cios das otimiza√ß√µes TCP/IP:" -ForegroundColor Cyan
        Write-Host "- Melhor aproveitamento da largura de banda dispon√≠vel" -ForegroundColor DarkGray
        Write-Host "- Redu√ß√£o da lat√™ncia em conex√µes de internet" -ForegroundColor DarkGray
        Write-Host "- Melhor desempenho em downloads e uploads" -ForegroundColor DarkGray
        Write-Host "- Conex√µes mais est√°veis em redes congestionadas" -ForegroundColor DarkGray
        
        Write-Host "`nNota: Algumas altera√ß√µes podem requerer reinicializa√ß√£o para ter efeito completo." -ForegroundColor Yellow
        $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (s/n)"
        
        if ($confirmRestart -eq 's') {
            Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
            Restart-Computer -Force
        }
    } else {
        Write-Host "Otimiza√ß√µes TCP/IP canceladas." -ForegroundColor Yellow
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-CheckNetworkSpeed {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Verificar Velocidade da Conex√£o ---" -ForegroundColor Magenta
    Write-Host "Realiza testes para verificar a velocidade e qualidade da sua conex√£o com a internet." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o realiza testes b√°sicos para avaliar a velocidade e qualidade da sua conex√£o." -ForegroundColor White
    Write-Host "Nota: Para testes de velocidade mais precisos, recomendamos usar sites especializados como speedtest.net" -ForegroundColor White
    Write-Host ""
    
    # Teste 1: Verificar conectividade b√°sica
    Write-Host "Teste 1: Verificando conectividade b√°sica com a internet..." -ForegroundColor Yellow
    $pingGoogle = Test-Connection -ComputerName google.com -Count 4 -ErrorAction SilentlyContinue
    
    if ($pingGoogle) {
        $avgLatency = ($pingGoogle | Measure-Object -Property ResponseTime -Average).Average
        $maxLatency = ($pingGoogle | Measure-Object -Property ResponseTime -Maximum).Maximum
        $minLatency = ($pingGoogle | Measure-Object -Property ResponseTime -Minimum).Minimum
        
        Write-Host "Conectividade: OK" -ForegroundColor Green
        Write-Host "Lat√™ncia m√©dia: $avgLatency ms" -ForegroundColor $(if ($avgLatency -lt 50) { "Green" } elseif ($avgLatency -lt 100) { "Yellow" } else { "Red" })
        Write-Host "Lat√™ncia m√≠nima: $minLatency ms" -ForegroundColor Green
        Write-Host "Lat√™ncia m√°xima: $maxLatency ms" -ForegroundColor $(if ($maxLatency -lt 100) { "Green" } elseif ($maxLatency -lt 200) { "Yellow" } else { "Red" })
        
        # Avalia√ß√£o da qualidade da conex√£o
        if ($avgLatency -lt 30) {
            $qualidade = "Excelente"
            $cor = "Green"
        } elseif ($avgLatency -lt 60) {
            $qualidade = "Boa"
            $cor = "Green"
        } elseif ($avgLatency -lt 100) {
            $qualidade = "Razo√°vel"
            $cor = "Yellow"
        } else {
            $qualidade = "Ruim"
            $cor = "Red"
        }
        
        Write-Host "Qualidade da conex√£o: $qualidade" -ForegroundColor $cor
    } else {
        Write-Host "N√£o foi poss√≠vel conectar √† internet. Verifique sua conex√£o." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    Write-Host ""
    
    # Teste 2: Verificar resolu√ß√£o DNS
    Write-Host "Teste 2: Verificando velocidade de resolu√ß√£o DNS..." -ForegroundColor Yellow
    $domains = @("google.com", "microsoft.com", "amazon.com", "facebook.com", "youtube.com")
    $dnsResults = @()
    
    foreach ($domain in $domains) {
        $startTime = Get-Date
        try {
            $null = Resolve-DnsName -Name $domain -ErrorAction SilentlyContinue
            $endTime = Get-Date
            $timeSpan = New-TimeSpan -Start $startTime -End $endTime
            $dnsResults += [PSCustomObject]@{
                Domain = $domain
                Time = $timeSpan.TotalMilliseconds
                Status = "OK"
            }
        } catch {
            $dnsResults += [PSCustomObject]@{
                Domain = $domain
                Time = 0
                Status = "Falha"
            }
        }
    }
    
    $dnsResults | Format-Table -AutoSize
    
    $avgDnsTime = ($dnsResults | Where-Object { $_.Status -eq "OK" } | Measure-Object -Property Time -Average).Average
    Write-Host "Tempo m√©dio de resolu√ß√£o DNS: $([math]::Round($avgDnsTime, 2)) ms" -ForegroundColor $(if ($avgDnsTime -lt 50) { "Green" } elseif ($avgDnsTime -lt 100) { "Yellow" } else { "Red" })
    
    Write-Host ""
    
    # Teste 3: Verificar MTU
    Write-Host "Teste 3: Verificando MTU (Maximum Transmission Unit)..." -ForegroundColor Yellow
    
    $activeAdapter = Get-NetAdapter | Where-Object { $_.Status -eq "Up" } | Select-Object -First 1
    if ($activeAdapter) {
        $mtu = Get-NetIPInterface -InterfaceIndex $activeAdapter.ifIndex -AddressFamily IPv4 | Select-Object -ExpandProperty NlMtu
        Write-Host "MTU atual: $mtu bytes" -ForegroundColor White
        
        if ($mtu -eq 1500) {
            Write-Host "MTU est√° no valor padr√£o (1500), que √© ideal para a maioria das conex√µes." -ForegroundColor Green
        } elseif ($mtu -lt 1500) {
            Write-Host "MTU est√° abaixo do valor padr√£o. Isso pode afetar o desempenho em algumas situa√ß√µes." -ForegroundColor Yellow
        } else {
            Write-Host "MTU est√° acima do valor padr√£o. Isso pode causar fragmenta√ß√£o de pacotes em algumas redes." -ForegroundColor Yellow
        }
    } else {
        Write-Host "N√£o foi poss√≠vel determinar o MTU. Nenhum adaptador de rede ativo encontrado." -ForegroundColor Red
    }
    
    Write-Host ""
    
    # Teste 4: Verificar perda de pacotes
    Write-Host "Teste 4: Verificando perda de pacotes..." -ForegroundColor Yellow
    $packetLossTest = Test-Connection -ComputerName google.com -Count 50 -ErrorAction SilentlyContinue
    
    if ($packetLossTest) {
        $packetsSent = 50
        $packetsReceived = ($packetLossTest | Measure-Object).Count
        $packetsLost = $packetsSent - $packetsReceived
        $packetLossPercentage = ($packetsLost / $packetsSent) * 100
        
        Write-Host "Pacotes enviados: $packetsSent" -ForegroundColor White
        Write-Host "Pacotes recebidos: $packetsReceived" -ForegroundColor White
        Write-Host "Pacotes perdidos: $packetsLost" -ForegroundColor $(if ($packetsLost -eq 0) { "Green" } elseif ($packetsLost -lt 5) { "Yellow" } else { "Red" })
        Write-Host "Percentual de perda: $([math]::Round($packetLossPercentage, 2))%" -ForegroundColor $(if ($packetLossPercentage -eq 0) { "Green" } elseif ($packetLossPercentage -lt 10) { "Yellow" } else { "Red" })
        
        # Avalia√ß√£o da qualidade da conex√£o baseada na perda de pacotes
        if ($packetLossPercentage -eq 0) {
            Write-Host "Qualidade da conex√£o (perda de pacotes): Excelente" -ForegroundColor Green
        } elseif ($packetLossPercentage -lt 2) {
            Write-Host "Qualidade da conex√£o (perda de pacotes): Boa" -ForegroundColor Green
        } elseif ($packetLossPercentage -lt 5) {
            Write-Host "Qualidade da conex√£o (perda de pacotes): Razo√°vel" -ForegroundColor Yellow
        } else {
            Write-Host "Qualidade da conex√£o (perda de pacotes): Ruim" -ForegroundColor Red
        }
    } else {
        Write-Host "N√£o foi poss√≠vel realizar o teste de perda de pacotes." -ForegroundColor Red
    }
    
    Write-Host ""
    
    # Resumo e recomenda√ß√µes
    Write-Host "=== Resumo da An√°lise de Rede ===" -ForegroundColor Cyan
    
    # Recomenda√ß√µes baseadas nos resultados
    Write-Host "Recomenda√ß√µes:" -ForegroundColor Yellow
    
    if ($avgLatency -gt 100) {
        Write-Host "- Sua lat√™ncia est√° alta. Considere verificar outros dispositivos na rede ou contatar seu provedor." -ForegroundColor Yellow
    }
    
    if ($avgDnsTime -gt 100) {
        Write-Host "- A resolu√ß√£o DNS est√° lenta. Considere mudar para servidores DNS mais r√°pidos como Google (8.8.8.8) ou Cloudflare (1.1.1.1)." -ForegroundColor Yellow
    }
    
    if ($packetLossPercentage -gt 2) {
        Write-Host "- H√° perda significativa de pacotes. Verifique sua conex√£o f√≠sica ou contate seu provedor." -ForegroundColor Yellow
    }
    
    if ($mtu -ne 1500 -and $mtu -ne 0) {
        Write-Host "- Seu MTU n√£o est√° no valor padr√£o. Considere ajust√°-lo para 1500 para melhor desempenho." -ForegroundColor Yellow
    }
    
    if ($avgLatency -le 100 -and $avgDnsTime -le 100 -and $packetLossPercentage -le 2) {
        Write-Host "- Sua conex√£o parece estar em boas condi√ß√µes! N√£o h√° problemas significativos detectados." -ForegroundColor Green
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-ConfigureQoS {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Configurar QoS (Qualidade de Servi√ßo) ---" -ForegroundColor Gray
    Write-Host "Configura prioridades de tr√°fego de rede para melhorar o desempenho de aplica√ß√µes espec√≠ficas." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "O QoS (Quality of Service) permite priorizar certos tipos de tr√°fego de rede sobre outros." -ForegroundColor White
    Write-Host "Isso √© √∫til para garantir que aplica√ß√µes importantes como jogos, chamadas de v√≠deo ou streaming" -ForegroundColor White
    Write-Host "tenham prioridade sobre downloads ou atualiza√ß√µes em segundo plano." -ForegroundColor White
    Write-Host ""
    
    Write-Host "Op√ß√µes de configura√ß√£o de QoS:" -ForegroundColor Yellow
    Write-Host "[1] Configurar QoS para Jogos (prioriza tr√°fego de jogos)" -ForegroundColor White
    Write-Host "[2] Configurar QoS para Videoconfer√™ncia (prioriza Zoom, Teams, etc.)" -ForegroundColor White
    Write-Host "[3] Configurar QoS para Streaming (prioriza Netflix, YouTube, etc.)" -ForegroundColor White
    Write-Host "[4] Configurar QoS Personalizado" -ForegroundColor White
    Write-Host "[5] Desativar QoS" -ForegroundColor White
    Write-Host "[0] Voltar" -ForegroundColor White
    Write-Host ""
    
    $qosChoice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($qosChoice) {
        "1" {
            Write-Host "Configurando QoS para Jogos..." -ForegroundColor Yellow
            
            # Criar pol√≠tica de QoS para jogos
            Write-Host "Criando pol√≠tica de QoS para jogos..." -ForegroundColor DarkGray
            
            # Verificar se o servi√ßo QoS est√° em execu√ß√£o
            $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            if ($qosService -and $qosService.Status -ne "Running") {
                Write-Host "Iniciando servi√ßo QoS RSVP..." -ForegroundColor DarkGray
                Start-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            }
            
            # Configurar QoS para jogos usando netsh
            netsh advfirewall firewall add rule name="QoS-Games" dir=out action=allow protocol=UDP remoteport=3074,3478,3479,3480 enable=yes
            
            # Configurar prioridade para jogos
            if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS")) {
                New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Force | Out-Null
            }
            
            # Adicionar pol√≠tica para jogos
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Application Name" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Protocol" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Remote Port" -Value "3074,3478-3480" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "DSCP Value" -Value "46" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Throttle Rate" -Value "-1" -Type String
            
            Write-Host "QoS para Jogos configurado com sucesso!" -ForegroundColor Green
            Write-Host "Os jogos online agora ter√£o prioridade sobre outros tipos de tr√°fego." -ForegroundColor Green
        }
        "2" {
            Write-Host "Configurando QoS para Videoconfer√™ncia..." -ForegroundColor Yellow
            
            # Criar pol√≠tica de QoS para videoconfer√™ncia
            Write-Host "Criando pol√≠tica de QoS para videoconfer√™ncia..." -ForegroundColor DarkGray
            
            # Verificar se o servi√ßo QoS est√° em execu√ß√£o
            $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            if ($qosService -and $qosService.Status -ne "Running") {
                Write-Host "Iniciando servi√ßo QoS RSVP..." -ForegroundColor DarkGray
                Start-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            }
            
            # Configurar QoS para videoconfer√™ncia usando netsh
            netsh advfirewall firewall add rule name="QoS-VideoConference" dir=out action=allow protocol=UDP remoteport=3478-3479,8801-8810 enable=yes
            
            # Configurar prioridade para videoconfer√™ncia
            if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS")) {
                New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Force | Out-Null
            }
            
            # Adicionar pol√≠tica para Zoom
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Application Name" -Value "Zoom.exe" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Protocol" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Remote Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "DSCP Value" -Value "46" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Throttle Rate" -Value "-1" -Type String
            
            # Adicionar pol√≠tica para Teams
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Application Name" -Value "Teams.exe" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Protocol" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Remote Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "DSCP Value" -Value "46" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Throttle Rate" -Value "-1" -Type String
            
            Write-Host "QoS para Videoconfer√™ncia configurado com sucesso!" -ForegroundColor Green
            Write-Host "Aplicativos como Zoom e Teams agora ter√£o prioridade sobre outros tipos de tr√°fego." -ForegroundColor Green
        }
        "3" {
            Write-Host "Configurando QoS para Streaming..." -ForegroundColor Yellow
            
            # Criar pol√≠tica de QoS para streaming
            Write-Host "Criando pol√≠tica de QoS para streaming..." -ForegroundColor DarkGray
            
            # Verificar se o servi√ßo QoS est√° em execu√ß√£o
            $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            if ($qosService -and $qosService.Status -ne "Running") {
                Write-Host "Iniciando servi√ßo QoS RSVP..." -ForegroundColor DarkGray
                Start-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            }
            
            # Configurar QoS para streaming usando netsh
            netsh advfirewall firewall add rule name="QoS-Streaming" dir=out action=allow protocol=TCP remoteport=80,443 enable=yes
            
            # Configurar prioridade para streaming
            if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS")) {
                New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Force | Out-Null
            }
            
            # Adicionar pol√≠tica para navegadores (streaming)
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Application Name" -Value "*.exe" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Protocol" -Value "TCP" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Remote Port" -Value "80,443" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "DSCP Value" -Value "34" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Streaming" -Name "Throttle Rate" -Value "-1" -Type String
            
            Write-Host "QoS para Streaming configurado com sucesso!" -ForegroundColor Green
            Write-Host "Servi√ßos de streaming como Netflix e YouTube agora ter√£o prioridade sobre outros tipos de tr√°fego." -ForegroundColor Green
        }
        "4" {
            Write-Host "Configurando QoS Personalizado..." -ForegroundColor Yellow
            
            # Solicitar informa√ß√µes para QoS personalizado
            $appName = Read-Host "Digite o nome do aplicativo (ex: chrome.exe, ou * para todos)"
            $protocol = Read-Host "Digite o protocolo (TCP, UDP, ou * para ambos)"
            $remotePorts = Read-Host "Digite as portas remotas (ex: 80,443, ou * para todas)"
            $priority = Read-Host "Digite o valor de prioridade DSCP (0-63, recomendado: 46 para alta prioridade)"
            
            # Verificar se o servi√ßo QoS est√° em execu√ß√£o
            $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            if ($qosService -and $qosService.Status -ne "Running") {
                Write-Host "Iniciando servi√ßo QoS RSVP..." -ForegroundColor DarkGray
                Start-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            }
            
            # Configurar QoS personalizado
            if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS")) {
                New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Force | Out-Null
            }
            
            # Adicionar pol√≠tica personalizada
            $policyName = "CustomQoS_" + (Get-Random)
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Application Name" -Value $appName -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Protocol" -Value $protocol -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Remote Port" -Value $remotePorts -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "DSCP Value" -Value $priority -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\$policyName" -Name "Throttle Rate" -Value "-1" -Type String
            
            Write-Host "QoS Personalizado configurado com sucesso!" -ForegroundColor Green
            Write-Host "A pol√≠tica de QoS personalizada foi criada com o nome: $policyName" -ForegroundColor Green
        }
        "5" {
            Write-Host "Desativando QoS..." -ForegroundColor Yellow
            
            # Remover pol√≠ticas de QoS
            if (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS") {
                Remove-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Recurse -Force
                Write-Host "Pol√≠ticas de QoS removidas." -ForegroundColor Green
            }
            
            # Remover regras de firewall relacionadas a QoS
            netsh advfirewall firewall delete rule name="QoS-Games"
            netsh advfirewall firewall delete rule name="QoS-VideoConference"
            netsh advfirewall firewall delete rule name="QoS-Streaming"
            
            # Parar servi√ßo QoS
            $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            if ($qosService) {
                Stop-Service -Name "QoS RSVP" -Force -ErrorAction SilentlyContinue
                Set-Service -Name "QoS RSVP" -Startup Disabled -ErrorAction SilentlyContinue
                Write-Host "Servi√ßo QoS RSVP parado e desabilitado." -ForegroundColor Green
            }
            
            Write-Host "QoS desativado com sucesso!" -ForegroundColor Green
        }
        "0" {
            Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
        }
        default {
            Write-Host "Op√ß√£o inv√°lida." -ForegroundColor Red
        }
    }
    
    if ($qosChoice -ne "0") {
        Write-Host "`nNota: Algumas altera√ß√µes de QoS podem requerer reinicializa√ß√£o para ter efeito completo." -ForegroundColor Yellow
        $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (s/n)"
        
        if ($confirmRestart -eq 's') {
            Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
            Restart-Computer -Force
        }
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-DisableIPv6 {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Desativar IPv6 ---" -ForegroundColor Yellow
    Write-Host "Desativa o protocolo IPv6 em adaptadores de rede para resolver problemas de conectividade." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "O IPv6 √© o protocolo de internet mais recente, mas em algumas redes pode causar problemas de conectividade." -ForegroundColor White
    Write-Host "Desativar o IPv6 pode resolver problemas em redes que n√£o o suportam adequadamente." -ForegroundColor White
    Write-Host "Nota: Desativar o IPv6 n√£o √© recomendado a menos que voc√™ esteja enfrentando problemas espec√≠ficos." -ForegroundColor Yellow
    Write-Host ""
    
    # Verificar status atual do IPv6
    Write-Host "Verificando status atual do IPv6..." -ForegroundColor Yellow
    
    $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" }
    
    if ($networkAdapters.Count -eq 0) {
        Write-Host "Nenhum adaptador de rede ativo encontrado." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    Write-Host "Status do IPv6 nos adaptadores de rede ativos:" -ForegroundColor White
    
    foreach ($adapter in $networkAdapters) {
        $ipv6Status = Get-NetAdapterBinding -InterfaceAlias $adapter.Name -ComponentID "ms_tcpip6"
        $status = if ($ipv6Status.Enabled) { "Ativado" } else { "Desativado" }
        $statusColor = if ($ipv6Status.Enabled) { "Green" } else { "Yellow" }
        
        Write-Host "$($adapter.Name): $status" -ForegroundColor $statusColor
    }
    
    Write-Host ""
    Write-Host "Op√ß√µes:" -ForegroundColor Yellow
    Write-Host "[1] Desativar IPv6 em todos os adaptadores" -ForegroundColor White
    Write-Host "[2] Ativar IPv6 em todos os adaptadores" -ForegroundColor White
    Write-Host "[3] Gerenciar IPv6 em adaptadores espec√≠ficos" -ForegroundColor White
    Write-Host "[0] Voltar" -ForegroundColor White
    Write-Host ""
    
    $ipv6Choice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($ipv6Choice) {
        "1" {
            Write-Host "Desativando IPv6 em todos os adaptadores de rede..." -ForegroundColor Yellow
            
            foreach ($adapter in $networkAdapters) {
                Disable-NetAdapterBinding -InterfaceAlias $adapter.Name -ComponentID "ms_tcpip6"
                Write-Host "IPv6 desativado em $($adapter.Name)" -ForegroundColor Green
            }
            
            # Desativar IPv6 globalmente no registro
            Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters" -Name "DisabledComponents" -Value 0xffffffff -Type DWord
            
            Write-Host "IPv6 desativado em todos os adaptadores de rede!" -ForegroundColor Green
            Write-Host "Nota: Algumas altera√ß√µes podem requerer reinicializa√ß√£o para ter efeito completo." -ForegroundColor Yellow
        }
        "2" {
            Write-Host "Ativando IPv6 em todos os adaptadores de rede..." -ForegroundColor Yellow
            
            foreach ($adapter in $networkAdapters) {
                Enable-NetAdapterBinding -InterfaceAlias $adapter.Name -ComponentID "ms_tcpip6"
                Write-Host "IPv6 ativado em $($adapter.Name)" -ForegroundColor Green
            }
            
            # Ativar IPv6 globalmente no registro
            Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters" -Name "DisabledComponents" -Value 0x0 -Type DWord
            
            Write-Host "IPv6 ativado em todos os adaptadores de rede!" -ForegroundColor Green
            Write-Host "Nota: Algumas altera√ß√µes podem requerer reinicializa√ß√£o para ter efeito completo." -ForegroundColor Yellow
        }
        "3" {
            Write-Host "Gerenciando IPv6 em adaptadores espec√≠ficos..." -ForegroundColor Yellow
            
            $index = 1
            $adapterList = @()
            
            foreach ($adapter in $networkAdapters) {
                $ipv6Status = Get-NetAdapterBinding -InterfaceAlias $adapter.Name -ComponentID "ms_tcpip6"
                $status = if ($ipv6Status.Enabled) { "Ativado" } else { "Desativado" }
                $statusColor = if ($ipv6Status.Enabled) { "Green" } else { "Yellow" }
                
                Write-Host "[$index] $($adapter.Name): $status" -ForegroundColor $statusColor
                $adapterList += $adapter
                $index++
            }
            
            Write-Host "[0] Voltar" -ForegroundColor White
            Write-Host ""
            
            $adapterChoice = Read-Host "Selecione o n√∫mero do adaptador que deseja gerenciar (ou 0 para voltar)"
            
            if ($adapterChoice -eq "0" -or $adapterChoice -eq "") {
                Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
                break
            }
            
            $adapterIndex = [int]$adapterChoice - 1
            if ($adapterIndex -lt 0 -or $adapterIndex -ge $adapterList.Count) {
                Write-Host "Sele√ß√£o inv√°lida." -ForegroundColor Red
                break
            }
            
            $selectedAdapter = $adapterList[$adapterIndex]
            $ipv6Status = Get-NetAdapterBinding -InterfaceAlias $selectedAdapter.Name -ComponentID "ms_tcpip6"
            
            if ($ipv6Status.Enabled) {
                Write-Host "Desativando IPv6 em $($selectedAdapter.Name)..." -ForegroundColor Yellow
                Disable-NetAdapterBinding -InterfaceAlias $selectedAdapter.Name -ComponentID "ms_tcpip6"
                Write-Host "IPv6 desativado em $($selectedAdapter.Name)" -ForegroundColor Green
            } else {
                Write-Host "Ativando IPv6 em $($selectedAdapter.Name)..." -ForegroundColor Yellow
                Enable-NetAdapterBinding -InterfaceAlias $selectedAdapter.Name -ComponentID "ms_tcpip6"
                Write-Host "IPv6 ativado em $($selectedAdapter.Name)" -ForegroundColor Green
            }
        }
        "0" {
            Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
        }
        default {
            Write-Host "Op√ß√£o inv√°lida." -ForegroundColor Red
        }
    }
    
    if ($ipv6Choice -eq "1" -or $ipv6Choice -eq "2") {
        Write-Host "`nNota: Algumas altera√ß√µes de IPv6 podem requerer reinicializa√ß√£o para ter efeito completo." -ForegroundColor Yellow
        $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (s/n)"
        
        if ($confirmRestart -eq 's') {
            Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
            Restart-Computer -Force
        }
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-OptimizeGamingLatency {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Otimizar Lat√™ncia de Rede para Jogos ---" -ForegroundColor Cyan
    Write-Host "Configura par√¢metros de rede para reduzir a lat√™ncia em jogos online." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o otimiza v√°rios par√¢metros de rede para reduzir a lat√™ncia em jogos online." -ForegroundColor White
    Write-Host "As otimiza√ß√µes s√£o seguras e podem ser revertidas se necess√°rio." -ForegroundColor White
    Write-Host ""
    
    # Verificar lat√™ncia atual
    Write-Host "Verificando lat√™ncia atual para servidores de jogos populares..." -ForegroundColor Yellow
    
    $gameServers = @(
        @{Name="Google (Stadia)"; Address="stadia.google.com"},
        @{Name="EA Games"; Address="ea.com"},
        @{Name="Steam"; Address="steamcommunity.com"},
        @{Name="Epic Games"; Address="epicgames.com"},
        @{Name="Xbox Live"; Address="xbox.com"}
    )
    
    $latencyResults = @()
    
    foreach ($server in $gameServers) {
        try {
            $pingResult = Test-Connection -ComputerName $server.Address -Count 4 -ErrorAction SilentlyContinue
            if ($pingResult) {
                $avgLatency = ($pingResult | Measure-Object -Property ResponseTime -Average).Average
                $latencyResults += [PSCustomObject]@{
                    Server = $server.Name
                    Latency = [math]::Round($avgLatency, 2)
                    Status = "OK"
                }
            } else {
                $latencyResults += [PSCustomObject]@{
                    Server = $server.Name
                    Latency = 0
                    Status = "Falha"
                }
            }
        } catch {
            $latencyResults += [PSCustomObject]@{
                Server = $server.Name
                Latency = 0
                Status = "Falha"
            }
        }
    }
    
    Write-Host "Lat√™ncia atual para servidores de jogos:" -ForegroundColor White
    $latencyResults | Format-Table -AutoSize
    
    $avgLatency = ($latencyResults | Where-Object { $_.Status -eq "OK" } | Measure-Object -Property Latency -Average).Average
    if ($avgLatency -gt 0) {
        Write-Host "Lat√™ncia m√©dia atual: $([math]::Round($avgLatency, 2)) ms" -ForegroundColor $(if ($avgLatency -lt 50) { "Green" } elseif ($avgLatency -lt 100) { "Yellow" } else { "Red" })
    } else {
        Write-Host "N√£o foi poss√≠vel determinar a lat√™ncia m√©dia atual." -ForegroundColor Red
    }
    
    Write-Host ""
    $confirm = Read-Host "Deseja aplicar otimiza√ß√µes de lat√™ncia para jogos? (s/n)"
    
    if ($confirm -eq 's') {
        Write-Host "Aplicando otimiza√ß√µes de lat√™ncia para jogos..." -ForegroundColor Yellow
        
        # Otimiza√ß√£o 1: Configurar QoS para jogos
        Write-Host "Configurando QoS para jogos..." -ForegroundColor DarkGray
        
        # Verificar se o servi√ßo QoS est√° em execu√ß√£o
        $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
        if ($qosService -and $qosService.Status -ne "Running") {
            Write-Host "Iniciando servi√ßo QoS RSVP..." -ForegroundColor DarkGray
            Start-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
        }
        
        # Configurar QoS para jogos usando netsh
        netsh advfirewall firewall add rule name="QoS-Games" dir=out action=allow protocol=UDP remoteport=3074,3478,3479,3480 enable=yes
        
        # Configurar prioridade para jogos
        if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS")) {
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Force | Out-Null
        }
        
        # Adicionar pol√≠tica para jogos
        New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Force | Out-Null
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Application Name" -Value "*" -Type String
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Version" -Value "1.0" -Type String
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Protocol" -Value "*" -Type String
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Local Port" -Value "*" -Type String
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Local IP" -Value "*" -Type String
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Remote Port" -Value "3074,3478-3480" -Type String
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Remote IP" -Value "*" -Type String
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "DSCP Value" -Value "46" -Type String
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Throttle Rate" -Value "-1" -Type String
        
        # Otimiza√ß√£o 2: Configurar TCP/IP para jogos
        Write-Host "Configurando TCP/IP para jogos..." -ForegroundColor DarkGray
        
        # Habilitar TCP Window Auto-Tuning
        netsh int tcp set global autotuninglevel=normal
        
        # Habilitar Receive-Side Scaling (RSS)
        netsh int tcp set global rss=enabled
        
        # Configurar Congestion Provider para CTCP
        netsh int tcp set global congestionprovider=ctcp
        
        # Habilitar ECN Capability
        netsh int tcp set global ecncapability=enabled
        
        # Otimiza√ß√£o 3: Configurar Nagle Algorithm (reduz lat√™ncia para pacotes pequenos)
        Write-Host "Configurando Nagle Algorithm..." -ForegroundColor DarkGray
        
        # Desabilitar Nagle Algorithm para jogos
        if (-not (Test-Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces")) {
            New-Item -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces" -Force | Out-Null
        }
        
        $networkInterfaces = Get-ChildItem "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces"
        foreach ($interface in $networkInterfaces) {
            Set-ItemProperty -Path $interface.PSPath -Name "TcpAckFrequency" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
            Set-ItemProperty -Path $interface.PSPath -Name "TCPNoDelay" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
        }
        
        # Otimiza√ß√£o 4: Configurar prioridade de CPU para jogos
        Write-Host "Configurando prioridade de CPU para jogos..." -ForegroundColor DarkGray
        
        # Configurar prioridade para jogos
        if (-not (Test-Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games")) {
            New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Force | Out-Null
        }
        
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "GPU Priority" -Value 8 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Priority" -Value 6 -Type DWord -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" -Name "Scheduling Category" -Type String -Value "High" -Force -ErrorAction SilentlyContinue
        
        # Otimiza√ß√£o 5: Configurar Network Throttling Index
        Write-Host "Configurando Network Throttling Index..." -ForegroundColor DarkGray
        
        if (-not (Test-Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile")) {
            New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile" -Force | Out-Null
        }
        
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile" -Name "NetworkThrottlingIndex" -Value 0xffffffff -Type DWord -Force -ErrorAction SilentlyContinue
        
        Write-Host "Otimiza√ß√µes de lat√™ncia para jogos aplicadas com sucesso!" -ForegroundColor Green
        
        # Verificar lat√™ncia ap√≥s otimiza√ß√µes
        Write-Host "`nVerificando lat√™ncia ap√≥s otimiza√ß√µes..." -ForegroundColor Yellow
        
        $latencyResultsAfter = @()
        
        foreach ($server in $gameServers) {
            try {
                $pingResult = Test-Connection -ComputerName $server.Address -Count 4 -ErrorAction SilentlyContinue
                if ($pingResult) {
                    $avgLatency = ($pingResult | Measure-Object -Property ResponseTime -Average).Average
                    $latencyResultsAfter += [PSCustomObject]@{
                        Server = $server.Name
                        Latency = [math]::Round($avgLatency, 2)
                        Status = "OK"
                    }
                } else {
                    $latencyResultsAfter += [PSCustomObject]@{
                        Server = $server.Name
                        Latency = 0
                        Status = "Falha"
                    }
                }
            } catch {
                $latencyResultsAfter += [PSCustomObject]@{
                    Server = $server.Name
                    Latency = 0
                    Status = "Falha"
                }
            }
        }
        
        Write-Host "Lat√™ncia ap√≥s otimiza√ß√µes:" -ForegroundColor White
        $latencyResultsAfter | Format-Table -AutoSize
        
        $avgLatencyAfter = ($latencyResultsAfter | Where-Object { $_.Status -eq "OK" } | Measure-Object -Property Latency -Average).Average
        if ($avgLatencyAfter -gt 0) {
            Write-Host "Lat√™ncia m√©dia ap√≥s otimiza√ß√µes: $([math]::Round($avgLatencyAfter, 2)) ms" -ForegroundColor $(if ($avgLatencyAfter -lt 50) { "Green" } elseif ($avgLatencyAfter -lt 100) { "Yellow" } else { "Red" })
        } else {
            Write-Host "N√£o foi poss√≠vel determinar a lat√™ncia m√©dia ap√≥s otimiza√ß√µes." -ForegroundColor Red
        }
        
        Write-Host "`nBenef√≠cios das otimiza√ß√µes de lat√™ncia para jogos:" -ForegroundColor Cyan
        Write-Host "- Redu√ß√£o da lat√™ncia em jogos online" -ForegroundColor DarkGray
        Write-Host "- Melhor resposta em jogos competitivos" -ForegroundColor DarkGray
        Write-Host "- Redu√ß√£o de lag e stuttering" -ForegroundColor DarkGray
        Write-Host "- Melhor experi√™ncia geral em jogos online" -ForegroundColor DarkGray
        
        Write-Host "`nNota: Algumas altera√ß√µes podem requerer reinicializa√ß√£o para ter efeito completo." -ForegroundColor Yellow
        $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (s/n)"
        
        if ($confirmRestart -eq 's') {
            Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
            Restart-Computer -Force
        }
    } else {
        Write-Host "Otimiza√ß√µes de lat√™ncia para jogos canceladas." -ForegroundColor Yellow
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - DESEMPENHO (Expandidas) ---
function Invoke-OptimizeVisualEffects {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Desempenho: Ajustar Efeitos Visuais para Melhor Desempenho ---" -ForegroundColor Green
    Write-Host "Configura os efeitos visuais do Windows para priorizar o desempenho sobre a apar√™ncia." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o ajusta os efeitos visuais do Windows para priorizar o desempenho." -ForegroundColor White
    Write-Host "Desativar efeitos visuais pode melhorar significativamente o desempenho em sistemas mais antigos." -ForegroundColor White
    Write-Host ""
    
    # Verificar configura√ß√µes atuais
    Write-Host "Verificando configura√ß√µes atuais de efeitos visuais..." -ForegroundColor Yellow
    
    $visualFXPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects"
    $visualFXSetting = Get-ItemProperty -Path $visualFXPath -Name "VisualFXSetting" -ErrorAction SilentlyContinue
    
    if ($visualFXSetting) {
        switch ($visualFXSetting.VisualFXSetting) {
            0 { $currentSetting = "Deixar o Windows escolher (Autom√°tico)" }
            1 { $currentSetting = "Ajustar para melhor apar√™ncia" }
            2 { $currentSetting = "Ajustar para melhor desempenho" }
            3 { $currentSetting = "Personalizado" }
            default { $currentSetting = "Desconhecido" }
        }
        
        Write-Host "Configura√ß√£o atual: $currentSetting" -ForegroundColor White
    } else {
        Write-Host "N√£o foi poss√≠vel determinar a configura√ß√£o atual." -ForegroundColor DarkGray
    }
    
    Write-Host ""
    Write-Host "Op√ß√µes de configura√ß√£o:" -ForegroundColor Yellow
    Write-Host "[1] Ajustar para melhor desempenho (desativa todos os efeitos visuais)" -ForegroundColor White
    Write-Host "[2] Ajustar para melhor apar√™ncia (ativa todos os efeitos visuais)" -ForegroundColor White
    Write-Host "[3] Deixar o Windows escolher (configura√ß√£o autom√°tica)" -ForegroundColor White
    Write-Host "[4] Configura√ß√£o personalizada (escolher efeitos espec√≠ficos)" -ForegroundColor White
    Write-Host "[0] Voltar" -ForegroundColor White
    Write-Host ""
    
    $visualChoice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($visualChoice) {
        "1" {
            Write-Host "Ajustando para melhor desempenho..." -ForegroundColor Yellow
            
            # Configurar para melhor desempenho (desativar todos os efeitos visuais)
            Set-ItemProperty -Path $visualFXPath -Name "VisualFXSetting" -Value 2 -Type DWord -Force
            
            # Desativar efeitos visuais espec√≠ficos
            $desktopPath = "HKCU:\Control Panel\Desktop"
            $advancedPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced"
            $windowMetricsPath = "HKCU:\Control Panel\Desktop\WindowMetrics"
            
            # Desativar anima√ß√µes de janela
            Set-ItemProperty -Path $desktopPath -Name "UserPreferencesMask" -Value ([byte[]](0x90, 0x12, 0x01, 0x80)) -Type Binary -Force
            
            # Desativar anima√ß√µes de minimizar/maximizar
            Set-ItemProperty -Path $windowMetricsPath -Name "MinAnimate" -Value 0 -Type String -Force
            
            # Desativar efeitos de transpar√™ncia
            Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize" -Name "EnableTransparency" -Value 0 -Type DWord -Force
            
            # Desativar anima√ß√µes da barra de tarefas
            Set-ItemProperty -Path $advancedPath -Name "TaskbarAnimations" -Value 0 -Type DWord -Force
            
            # Desativar sele√ß√£o transparente
            Set-ItemProperty -Path $advancedPath -Name "ListviewAlphaSelect" -Value 0 -Type DWord -Force
            
            # Desativar sombras sob o ponteiro do mouse
            Set-ItemProperty -Path $advancedPath -Name "EnablePointerShadow" -Value 0 -Type DWord -Force
            
            # Desativar sombras sob janelas
            Set-ItemProperty -Path $advancedPath -Name "ListviewShadow" -Value 0 -Type DWord -Force
            
            Write-Host "Configura√ß√£o ajustada para melhor desempenho!" -ForegroundColor Green
            Write-Host "Todos os efeitos visuais foram desativados para maximizar o desempenho." -ForegroundColor Green
        }
        "2" {
            Write-Host "Ajustando para melhor apar√™ncia..." -ForegroundColor Yellow
            
            # Configurar para melhor apar√™ncia (ativar todos os efeitos visuais)
            Set-ItemProperty -Path $visualFXPath -Name "VisualFXSetting" -Value 1 -Type DWord -Force
            
            # Ativar efeitos visuais espec√≠ficos
            $desktopPath = "HKCU:\Control Panel\Desktop"
            $advancedPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced"
            $windowMetricsPath = "HKCU:\Control Panel\Desktop\WindowMetrics"
            
            # Ativar anima√ß√µes de janela
            Set-ItemProperty -Path $desktopPath -Name "UserPreferencesMask" -Value ([byte[]](0x9E, 0x3E, 0x07, 0x80)) -Type Binary -Force
            
            # Ativar anima√ß√µes de minimizar/maximizar
            Set-ItemProperty -Path $windowMetricsPath -Name "MinAnimate" -Value 1 -Type String -Force
            
            # Ativar efeitos de transpar√™ncia
            Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize" -Name "EnableTransparency" -Value 1 -Type DWord -Force
            
            # Ativar anima√ß√µes da barra de tarefas
            Set-ItemProperty -Path $advancedPath -Name "TaskbarAnimations" -Value 1 -Type DWord -Force
            
            # Ativar sele√ß√£o transparente
            Set-ItemProperty -Path $advancedPath -Name "ListviewAlphaSelect" -Value 1 -Type DWord -Force
            
            # Ativar sombras sob o ponteiro do mouse
            Set-ItemProperty -Path $advancedPath -Name "EnablePointerShadow" -Value 1 -Type DWord -Force
            
            # Ativar sombras sob janelas
            Set-ItemProperty -Path $advancedPath -Name "ListviewShadow" -Value 1 -Type DWord -Force
            
            Write-Host "Configura√ß√£o ajustada para melhor apar√™ncia!" -ForegroundColor Green
            Write-Host "Todos os efeitos visuais foram ativados para maximizar a apar√™ncia." -ForegroundColor Green
        }
        "3" {
            Write-Host "Configurando para deixar o Windows escolher..." -ForegroundColor Yellow
            
            # Configurar para deixar o Windows escolher (configura√ß√£o autom√°tica)
            Set-ItemProperty -Path $visualFXPath -Name "VisualFXSetting" -Value 0 -Type DWord -Force
            
            Write-Host "Configura√ß√£o ajustada para deixar o Windows escolher!" -ForegroundColor Green
            Write-Host "O Windows ir√° determinar automaticamente quais efeitos visuais usar com base no desempenho do sistema." -ForegroundColor Green
        }
        "4" {
            Write-Host "Configura√ß√£o personalizada de efeitos visuais..." -ForegroundColor Yellow
            
            # Configurar para personalizado
            Set-ItemProperty -Path $visualFXPath -Name "VisualFXSetting" -Value 3 -Type DWord -Force
            
            $desktopPath = "HKCU:\Control Panel\Desktop"
            $advancedPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced"
            $windowMetricsPath = "HKCU:\Control Panel\Desktop\WindowMetrics"
            
            # Listar efeitos visuais dispon√≠veis
            Write-Host ""
            Write-Host "Efeitos visuais dispon√≠veis:" -ForegroundColor Yellow
            Write-Host "[1] Anima√ß√µes de janela" -ForegroundColor White
            Write-Host "[2] Anima√ß√µes de minimizar/maximizar" -ForegroundColor White
            Write-Host "[3] Efeitos de transpar√™ncia" -ForegroundColor White
            Write-Host "[4] Anima√ß√µes da barra de tarefas" -ForegroundColor White
            Write-Host "[5] Sele√ß√£o transparente" -ForegroundColor White
            Write-Host "[6] Sombras sob o ponteiro do mouse" -ForegroundColor White
            Write-Host "[7] Sombras sob janelas" -ForegroundColor White
            Write-Host ""
            
            # Solicitar quais efeitos ativar/desativar
            $animations = Read-Host "Ativar anima√ß√µes de janela? (s/n)"
            $minAnimate = Read-Host "Ativar anima√ß√µes de minimizar/maximizar? (s/n)"
            $transparency = Read-Host "Ativar efeitos de transpar√™ncia? (s/n)"
            $taskbarAnimations = Read-Host "Ativar anima√ß√µes da barra de tarefas? (s/n)"
            $alphaSelect = Read-Host "Ativar sele√ß√£o transparente? (s/n)"
            $pointerShadow = Read-Host "Ativar sombras sob o ponteiro do mouse? (s/n)"
            $listviewShadow = Read-Host "Ativar sombras sob janelas? (s/n)"
            
            # Aplicar configura√ß√µes personalizadas
            if ($animations -eq "s") {
                Set-ItemProperty -Path $desktopPath -Name "UserPreferencesMask" -Value ([byte[]](0x9E, 0x3E, 0x07, 0x80)) -Type Binary -Force
            } else {
                Set-ItemProperty -Path $desktopPath -Name "UserPreferencesMask" -Value ([byte[]](0x90, 0x12, 0x01, 0x80)) -Type Binary -Force
            }
            
            if ($minAnimate -eq "s") {
                Set-ItemProperty -Path $windowMetricsPath -Name "MinAnimate" -Value 1 -Type String -Force
            } else {
                Set-ItemProperty -Path $windowMetricsPath -Name "MinAnimate" -Value 0 -Type String -Force
            }
            
            if ($transparency -eq "s") {
                Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize" -Name "EnableTransparency" -Value 1 -Type DWord -Force
            } else {
                Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize" -Name "EnableTransparency" -Value 0 -Type DWord -Force
            }
            
            if ($taskbarAnimations -eq "s") {
                Set-ItemProperty -Path $advancedPath -Name "TaskbarAnimations" -Value 1 -Type DWord -Force
            } else {
                Set-ItemProperty -Path $advancedPath -Name "TaskbarAnimations" -Value 0 -Type DWord -Force
            }
            
            if ($alphaSelect -eq "s") {
                Set-ItemProperty -Path $advancedPath -Name "ListviewAlphaSelect" -Value 1 -Type DWord -Force
            } else {
                Set-ItemProperty -Path $advancedPath -Name "ListviewAlphaSelect" -Value 0 -Type DWord -Force
            }
            
            if ($pointerShadow -eq "s") {
                Set-ItemProperty -Path $advancedPath -Name "EnablePointerShadow" -Value 1 -Type DWord -Force
            } else {
                Set-ItemProperty -Path $advancedPath -Name "EnablePointerShadow" -Value 0 -Type DWord -Force
            }
            
            if ($listviewShadow -eq "s") {
                Set-ItemProperty -Path $advancedPath -Name "ListviewShadow" -Value 1 -Type DWord -Force
            } else {
                Set-ItemProperty -Path $advancedPath -Name "ListviewShadow" -Value 0 -Type DWord -Force
            }
            
            Write-Host "Configura√ß√£o personalizada aplicada!" -ForegroundColor Green
        }
        "0" {
            Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
        }
        default {
            Write-Host "Op√ß√£o inv√°lida." -ForegroundColor Red
        }
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
}

function Invoke-OptimizeDisk {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Desempenho: Otimizar Disco do Sistema ---" -ForegroundColor Cyan
    Write-Host "Otimiza o disco do sistema para melhorar o desempenho geral." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o realiza otimiza√ß√µes no disco do sistema para melhorar o desempenho." -ForegroundColor White
    Write-Host "Isso inclui desfragmenta√ß√£o (em HDDs), TRIM (em SSDs) e limpeza de arquivos desnecess√°rios." -ForegroundColor White
    Write-Host ""
    
    # Verificar tipo de disco
    Write-Host "Verificando tipo de disco..." -ForegroundColor Yellow
    
    $diskType = Get-PhysicalDisk | Select-Object MediaType
    
    if ($diskType.MediaType -eq "SSD") {
        Write-Host "Tipo de disco: SSD (Solid State Drive)" -ForegroundColor Green
        $optimizeType = "ReTrim"
    } else {
        Write-Host "Tipo de disco: HDD (Hard Disk Drive)" -ForegroundColor White
        $optimizeType = "Defrag"
    }
    
    # Verificar status da otimiza√ß√£o
    Write-Host "Verificando status da otimiza√ß√£o..." -ForegroundColor Yellow
    
    $volumeInfo = Get-Volume -DriveLetter C
    $fileSystem = $volumeInfo.FileSystemTypeName
    
    if ($fileSystem -eq "NTFS") {
        Write-Host "Sistema de arquivos: NTFS" -ForegroundColor Green
    } else {
        Write-Host "Sistema de arquivos: $fileSystem (n√£o suportado)" -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
        return
    }
    
    # Verificar se a otimiza√ß√£o est√° habilitada
    $scheduledTask = Get-ScheduledTask -TaskName "Optimize Drives" -ErrorAction SilentlyContinue
    
    if ($scheduledTask) {
        Write-Host "Otimiza√ß√£o agendada: Habilitada" -ForegroundColor Green
    } else {
        Write-Host "Otimiza√ß√£o agendada: Desabilitada" -ForegroundColor Yellow
    }
    
    Write-Host ""
    Write-Host "Op√ß√µes de otimiza√ß√£o:" -ForegroundColor Yellow
    Write-Host "[1] Otimizar disco (ReTrim para SSD, Desfragmentar para HDD)" -ForegroundColor White
    Write-Host "[2] Verificar e corrigir erros no disco (CHKDSK)" -ForegroundColor White
    Write-Host "[3] Limpar arquivos desnecess√°rios (Limpeza de Disco)" -ForegroundColor White
    Write-Host "[0] Voltar" -ForegroundColor White
    Write-Host ""
    
    $optimizeChoice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($optimizeChoice) {
        "1" {
            Write-Host "Otimizando disco (C:)..." -ForegroundColor Yellow
            
            # Otimizar disco
            Optimize-Volume -DriveLetter C -Verbose -ErrorAction SilentlyContinue -$optimizeType
            
            Write-Host "Otimiza√ß√£o do disco (C:) conclu√≠da!" -ForegroundColor Green
        }
        "2" {
            Write-Host "Verificando e corrigindo erros no disco (C:)..." -ForegroundColor Yellow
            
            # Agendar CHKDSK para o pr√≥ximo boot
            Write-Host "Agendando CHKDSK para o pr√≥ximo boot..." -ForegroundColor DarkGray
            chkdsk C: /f
            
            Write-Host "CHKDSK agendado para o pr√≥ximo boot. Reinicie o computador para executar a verifica√ß√£o." -ForegroundColor Green
        }
        "3" {
            Write-Host "Limpando arquivos desnecess√°rios (Limpeza de Disco)..." -ForegroundColor Yellow
            
            # Executar Limpeza de Disco
            Write-Host "Executando Limpeza de Disco..." -ForegroundColor DarkGray
            Start-Process -FilePath cleanmgr.exe -ArgumentList "/d C:" -Wait -ErrorAction SilentlyContinue
            
            Write-Host "Limpeza de Disco conclu√≠da!" -ForegroundColor Green
        }
        "0" {
            Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
        }
        default {
            Write-Host "Op√ß√£o inv√°lida." -ForegroundColor Red
        }
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
}

function Invoke-CleanPrefetch {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Desempenho: Limpar Arquivos Prefetch ---" -ForegroundColor Yellow
    Write-Host "Remove arquivos prefetch para melhorar o tempo de inicializa√ß√£o de aplicativos." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o remove os arquivos prefetch, que s√£o usados pelo Windows para acelerar a inicializa√ß√£o de aplicativos." -ForegroundColor White
    Write-Host "Limpar esses arquivos pode ajudar a resolver problemas de desempenho e melhorar o tempo de inicializa√ß√£o." -ForegroundColor White
    Write-Host "Nota: Limpar os arquivos prefetch pode fazer com que os aplicativos demorem mais para iniciar na primeira vez ap√≥s a limpeza." -ForegroundColor Yellow
    Write-Host ""
    
    # Verificar status do Prefetcher
    Write-Host "Verificando status do Prefetcher..." -ForegroundColor Yellow
    
    $prefetcherStatus = Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management\PrefetchParameters" -Name "EnablePrefetcher" -ErrorAction SilentlyContinue
    
    if ($prefetcherStatus) {
        switch ($prefetcherStatus.EnablePrefetcher) {
            0 { $currentStatus = "Desativado" }
            1 { $currentStatus = "Aplicativos" }
            2 { $currentStatus = "Inicializa√ß√£o" }
            3 { $currentStatus = "Tudo" }
            default { $currentStatus = "Desconhecido" }
        }
        
        Write-Host "Status atual do Prefetcher: $currentStatus" -ForegroundColor White
    } else {
        Write-Host "N√£o foi poss√≠vel determinar o status do Prefetcher." -ForegroundColor Red
    }
    
    Write-Host ""
    Write-Host "Op√ß√µes de limpeza:" -ForegroundColor Yellow
    Write-Host "[1] Limpar arquivos prefetch" -ForegroundColor White
    Write-Host "[2] Desativar Prefetcher" -ForegroundColor White
    Write-Host "[3] Ativar Prefetcher (para aplicativos e inicializa√ß√£o)" -ForegroundColor White
    Write-Host "[0] Voltar" -ForegroundColor White
    Write-Host ""
    
    $prefetchChoice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($prefetchChoice) {
        "1" {
            Write-Host "Limpando arquivos prefetch..." -ForegroundColor Yellow
            
            # Parar o servi√ßo Superfetch/SysMain
            Stop-Service -Name "SysMain" -Force -ErrorAction SilentlyContinue
            
            # Remover arquivos prefetch
            Remove-Item "$env:SystemRoot\Prefetch\*.pf" -Force -ErrorAction SilentlyContinue
            
            # Iniciar o servi√ßo Superfetch/SysMain
            Start-Service -Name "SysMain" -ErrorAction SilentlyContinue
            
            Write-Host "Arquivos prefetch limpos com sucesso!" -ForegroundColor Green
            Write-Host "Os aplicativos podem demorar mais para iniciar na primeira vez ap√≥s a limpeza." -ForegroundColor Yellow
        }
        "2" {
            Write-Host "Desativando Prefetcher..." -ForegroundColor Yellow
            
            # Desativar Prefetcher
            Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management\PrefetchParameters" -Name "EnablePrefetcher" -Value 0 -Type DWord -Force
            
            Write-Host "Prefetcher desativado com sucesso!" -ForegroundColor Green
            Write-Host "Reinicie o computador para aplicar as altera√ß√µes." -ForegroundColor Yellow
        }
        "3" {
            Write-Host "Ativando Prefetcher (para aplicativos e inicializa√ß√£o)..." -ForegroundColor Yellow
            
            # Ativar Prefetcher
            Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management\PrefetchParameters" -Name "EnablePrefetcher" -Value 3 -Type DWord -Force
            
            Write-Host "Prefetcher ativado com sucesso!" -ForegroundColor Green
            Write-Host "Reinicie o computador para aplicar as altera√ß√µes." -ForegroundColor Yellow
        }
        "0" {
            Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
        }
        default {
            Write-Host "Op√ß√£o inv√°lida." -ForegroundColor Red
        }
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
}

function Invoke-SetHighPerformancePower {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Desempenho: Definir Plano de Energia para Alto Desempenho ---" -ForegroundColor White
    Write-Host "Configura o plano de energia para 'Alto desempenho' para maximizar o desempenho do sistema." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o configura o plano de energia para 'Alto desempenho', o que pode melhorar o desempenho do sistema." -ForegroundColor White
    Write-Host "Nota: O plano de energia 'Alto desempenho' pode aumentar o consumo de energia e reduzir a vida √∫til da bateria em laptops." -ForegroundColor Yellow
    Write-Host ""
    
    # Verificar plano de energia atual
    Write-Host "Verificando plano de energia atual..." -ForegroundColor Yellow
    
    $currentPlan = powercfg /getactivescheme
    
    if ($currentPlan -match "8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c") {
        Write-Host "Plano de energia atual: Alto desempenho" -ForegroundColor Green
    } elseif ($currentPlan -match "381b4222-f694-41f0-9685-ff5bb260df2e") {
        Write-Host "Plano de energia atual: Equilibrado" -ForegroundColor White
    } elseif ($currentPlan -match "a1841308-3541-4fab-bc81-f71556f20b4a") {
        Write-Host "Plano de energia atual: Economia de energia" -ForegroundColor White
    } else {
        Write-Host "Plano de energia atual: Desconhecido" -ForegroundColor Red
    }
    
    Write-Host ""
    Write-Host "Deseja configurar o plano de energia para 'Alto desempenho'?" -ForegroundColor Yellow
    $confirm = Read-Host "(s/n)"
    
    if ($confirm -eq 's') {
        Write-Host "Configurando plano de energia para 'Alto desempenho'..." -ForegroundColor Yellow
        
        # Definir plano de energia para Alto Desempenho
        powercfg /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c
        
        Write-Host "Plano de energia configurado para 'Alto desempenho' com sucesso!" -ForegroundColor Green
        Write-Host "O sistema agora priorizar√° o desempenho em vez da economia de energia." -ForegroundColor Green
    } else {
        Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
}

function Invoke-OptimizeSuperFetch {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Desempenho: Otimizar Servi√ßo SuperFetch/SysMain ---" -ForegroundColor Magenta
    Write-Host "Otimiza o servi√ßo SuperFetch/SysMain para melhorar o tempo de carregamento de aplicativos." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o otimiza o servi√ßo SuperFetch/SysMain, que pr√©-carrega aplicativos usados com frequ√™ncia na mem√≥ria." -ForegroundColor White
    Write-Host "Desativar ou configurar corretamente este servi√ßo pode melhorar o desempenho, especialmente em SSDs." -ForegroundColor White
    Write-Host ""
    
    # Verificar status do servi√ßo SuperFetch/SysMain
    Write-Host "Verificando status do servi√ßo SuperFetch/SysMain..." -ForegroundColor Yellow
    
    $superFetchService = Get-Service -Name "SysMain" -ErrorAction SilentlyContinue
    
    if ($superFetchService) {
        Write-Host "Nome do servi√ßo: $($superFetchService.DisplayName)" -ForegroundColor White
        Write-Host "Status atual: $($superFetchService.Status)" -ForegroundColor $(if ($superFetchService.Status -eq "Running") { "Green" } else { "Yellow" })
        Write-Host "Tipo de inicializa√ß√£o: $($superFetchService.StartType)" -ForegroundColor White
    } else {
        Write-Host "Servi√ßo SuperFetch/SysMain n√£o encontrado." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
        return
    }
    
    Write-Host ""
    Write-Host "Op√ß√µes de otimiza√ß√£o:" -ForegroundColor Yellow
    Write-Host "[1] Desativar SuperFetch/SysMain (recomendado para SSDs)" -ForegroundColor White
    Write-Host "[2] Ativar SuperFetch/SysMain (configura√ß√£o padr√£o)" -ForegroundColor White
    Write-Host "[0] Voltar" -ForegroundColor White
    Write-Host ""
    
    $superFetchChoice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($superFetchChoice) {
        "1" {
            Write-Host "Desativando SuperFetch/SysMain..." -ForegroundColor Yellow
            
            # Desativar o servi√ßo
            Set-Service -Name "SysMain" -StartupType Disabled -ErrorAction SilentlyContinue
            Stop-Service -Name "SysMain" -Force -ErrorAction SilentlyContinue
            
            Write-Host "Servi√ßo SuperFetch/SysMain desativado com sucesso!" -ForegroundColor Green
            Write-Host "Recomendado para sistemas com SSDs." -ForegroundColor Green
        }
        "2" {
            Write-Host "Ativando SuperFetch/SysMain..." -ForegroundColor Yellow
            
            # Configurar o servi√ßo para autom√°tico
            Set-Service -Name "SysMain" -StartupType Automatic -ErrorAction SilentlyContinue
            Start-Service -Name "SysMain" -ErrorAction SilentlyContinue
            
            Write-Host "Servi√ßo SuperFetch/SysMain ativado com sucesso!" -ForegroundColor Green
            Write-Host "Configura√ß√£o padr√£o para sistemas com HDDs." -ForegroundColor Green
        }
        "0" {
            Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
        }
        default {
            Write-Host "Op√ß√£o inv√°lida." -ForegroundColor Red
        }
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
}

function Invoke-AdjustVirtualMemory {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Desempenho: Ajustar Tamanho da Mem√≥ria Virtual ---" -ForegroundColor Gray
    Write-Host "Configura o tamanho da mem√≥ria virtual para melhorar o desempenho do sistema." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o ajusta o tamanho da mem√≥ria virtual (arquivo de pagina√ß√£o) para melhorar o desempenho." -ForegroundColor White
    Write-Host "A mem√≥ria virtual √© usada quando a mem√≥ria RAM est√° cheia, e ajustar seu tamanho pode evitar problemas de desempenho." -ForegroundColor White
    Write-Host ""
    
    # Verificar configura√ß√µes atuais de mem√≥ria virtual
    Write-Host "Verificando configura√ß√µes atuais de mem√≥ria virtual..." -ForegroundColor Yellow
    
    $wmi = Get-WmiObject -Class Win32_ComputerSystem
    $automaticManagedPagefile = $wmi.AutomaticManagedPagefile
    
    if ($automaticManagedPagefile) {
        Write-Host "Gerenciamento autom√°tico do arquivo de pagina√ß√£o: Ativado" -ForegroundColor Green
    } else {
        Write-Host "Gerenciamento autom√°tico do arquivo de pagina√ß√£o: Desativado" -ForegroundColor Yellow
    }
    
    # Obter informa√ß√µes sobre o arquivo de pagina√ß√£o
    $pageFile = Get-WmiObject -Class Win32_PageFileUsage
    
    if ($pageFile) {
        Write-Host "Local do arquivo de pagina√ß√£o: $($pageFile.Name)" -ForegroundColor White
        Write-Host "Tamanho alocado: $([math]::Round($pageFile.AllocatedBaseSize / 1024, 2)) GB" -ForegroundColor White
    } else {
        Write-Host "N√£o foi poss√≠vel obter informa√ß√µes sobre o arquivo de pagina√ß√£o." -ForegroundColor Red
    }
    
    Write-Host ""
    Write-Host "Op√ß√µes de configura√ß√£o:" -ForegroundColor Yellow
    Write-Host "[1] Ativar gerenciamento autom√°tico do arquivo de pagina√ß√£o" -ForegroundColor White
    Write-Host "[2] Desativar gerenciamento autom√°tico e definir tamanho personalizado" -ForegroundColor White
    Write-Host "[0] Voltar" -ForegroundColor White
    Write-Host ""
    
    $pageChoice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($pageChoice) {
        "1" {
            Write-Host "Ativando gerenciamento autom√°tico do arquivo de pagina√ß√£o..." -ForegroundColor Yellow
            
            # Ativar gerenciamento autom√°tico
            $wmi.AutomaticManagedPagefile = $true
            $wmi.Put()
            
            Write-Host "Gerenciamento autom√°tico do arquivo de pagina√ß√£o ativado com sucesso!" -ForegroundColor Green
            Write-Host "O Windows agora gerenciar√° automaticamente o tamanho do arquivo de pagina√ß√£o." -ForegroundColor Green
        }
        "2" {
            Write-Host "Desativando gerenciamento autom√°tico e definindo tamanho personalizado..." -ForegroundColor Yellow
            
            # Desativar gerenciamento autom√°tico
            $wmi.AutomaticManagedPagefile = $false
            $wmi.Put()
            
            # Solicitar tamanho inicial e m√°ximo
            $initialSize = Read-Host "Digite o tamanho inicial do arquivo de pagina√ß√£o (em MB)"
            $maximumSize = Read-Host "Digite o tamanho m√°ximo do arquivo de pagina√ß√£o (em MB)"
            
            # Configurar tamanho personalizado
            try {
                $pageFileSetting = Get-WmiObject -Class Win32_PageFileSetting | Where-Object {$_.Name -like "*pagefile.sys"}
                
                if ($pageFileSetting) {
                    $pageFileSetting.InitialSize = $initialSize
                    $pageFileSetting.MaximumSize = $maximumSize
                    $pageFileSetting.Put()
                    
                    Write-Host "Tamanho do arquivo de pagina√ß√£o definido para:" -ForegroundColor Green
                    Write-Host "Tamanho inicial: $initialSize MB" -ForegroundColor White
                    Write-Host "Tamanho m√°ximo: $maximumSize MB" -ForegroundColor White
                } else {
                    Write-Host "N√£o foi poss√≠vel encontrar o arquivo de pagina√ß√£o." -ForegroundColor Red
                }
            } catch {
                Write-Host "Ocorreu um erro ao configurar o tamanho do arquivo de pagina√ß√£o." -ForegroundColor Red
            }
            
            Write-Host "Configura√ß√£o personalizada aplicada!" -ForegroundColor Green
            Write-Host "Reinicie o computador para aplicar as altera√ß√µes." -ForegroundColor Yellow
        }
        "0" {
            Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
        }
        default {
            Write-Host "Op√ß√£o inv√°lida." -ForegroundColor Red
        }
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
}

function Invoke-DisableIndexing {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Desempenho: Desativar Indexa√ß√£o de Arquivos ---" -ForegroundColor Green
    Write-Host "Desativa a indexa√ß√£o de arquivos para melhorar o desempenho do sistema." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o desativa a indexa√ß√£o de arquivos, que pode melhorar o desempenho, especialmente em HDDs." -ForegroundColor White
    Write-Host "Desativar a indexa√ß√£o pode fazer com que as pesquisas de arquivos demorem mais." -ForegroundColor Yellow
    Write-Host ""
    
    # Verificar status do servi√ßo de indexa√ß√£o
    Write-Host "Verificando status do servi√ßo de indexa√ß√£o..." -ForegroundColor Yellow
    
    $indexingService = Get-Service -Name "WSearch" -ErrorAction SilentlyContinue
    
    if ($indexingService) {
        Write-Host "Nome do servi√ßo: $($indexingService.DisplayName)" -ForegroundColor White
        Write-Host "Status atual: $($indexingService.Status)" -ForegroundColor $(if ($indexingService.Status -eq "Running") { "Green" } else { "Yellow" })
        Write-Host "Tipo de inicializa√ß√£o: $($indexingService.StartType)" -ForegroundColor White
    } else {
        Write-Host "Servi√ßo de indexa√ß√£o n√£o encontrado." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
        return
    }
    
    Write-Host ""
    Write-Host "Op√ß√µes de configura√ß√£o:" -ForegroundColor Yellow
    Write-Host "[1] Desativar indexa√ß√£o de arquivos" -ForegroundColor White
    Write-Host "[2] Ativar indexa√ß√£o de arquivos (configura√ß√£o padr√£o)" -ForegroundColor White
    Write-Host "[0] Voltar" -ForegroundColor White
    Write-Host ""
    
    $indexChoice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($indexChoice) {
        "1" {
            Write-Host "Desativando indexa√ß√£o de arquivos..." -ForegroundColor Yellow
            
            # Desativar o servi√ßo
            Set-Service -Name "WSearch" -StartupType Disabled -ErrorAction SilentlyContinue
            Stop-Service -Name "WSearch" -Force -ErrorAction SilentlyContinue
            
            Write-Host "Indexa√ß√£o de arquivos desativada com sucesso!" -ForegroundColor Green
            Write-Host "As pesquisas de arquivos podem demorar mais." -ForegroundColor Yellow
        }
        "2" {
            Write-Host "Ativando indexa√ß√£o de arquivos..." -ForegroundColor Yellow
            
            # Configurar o servi√ßo para autom√°tico
            Set-Service -Name "WSearch" -StartupType AutomaticDelayedStart -ErrorAction SilentlyContinue
            Start-Service -Name "WSearch" -ErrorAction SilentlyContinue
            
            Write-Host "Indexa√ß√£o de arquivos ativada com sucesso!" -ForegroundColor Green
            Write-Host "As pesquisas de arquivos ser√£o mais r√°pidas, mas o desempenho do sistema pode ser afetado." -ForegroundColor Yellow
        }
        "0" {
            Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
        }
        default {
            Write-Host "Op√ß√£o inv√°lida." -ForegroundColor Red
        }
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
}

function Invoke-OptimizeStartup {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Desempenho: Otimizar Inicializa√ß√£o do Sistema ---" -ForegroundColor Cyan
    Write-Host "Gerencia os programas e servi√ßos que s√£o iniciados com o Windows para melhorar o tempo de inicializa√ß√£o." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o permite gerenciar os programas e servi√ßos que s√£o iniciados com o Windows." -ForegroundColor White
    Write-Host "Desativar programas e servi√ßos desnecess√°rios pode melhorar significativamente o tempo de inicializa√ß√£o." -ForegroundColor White
    Write-Host ""
    
    # Listar programas de inicializa√ß√£o
    Write-Host "Listando programas de inicializa√ß√£o..." -ForegroundColor Yellow
    
    $startupPrograms = Get-CimInstance -ClassName Win32_StartupCommand
    
    if ($startupPrograms) {
        Write-Host "Programas de inicializa√ß√£o:" -ForegroundColor White
        
        $index = 1
        foreach ($program in $startupPrograms) {
            Write-Host "[$index] $($program.Name) - $($program.Command)" -ForegroundColor White
            $index++
        }
    } else {
        Write-Host "Nenhum programa de inicializa√ß√£o encontrado." -ForegroundColor DarkGray
    }
    
    Write-Host ""
    Write-Host "Op√ß√µes de gerenciamento:" -ForegroundColor Yellow
    Write-Host "[1] Desabilitar programa de inicializa√ß√£o" -ForegroundColor White
    Write-Host "[2] Gerenciar servi√ßos de inicializa√ß√£o" -ForegroundColor White
    Write-Host "[0] Voltar" -ForegroundColor White
    Write-Host ""
    
    $startupChoice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($startupChoice) {
        "1" {
            Write-Host "Desabilitando programa de inicializa√ß√£o..." -ForegroundColor Yellow
            
            # Selecionar programa para desabilitar
            $programChoice = Read-Host "Digite o n√∫mero do programa que deseja desabilitar (ou 0 para voltar)"
            
            if ($programChoice -eq "0" -or $programChoice -eq "") {
                Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
                break
            }
            
            $programIndex = [int]$programChoice - 1
            if ($programIndex -lt 0 -or $programIndex -ge $startupPrograms.Count) {
                Write-Host "Sele√ß√£o inv√°lida." -ForegroundColor Red
                break
            }
            
            $selectedProgram = $startupPrograms[$programIndex]
            
            # Desabilitar programa de inicializa√ß√£o
            Write-Host "Desabilitando $($selectedProgram.Name)..." -ForegroundColor DarkGray
            
            # Remover entrada do registro
            $regPath = $selectedProgram.Location
            $regName = $selectedProgram.Name
            
            try {
                Remove-ItemProperty -Path $regPath -Name $regName -Force -ErrorAction SilentlyContinue
                Write-Host "$($selectedProgram.Name) desabilitado com sucesso!" -ForegroundColor Green
            } catch {
                Write-Host "N√£o foi poss√≠vel desabilitar $($selectedProgram.Name)." -ForegroundColor Red
            }
        }
        "2" {
            Write-Host "Gerenciando servi√ßos de inicializa√ß√£o..." -ForegroundColor Yellow
            
            # Listar servi√ßos de inicializa√ß√£o
            Write-Host "Listando servi√ßos de inicializa√ß√£o..." -ForegroundColor DarkGray
            
            $startupServices = Get-Service | Where-Object {$_.StartType -ne "Disabled"}
            
            if ($startupServices) {
                Write-Host "Servi√ßos de inicializa√ß√£o:" -ForegroundColor White
                
                $index = 1
                foreach ($service in $startupServices) {
                    Write-Host "[$index] $($service.DisplayName) - $($service.Status)" -ForegroundColor White
                    $index++
                }
            } else {
                Write-Host "Nenhum servi√ßo de inicializa√ß√£o encontrado." -ForegroundColor DarkGray
            }
            
            Write-Host ""
            Write-Host "Op√ß√µes de gerenciamento:" -ForegroundColor Yellow
            Write-Host "[1] Desabilitar servi√ßo" -ForegroundColor White
            Write-Host "[2] Configurar servi√ßo para 'Atraso na Inicializa√ß√£o'" -ForegroundColor White
            Write-Host "[0] Voltar" -ForegroundColor White
            Write-Host ""
            
            $serviceChoice = Read-Host "Selecione uma op√ß√£o"
            
            switch ($serviceChoice) {
                "1" {
                    Write-Host "Desabilitando servi√ßo..." -ForegroundColor Yellow
                    
                    # Selecionar servi√ßo para desabilitar
                    $serviceChoice = Read-Host "Digite o n√∫mero do servi√ßo que deseja desabilitar (ou 0 para voltar)"
                    
                    if ($serviceChoice -eq "0" -or $serviceChoice -eq "") {
                        Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
                        break
                    }
                    
                    $serviceIndex = [int]$serviceChoice - 1
                    if ($serviceIndex -lt 0 -or $serviceIndex -ge $startupServices.Count) {
                        Write-Host "Sele√ß√£o inv√°lida." -ForegroundColor Red
                        break
                    }
                    
                    $selectedService = $startupServices[$serviceIndex]
                    
                    # Desabilitar servi√ßo
                    Write-Host "Desabilitando $($selectedService.DisplayName)..." -ForegroundColor DarkGray
                    
                    Set-Service -Name $selectedService.Name -StartupType Disabled -ErrorAction SilentlyContinue
                    Stop-Service -Name $selectedService.Name -Force -ErrorAction SilentlyContinue
                    
                    Write-Host "$($selectedService.DisplayName) desabilitado com sucesso!" -ForegroundColor Green
                }
                "2" {
                    Write-Host "Configurando servi√ßo para 'Atraso na Inicializa√ß√£o'..." -ForegroundColor Yellow
                    
                    # Selecionar servi√ßo para configurar
                    $serviceChoice = Read-Host "Digite o n√∫mero do servi√ßo que deseja configurar (ou 0 para voltar)"
                    
                    if ($serviceChoice -eq "0" -or $serviceChoice -eq "") {
                        Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
                        break
                    }
                    
                    $serviceIndex = [int]$serviceChoice - 1
                    if ($serviceIndex -lt 0 -or $serviceIndex -ge $startupServices.Count) {
                        Write-Host "Sele√ß√£o inv√°lida." -ForegroundColor Red
                        break
                    }
                    
                    $selectedService = $startupServices[$serviceIndex]
                    
                    # Configurar servi√ßo para 'Atraso na Inicializa√ß√£o'
                    Write-Host "Configurando $($selectedService.DisplayName) para 'Atraso na Inicializa√ß√£o'..." -ForegroundColor DarkGray
                    
                    # Configurar servi√ßo para autom√°tico (Atraso na Inicializa√ß√£o)
                    Set-Service -Name $selectedService.Name -StartupType AutomaticDelayedStart -ErrorAction SilentlyContinue
                    
                    Write-Host "$($selectedService.DisplayName) configurado para 'Atraso na Inicializa√ß√£o' com sucesso!" -ForegroundColor Green
                }
                "0" {
                    Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
                }
                default {
                    Write-Host "Op√ß√£o inv√°lida." -ForegroundColor Red
                }
            }
        }
        "0" {
            Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
        }
        default {
            Write-Host "Op√ß√£o inv√°lida." -ForegroundColor Red
        }
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Desempenho..."
}

# --- Fun√ß√µes para os Sub-Subgrupos AVANCADOS - REDE (Expandidas) ---
function Invoke-NetworkFlushDns {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Limpar Cache de DNS ---" -ForegroundColor Yellow
    Write-Host "Limpa o cache de resolu√ß√£o de nomes de dom√≠nio local (`ipconfig /flushdns`)." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Executando: Limpando cache de DNS..." -ForegroundColor Yellow
    
    # Mostrar estat√≠sticas do cache DNS antes da limpeza (se dispon√≠vel)
    try {
        Write-Host "Estat√≠sticas do cache DNS antes da limpeza:" -ForegroundColor White
        Get-DnsClientCache | Measure-Object | ForEach-Object { Write-Host "Entradas no cache: $($_.Count)" -ForegroundColor White }
    } catch {
        Write-Host "N√£o foi poss√≠vel obter estat√≠sticas do cache DNS." -ForegroundColor DarkGray
    }
    
    # Limpar o cache DNS
    ipconfig /flushdns
    Write-Host "Cache de DNS limpo com sucesso!" -ForegroundColor Green
    
    # Verificar se o cache est√° vazio ap√≥s a limpeza
    try {
        $dnsEntriesAfter = (Get-DnsClientCache | Measure-Object).Count
        Write-Host "Entradas no cache ap√≥s limpeza: $dnsEntriesAfter" -ForegroundColor White
    } catch {
        Write-Host "N√£o foi poss√≠vel verificar o cache DNS ap√≥s a limpeza." -ForegroundColor DarkGray
    }
    
    Write-Host "`nBenef√≠cios da limpeza do cache DNS:" -ForegroundColor Cyan
    Write-Host "- Resolu√ß√£o mais r√°pida de novos endere√ßos de sites" -ForegroundColor DarkGray
    Write-Host "- Corre√ß√£o de problemas de acesso a sites que mudaram de endere√ßo IP" -ForegroundColor DarkGray
    Write-Host "- Melhoria na navega√ß√£o web em geral" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-NetworkChangeDns {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Mudar Servidor DNS ---" -ForegroundColor Cyan
    Write-Host "Permite definir servidores DNS personalizados para suas conex√µes de rede." -ForegroundColor DarkGray
    Write-Host ""

    # Listar adaptadores de rede ativos
    Write-Host "Listando adaptadores de rede ativos..." -ForegroundColor Yellow
    $networkAdapters = Get-NetAdapter | Where-Object { $_.Status -eq "Up" }
    
    if ($networkAdapters.Count -eq 0) {
        Write-Host "Nenhum adaptador de rede ativo encontrado." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    Write-Host "Adaptadores de rede ativos:" -ForegroundColor White
    $index = 1
    foreach ($adapter in $networkAdapters) {
        Write-Host "[$index] $($adapter.Name) - $($adapter.InterfaceDescription)" -ForegroundColor White
        $index++
    }
    Write-Host ""
    
    # Selecionar adaptador de rede
    $adapterChoice = Read-Host "Selecione o n√∫mero do adaptador que deseja configurar (ou 0 para voltar)"
    
    if ($adapterChoice -eq "0" -or $adapterChoice -eq "") {
        Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    $adapterIndex = [int]$adapterChoice - 1
    if ($adapterIndex -lt 0 -or $adapterIndex -ge $networkAdapters.Count) {
        Write-Host "Sele√ß√£o inv√°lida." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    $selectedAdapter = $networkAdapters[$adapterIndex]
    
    # Mostrar configura√ß√£o DNS atual
    Write-Host "Configura√ß√£o DNS atual para $($selectedAdapter.Name):" -ForegroundColor Yellow
    $currentDns = Get-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -AddressFamily IPv4 | Select-Object -ExpandProperty ServerAddresses
    
    if ($currentDns.Count -eq 0) {
        Write-Host "Nenhum servidor DNS configurado manualmente (usando DHCP)." -ForegroundColor DarkGray
    } else {
        foreach ($dns in $currentDns) {
            Write-Host $dns -ForegroundColor White
        }
    }
    Write-Host ""
    
    # Op√ß√µes de DNS
    Write-Host "Op√ß√µes de DNS:" -ForegroundColor Yellow
    Write-Host "[1] Google DNS (8.8.8.8, 8.8.4.4)" -ForegroundColor White
    Write-Host "[2] Cloudflare DNS (1.1.1.1, 1.0.0.1)" -ForegroundColor White
    Write-Host "[3] OpenDNS (208.67.222.222, 208.67.220.220)" -ForegroundColor White
    Write-Host "[4] Quad9 (9.9.9.9, 149.112.112.112)" -ForegroundColor White
    Write-Host "[5] AdGuard DNS (94.140.14.14, 94.140.15.15)" -ForegroundColor White
    Write-Host "[6] Inserir DNS personalizado" -ForegroundColor White
    Write-Host "[7] Usar DNS autom√°tico (DHCP)" -ForegroundColor White
    Write-Host "[0] Cancelar" -ForegroundColor White
    Write-Host ""
    
    $dnsChoice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($dnsChoice) {
        "1" {
            $primaryDns = "8.8.8.8"
            $secondaryDns = "8.8.4.4"
            $dnsName = "Google DNS"
        }
        "2" {
            $primaryDns = "1.1.1.1"
            $secondaryDns = "1.0.0.1"
            $dnsName = "Cloudflare DNS"
        }
        "3" {
            $primaryDns = "208.67.222.222"
            $secondaryDns = "208.67.220.220"
            $dnsName = "OpenDNS"
        }
        "4" {
            $primaryDns = "9.9.9.9"
            $secondaryDns = "149.112.112.112"
            $dnsName = "Quad9"
        }
        "5" {
            $primaryDns = "94.140.14.14"
            $secondaryDns = "94.140.15.15"
            $dnsName = "AdGuard DNS"
        }
        "6" {
            $primaryDns = Read-Host "Digite o endere√ßo do DNS prim√°rio"
            $secondaryDns = Read-Host "Digite o endere√ßo do DNS secund√°rio (ou deixe em branco)"
            $dnsName = "DNS Personalizado"
        }
        "7" {
            Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ResetServerAddresses
            Write-Host "Configura√ß√£o de DNS definida para autom√°tica (DHCP)." -ForegroundColor Green
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
        "0" {
            Write-Host "Opera√ß√£o cancelada." -ForegroundColor Yellow
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
        default {
            Write-Host "Op√ß√£o inv√°lida." -ForegroundColor Red
            Write-Host ""
            Read-Host "Pressione Enter para voltar ao menu de Rede..."
            return
        }
    }
    
    # Aplicar configura√ß√£o de DNS
    if ($secondaryDns -eq "") {
        Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ServerAddresses $primaryDns
    } else {
        Set-DnsClientServerAddress -InterfaceIndex $selectedAdapter.ifIndex -ServerAddresses $primaryDns, $secondaryDns
    }
    
    Write-Host "Configura√ß√£o de DNS alterada para $dnsName." -ForegroundColor Green
    Write-Host "DNS Prim√°rio: $primaryDns" -ForegroundColor White
    if ($secondaryDns -ne "") {
        Write-Host "DNS Secund√°rio: $secondaryDns" -ForegroundColor White
    }
    
    # Limpar cache DNS ap√≥s a mudan√ßa
    Write-Host "Limpando cache DNS para aplicar as altera√ß√µes..." -ForegroundColor Yellow
    ipconfig /flushdns
    Write-Host "Cache DNS limpo." -ForegroundColor Green
    
    Write-Host "`nBenef√≠cios de usar servidores DNS alternativos:" -ForegroundColor Cyan
    Write-Host "- Maior velocidade de resolu√ß√£o de nomes" -ForegroundColor DarkGray
    Write-Host "- Melhor confiabilidade e disponibilidade" -ForegroundColor DarkGray
    Write-Host "- Alguns servidores oferecem prote√ß√£o adicional contra malware e phishing" -ForegroundColor DarkGray
    Write-Host "- Possibilidade de contornar bloqueios de conte√∫do baseados em DNS" -ForegroundColor DarkGray

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-NetworkReset {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Resetar Configura√ß√µes de Rede ---" -ForegroundColor White
    Write-Host "Reinicia os componentes de rede. Use como √∫ltimo recurso para solucionar problemas de conex√£o." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "!!! ATEN√á√ÉO: ESTE COMANDO VAI REINICIAR SUAS CONFIGURA√á√ïES DE REDE !!!" -ForegroundColor Red
    Write-Host "Sua conex√£o ser√° interrompida temporariamente e todas as configura√ß√µes de rede personalizadas ser√£o redefinidas." -ForegroundColor Yellow
    Write-Host "Isso inclui adaptadores de rede, configura√ß√µes de DNS, configura√ß√µes de proxy, etc." -ForegroundColor Yellow
    Write-Host ""
    
    Write-Host "Esta opera√ß√£o pode ajudar a resolver os seguintes problemas:" -ForegroundColor Cyan
    Write-Host "- Conex√µes de rede inst√°veis ou intermitentes" -ForegroundColor DarkGray
    Write-Host "- Problemas de DNS ou resolu√ß√£o de nomes" -ForegroundColor DarkGray
    Write-Host "- Problemas de conectividade ap√≥s instala√ß√£o de software ou atualiza√ß√µes" -ForegroundColor DarkGray
    Write-Host "- Erros de rede persistentes que n√£o s√£o resolvidos por outros m√©todos" -ForegroundColor DarkGray
    Write-Host ""
    
    $confirm = Read-Host "Tem certeza que deseja resetar as configura√ß√µes de rede? (digite 'sim' para confirmar)"
    
    if ($confirm -eq 'sim') {
        Write-Host "Iniciando reset de configura√ß√µes de rede..." -ForegroundColor Yellow
        
        # Etapa 1: Resetar pilha TCP/IP
        Write-Host "Etapa 1: Resetando pilha TCP/IP..." -ForegroundColor DarkGray
        netsh int ip reset
        
        # Etapa 2: Resetar cat√°logo Winsock
        Write-Host "Etapa 2: Resetando cat√°logo Winsock..." -ForegroundColor DarkGray
        netsh winsock reset
        
        # Etapa 3: Limpar cache DNS
        Write-Host "Etapa 3: Limpando cache DNS..." -ForegroundColor DarkGray
        ipconfig /flushdns
        
        # Etapa 4: Renovar configura√ß√µes DHCP
        Write-Host "Etapa 4: Renovando configura√ß√µes DHCP..." -ForegroundColor DarkGray
        ipconfig /release
        ipconfig /renew
        
        # Etapa 5: Reiniciar adaptadores de rede
        Write-Host "Etapa 5: Reiniciando adaptadores de rede..." -ForegroundColor DarkGray
        Get-NetAdapter | Restart-NetAdapter -ErrorAction SilentlyContinue
        
        Write-Host "Reset de configura√ß√µes de rede conclu√≠do!" -ForegroundColor Green
        Write-Host "Recomenda-se reiniciar o computador para aplicar todas as altera√ß√µes." -ForegroundColor Yellow
        
        $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (s/n)"
        if ($confirmRestart -eq 's') {
            Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
            Restart-Computer -Force
        } else {
            Write-Host "Rein√≠cio cancelado. Algumas altera√ß√µes podem n√£o ter efeito at√© que o computador seja reiniciado." -ForegroundColor Yellow
        }
    } else {
        Write-Host "Reset de configura√ß√µes de rede cancelado." -ForegroundColor Green
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-OptimizeTcpIp {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Otimizar Configura√ß√µes TCP/IP ---" -ForegroundColor Green
    Write-Host "Ajusta configura√ß√µes avan√ßadas do TCP/IP para melhorar o desempenho da conex√£o." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o otimiza v√°rios par√¢metros TCP/IP para melhorar a velocidade e estabilidade da conex√£o." -ForegroundColor White
    Write-Host "As otimiza√ß√µes s√£o seguras e podem ser revertidas se necess√°rio." -ForegroundColor White
    Write-Host ""
    
    Write-Host "Configura√ß√µes atuais:" -ForegroundColor Yellow
    
    # Mostrar configura√ß√µes atuais
    Write-Host "Auto-Tuning Level:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Auto-Tuning Level"
    
    Write-Host "Congestion Provider:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Congestion Control Provider"
    
    Write-Host "ECN Capability:" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "ECN Capability"
    
    Write-Host "Receive-Side Scaling (RSS):" -ForegroundColor DarkGray
    netsh int tcp show global | Select-String "Receive-Side Scaling State"
    
    Write-Host ""
    $confirm = Read-Host "Deseja aplicar otimiza√ß√µes TCP/IP recomendadas? (s/n)"
    
    if ($confirm -eq 's') {
        Write-Host "Aplicando otimiza√ß√µes TCP/IP..." -ForegroundColor Yellow
        
        # Otimiza√ß√£o 1: Habilitar TCP Window Auto-Tuning
        Write-Host "Configurando TCP Auto-Tuning para 'normal'..." -ForegroundColor DarkGray
        netsh int tcp set global autotuninglevel=normal
        
        # Otimiza√ß√£o 2: Habilitar Receive-Side Scaling (RSS)
        Write-Host "Habilitando Receive-Side Scaling (RSS)..." -ForegroundColor DarkGray
        netsh int tcp set global rss=enabled
        
        # Otimiza√ß√£o 3: Configurar Congestion Provider para CTCP
        Write-Host "Configurando Congestion Provider para 'ctcp'..." -ForegroundColor DarkGray
        netsh int tcp set global congestionprovider=ctcp
        
        # Otimiza√ß√£o 4: Habilitar ECN Capability
        Write-Host "Habilitando ECN Capability..." -ForegroundColor DarkGray
        netsh int tcp set global ecncapability=enabled
        
        # Otimiza√ß√£o 5: Configurar NetDMA (se dispon√≠vel)
        Write-Host "Tentando configurar NetDMA..." -ForegroundColor DarkGray
        netsh int tcp set global netdma=enabled
        
        # Otimiza√ß√£o 6: Configurar tamanho de buffer TCP
        Write-Host "Configurando tamanho de buffer TCP..." -ForegroundColor DarkGray
        netsh int tcp set global chimney=enabled
        
        # Otimiza√ß√£o 7: Configurar QoS
        Write-Host "Configurando QoS..." -ForegroundColor DarkGray
        netsh int tcp set global timestamps=disabled
        
        Write-Host "Otimiza√ß√µes TCP/IP aplicadas com sucesso!" -ForegroundColor Green
        
        Write-Host "`nNovas configura√ß√µes:" -ForegroundColor Yellow
        
        # Mostrar novas configura√ß√µes
        Write-Host "Auto-Tuning Level:" -ForegroundColor DarkGray
        netsh int tcp show global | Select-String "Auto-Tuning Level"
        
        Write-Host "Congestion Provider:" -ForegroundColor DarkGray
        netsh int tcp show global | Select-String "Congestion Control Provider"
        
        Write-Host "ECN Capability:" -ForegroundColor DarkGray
        netsh int tcp show global | Select-String "ECN Capability"
        
        Write-Host "Receive-Side Scaling (RSS):" -ForegroundColor DarkGray
        netsh int tcp show global | Select-String "Receive-Side Scaling State"
        
        Write-Host "`nBenef√≠cios das otimiza√ß√µes TCP/IP:" -ForegroundColor Cyan
        Write-Host "- Melhor aproveitamento da largura de banda dispon√≠vel" -ForegroundColor DarkGray
        Write-Host "- Redu√ß√£o da lat√™ncia em conex√µes de internet" -ForegroundColor DarkGray
        Write-Host "- Melhor desempenho em downloads e uploads" -ForegroundColor DarkGray
        Write-Host "- Conex√µes mais est√°veis em redes congestionadas" -ForegroundColor DarkGray
        
        Write-Host "`nNota: Algumas altera√ß√µes podem requerer reinicializa√ß√£o para ter efeito completo." -ForegroundColor Yellow
        $confirmRestart = Read-Host "Deseja reiniciar o computador agora? (s/n)"
        
        if ($confirmRestart -eq 's') {
            Write-Host "Reiniciando o computador... Salve seu trabalho!" -ForegroundColor Red
            Restart-Computer -Force
        }
    } else {
        Write-Host "Otimiza√ß√µes TCP/IP canceladas." -ForegroundColor Yellow
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-CheckNetworkSpeed {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Verificar Velocidade da Conex√£o ---" -ForegroundColor Magenta
    Write-Host "Realiza testes para verificar a velocidade e qualidade da sua conex√£o com a internet." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "Esta fun√ß√£o realiza testes b√°sicos para avaliar a velocidade e qualidade da sua conex√£o." -ForegroundColor White
    Write-Host "Nota: Para testes de velocidade mais precisos, recomendamos usar sites especializados como speedtest.net" -ForegroundColor White
    Write-Host ""
    
    # Teste 1: Verificar conectividade b√°sica
    Write-Host "Teste 1: Verificando conectividade b√°sica com a internet..." -ForegroundColor Yellow
    $pingGoogle = Test-Connection -ComputerName google.com -Count 4 -ErrorAction SilentlyContinue
    
    if ($pingGoogle) {
        $avgLatency = ($pingGoogle | Measure-Object -Property ResponseTime -Average).Average
        $maxLatency = ($pingGoogle | Measure-Object -Property ResponseTime -Maximum).Maximum
        $minLatency = ($pingGoogle | Measure-Object -Property ResponseTime -Minimum).Minimum
        
        Write-Host "Conectividade: OK" -ForegroundColor Green
        Write-Host "Lat√™ncia m√©dia: $avgLatency ms" -ForegroundColor $(if ($avgLatency -lt 50) { "Green" } elseif ($avgLatency -lt 100) { "Yellow" } else { "Red" })
        Write-Host "Lat√™ncia m√≠nima: $minLatency ms" -ForegroundColor Green
        Write-Host "Lat√™ncia m√°xima: $maxLatency ms" -ForegroundColor $(if ($maxLatency -lt 100) { "Green" } elseif ($maxLatency -lt 200) { "Yellow" } else { "Red" })
        
        # Avalia√ß√£o da qualidade da conex√£o
        if ($avgLatency -lt 30) {
            $qualidade = "Excelente"
            $cor = "Green"
        } elseif ($avgLatency -lt 60) {
            $qualidade = "Boa"
            $cor = "Green"
        } elseif ($avgLatency -lt 100) {
            $qualidade = "Razo√°vel"
            $cor = "Yellow"
        } else {
            $qualidade = "Ruim"
            $cor = "Red"
        }
        
        Write-Host "Qualidade da conex√£o: $qualidade" -ForegroundColor $cor
    } else {
        Write-Host "N√£o foi poss√≠vel conectar √† internet. Verifique sua conex√£o." -ForegroundColor Red
        Write-Host ""
        Read-Host "Pressione Enter para voltar ao menu de Rede..."
        return
    }
    
    Write-Host ""
    
    # Teste 2: Verificar resolu√ß√£o DNS
    Write-Host "Teste 2: Verificando velocidade de resolu√ß√£o DNS..." -ForegroundColor Yellow
    $domains = @("google.com", "microsoft.com", "amazon.com", "facebook.com", "youtube.com")
    $dnsResults = @()
    
    foreach ($domain in $domains) {
        $startTime = Get-Date
        try {
            $null = Resolve-DnsName -Name $domain -ErrorAction SilentlyContinue
            $endTime = Get-Date
            $timeSpan = New-TimeSpan -Start $startTime -End $endTime
            $dnsResults += [PSCustomObject]@{
                Domain = $domain
                Time = $timeSpan.TotalMilliseconds
                Status = "OK"
            }
        } catch {
            $dnsResults += [PSCustomObject]@{
                Domain = $domain
                Time = 0
                Status = "Falha"
            }
        }
    }
    
    $dnsResults | Format-Table -AutoSize
    
    $avgDnsTime = ($dnsResults | Where-Object { $_.Status -eq "OK" } | Measure-Object -Property Time -Average).Average
    Write-Host "Tempo m√©dio de resolu√ß√£o DNS: $([math]::Round($avgDnsTime, 2)) ms" -ForegroundColor $(if ($avgDnsTime -lt 50) { "Green" } elseif ($avgDnsTime -lt 100) { "Yellow" } else { "Red" })
    
    Write-Host ""
    
    # Teste 3: Verificar MTU
    Write-Host "Teste 3: Verificando MTU (Maximum Transmission Unit)..." -ForegroundColor Yellow
    
    $activeAdapter = Get-NetAdapter | Where-Object { $_.Status -eq "Up" } | Select-Object -First 1
    if ($activeAdapter) {
        $mtu = Get-NetIPInterface -InterfaceIndex $activeAdapter.ifIndex -AddressFamily IPv4 | Select-Object -ExpandProperty NlMtu
        Write-Host "MTU atual: $mtu bytes" -ForegroundColor White
        
        if ($mtu -eq 1500) {
            Write-Host "MTU est√° no valor padr√£o (1500), que √© ideal para a maioria das conex√µes." -ForegroundColor Green
        } elseif ($mtu -lt 1500) {
            Write-Host "MTU est√° abaixo do valor padr√£o. Isso pode afetar o desempenho em algumas situa√ß√µes." -ForegroundColor Yellow
        } else {
            Write-Host "MTU est√° acima do valor padr√£o. Isso pode causar fragmenta√ß√£o de pacotes em algumas redes." -ForegroundColor Yellow
        }
    } else {
        Write-Host "N√£o foi poss√≠vel determinar o MTU. Nenhum adaptador de rede ativo encontrado." -ForegroundColor Red
    }
    
    Write-Host ""
    
    # Teste 4: Verificar perda de pacotes
    Write-Host "Teste 4: Verificando perda de pacotes..." -ForegroundColor Yellow
    $packetLossTest = Test-Connection -ComputerName google.com -Count 50 -ErrorAction SilentlyContinue
    
    if ($packetLossTest) {
        $packetsSent = 50
        $packetsReceived = ($packetLossTest | Measure-Object).Count
        $packetsLost = $packetsSent - $packetsReceived
        $packetLossPercentage = ($packetsLost / $packetsSent) * 100
        
        Write-Host "Pacotes enviados: $packetsSent" -ForegroundColor White
        Write-Host "Pacotes recebidos: $packetsReceived" -ForegroundColor White
        Write-Host "Pacotes perdidos: $packetsLost" -ForegroundColor $(if ($packetsLost -eq 0) { "Green" } elseif ($packetsLost -lt 5) { "Yellow" } else { "Red" })
        Write-Host "Percentual de perda: $([math]::Round($packetLossPercentage, 2))%" -ForegroundColor $(if ($packetLossPercentage -eq 0) { "Green" } elseif ($packetLossPercentage -lt 10) { "Yellow" } else { "Red" })
        
        # Avalia√ß√£o da qualidade da conex√£o baseada na perda de pacotes
        if ($packetLossPercentage -eq 0) {
            Write-Host "Qualidade da conex√£o (perda de pacotes): Excelente" -ForegroundColor Green
        } elseif ($packetLossPercentage -lt 2) {
            Write-Host "Qualidade da conex√£o (perda de pacotes): Boa" -ForegroundColor Green
        } elseif ($packetLossPercentage -lt 5) {
            Write-Host "Qualidade da conex√£o (perda de pacotes): Razo√°vel" -ForegroundColor Yellow
        } else {
            Write-Host "Qualidade da conex√£o (perda de pacotes): Ruim" -ForegroundColor Red
        }
    } else {
        Write-Host "N√£o foi poss√≠vel realizar o teste de perda de pacotes." -ForegroundColor Red
    }
    
    Write-Host ""
    
    # Resumo e recomenda√ß√µes
    Write-Host "=== Resumo da An√°lise de Rede ===" -ForegroundColor Cyan
    
    # Recomenda√ß√µes baseadas nos resultados
    Write-Host "Recomenda√ß√µes:" -ForegroundColor Yellow
    
    if ($avgLatency -gt 100) {
        Write-Host "- Sua lat√™ncia est√° alta. Considere verificar outros dispositivos na rede ou contatar seu provedor." -ForegroundColor Yellow
    }
    
    if ($avgDnsTime -gt 100) {
        Write-Host "- A resolu√ß√£o DNS est√° lenta. Considere mudar para servidores DNS mais r√°pidos como Google (8.8.8.8) ou Cloudflare (1.1.1.1)." -ForegroundColor Yellow
    }
    
    if ($packetLossPercentage -gt 2) {
        Write-Host "- H√° perda significativa de pacotes. Verifique sua conex√£o f√≠sica ou contate seu provedor." -ForegroundColor Yellow
    }
    
    if ($mtu -ne 1500 -and $mtu -ne 0) {
        Write-Host "- Seu MTU n√£o est√° no valor padr√£o. Considere ajust√°-lo para 1500 para melhor desempenho." -ForegroundColor Yellow
    }
    
    if ($avgLatency -le 100 -and $avgDnsTime -le 100 -and $packetLossPercentage -le 2) {
        Write-Host "- Sua conex√£o parece estar em boas condi√ß√µes! N√£o h√° problemas significativos detectados." -ForegroundColor Green
    }

    Write-Host ""
    Read-Host "Pressione Enter para voltar ao menu de Rede..."
}

function Invoke-ConfigureQoS {
    Clear-Host
    Banner-TORK
    Write-Host ""
    Write-Host "--- Rede: Configurar QoS (Qualidade de Servi√ßo) ---" -ForegroundColor Gray
    Write-Host "Configura prioridades de tr√°fego de rede para melhorar o desempenho de aplica√ß√µes espec√≠ficas." -ForegroundColor DarkGray
    Write-Host ""

    Write-Host "O QoS (Quality of Service) permite priorizar certos tipos de tr√°fego de rede sobre outros." -ForegroundColor White
    Write-Host "Isso √© √∫til para garantir que aplica√ß√µes importantes como jogos, chamadas de v√≠deo ou streaming" -ForegroundColor White
    Write-Host "tenham prioridade sobre downloads ou atualiza√ß√µes em segundo plano." -ForegroundColor White
    Write-Host ""
    
    Write-Host "Op√ß√µes de configura√ß√£o de QoS:" -ForegroundColor Yellow
    Write-Host "[1] Configurar QoS para Jogos (prioriza tr√°fego de jogos)" -ForegroundColor White
    Write-Host "[2] Configurar QoS para Videoconfer√™ncia (prioriza Zoom, Teams, etc.)" -ForegroundColor White
    Write-Host "[3] Configurar QoS para Streaming (prioriza Netflix, YouTube, etc.)" -ForegroundColor White
    Write-Host "[4] Configurar QoS Personalizado" -ForegroundColor White
    Write-Host "[5] Desativar QoS" -ForegroundColor White
    Write-Host "[0] Voltar" -ForegroundColor White
    Write-Host ""
    
    $qosChoice = Read-Host "Selecione uma op√ß√£o"
    
    switch ($qosChoice) {
        "1" {
            Write-Host "Configurando QoS para Jogos..." -ForegroundColor Yellow
            
            # Criar pol√≠tica de QoS para jogos
            Write-Host "Criando pol√≠tica de QoS para jogos..." -ForegroundColor DarkGray
            
            # Verificar se o servi√ßo QoS est√° em execu√ß√£o
            $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            if ($qosService -and $qosService.Status -ne "Running") {
                Write-Host "Iniciando servi√ßo QoS RSVP..." -ForegroundColor DarkGray
                Start-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            }
            
            # Configurar QoS para jogos usando netsh
            netsh advfirewall firewall add rule name="QoS-Games" dir=out action=allow protocol=UDP remoteport=3074,3478,3479,3480 enable=yes
            
            # Configurar prioridade para jogos
            if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS")) {
                New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Force | Out-Null
            }
            
            # Adicionar pol√≠tica para jogos
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Application Name" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Protocol" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Remote Port" -Value "3074,3478-3480" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "DSCP Value" -Value "46" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Games" -Name "Throttle Rate" -Value "-1" -Type String
            
            Write-Host "QoS para Jogos configurado com sucesso!" -ForegroundColor Green
            Write-Host "Os jogos online agora ter√£o prioridade sobre outros tipos de tr√°fego." -ForegroundColor Green
        }
        "2" {
            Write-Host "Configurando QoS para Videoconfer√™ncia..." -ForegroundColor Yellow
            
            # Criar pol√≠tica de QoS para videoconfer√™ncia
            Write-Host "Criando pol√≠tica de QoS para videoconfer√™ncia..." -ForegroundColor DarkGray
            
            # Verificar se o servi√ßo QoS est√° em execu√ß√£o
            $qosService = Get-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            if ($qosService -and $qosService.Status -ne "Running") {
                Write-Host "Iniciando servi√ßo QoS RSVP..." -ForegroundColor DarkGray
                Start-Service -Name "QoS RSVP" -ErrorAction SilentlyContinue
            }
            
            # Configurar QoS para videoconfer√™ncia usando netsh
            netsh advfirewall firewall add rule name="QoS-VideoConference" dir=out action=allow protocol=UDP remoteport=3478-3479,8801-8810 enable=yes
            
            # Configurar prioridade para videoconfer√™ncia
            if (-not (Test-Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS")) {
                New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS" -Force | Out-Null
            }
            
            # Adicionar pol√≠tica para Zoom
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Application Name" -Value "Zoom.exe" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Protocol" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Remote Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "DSCP Value" -Value "46" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Zoom" -Name "Throttle Rate" -Value "-1" -Type String
            
            # Adicionar pol√≠tica para Teams
            New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Force | Out-Null
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Application Name" -Value "Teams.exe" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Version" -Value "1.0" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Protocol" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Local Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Local IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Remote Port" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\QoS\Teams" -Name "Remote IP" -Value "*" -Type String
            Set-ItemProperty -Path "HKLM:\SOFTWARE\
